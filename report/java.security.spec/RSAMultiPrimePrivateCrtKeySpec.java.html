<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>RSAMultiPrimePrivateCrtKeySpec.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.security.spec</a> &gt; <span class="el_source">RSAMultiPrimePrivateCrtKeySpec.java</span></div><h1>RSAMultiPrimePrivateCrtKeySpec.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2001, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package java.security.spec;

import java.math.BigInteger;

/**
 * This class specifies an RSA multi-prime private key, as defined in the
 * PKCS#1 v2.1, using the Chinese Remainder Theorem (CRT) information
 * values for efficiency.
 *
 * @author Valerie Peng
 *
 *
 * @see java.security.Key
 * @see java.security.KeyFactory
 * @see KeySpec
 * @see PKCS8EncodedKeySpec
 * @see RSAPrivateKeySpec
 * @see RSAPublicKeySpec
 * @see RSAOtherPrimeInfo
 *
 * @since 1.4
 */

public class RSAMultiPrimePrivateCrtKeySpec extends RSAPrivateKeySpec {

    private final BigInteger publicExponent;
    private final BigInteger primeP;
    private final BigInteger primeQ;
    private final BigInteger primeExponentP;
    private final BigInteger primeExponentQ;
    private final BigInteger crtCoefficient;
    private final RSAOtherPrimeInfo otherPrimeInfo[];

   /**
    * Creates a new {@code RSAMultiPrimePrivateCrtKeySpec}
    * given the modulus, publicExponent, privateExponent,
    * primeP, primeQ, primeExponentP, primeExponentQ,
    * crtCoefficient, and otherPrimeInfo as defined in PKCS#1 v2.1.
    *
    * &lt;p&gt;Note that the contents of {@code otherPrimeInfo}
    * are copied to protect against subsequent modification when
    * constructing this object.
    *
    * @param modulus the modulus n.
    * @param publicExponent the public exponent e.
    * @param privateExponent the private exponent d.
    * @param primeP the prime factor p of n.
    * @param primeQ the prime factor q of n.
    * @param primeExponentP this is d mod (p-1).
    * @param primeExponentQ this is d mod (q-1).
    * @param crtCoefficient the Chinese Remainder Theorem
    * coefficient q-1 mod p.
    * @param otherPrimeInfo triplets of the rest of primes, null can be
    * specified if there are only two prime factors (p and q).
    * @exception NullPointerException if any of the parameters, i.e.
    * {@code modulus},
    * {@code publicExponent}, {@code privateExponent},
    * {@code primeP}, {@code primeQ},
    * {@code primeExponentP}, {@code primeExponentQ},
    * {@code crtCoefficient}, is null.
    * @exception IllegalArgumentException if an empty, i.e. 0-length,
    * {@code otherPrimeInfo} is specified.
    */
    public RSAMultiPrimePrivateCrtKeySpec(BigInteger modulus,
                                BigInteger publicExponent,
                                BigInteger privateExponent,
                                BigInteger primeP,
                                BigInteger primeQ,
                                BigInteger primeExponentP,
                                BigInteger primeExponentQ,
                                BigInteger crtCoefficient,
                                RSAOtherPrimeInfo[] otherPrimeInfo) {
<span class="nc" id="L98">        super(modulus, privateExponent);</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">        if (modulus == null) {</span>
<span class="nc" id="L100">            throw new NullPointerException(&quot;the modulus parameter must be &quot; +</span>
                                            &quot;non-null&quot;);
        }
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (publicExponent == null) {</span>
<span class="nc" id="L104">            throw new NullPointerException(&quot;the publicExponent parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L107" title="All 2 branches missed.">        if (privateExponent == null) {</span>
<span class="nc" id="L108">            throw new NullPointerException(&quot;the privateExponent parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (primeP == null) {</span>
<span class="nc" id="L112">            throw new NullPointerException(&quot;the primeP parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L115" title="All 2 branches missed.">        if (primeQ == null) {</span>
<span class="nc" id="L116">            throw new NullPointerException(&quot;the primeQ parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L119" title="All 2 branches missed.">        if (primeExponentP == null) {</span>
<span class="nc" id="L120">            throw new NullPointerException(&quot;the primeExponentP parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L123" title="All 2 branches missed.">        if (primeExponentQ == null) {</span>
<span class="nc" id="L124">            throw new NullPointerException(&quot;the primeExponentQ parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc bnc" id="L127" title="All 2 branches missed.">        if (crtCoefficient == null) {</span>
<span class="nc" id="L128">            throw new NullPointerException(&quot;the crtCoefficient parameter &quot; +</span>
                                            &quot;must be non-null&quot;);
        }
<span class="nc" id="L131">        this.publicExponent = publicExponent;</span>
<span class="nc" id="L132">        this.primeP = primeP;</span>
<span class="nc" id="L133">        this.primeQ = primeQ;</span>
<span class="nc" id="L134">        this.primeExponentP = primeExponentP;</span>
<span class="nc" id="L135">        this.primeExponentQ = primeExponentQ;</span>
<span class="nc" id="L136">        this.crtCoefficient = crtCoefficient;</span>
<span class="nc bnc" id="L137" title="All 2 branches missed.">        if (otherPrimeInfo == null)  {</span>
<span class="nc" id="L138">            this.otherPrimeInfo = null;</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">        } else if (otherPrimeInfo.length == 0) {</span>
<span class="nc" id="L140">            throw new IllegalArgumentException(&quot;the otherPrimeInfo &quot; +</span>
                                                &quot;parameter must not be empty&quot;);
        } else {
<span class="nc" id="L143">            this.otherPrimeInfo = otherPrimeInfo.clone();</span>
        }
<span class="nc" id="L145">    }</span>

    /**
     * Returns the public exponent.
     *
     * @return the public exponent.
     */
    public BigInteger getPublicExponent() {
<span class="nc" id="L153">        return this.publicExponent;</span>
    }

    /**
     * Returns the primeP.
     *
     * @return the primeP.
     */
    public BigInteger getPrimeP() {
<span class="nc" id="L162">        return this.primeP;</span>
    }

    /**
     * Returns the primeQ.
     *
     * @return the primeQ.
     */
    public BigInteger getPrimeQ() {
<span class="nc" id="L171">        return this.primeQ;</span>
    }

    /**
     * Returns the primeExponentP.
     *
     * @return the primeExponentP.
     */
    public BigInteger getPrimeExponentP() {
<span class="nc" id="L180">        return this.primeExponentP;</span>
    }

    /**
     * Returns the primeExponentQ.
     *
     * @return the primeExponentQ.
     */
    public BigInteger getPrimeExponentQ() {
<span class="nc" id="L189">        return this.primeExponentQ;</span>
    }

    /**
     * Returns the crtCoefficient.
     *
     * @return the crtCoefficient.
     */
    public BigInteger getCrtCoefficient() {
<span class="nc" id="L198">        return this.crtCoefficient;</span>
    }

    /**
     * Returns a copy of the otherPrimeInfo or null if there are
     * only two prime factors (p and q).
     *
     * @return the otherPrimeInfo. Returns a new array each
     * time this method is called.
     */
    public RSAOtherPrimeInfo[] getOtherPrimeInfo() {
<span class="nc bnc" id="L209" title="All 2 branches missed.">        if (otherPrimeInfo == null) return null;</span>
<span class="nc" id="L210">        return otherPrimeInfo.clone();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>