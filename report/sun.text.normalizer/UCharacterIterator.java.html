<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>UCharacterIterator.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">sun.text.normalizer</a> &gt; <span class="el_source">UCharacterIterator.java</span></div><h1>UCharacterIterator.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2003, 2006, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

/*
 *******************************************************************************
 * (C) Copyright IBM Corp. 1996-2005 - All Rights Reserved                     *
 *                                                                             *
 * The original version of this source code and documentation is copyrighted   *
 * and owned by IBM, These materials are provided under terms of a License     *
 * Agreement between IBM and Sun. This technology is protected by multiple     *
 * US and International patents. This notice and attribution to IBM may not    *
 * to removed.                                                                 *
 *******************************************************************************
 */

package sun.text.normalizer;

import java.text.CharacterIterator;

/**
 * Abstract class that defines an API for iteration on text objects.This is an
 * interface for forward and backward iteration and random access into a text
 * object. Forward iteration is done with post-increment and backward iteration
 * is done with pre-decrement semantics, while the
 * &lt;code&gt;java.text.CharacterIterator&lt;/code&gt; interface methods provided forward
 * iteration with &quot;pre-increment&quot; and backward iteration with pre-decrement
 * semantics. This API is more efficient for forward iteration over code points.
 * The other major difference is that this API can do both code unit and code point
 * iteration, &lt;code&gt;java.text.CharacterIterator&lt;/code&gt; can only iterate over
 * code units and is limited to BMP (0 - 0xFFFF)
 * @author Ram
 * @stable ICU 2.4
 */
public abstract class UCharacterIterator
                      implements Cloneable {

    /**
     * Protected default constructor for the subclasses
     * @stable ICU 2.4
     */
<span class="nc" id="L63">    protected UCharacterIterator(){</span>
<span class="nc" id="L64">    }</span>

    /**
     * Indicator that we have reached the ends of the UTF16 text.
     * Moved from UForwardCharacterIterator.java
     * @stable ICU 2.4
     */
    public static final int DONE = -1;

    // static final methods ----------------------------------------------------

    /**
     * Returns a &lt;code&gt;UCharacterIterator&lt;/code&gt; object given a
     * source string.
     * @param source a string
     * @return UCharacterIterator object
     * @exception IllegalArgumentException if the argument is null
     * @stable ICU 2.4
     */
    public static final UCharacterIterator getInstance(String source){
<span class="nc" id="L84">        return new ReplaceableUCharacterIterator(source);</span>
    }

    //// for StringPrep
    /**
     * Returns a &lt;code&gt;UCharacterIterator&lt;/code&gt; object given a
     * source StringBuffer.
     * @param source an string buffer of UTF-16 code units
     * @return UCharacterIterator object
     * @exception IllegalArgumentException if the argument is null
     * @stable ICU 2.4
     */
    public static final UCharacterIterator getInstance(StringBuffer source){
<span class="nc" id="L97">        return new ReplaceableUCharacterIterator(source);</span>
    }

    /**
     * Returns a &lt;code&gt;UCharacterIterator&lt;/code&gt; object given a
     * CharacterIterator.
     * @param source a valid CharacterIterator object.
     * @return UCharacterIterator object
     * @exception IllegalArgumentException if the argument is null
     * @stable ICU 2.4
     */
    public static final UCharacterIterator getInstance(CharacterIterator source){
<span class="nc" id="L109">        return new CharacterIteratorWrapper(source);</span>
    }

    // public methods ----------------------------------------------------------

    /**
     * Returns the code unit at the current index.  If index is out
     * of range, returns DONE.  Index is not changed.
     * @return current code unit
     * @stable ICU 2.4
     */
    public abstract int current();

    /**
     * Returns the length of the text
     * @return length of the text
     * @stable ICU 2.4
     */
    public abstract int getLength();


    /**
     * Gets the current index in text.
     * @return current index in text.
     * @stable ICU 2.4
     */
    public abstract int getIndex();


    /**
     * Returns the UTF16 code unit at index, and increments to the next
     * code unit (post-increment semantics).  If index is out of
     * range, DONE is returned, and the iterator is reset to the limit
     * of the text.
     * @return the next UTF16 code unit, or DONE if the index is at the limit
     *         of the text.
     * @stable ICU 2.4
     */
    public abstract int next();

    /**
     * Returns the code point at index, and increments to the next code
     * point (post-increment semantics).  If index does not point to a
     * valid surrogate pair, the behavior is the same as
     * &lt;code&gt;next()&lt;/code&gt;.  Otherwise the iterator is incremented past
     * the surrogate pair, and the code point represented by the pair
     * is returned.
     * @return the next codepoint in text, or DONE if the index is at
     *         the limit of the text.
     * @stable ICU 2.4
     */
    public int nextCodePoint(){
<span class="nc" id="L161">        int ch1 = next();</span>
<span class="nc bnc" id="L162" title="All 2 branches missed.">        if(UTF16.isLeadSurrogate((char)ch1)){</span>
<span class="nc" id="L163">            int ch2 = next();</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">            if(UTF16.isTrailSurrogate((char)ch2)){</span>
<span class="nc" id="L165">                return UCharacterProperty.getRawSupplementary((char)ch1,</span>
                                                              (char)ch2);
<span class="nc bnc" id="L167" title="All 2 branches missed.">            }else if (ch2 != DONE) {</span>
                // unmatched surrogate so back out
<span class="nc" id="L169">                previous();</span>
            }
        }
<span class="nc" id="L172">        return ch1;</span>
    }

    /**
     * Decrement to the position of the previous code unit in the
     * text, and return it (pre-decrement semantics).  If the
     * resulting index is less than 0, the index is reset to 0 and
     * DONE is returned.
     * @return the previous code unit in the text, or DONE if the new
     *         index is before the start of the text.
     * @stable ICU 2.4
     */
    public abstract int previous();

    /**
     * Sets the index to the specified index in the text.
     * @param index the index within the text.
     * @exception IndexOutOfBoundsException is thrown if an invalid index is
     *            supplied
     * @stable ICU 2.4
     */
    public abstract void setIndex(int index);

    //// for StringPrep
    /**
     * Fills the buffer with the underlying text storage of the iterator
     * If the buffer capacity is not enough a exception is thrown. The capacity
     * of the fill in buffer should at least be equal to length of text in the
     * iterator obtained by calling &lt;code&gt;getLength()&lt;/code&gt;.
     * &lt;b&gt;Usage:&lt;/b&gt;
     *
     * &lt;code&gt;
     * &lt;pre&gt;
     *         UChacterIterator iter = new UCharacterIterator.getInstance(text);
     *         char[] buf = new char[iter.getLength()];
     *         iter.getText(buf);
     *
     *         OR
     *         char[] buf= new char[1];
     *         int len = 0;
     *         for(;;){
     *             try{
     *                 len = iter.getText(buf);
     *                 break;
     *             }catch(IndexOutOfBoundsException e){
     *                 buf = new char[iter.getLength()];
     *             }
     *         }
     * &lt;/pre&gt;
     * &lt;/code&gt;
     *
     * @param fillIn an array of chars to fill with the underlying UTF-16 code
     *         units.
     * @param offset the position within the array to start putting the data.
     * @return the number of code units added to fillIn, as a convenience
     * @exception IndexOutOfBounds exception if there is not enough
     *            room after offset in the array, or if offset &lt; 0.
     * @stable ICU 2.4
     */
    public abstract int getText(char[] fillIn, int offset);

    //// for StringPrep
    /**
     * Convenience override for &lt;code&gt;getText(char[], int)&lt;/code&gt; that provides
     * an offset of 0.
     * @param fillIn an array of chars to fill with the underlying UTF-16 code
     *         units.
     * @return the number of code units added to fillIn, as a convenience
     * @exception IndexOutOfBounds exception if there is not enough
     *            room in the array.
     * @stable ICU 2.4
     */
    public final int getText(char[] fillIn) {
<span class="nc" id="L245">        return getText(fillIn, 0);</span>
    }

    //// for StringPrep
    /**
     * Convenience method for returning the underlying text storage as as string
     * @return the underlying text storage in the iterator as a string
     * @stable ICU 2.4
     */
    public String getText() {
<span class="nc" id="L255">        char[] text = new char[getLength()];</span>
<span class="nc" id="L256">        getText(text);</span>
<span class="nc" id="L257">        return new String(text);</span>
    }

    /**
     * Moves the current position by the number of code units
     * specified, either forward or backward depending on the sign
     * of delta (positive or negative respectively).  If the resulting
     * index would be less than zero, the index is set to zero, and if
     * the resulting index would be greater than limit, the index is
     * set to limit.
     *
     * @param delta the number of code units to move the current
     *              index.
     * @return the new index.
     * @exception IndexOutOfBoundsException is thrown if an invalid index is
     *            supplied
     * @stable ICU 2.4
     *
     */
    public int moveIndex(int delta) {
<span class="nc" id="L277">        int x = Math.max(0, Math.min(getIndex() + delta, getLength()));</span>
<span class="nc" id="L278">        setIndex(x);</span>
<span class="nc" id="L279">        return x;</span>
    }

    /**
     * Creates a copy of this iterator, independent from other iterators.
     * If it is not possible to clone the iterator, returns null.
     * @return copy of this iterator
     * @stable ICU 2.4
     */
    public Object clone() throws CloneNotSupportedException{
<span class="nc" id="L289">        return super.clone();</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>