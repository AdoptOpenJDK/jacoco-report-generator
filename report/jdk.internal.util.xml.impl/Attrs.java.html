<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Attrs.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">jdk.internal.util.xml.impl</a> &gt; <span class="el_source">Attrs.java</span></div><h1>Attrs.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package jdk.internal.util.xml.impl;

import jdk.internal.org.xml.sax.Attributes;

public class Attrs implements Attributes {

    /**
     * Attributes string array. Each individual attribute is represented by four
     * strings: namespace URL(+0), qname(+1), local name(+2), value(+3),
     * type(+4), declared[&quot;d&quot;] and default[&quot;D&quot;](+5). In order to find attribute
     * by the attrubute index, the attribute index MUST be multiplied by 8. The
     * result will point to the attribute namespace URL.
     */
    /* pkg */ String[] mItems;
    /**
     * Number of attributes in the attributes string array.
     */
    private char mLength;
    /**
     * current index
     */
<span class="fc" id="L47">    private char mAttrIdx = 0;</span>

    /**
     * Constructor.
     */
<span class="fc" id="L52">    public Attrs() {</span>
        //              The default number of attributies capacity is 8.
<span class="fc" id="L54">        mItems = new String[(8 &lt;&lt; 3)];</span>
<span class="fc" id="L55">    }</span>

    /**
     * Sets up the number of attributes and ensure the capacity of the attribute
     * string array.
     *
     * @param length The number of attributes in the object.
     */
    public void setLength(char length) {
<span class="pc bpc" id="L64" title="1 of 2 branches missed.">        if (length &gt; ((char) (mItems.length &gt;&gt; 3))) {</span>
<span class="nc" id="L65">            mItems = new String[length &lt;&lt; 3];</span>
        }
<span class="fc" id="L67">        mLength = length;</span>
<span class="fc" id="L68">    }</span>

    /**
     * Return the number of attributes in the list.
     *
     * &lt;p&gt;Once you know the number of attributes, you can iterate through the
     * list.&lt;/p&gt;
     *
     * @return The number of attributes in the list.
     * @see #getURI(int)
     * @see #getLocalName(int)
     * @see #getQName(int)
     * @see #getType(int)
     * @see #getValue(int)
     */
    public int getLength() {
<span class="nc" id="L84">        return mLength;</span>
    }

    /**
     * Look up an attribute's Namespace URI by index.
     *
     * @param index The attribute index (zero-based).
     * @return The Namespace URI, or the empty string if none is available, or
     * null if the index is out of range.
     * @see #getLength
     */
    public String getURI(int index) {
<span class="nc bnc" id="L96" title="All 4 branches missed.">        return ((index &gt;= 0) &amp;&amp; (index &lt; mLength))</span>
                ? (mItems[index &lt;&lt; 3])
                : null;
    }

    /**
     * Look up an attribute's local name by index.
     *
     * @param index The attribute index (zero-based).
     * @return The local name, or the empty string if Namespace processing is
     * not being performed, or null if the index is out of range.
     * @see #getLength
     */
    public String getLocalName(int index) {
<span class="nc bnc" id="L110" title="All 4 branches missed.">        return ((index &gt;= 0) &amp;&amp; (index &lt; mLength))</span>
                ? (mItems[(index &lt;&lt; 3) + 2])
                : null;
    }

    /**
     * Look up an attribute's XML 1.0 qualified name by index.
     *
     * @param index The attribute index (zero-based).
     * @return The XML 1.0 qualified name, or the empty string if none is
     * available, or null if the index is out of range.
     * @see #getLength
     */
    public String getQName(int index) {
<span class="nc bnc" id="L124" title="All 4 branches missed.">        if ((index &lt; 0) || (index &gt;= mLength)) {</span>
<span class="nc" id="L125">            return null;</span>
        }
<span class="nc" id="L127">        return mItems[(index &lt;&lt; 3) + 1];</span>
    }

    /**
     * Look up an attribute's type by index.
     *
     * &lt;p&gt;The attribute type is one of the strings &quot;CDATA&quot;, &quot;ID&quot;, &quot;IDREF&quot;,
     * &quot;IDREFS&quot;, &quot;NMTOKEN&quot;, &quot;NMTOKENS&quot;, &quot;ENTITY&quot;, &quot;ENTITIES&quot;, or &quot;NOTATION&quot;
     * (always in upper case).&lt;/p&gt;
     *
     * &lt;p&gt;If the parser has not read a declaration for the attribute, or if the
     * parser does not report attribute types, then it must return the value
     * &quot;CDATA&quot; as stated in the XML 1.0 Recommentation (clause 3.3.3,
     * &quot;Attribute-Value Normalization&quot;).&lt;/p&gt;
     *
     * &lt;p&gt;For an enumerated attribute that is not a notation, the parser will
     * report the type as &quot;NMTOKEN&quot;.&lt;/p&gt;
     *
     * @param index The attribute index (zero-based).
     * @return The attribute's type as a string, or null if the index is out of
     * range.
     * @see #getLength
     */
    public String getType(int index) {
<span class="nc bnc" id="L151" title="All 4 branches missed.">        return ((index &gt;= 0) &amp;&amp; (index &lt; (mItems.length &gt;&gt; 3)))</span>
                ? (mItems[(index &lt;&lt; 3) + 4])
                : null;
    }

    /**
     * Look up an attribute's value by index.
     *
     * &lt;p&gt;If the attribute value is a list of tokens (IDREFS, ENTITIES, or
     * NMTOKENS), the tokens will be concatenated into a single string with each
     * token separated by a single space.&lt;/p&gt;
     *
     * @param index The attribute index (zero-based).
     * @return The attribute's value as a string, or null if the index is out of
     * range.
     * @see #getLength
     */
    public String getValue(int index) {
<span class="nc bnc" id="L169" title="All 4 branches missed.">        return ((index &gt;= 0) &amp;&amp; (index &lt; mLength))</span>
                ? (mItems[(index &lt;&lt; 3) + 3])
                : null;
    }

    /**
     * Look up the index of an attribute by Namespace name.
     *
     * @param uri The Namespace URI, or the empty string if the name has no
     * Namespace URI.
     * @param localName The attribute's local name.
     * @return The index of the attribute, or -1 if it does not appear in the
     * list.
     */
    public int getIndex(String uri, String localName) {
<span class="nc" id="L184">        char len = mLength;</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">        for (char idx = 0; idx &lt; len; idx++) {</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">            if ((mItems[idx &lt;&lt; 3]).equals(uri)</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">                    &amp;&amp; mItems[(idx &lt;&lt; 3) + 2].equals(localName)) {</span>
<span class="nc" id="L188">                return idx;</span>
            }
        }
<span class="nc" id="L191">        return -1;</span>
    }

    /**
     * Look up the index of an attribute by Namespace name.
     *
     * @param uri The Namespace URI, or the empty string if the name has no
     * Namespace URI. &lt;code&gt;null&lt;/code&gt; value enforce the search by the local
     * name only.
     * @param localName The attribute's local name.
     * @return The index of the attribute, or -1 if it does not appear in the
     * list.
     */
    /* pkg */ int getIndexNullNS(String uri, String localName) {
<span class="nc" id="L205">        char len = mLength;</span>
<span class="nc bnc" id="L206" title="All 2 branches missed.">        if (uri != null) {</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">            for (char idx = 0; idx &lt; len; idx++) {</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">                if ((mItems[idx &lt;&lt; 3]).equals(uri)</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">                        &amp;&amp; mItems[(idx &lt;&lt; 3) + 2].equals(localName)) {</span>
<span class="nc" id="L210">                    return idx;</span>
                }
            }
        } else {
<span class="nc bnc" id="L214" title="All 2 branches missed.">            for (char idx = 0; idx &lt; len; idx++) {</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">                if (mItems[(idx &lt;&lt; 3) + 2].equals(localName)) {</span>
<span class="nc" id="L216">                    return idx;</span>
                }
            }
        }
<span class="nc" id="L220">        return -1;</span>
    }

    /**
     * Look up the index of an attribute by XML 1.0 qualified name.
     *
     * @param qName The qualified (prefixed) name.
     * @return The index of the attribute, or -1 if it does not appear in the
     * list.
     */
    public int getIndex(String qName) {
<span class="fc" id="L231">        char len = mLength;</span>
<span class="fc bfc" id="L232" title="All 2 branches covered.">        for (char idx = 0; idx &lt; len; idx++) {</span>
<span class="fc bfc" id="L233" title="All 2 branches covered.">            if (mItems[(idx &lt;&lt; 3) + 1].equals(qName)) {</span>
<span class="fc" id="L234">                return idx;</span>
            }
        }
<span class="fc" id="L237">        return -1;</span>
    }

    /**
     * Look up an attribute's type by Namespace name.
     *
     * &lt;p&gt;See {@link #getType(int) getType(int)} for a description of the
     * possible types.&lt;/p&gt;
     *
     * @param uri The Namespace URI, or the empty String if the name has no
     * Namespace URI.
     * @param localName The local name of the attribute.
     * @return The attribute type as a string, or null if the attribute is not
     * in the list or if Namespace processing is not being performed.
     */
    public String getType(String uri, String localName) {
<span class="nc" id="L253">        int idx = getIndex(uri, localName);</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">        return (idx &gt;= 0) ? (mItems[(idx &lt;&lt; 3) + 4]) : null;</span>
    }

    /**
     * Look up an attribute's type by XML 1.0 qualified name.
     *
     * &lt;p&gt;See {@link #getType(int) getType(int)} for a description of the
     * possible types.&lt;/p&gt;
     *
     * @param qName The XML 1.0 qualified name.
     * @return The attribute type as a string, or null if the attribute is not
     * in the list or if qualified names are not available.
     */
    public String getType(String qName) {
<span class="nc" id="L268">        int idx = getIndex(qName);</span>
<span class="nc bnc" id="L269" title="All 2 branches missed.">        return (idx &gt;= 0) ? (mItems[(idx &lt;&lt; 3) + 4]) : null;</span>
    }

    /**
     * Look up an attribute's value by Namespace name.
     *
     * &lt;p&gt;See {@link #getValue(int) getValue(int)} for a description of the
     * possible values.&lt;/p&gt;
     *
     * @param uri The Namespace URI, or the empty String if the name has no
     * Namespace URI.
     * @param localName The local name of the attribute.
     * @return The attribute value as a string, or null if the attribute is not
     * in the list.
     */
    public String getValue(String uri, String localName) {
<span class="nc" id="L285">        int idx = getIndex(uri, localName);</span>
<span class="nc bnc" id="L286" title="All 2 branches missed.">        return (idx &gt;= 0) ? (mItems[(idx &lt;&lt; 3) + 3]) : null;</span>
    }

    /**
     * Look up an attribute's value by XML 1.0 qualified name.
     *
     * &lt;p&gt;See {@link #getValue(int) getValue(int)} for a description of the
     * possible values.&lt;/p&gt;
     *
     * @param qName The XML 1.0 qualified name.
     * @return The attribute value as a string, or null if the attribute is not
     * in the list or if qualified names are not available.
     */
    public String getValue(String qName) {
<span class="fc" id="L300">        int idx = getIndex(qName);</span>
<span class="fc bfc" id="L301" title="All 2 branches covered.">        return (idx &gt;= 0) ? (mItems[(idx &lt;&lt; 3) + 3]) : null;</span>
    }

    /**
     * Returns false unless the attribute was declared in the DTD. This helps
     * distinguish two kinds of attributes that SAX reports as CDATA: ones that
     * were declared (and hence are usually valid), and those that were not (and
     * which are never valid).
     *
     * @param index The attribute index (zero-based).
     * @return true if the attribute was declared in the DTD, false otherwise.
     * @exception java.lang.ArrayIndexOutOfBoundsException When the supplied
     * index does not identify an attribute.
     */
    public boolean isDeclared(int index) {
<span class="nc bnc" id="L316" title="All 4 branches missed.">        if ((index &lt; 0) || (index &gt;= mLength)) {</span>
<span class="nc" id="L317">            throw new ArrayIndexOutOfBoundsException(&quot;&quot;);</span>
        }

<span class="nc bnc" id="L320" title="All 2 branches missed.">        return ((mItems[(index &lt;&lt; 3) + 5]) != null);</span>
    }

    /**
     * Returns false unless the attribute was declared in the DTD. This helps
     * distinguish two kinds of attributes that SAX reports as CDATA: ones that
     * were declared (and hence are usually valid), and those that were not (and
     * which are never valid).
     *
     * @param qName The XML qualified (prefixed) name.
     * @return true if the attribute was declared in the DTD, false otherwise.
     * @exception java.lang.IllegalArgumentException When the supplied name does
     * not identify an attribute.
     */
    public boolean isDeclared(String qName) {
<span class="nc" id="L335">        int idx = getIndex(qName);</span>
<span class="nc bnc" id="L336" title="All 2 branches missed.">        if (idx &lt; 0) {</span>
<span class="nc" id="L337">            throw new IllegalArgumentException(&quot;&quot;);</span>
        }

<span class="nc bnc" id="L340" title="All 2 branches missed.">        return ((mItems[(idx &lt;&lt; 3) + 5]) != null);</span>
    }

    /**
     * Returns false unless the attribute was declared in the DTD. This helps
     * distinguish two kinds of attributes that SAX reports as CDATA: ones that
     * were declared (and hence are usually valid), and those that were not (and
     * which are never valid).
     *
     * &lt;p&gt;Remember that since DTDs do not &quot;understand&quot; namespaces, the namespace
     * URI associated with an attribute may not have come from the DTD. The
     * declaration will have applied to the attribute's &lt;em&gt;qName&lt;/em&gt;.
     *
     * @param uri The Namespace URI, or the empty string if the name has no
     * Namespace URI.
     * @param localName The attribute's local name.
     * @return true if the attribute was declared in the DTD, false otherwise.
     * @exception java.lang.IllegalArgumentException When the supplied names do
     * not identify an attribute.
     */
    public boolean isDeclared(String uri, String localName) {
<span class="nc" id="L361">        int idx = getIndex(uri, localName);</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">        if (idx &lt; 0) {</span>
<span class="nc" id="L363">            throw new IllegalArgumentException(&quot;&quot;);</span>
        }

<span class="nc bnc" id="L366" title="All 2 branches missed.">        return ((mItems[(idx &lt;&lt; 3) + 5]) != null);</span>
    }

    /**
     * Returns true unless the attribute value was provided by DTD defaulting.
     *
     * @param index The attribute index (zero-based).
     * @return true if the value was found in the XML text, false if the value
     * was provided by DTD defaulting.
     * @exception java.lang.ArrayIndexOutOfBoundsException When the supplied
     * index does not identify an attribute.
     */
    public boolean isSpecified(int index) {
<span class="nc bnc" id="L379" title="All 4 branches missed.">        if ((index &lt; 0) || (index &gt;= mLength)) {</span>
<span class="nc" id="L380">            throw new ArrayIndexOutOfBoundsException(&quot;&quot;);</span>
        }

<span class="nc" id="L383">        String str = mItems[(index &lt;&lt; 3) + 5];</span>
<span class="nc bnc" id="L384" title="All 4 branches missed.">        return ((str != null) ? (str.charAt(0) == 'd') : true);</span>
    }

    /**
     * Returns true unless the attribute value was provided by DTD defaulting.
     *
     * &lt;p&gt;Remember that since DTDs do not &quot;understand&quot; namespaces, the namespace
     * URI associated with an attribute may not have come from the DTD. The
     * declaration will have applied to the attribute's &lt;em&gt;qName&lt;/em&gt;.
     *
     * @param uri The Namespace URI, or the empty string if the name has no
     * Namespace URI.
     * @param localName The attribute's local name.
     * @return true if the value was found in the XML text, false if the value
     * was provided by DTD defaulting.
     * @exception java.lang.IllegalArgumentException When the supplied names do
     * not identify an attribute.
     */
    public boolean isSpecified(String uri, String localName) {
<span class="nc" id="L403">        int idx = getIndex(uri, localName);</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">        if (idx &lt; 0) {</span>
<span class="nc" id="L405">            throw new IllegalArgumentException(&quot;&quot;);</span>
        }

<span class="nc" id="L408">        String str = mItems[(idx &lt;&lt; 3) + 5];</span>
<span class="nc bnc" id="L409" title="All 4 branches missed.">        return ((str != null) ? (str.charAt(0) == 'd') : true);</span>
    }

    /**
     * Returns true unless the attribute value was provided by DTD defaulting.
     *
     * @param qName The XML qualified (prefixed) name.
     * @return true if the value was found in the XML text, false if the value
     * was provided by DTD defaulting.
     * @exception java.lang.IllegalArgumentException When the supplied name does
     * not identify an attribute.
     */
    public boolean isSpecified(String qName) {
<span class="nc" id="L422">        int idx = getIndex(qName);</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">        if (idx &lt; 0) {</span>
<span class="nc" id="L424">            throw new IllegalArgumentException(&quot;&quot;);</span>
        }

<span class="nc" id="L427">        String str = mItems[(idx &lt;&lt; 3) + 5];</span>
<span class="nc bnc" id="L428" title="All 4 branches missed.">        return ((str != null) ? (str.charAt(0) == 'd') : true);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>