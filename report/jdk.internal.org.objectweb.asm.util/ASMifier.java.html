<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ASMifier.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">jdk.internal.org.objectweb.asm.util</a> &gt; <span class="el_source">ASMifier.java</span></div><h1>ASMifier.java</h1><pre class="source lang-java linenums">/*
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

/*
 * This file is available under and governed by the GNU General Public
 * License version 2 only, as published by the Free Software Foundation.
 * However, the following notice accompanied the original version of this
 * file:
 *
 * ASM: a very small and fast Java bytecode manipulation framework
 * Copyright (c) 2000-2011 INRIA, France Telecom
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */
package jdk.internal.org.objectweb.asm.util;

import java.io.FileInputStream;
import java.io.PrintWriter;
import java.util.HashMap;
import java.util.Map;

import jdk.internal.org.objectweb.asm.Attribute;
import jdk.internal.org.objectweb.asm.ClassReader;
import jdk.internal.org.objectweb.asm.Handle;
import jdk.internal.org.objectweb.asm.Label;
import jdk.internal.org.objectweb.asm.Opcodes;
import jdk.internal.org.objectweb.asm.Type;
import jdk.internal.org.objectweb.asm.TypePath;

/**
 * A {@link Printer} that prints the ASM code to generate the classes if visits.
 *
 * @author Eric Bruneton
 */
public class ASMifier extends Printer {

    /**
     * The name of the visitor variable in the produced code.
     */
    protected final String name;

    /**
     * Identifier of the annotation visitor variable in the produced code.
     */
    protected final int id;

    /**
     * The label names. This map associates String values to Label keys. It is
     * used only in ASMifierMethodVisitor.
     */
    protected Map&lt;Label, String&gt; labelNames;

    /**
     * Pseudo access flag used to distinguish class access flags.
     */
    private static final int ACCESS_CLASS = 262144;

    /**
     * Pseudo access flag used to distinguish field access flags.
     */
    private static final int ACCESS_FIELD = 524288;

    /**
     * Pseudo access flag used to distinguish inner class flags.
     */
    private static final int ACCESS_INNER = 1048576;

    /**
     * Constructs a new {@link ASMifier}. &lt;i&gt;Subclasses must not use this
     * constructor&lt;/i&gt;. Instead, they must use the
     * {@link #ASMifier(int, String, int)} version.
     *
     * @throws IllegalStateException
     *             If a subclass calls this constructor.
     */
    public ASMifier() {
<span class="nc" id="L121">        this(Opcodes.ASM5, &quot;cw&quot;, 0);</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">        if (getClass() != ASMifier.class) {</span>
<span class="nc" id="L123">            throw new IllegalStateException();</span>
        }
<span class="nc" id="L125">    }</span>

    /**
     * Constructs a new {@link ASMifier}.
     *
     * @param api
     *            the ASM API version implemented by this class. Must be one of
     *            {@link Opcodes#ASM4} or {@link Opcodes#ASM5}.
     * @param name
     *            the name of the visitor variable in the produced code.
     * @param id
     *            identifier of the annotation visitor variable in the produced
     *            code.
     */
    protected ASMifier(final int api, final String name, final int id) {
<span class="nc" id="L140">        super(api);</span>
<span class="nc" id="L141">        this.name = name;</span>
<span class="nc" id="L142">        this.id = id;</span>
<span class="nc" id="L143">    }</span>

    /**
     * Prints the ASM source code to generate the given class to the standard
     * output.
     * &lt;p&gt;
     * Usage: ASMifier [-debug] &amp;lt;binary class name or class file name&amp;gt;
     *
     * @param args
     *            the command line arguments.
     *
     * @throws Exception
     *             if the class cannot be found, or if an IO exception occurs.
     */
    public static void main(final String[] args) throws Exception {
<span class="nc" id="L158">        int i = 0;</span>
<span class="nc" id="L159">        int flags = ClassReader.SKIP_DEBUG;</span>

<span class="nc" id="L161">        boolean ok = true;</span>
<span class="nc bnc" id="L162" title="All 4 branches missed.">        if (args.length &lt; 1 || args.length &gt; 2) {</span>
<span class="nc" id="L163">            ok = false;</span>
        }
<span class="nc bnc" id="L165" title="All 4 branches missed.">        if (ok &amp;&amp; &quot;-debug&quot;.equals(args[0])) {</span>
<span class="nc" id="L166">            i = 1;</span>
<span class="nc" id="L167">            flags = 0;</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">            if (args.length != 2) {</span>
<span class="nc" id="L169">                ok = false;</span>
            }
        }
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (!ok) {</span>
<span class="nc" id="L173">            System.err</span>
<span class="nc" id="L174">                    .println(&quot;Prints the ASM code to generate the given class.&quot;);</span>
<span class="nc" id="L175">            System.err.println(&quot;Usage: ASMifier [-debug] &quot;</span>
                    + &quot;&lt;fully qualified class name or class file name&gt;&quot;);
<span class="nc" id="L177">            return;</span>
        }
        ClassReader cr;
<span class="nc bnc" id="L180" title="All 4 branches missed.">        if (args[i].endsWith(&quot;.class&quot;) || args[i].indexOf('\\') &gt; -1</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">                || args[i].indexOf('/') &gt; -1) {</span>
<span class="nc" id="L182">            cr = new ClassReader(new FileInputStream(args[i]));</span>
        } else {
<span class="nc" id="L184">            cr = new ClassReader(args[i]);</span>
        }
<span class="nc" id="L186">        cr.accept(new TraceClassVisitor(null, new ASMifier(), new PrintWriter(</span>
                System.out)), flags);
<span class="nc" id="L188">    }</span>

    // ------------------------------------------------------------------------
    // Classes
    // ------------------------------------------------------------------------

    @Override
    public void visit(final int version, final int access, final String name,
            final String signature, final String superName,
            final String[] interfaces) {
        String simpleName;
<span class="nc" id="L199">        int n = name.lastIndexOf('/');</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">        if (n == -1) {</span>
<span class="nc" id="L201">            simpleName = name;</span>
        } else {
<span class="nc" id="L203">            text.add(&quot;package asm.&quot; + name.substring(0, n).replace('/', '.')</span>
                    + &quot;;\n&quot;);
<span class="nc" id="L205">            simpleName = name.substring(n + 1);</span>
        }
<span class="nc" id="L207">        text.add(&quot;import java.util.*;\n&quot;);</span>
<span class="nc" id="L208">        text.add(&quot;import jdk.internal.org.objectweb.asm.*;\n&quot;);</span>
<span class="nc" id="L209">        text.add(&quot;import jdk.internal.org.objectweb.asm.attrs.*;\n&quot;);</span>
<span class="nc" id="L210">        text.add(&quot;public class &quot; + simpleName + &quot;Dump implements Opcodes {\n\n&quot;);</span>
<span class="nc" id="L211">        text.add(&quot;public static byte[] dump () throws Exception {\n\n&quot;);</span>
<span class="nc" id="L212">        text.add(&quot;ClassWriter cw = new ClassWriter(0);\n&quot;);</span>
<span class="nc" id="L213">        text.add(&quot;FieldVisitor fv;\n&quot;);</span>
<span class="nc" id="L214">        text.add(&quot;MethodVisitor mv;\n&quot;);</span>
<span class="nc" id="L215">        text.add(&quot;AnnotationVisitor av0;\n\n&quot;);</span>

<span class="nc" id="L217">        buf.setLength(0);</span>
<span class="nc" id="L218">        buf.append(&quot;cw.visit(&quot;);</span>
<span class="nc bnc" id="L219" title="All 8 branches missed.">        switch (version) {</span>
        case Opcodes.V1_1:
<span class="nc" id="L221">            buf.append(&quot;V1_1&quot;);</span>
<span class="nc" id="L222">            break;</span>
        case Opcodes.V1_2:
<span class="nc" id="L224">            buf.append(&quot;V1_2&quot;);</span>
<span class="nc" id="L225">            break;</span>
        case Opcodes.V1_3:
<span class="nc" id="L227">            buf.append(&quot;V1_3&quot;);</span>
<span class="nc" id="L228">            break;</span>
        case Opcodes.V1_4:
<span class="nc" id="L230">            buf.append(&quot;V1_4&quot;);</span>
<span class="nc" id="L231">            break;</span>
        case Opcodes.V1_5:
<span class="nc" id="L233">            buf.append(&quot;V1_5&quot;);</span>
<span class="nc" id="L234">            break;</span>
        case Opcodes.V1_6:
<span class="nc" id="L236">            buf.append(&quot;V1_6&quot;);</span>
<span class="nc" id="L237">            break;</span>
        case Opcodes.V1_7:
<span class="nc" id="L239">            buf.append(&quot;V1_7&quot;);</span>
<span class="nc" id="L240">            break;</span>
        default:
<span class="nc" id="L242">            buf.append(version);</span>
            break;
        }
<span class="nc" id="L245">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L246">        appendAccess(access | ACCESS_CLASS);</span>
<span class="nc" id="L247">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L248">        appendConstant(name);</span>
<span class="nc" id="L249">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L250">        appendConstant(signature);</span>
<span class="nc" id="L251">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L252">        appendConstant(superName);</span>
<span class="nc" id="L253">        buf.append(&quot;, &quot;);</span>
<span class="nc bnc" id="L254" title="All 4 branches missed.">        if (interfaces != null &amp;&amp; interfaces.length &gt; 0) {</span>
<span class="nc" id="L255">            buf.append(&quot;new String[] {&quot;);</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">            for (int i = 0; i &lt; interfaces.length; ++i) {</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">                buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L258">                appendConstant(interfaces[i]);</span>
            }
<span class="nc" id="L260">            buf.append(&quot; }&quot;);</span>
        } else {
<span class="nc" id="L262">            buf.append(&quot;null&quot;);</span>
        }
<span class="nc" id="L264">        buf.append(&quot;);\n\n&quot;);</span>
<span class="nc" id="L265">        text.add(buf.toString());</span>
<span class="nc" id="L266">    }</span>

    @Override
    public void visitSource(final String file, final String debug) {
<span class="nc" id="L270">        buf.setLength(0);</span>
<span class="nc" id="L271">        buf.append(&quot;cw.visitSource(&quot;);</span>
<span class="nc" id="L272">        appendConstant(file);</span>
<span class="nc" id="L273">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L274">        appendConstant(debug);</span>
<span class="nc" id="L275">        buf.append(&quot;);\n\n&quot;);</span>
<span class="nc" id="L276">        text.add(buf.toString());</span>
<span class="nc" id="L277">    }</span>

    @Override
    public void visitOuterClass(final String owner, final String name,
            final String desc) {
<span class="nc" id="L282">        buf.setLength(0);</span>
<span class="nc" id="L283">        buf.append(&quot;cw.visitOuterClass(&quot;);</span>
<span class="nc" id="L284">        appendConstant(owner);</span>
<span class="nc" id="L285">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L286">        appendConstant(name);</span>
<span class="nc" id="L287">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L288">        appendConstant(desc);</span>
<span class="nc" id="L289">        buf.append(&quot;);\n\n&quot;);</span>
<span class="nc" id="L290">        text.add(buf.toString());</span>
<span class="nc" id="L291">    }</span>

    @Override
    public ASMifier visitClassAnnotation(final String desc,
            final boolean visible) {
<span class="nc" id="L296">        return visitAnnotation(desc, visible);</span>
    }

    @Override
    public ASMifier visitClassTypeAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L302">        return visitTypeAnnotation(typeRef, typePath, desc, visible);</span>
    }

    @Override
    public void visitClassAttribute(final Attribute attr) {
<span class="nc" id="L307">        visitAttribute(attr);</span>
<span class="nc" id="L308">    }</span>

    @Override
    public void visitInnerClass(final String name, final String outerName,
            final String innerName, final int access) {
<span class="nc" id="L313">        buf.setLength(0);</span>
<span class="nc" id="L314">        buf.append(&quot;cw.visitInnerClass(&quot;);</span>
<span class="nc" id="L315">        appendConstant(name);</span>
<span class="nc" id="L316">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L317">        appendConstant(outerName);</span>
<span class="nc" id="L318">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L319">        appendConstant(innerName);</span>
<span class="nc" id="L320">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L321">        appendAccess(access | ACCESS_INNER);</span>
<span class="nc" id="L322">        buf.append(&quot;);\n\n&quot;);</span>
<span class="nc" id="L323">        text.add(buf.toString());</span>
<span class="nc" id="L324">    }</span>

    @Override
    public ASMifier visitField(final int access, final String name,
            final String desc, final String signature, final Object value) {
<span class="nc" id="L329">        buf.setLength(0);</span>
<span class="nc" id="L330">        buf.append(&quot;{\n&quot;);</span>
<span class="nc" id="L331">        buf.append(&quot;fv = cw.visitField(&quot;);</span>
<span class="nc" id="L332">        appendAccess(access | ACCESS_FIELD);</span>
<span class="nc" id="L333">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L334">        appendConstant(name);</span>
<span class="nc" id="L335">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L336">        appendConstant(desc);</span>
<span class="nc" id="L337">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L338">        appendConstant(signature);</span>
<span class="nc" id="L339">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L340">        appendConstant(value);</span>
<span class="nc" id="L341">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L342">        text.add(buf.toString());</span>
<span class="nc" id="L343">        ASMifier a = createASMifier(&quot;fv&quot;, 0);</span>
<span class="nc" id="L344">        text.add(a.getText());</span>
<span class="nc" id="L345">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L346">        return a;</span>
    }

    @Override
    public ASMifier visitMethod(final int access, final String name,
            final String desc, final String signature, final String[] exceptions) {
<span class="nc" id="L352">        buf.setLength(0);</span>
<span class="nc" id="L353">        buf.append(&quot;{\n&quot;);</span>
<span class="nc" id="L354">        buf.append(&quot;mv = cw.visitMethod(&quot;);</span>
<span class="nc" id="L355">        appendAccess(access);</span>
<span class="nc" id="L356">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L357">        appendConstant(name);</span>
<span class="nc" id="L358">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L359">        appendConstant(desc);</span>
<span class="nc" id="L360">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L361">        appendConstant(signature);</span>
<span class="nc" id="L362">        buf.append(&quot;, &quot;);</span>
<span class="nc bnc" id="L363" title="All 4 branches missed.">        if (exceptions != null &amp;&amp; exceptions.length &gt; 0) {</span>
<span class="nc" id="L364">            buf.append(&quot;new String[] {&quot;);</span>
<span class="nc bnc" id="L365" title="All 2 branches missed.">            for (int i = 0; i &lt; exceptions.length; ++i) {</span>
<span class="nc bnc" id="L366" title="All 2 branches missed.">                buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L367">                appendConstant(exceptions[i]);</span>
            }
<span class="nc" id="L369">            buf.append(&quot; }&quot;);</span>
        } else {
<span class="nc" id="L371">            buf.append(&quot;null&quot;);</span>
        }
<span class="nc" id="L373">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L374">        text.add(buf.toString());</span>
<span class="nc" id="L375">        ASMifier a = createASMifier(&quot;mv&quot;, 0);</span>
<span class="nc" id="L376">        text.add(a.getText());</span>
<span class="nc" id="L377">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L378">        return a;</span>
    }

    @Override
    public void visitClassEnd() {
<span class="nc" id="L383">        text.add(&quot;cw.visitEnd();\n\n&quot;);</span>
<span class="nc" id="L384">        text.add(&quot;return cw.toByteArray();\n&quot;);</span>
<span class="nc" id="L385">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L386">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L387">    }</span>

    // ------------------------------------------------------------------------
    // Annotations
    // ------------------------------------------------------------------------

    @Override
    public void visit(final String name, final Object value) {
<span class="nc" id="L395">        buf.setLength(0);</span>
<span class="nc" id="L396">        buf.append(&quot;av&quot;).append(id).append(&quot;.visit(&quot;);</span>
<span class="nc" id="L397">        appendConstant(buf, name);</span>
<span class="nc" id="L398">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L399">        appendConstant(buf, value);</span>
<span class="nc" id="L400">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L401">        text.add(buf.toString());</span>
<span class="nc" id="L402">    }</span>

    @Override
    public void visitEnum(final String name, final String desc,
            final String value) {
<span class="nc" id="L407">        buf.setLength(0);</span>
<span class="nc" id="L408">        buf.append(&quot;av&quot;).append(id).append(&quot;.visitEnum(&quot;);</span>
<span class="nc" id="L409">        appendConstant(buf, name);</span>
<span class="nc" id="L410">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L411">        appendConstant(buf, desc);</span>
<span class="nc" id="L412">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L413">        appendConstant(buf, value);</span>
<span class="nc" id="L414">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L415">        text.add(buf.toString());</span>
<span class="nc" id="L416">    }</span>

    @Override
    public ASMifier visitAnnotation(final String name, final String desc) {
<span class="nc" id="L420">        buf.setLength(0);</span>
<span class="nc" id="L421">        buf.append(&quot;{\n&quot;);</span>
<span class="nc" id="L422">        buf.append(&quot;AnnotationVisitor av&quot;).append(id + 1).append(&quot; = av&quot;);</span>
<span class="nc" id="L423">        buf.append(id).append(&quot;.visitAnnotation(&quot;);</span>
<span class="nc" id="L424">        appendConstant(buf, name);</span>
<span class="nc" id="L425">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L426">        appendConstant(buf, desc);</span>
<span class="nc" id="L427">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L428">        text.add(buf.toString());</span>
<span class="nc" id="L429">        ASMifier a = createASMifier(&quot;av&quot;, id + 1);</span>
<span class="nc" id="L430">        text.add(a.getText());</span>
<span class="nc" id="L431">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L432">        return a;</span>
    }

    @Override
    public ASMifier visitArray(final String name) {
<span class="nc" id="L437">        buf.setLength(0);</span>
<span class="nc" id="L438">        buf.append(&quot;{\n&quot;);</span>
<span class="nc" id="L439">        buf.append(&quot;AnnotationVisitor av&quot;).append(id + 1).append(&quot; = av&quot;);</span>
<span class="nc" id="L440">        buf.append(id).append(&quot;.visitArray(&quot;);</span>
<span class="nc" id="L441">        appendConstant(buf, name);</span>
<span class="nc" id="L442">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L443">        text.add(buf.toString());</span>
<span class="nc" id="L444">        ASMifier a = createASMifier(&quot;av&quot;, id + 1);</span>
<span class="nc" id="L445">        text.add(a.getText());</span>
<span class="nc" id="L446">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L447">        return a;</span>
    }

    @Override
    public void visitAnnotationEnd() {
<span class="nc" id="L452">        buf.setLength(0);</span>
<span class="nc" id="L453">        buf.append(&quot;av&quot;).append(id).append(&quot;.visitEnd();\n&quot;);</span>
<span class="nc" id="L454">        text.add(buf.toString());</span>
<span class="nc" id="L455">    }</span>

    // ------------------------------------------------------------------------
    // Fields
    // ------------------------------------------------------------------------

    @Override
    public ASMifier visitFieldAnnotation(final String desc,
            final boolean visible) {
<span class="nc" id="L464">        return visitAnnotation(desc, visible);</span>
    }

    @Override
    public ASMifier visitFieldTypeAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L470">        return visitTypeAnnotation(typeRef, typePath, desc, visible);</span>
    }

    @Override
    public void visitFieldAttribute(final Attribute attr) {
<span class="nc" id="L475">        visitAttribute(attr);</span>
<span class="nc" id="L476">    }</span>

    @Override
    public void visitFieldEnd() {
<span class="nc" id="L480">        buf.setLength(0);</span>
<span class="nc" id="L481">        buf.append(name).append(&quot;.visitEnd();\n&quot;);</span>
<span class="nc" id="L482">        text.add(buf.toString());</span>
<span class="nc" id="L483">    }</span>

    // ------------------------------------------------------------------------
    // Methods
    // ------------------------------------------------------------------------

    @Override
    public void visitParameter(String parameterName, int access) {
<span class="nc" id="L491">        buf.setLength(0);</span>
<span class="nc" id="L492">        buf.append(name).append(&quot;.visitParameter(&quot;);</span>
<span class="nc" id="L493">        appendString(buf, parameterName);</span>
<span class="nc" id="L494">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L495">        appendAccess(access);</span>
<span class="nc" id="L496">        text.add(buf.append(&quot;);\n&quot;).toString());</span>
<span class="nc" id="L497">    }</span>

    @Override
    public ASMifier visitAnnotationDefault() {
<span class="nc" id="L501">        buf.setLength(0);</span>
<span class="nc" id="L502">        buf.append(&quot;{\n&quot;).append(&quot;av0 = &quot;).append(name)</span>
<span class="nc" id="L503">                .append(&quot;.visitAnnotationDefault();\n&quot;);</span>
<span class="nc" id="L504">        text.add(buf.toString());</span>
<span class="nc" id="L505">        ASMifier a = createASMifier(&quot;av&quot;, 0);</span>
<span class="nc" id="L506">        text.add(a.getText());</span>
<span class="nc" id="L507">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L508">        return a;</span>
    }

    @Override
    public ASMifier visitMethodAnnotation(final String desc,
            final boolean visible) {
<span class="nc" id="L514">        return visitAnnotation(desc, visible);</span>
    }

    @Override
    public ASMifier visitMethodTypeAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L520">        return visitTypeAnnotation(typeRef, typePath, desc, visible);</span>
    }

    @Override
    public ASMifier visitParameterAnnotation(final int parameter,
            final String desc, final boolean visible) {
<span class="nc" id="L526">        buf.setLength(0);</span>
<span class="nc" id="L527">        buf.append(&quot;{\n&quot;).append(&quot;av0 = &quot;).append(name)</span>
<span class="nc" id="L528">                .append(&quot;.visitParameterAnnotation(&quot;).append(parameter)</span>
<span class="nc" id="L529">                .append(&quot;, &quot;);</span>
<span class="nc" id="L530">        appendConstant(desc);</span>
<span class="nc" id="L531">        buf.append(&quot;, &quot;).append(visible).append(&quot;);\n&quot;);</span>
<span class="nc" id="L532">        text.add(buf.toString());</span>
<span class="nc" id="L533">        ASMifier a = createASMifier(&quot;av&quot;, 0);</span>
<span class="nc" id="L534">        text.add(a.getText());</span>
<span class="nc" id="L535">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L536">        return a;</span>
    }

    @Override
    public void visitMethodAttribute(final Attribute attr) {
<span class="nc" id="L541">        visitAttribute(attr);</span>
<span class="nc" id="L542">    }</span>

    @Override
    public void visitCode() {
<span class="nc" id="L546">        text.add(name + &quot;.visitCode();\n&quot;);</span>
<span class="nc" id="L547">    }</span>

    @Override
    public void visitFrame(final int type, final int nLocal,
            final Object[] local, final int nStack, final Object[] stack) {
<span class="nc" id="L552">        buf.setLength(0);</span>
<span class="nc bnc" id="L553" title="All 6 branches missed.">        switch (type) {</span>
        case Opcodes.F_NEW:
        case Opcodes.F_FULL:
<span class="nc" id="L556">            declareFrameTypes(nLocal, local);</span>
<span class="nc" id="L557">            declareFrameTypes(nStack, stack);</span>
<span class="nc bnc" id="L558" title="All 2 branches missed.">            if (type == Opcodes.F_NEW) {</span>
<span class="nc" id="L559">                buf.append(name).append(&quot;.visitFrame(Opcodes.F_NEW, &quot;);</span>
            } else {
<span class="nc" id="L561">                buf.append(name).append(&quot;.visitFrame(Opcodes.F_FULL, &quot;);</span>
            }
<span class="nc" id="L563">            buf.append(nLocal).append(&quot;, new Object[] {&quot;);</span>
<span class="nc" id="L564">            appendFrameTypes(nLocal, local);</span>
<span class="nc" id="L565">            buf.append(&quot;}, &quot;).append(nStack).append(&quot;, new Object[] {&quot;);</span>
<span class="nc" id="L566">            appendFrameTypes(nStack, stack);</span>
<span class="nc" id="L567">            buf.append('}');</span>
<span class="nc" id="L568">            break;</span>
        case Opcodes.F_APPEND:
<span class="nc" id="L570">            declareFrameTypes(nLocal, local);</span>
<span class="nc" id="L571">            buf.append(name).append(&quot;.visitFrame(Opcodes.F_APPEND,&quot;)</span>
<span class="nc" id="L572">                    .append(nLocal).append(&quot;, new Object[] {&quot;);</span>
<span class="nc" id="L573">            appendFrameTypes(nLocal, local);</span>
<span class="nc" id="L574">            buf.append(&quot;}, 0, null&quot;);</span>
<span class="nc" id="L575">            break;</span>
        case Opcodes.F_CHOP:
<span class="nc" id="L577">            buf.append(name).append(&quot;.visitFrame(Opcodes.F_CHOP,&quot;)</span>
<span class="nc" id="L578">                    .append(nLocal).append(&quot;, null, 0, null&quot;);</span>
<span class="nc" id="L579">            break;</span>
        case Opcodes.F_SAME:
<span class="nc" id="L581">            buf.append(name).append(</span>
                    &quot;.visitFrame(Opcodes.F_SAME, 0, null, 0, null&quot;);
<span class="nc" id="L583">            break;</span>
        case Opcodes.F_SAME1:
<span class="nc" id="L585">            declareFrameTypes(1, stack);</span>
<span class="nc" id="L586">            buf.append(name).append(</span>
                    &quot;.visitFrame(Opcodes.F_SAME1, 0, null, 1, new Object[] {&quot;);
<span class="nc" id="L588">            appendFrameTypes(1, stack);</span>
<span class="nc" id="L589">            buf.append('}');</span>
            break;
        }
<span class="nc" id="L592">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L593">        text.add(buf.toString());</span>
<span class="nc" id="L594">    }</span>

    @Override
    public void visitInsn(final int opcode) {
<span class="nc" id="L598">        buf.setLength(0);</span>
<span class="nc" id="L599">        buf.append(name).append(&quot;.visitInsn(&quot;).append(OPCODES[opcode])</span>
<span class="nc" id="L600">                .append(&quot;);\n&quot;);</span>
<span class="nc" id="L601">        text.add(buf.toString());</span>
<span class="nc" id="L602">    }</span>

    @Override
    public void visitIntInsn(final int opcode, final int operand) {
<span class="nc" id="L606">        buf.setLength(0);</span>
<span class="nc" id="L607">        buf.append(name)</span>
<span class="nc" id="L608">                .append(&quot;.visitIntInsn(&quot;)</span>
<span class="nc" id="L609">                .append(OPCODES[opcode])</span>
<span class="nc bnc" id="L610" title="All 2 branches missed.">                .append(&quot;, &quot;)</span>
<span class="nc" id="L611">                .append(opcode == Opcodes.NEWARRAY ? TYPES[operand] : Integer</span>
<span class="nc" id="L612">                        .toString(operand)).append(&quot;);\n&quot;);</span>
<span class="nc" id="L613">        text.add(buf.toString());</span>
<span class="nc" id="L614">    }</span>

    @Override
    public void visitVarInsn(final int opcode, final int var) {
<span class="nc" id="L618">        buf.setLength(0);</span>
<span class="nc" id="L619">        buf.append(name).append(&quot;.visitVarInsn(&quot;).append(OPCODES[opcode])</span>
<span class="nc" id="L620">                .append(&quot;, &quot;).append(var).append(&quot;);\n&quot;);</span>
<span class="nc" id="L621">        text.add(buf.toString());</span>
<span class="nc" id="L622">    }</span>

    @Override
    public void visitTypeInsn(final int opcode, final String type) {
<span class="nc" id="L626">        buf.setLength(0);</span>
<span class="nc" id="L627">        buf.append(name).append(&quot;.visitTypeInsn(&quot;).append(OPCODES[opcode])</span>
<span class="nc" id="L628">                .append(&quot;, &quot;);</span>
<span class="nc" id="L629">        appendConstant(type);</span>
<span class="nc" id="L630">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L631">        text.add(buf.toString());</span>
<span class="nc" id="L632">    }</span>

    @Override
    public void visitFieldInsn(final int opcode, final String owner,
            final String name, final String desc) {
<span class="nc" id="L637">        buf.setLength(0);</span>
<span class="nc" id="L638">        buf.append(this.name).append(&quot;.visitFieldInsn(&quot;)</span>
<span class="nc" id="L639">                .append(OPCODES[opcode]).append(&quot;, &quot;);</span>
<span class="nc" id="L640">        appendConstant(owner);</span>
<span class="nc" id="L641">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L642">        appendConstant(name);</span>
<span class="nc" id="L643">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L644">        appendConstant(desc);</span>
<span class="nc" id="L645">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L646">        text.add(buf.toString());</span>
<span class="nc" id="L647">    }</span>

    @Deprecated
    @Override
    public void visitMethodInsn(final int opcode, final String owner,
            final String name, final String desc) {
<span class="nc bnc" id="L653" title="All 2 branches missed.">        if (api &gt;= Opcodes.ASM5) {</span>
<span class="nc" id="L654">            super.visitMethodInsn(opcode, owner, name, desc);</span>
<span class="nc" id="L655">            return;</span>
        }
<span class="nc bnc" id="L657" title="All 2 branches missed.">        doVisitMethodInsn(opcode, owner, name, desc,</span>
                opcode == Opcodes.INVOKEINTERFACE);
<span class="nc" id="L659">    }</span>

    @Override
    public void visitMethodInsn(final int opcode, final String owner,
            final String name, final String desc, final boolean itf) {
<span class="nc bnc" id="L664" title="All 2 branches missed.">        if (api &lt; Opcodes.ASM5) {</span>
<span class="nc" id="L665">            super.visitMethodInsn(opcode, owner, name, desc, itf);</span>
<span class="nc" id="L666">            return;</span>
        }
<span class="nc" id="L668">        doVisitMethodInsn(opcode, owner, name, desc, itf);</span>
<span class="nc" id="L669">    }</span>

    private void doVisitMethodInsn(final int opcode, final String owner,
            final String name, final String desc, final boolean itf) {
<span class="nc" id="L673">        buf.setLength(0);</span>
<span class="nc" id="L674">        buf.append(this.name).append(&quot;.visitMethodInsn(&quot;)</span>
<span class="nc" id="L675">                .append(OPCODES[opcode]).append(&quot;, &quot;);</span>
<span class="nc" id="L676">        appendConstant(owner);</span>
<span class="nc" id="L677">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L678">        appendConstant(name);</span>
<span class="nc" id="L679">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L680">        appendConstant(desc);</span>
<span class="nc" id="L681">        buf.append(&quot;, &quot;);</span>
<span class="nc bnc" id="L682" title="All 2 branches missed.">        buf.append(itf ? &quot;true&quot; : &quot;false&quot;);</span>
<span class="nc" id="L683">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L684">        text.add(buf.toString());</span>
<span class="nc" id="L685">    }</span>

    @Override
    public void visitInvokeDynamicInsn(String name, String desc, Handle bsm,
            Object... bsmArgs) {
<span class="nc" id="L690">        buf.setLength(0);</span>
<span class="nc" id="L691">        buf.append(this.name).append(&quot;.visitInvokeDynamicInsn(&quot;);</span>
<span class="nc" id="L692">        appendConstant(name);</span>
<span class="nc" id="L693">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L694">        appendConstant(desc);</span>
<span class="nc" id="L695">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L696">        appendConstant(bsm);</span>
<span class="nc" id="L697">        buf.append(&quot;, new Object[]{&quot;);</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">        for (int i = 0; i &lt; bsmArgs.length; ++i) {</span>
<span class="nc" id="L699">            appendConstant(bsmArgs[i]);</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">            if (i != bsmArgs.length - 1) {</span>
<span class="nc" id="L701">                buf.append(&quot;, &quot;);</span>
            }
        }
<span class="nc" id="L704">        buf.append(&quot;});\n&quot;);</span>
<span class="nc" id="L705">        text.add(buf.toString());</span>
<span class="nc" id="L706">    }</span>

    @Override
    public void visitJumpInsn(final int opcode, final Label label) {
<span class="nc" id="L710">        buf.setLength(0);</span>
<span class="nc" id="L711">        declareLabel(label);</span>
<span class="nc" id="L712">        buf.append(name).append(&quot;.visitJumpInsn(&quot;).append(OPCODES[opcode])</span>
<span class="nc" id="L713">                .append(&quot;, &quot;);</span>
<span class="nc" id="L714">        appendLabel(label);</span>
<span class="nc" id="L715">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L716">        text.add(buf.toString());</span>
<span class="nc" id="L717">    }</span>

    @Override
    public void visitLabel(final Label label) {
<span class="nc" id="L721">        buf.setLength(0);</span>
<span class="nc" id="L722">        declareLabel(label);</span>
<span class="nc" id="L723">        buf.append(name).append(&quot;.visitLabel(&quot;);</span>
<span class="nc" id="L724">        appendLabel(label);</span>
<span class="nc" id="L725">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L726">        text.add(buf.toString());</span>
<span class="nc" id="L727">    }</span>

    @Override
    public void visitLdcInsn(final Object cst) {
<span class="nc" id="L731">        buf.setLength(0);</span>
<span class="nc" id="L732">        buf.append(name).append(&quot;.visitLdcInsn(&quot;);</span>
<span class="nc" id="L733">        appendConstant(cst);</span>
<span class="nc" id="L734">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L735">        text.add(buf.toString());</span>
<span class="nc" id="L736">    }</span>

    @Override
    public void visitIincInsn(final int var, final int increment) {
<span class="nc" id="L740">        buf.setLength(0);</span>
<span class="nc" id="L741">        buf.append(name).append(&quot;.visitIincInsn(&quot;).append(var).append(&quot;, &quot;)</span>
<span class="nc" id="L742">                .append(increment).append(&quot;);\n&quot;);</span>
<span class="nc" id="L743">        text.add(buf.toString());</span>
<span class="nc" id="L744">    }</span>

    @Override
    public void visitTableSwitchInsn(final int min, final int max,
            final Label dflt, final Label... labels) {
<span class="nc" id="L749">        buf.setLength(0);</span>
<span class="nc bnc" id="L750" title="All 2 branches missed.">        for (int i = 0; i &lt; labels.length; ++i) {</span>
<span class="nc" id="L751">            declareLabel(labels[i]);</span>
        }
<span class="nc" id="L753">        declareLabel(dflt);</span>

<span class="nc" id="L755">        buf.append(name).append(&quot;.visitTableSwitchInsn(&quot;).append(min)</span>
<span class="nc" id="L756">                .append(&quot;, &quot;).append(max).append(&quot;, &quot;);</span>
<span class="nc" id="L757">        appendLabel(dflt);</span>
<span class="nc" id="L758">        buf.append(&quot;, new Label[] {&quot;);</span>
<span class="nc bnc" id="L759" title="All 2 branches missed.">        for (int i = 0; i &lt; labels.length; ++i) {</span>
<span class="nc bnc" id="L760" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L761">            appendLabel(labels[i]);</span>
        }
<span class="nc" id="L763">        buf.append(&quot; });\n&quot;);</span>
<span class="nc" id="L764">        text.add(buf.toString());</span>
<span class="nc" id="L765">    }</span>

    @Override
    public void visitLookupSwitchInsn(final Label dflt, final int[] keys,
            final Label[] labels) {
<span class="nc" id="L770">        buf.setLength(0);</span>
<span class="nc bnc" id="L771" title="All 2 branches missed.">        for (int i = 0; i &lt; labels.length; ++i) {</span>
<span class="nc" id="L772">            declareLabel(labels[i]);</span>
        }
<span class="nc" id="L774">        declareLabel(dflt);</span>

<span class="nc" id="L776">        buf.append(name).append(&quot;.visitLookupSwitchInsn(&quot;);</span>
<span class="nc" id="L777">        appendLabel(dflt);</span>
<span class="nc" id="L778">        buf.append(&quot;, new int[] {&quot;);</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">        for (int i = 0; i &lt; keys.length; ++i) {</span>
<span class="nc bnc" id="L780" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;).append(keys[i]);</span>
        }
<span class="nc" id="L782">        buf.append(&quot; }, new Label[] {&quot;);</span>
<span class="nc bnc" id="L783" title="All 2 branches missed.">        for (int i = 0; i &lt; labels.length; ++i) {</span>
<span class="nc bnc" id="L784" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L785">            appendLabel(labels[i]);</span>
        }
<span class="nc" id="L787">        buf.append(&quot; });\n&quot;);</span>
<span class="nc" id="L788">        text.add(buf.toString());</span>
<span class="nc" id="L789">    }</span>

    @Override
    public void visitMultiANewArrayInsn(final String desc, final int dims) {
<span class="nc" id="L793">        buf.setLength(0);</span>
<span class="nc" id="L794">        buf.append(name).append(&quot;.visitMultiANewArrayInsn(&quot;);</span>
<span class="nc" id="L795">        appendConstant(desc);</span>
<span class="nc" id="L796">        buf.append(&quot;, &quot;).append(dims).append(&quot;);\n&quot;);</span>
<span class="nc" id="L797">        text.add(buf.toString());</span>
<span class="nc" id="L798">    }</span>

    @Override
    public ASMifier visitInsnAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L803">        return visitTypeAnnotation(&quot;visitInsnAnnotation&quot;, typeRef, typePath,</span>
                desc, visible);
    }

    @Override
    public void visitTryCatchBlock(final Label start, final Label end,
            final Label handler, final String type) {
<span class="nc" id="L810">        buf.setLength(0);</span>
<span class="nc" id="L811">        declareLabel(start);</span>
<span class="nc" id="L812">        declareLabel(end);</span>
<span class="nc" id="L813">        declareLabel(handler);</span>
<span class="nc" id="L814">        buf.append(name).append(&quot;.visitTryCatchBlock(&quot;);</span>
<span class="nc" id="L815">        appendLabel(start);</span>
<span class="nc" id="L816">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L817">        appendLabel(end);</span>
<span class="nc" id="L818">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L819">        appendLabel(handler);</span>
<span class="nc" id="L820">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L821">        appendConstant(type);</span>
<span class="nc" id="L822">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L823">        text.add(buf.toString());</span>
<span class="nc" id="L824">    }</span>

    @Override
    public ASMifier visitTryCatchAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L829">        return visitTypeAnnotation(&quot;visitTryCatchAnnotation&quot;, typeRef,</span>
                typePath, desc, visible);
    }

    @Override
    public void visitLocalVariable(final String name, final String desc,
            final String signature, final Label start, final Label end,
            final int index) {
<span class="nc" id="L837">        buf.setLength(0);</span>
<span class="nc" id="L838">        buf.append(this.name).append(&quot;.visitLocalVariable(&quot;);</span>
<span class="nc" id="L839">        appendConstant(name);</span>
<span class="nc" id="L840">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L841">        appendConstant(desc);</span>
<span class="nc" id="L842">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L843">        appendConstant(signature);</span>
<span class="nc" id="L844">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L845">        appendLabel(start);</span>
<span class="nc" id="L846">        buf.append(&quot;, &quot;);</span>
<span class="nc" id="L847">        appendLabel(end);</span>
<span class="nc" id="L848">        buf.append(&quot;, &quot;).append(index).append(&quot;);\n&quot;);</span>
<span class="nc" id="L849">        text.add(buf.toString());</span>
<span class="nc" id="L850">    }</span>

    @Override
    public Printer visitLocalVariableAnnotation(int typeRef, TypePath typePath,
            Label[] start, Label[] end, int[] index, String desc,
            boolean visible) {
<span class="nc" id="L856">        buf.setLength(0);</span>
<span class="nc" id="L857">        buf.append(&quot;{\n&quot;).append(&quot;av0 = &quot;).append(name)</span>
<span class="nc" id="L858">                .append(&quot;.visitLocalVariableAnnotation(&quot;);</span>
<span class="nc" id="L859">        buf.append(typeRef);</span>
<span class="nc" id="L860">        buf.append(&quot;, TypePath.fromString(\&quot;&quot;).append(typePath).append(&quot;\&quot;), &quot;);</span>
<span class="nc" id="L861">        buf.append(&quot;new Label[] {&quot;);</span>
<span class="nc bnc" id="L862" title="All 2 branches missed.">        for (int i = 0; i &lt; start.length; ++i) {</span>
<span class="nc bnc" id="L863" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L864">            appendLabel(start[i]);</span>
        }
<span class="nc" id="L866">        buf.append(&quot; }, new Label[] {&quot;);</span>
<span class="nc bnc" id="L867" title="All 2 branches missed.">        for (int i = 0; i &lt; end.length; ++i) {</span>
<span class="nc bnc" id="L868" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;);</span>
<span class="nc" id="L869">            appendLabel(end[i]);</span>
        }
<span class="nc" id="L871">        buf.append(&quot; }, new int[] {&quot;);</span>
<span class="nc bnc" id="L872" title="All 2 branches missed.">        for (int i = 0; i &lt; index.length; ++i) {</span>
<span class="nc bnc" id="L873" title="All 2 branches missed.">            buf.append(i == 0 ? &quot; &quot; : &quot;, &quot;).append(index[i]);</span>
        }
<span class="nc" id="L875">        buf.append(&quot; }, &quot;);</span>
<span class="nc" id="L876">        appendConstant(desc);</span>
<span class="nc" id="L877">        buf.append(&quot;, &quot;).append(visible).append(&quot;);\n&quot;);</span>
<span class="nc" id="L878">        text.add(buf.toString());</span>
<span class="nc" id="L879">        ASMifier a = createASMifier(&quot;av&quot;, 0);</span>
<span class="nc" id="L880">        text.add(a.getText());</span>
<span class="nc" id="L881">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L882">        return a;</span>
    }

    @Override
    public void visitLineNumber(final int line, final Label start) {
<span class="nc" id="L887">        buf.setLength(0);</span>
<span class="nc" id="L888">        buf.append(name).append(&quot;.visitLineNumber(&quot;).append(line).append(&quot;, &quot;);</span>
<span class="nc" id="L889">        appendLabel(start);</span>
<span class="nc" id="L890">        buf.append(&quot;);\n&quot;);</span>
<span class="nc" id="L891">        text.add(buf.toString());</span>
<span class="nc" id="L892">    }</span>

    @Override
    public void visitMaxs(final int maxStack, final int maxLocals) {
<span class="nc" id="L896">        buf.setLength(0);</span>
<span class="nc" id="L897">        buf.append(name).append(&quot;.visitMaxs(&quot;).append(maxStack).append(&quot;, &quot;)</span>
<span class="nc" id="L898">                .append(maxLocals).append(&quot;);\n&quot;);</span>
<span class="nc" id="L899">        text.add(buf.toString());</span>
<span class="nc" id="L900">    }</span>

    @Override
    public void visitMethodEnd() {
<span class="nc" id="L904">        buf.setLength(0);</span>
<span class="nc" id="L905">        buf.append(name).append(&quot;.visitEnd();\n&quot;);</span>
<span class="nc" id="L906">        text.add(buf.toString());</span>
<span class="nc" id="L907">    }</span>

    // ------------------------------------------------------------------------
    // Common methods
    // ------------------------------------------------------------------------

    public ASMifier visitAnnotation(final String desc, final boolean visible) {
<span class="nc" id="L914">        buf.setLength(0);</span>
<span class="nc" id="L915">        buf.append(&quot;{\n&quot;).append(&quot;av0 = &quot;).append(name)</span>
<span class="nc" id="L916">                .append(&quot;.visitAnnotation(&quot;);</span>
<span class="nc" id="L917">        appendConstant(desc);</span>
<span class="nc" id="L918">        buf.append(&quot;, &quot;).append(visible).append(&quot;);\n&quot;);</span>
<span class="nc" id="L919">        text.add(buf.toString());</span>
<span class="nc" id="L920">        ASMifier a = createASMifier(&quot;av&quot;, 0);</span>
<span class="nc" id="L921">        text.add(a.getText());</span>
<span class="nc" id="L922">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L923">        return a;</span>
    }

    public ASMifier visitTypeAnnotation(final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L928">        return visitTypeAnnotation(&quot;visitTypeAnnotation&quot;, typeRef, typePath,</span>
                desc, visible);
    }

    public ASMifier visitTypeAnnotation(final String method, final int typeRef,
            final TypePath typePath, final String desc, final boolean visible) {
<span class="nc" id="L934">        buf.setLength(0);</span>
<span class="nc" id="L935">        buf.append(&quot;{\n&quot;).append(&quot;av0 = &quot;).append(name).append(&quot;.&quot;)</span>
<span class="nc" id="L936">                .append(method).append(&quot;(&quot;);</span>
<span class="nc" id="L937">        buf.append(typeRef);</span>
<span class="nc" id="L938">        buf.append(&quot;, TypePath.fromString(\&quot;&quot;).append(typePath).append(&quot;\&quot;), &quot;);</span>
<span class="nc" id="L939">        appendConstant(desc);</span>
<span class="nc" id="L940">        buf.append(&quot;, &quot;).append(visible).append(&quot;);\n&quot;);</span>
<span class="nc" id="L941">        text.add(buf.toString());</span>
<span class="nc" id="L942">        ASMifier a = createASMifier(&quot;av&quot;, 0);</span>
<span class="nc" id="L943">        text.add(a.getText());</span>
<span class="nc" id="L944">        text.add(&quot;}\n&quot;);</span>
<span class="nc" id="L945">        return a;</span>
    }

    public void visitAttribute(final Attribute attr) {
<span class="nc" id="L949">        buf.setLength(0);</span>
<span class="nc" id="L950">        buf.append(&quot;// ATTRIBUTE &quot;).append(attr.type).append('\n');</span>
<span class="nc bnc" id="L951" title="All 2 branches missed.">        if (attr instanceof ASMifiable) {</span>
<span class="nc bnc" id="L952" title="All 2 branches missed.">            if (labelNames == null) {</span>
<span class="nc" id="L953">                labelNames = new HashMap&lt;Label, String&gt;();</span>
            }
<span class="nc" id="L955">            buf.append(&quot;{\n&quot;);</span>
<span class="nc" id="L956">            ((ASMifiable) attr).asmify(buf, &quot;attr&quot;, labelNames);</span>
<span class="nc" id="L957">            buf.append(name).append(&quot;.visitAttribute(attr);\n&quot;);</span>
<span class="nc" id="L958">            buf.append(&quot;}\n&quot;);</span>
        }
<span class="nc" id="L960">        text.add(buf.toString());</span>
<span class="nc" id="L961">    }</span>

    // ------------------------------------------------------------------------
    // Utility methods
    // ------------------------------------------------------------------------

    protected ASMifier createASMifier(final String name, final int id) {
<span class="nc" id="L968">        return new ASMifier(Opcodes.ASM5, name, id);</span>
    }

    /**
     * Appends a string representation of the given access modifiers to
     * {@link #buf buf}.
     *
     * @param access
     *            some access modifiers.
     */
    void appendAccess(final int access) {
<span class="nc" id="L979">        boolean first = true;</span>
<span class="nc bnc" id="L980" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_PUBLIC) != 0) {</span>
<span class="nc" id="L981">            buf.append(&quot;ACC_PUBLIC&quot;);</span>
<span class="nc" id="L982">            first = false;</span>
        }
<span class="nc bnc" id="L984" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_PRIVATE) != 0) {</span>
<span class="nc" id="L985">            buf.append(&quot;ACC_PRIVATE&quot;);</span>
<span class="nc" id="L986">            first = false;</span>
        }
<span class="nc bnc" id="L988" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_PROTECTED) != 0) {</span>
<span class="nc" id="L989">            buf.append(&quot;ACC_PROTECTED&quot;);</span>
<span class="nc" id="L990">            first = false;</span>
        }
<span class="nc bnc" id="L992" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_FINAL) != 0) {</span>
<span class="nc bnc" id="L993" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L994">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L996">            buf.append(&quot;ACC_FINAL&quot;);</span>
<span class="nc" id="L997">            first = false;</span>
        }
<span class="nc bnc" id="L999" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_STATIC) != 0) {</span>
<span class="nc bnc" id="L1000" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1001">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1003">            buf.append(&quot;ACC_STATIC&quot;);</span>
<span class="nc" id="L1004">            first = false;</span>
        }
<span class="nc bnc" id="L1006" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_SYNCHRONIZED) != 0) {</span>
<span class="nc bnc" id="L1007" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1008">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc bnc" id="L1010" title="All 2 branches missed.">            if ((access &amp; ACCESS_CLASS) == 0) {</span>
<span class="nc" id="L1011">                buf.append(&quot;ACC_SYNCHRONIZED&quot;);</span>
            } else {
<span class="nc" id="L1013">                buf.append(&quot;ACC_SUPER&quot;);</span>
            }
<span class="nc" id="L1015">            first = false;</span>
        }
<span class="nc bnc" id="L1017" title="All 4 branches missed.">        if ((access &amp; Opcodes.ACC_VOLATILE) != 0</span>
                &amp;&amp; (access &amp; ACCESS_FIELD) != 0) {
<span class="nc bnc" id="L1019" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1020">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1022">            buf.append(&quot;ACC_VOLATILE&quot;);</span>
<span class="nc" id="L1023">            first = false;</span>
        }
<span class="nc bnc" id="L1025" title="All 6 branches missed.">        if ((access &amp; Opcodes.ACC_BRIDGE) != 0 &amp;&amp; (access &amp; ACCESS_CLASS) == 0</span>
                &amp;&amp; (access &amp; ACCESS_FIELD) == 0) {
<span class="nc bnc" id="L1027" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1028">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1030">            buf.append(&quot;ACC_BRIDGE&quot;);</span>
<span class="nc" id="L1031">            first = false;</span>
        }
<span class="nc bnc" id="L1033" title="All 6 branches missed.">        if ((access &amp; Opcodes.ACC_VARARGS) != 0 &amp;&amp; (access &amp; ACCESS_CLASS) == 0</span>
                &amp;&amp; (access &amp; ACCESS_FIELD) == 0) {
<span class="nc bnc" id="L1035" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1036">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1038">            buf.append(&quot;ACC_VARARGS&quot;);</span>
<span class="nc" id="L1039">            first = false;</span>
        }
<span class="nc bnc" id="L1041" title="All 4 branches missed.">        if ((access &amp; Opcodes.ACC_TRANSIENT) != 0</span>
                &amp;&amp; (access &amp; ACCESS_FIELD) != 0) {
<span class="nc bnc" id="L1043" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1044">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1046">            buf.append(&quot;ACC_TRANSIENT&quot;);</span>
<span class="nc" id="L1047">            first = false;</span>
        }
<span class="nc bnc" id="L1049" title="All 6 branches missed.">        if ((access &amp; Opcodes.ACC_NATIVE) != 0 &amp;&amp; (access &amp; ACCESS_CLASS) == 0</span>
                &amp;&amp; (access &amp; ACCESS_FIELD) == 0) {
<span class="nc bnc" id="L1051" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1052">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1054">            buf.append(&quot;ACC_NATIVE&quot;);</span>
<span class="nc" id="L1055">            first = false;</span>
        }
<span class="nc bnc" id="L1057" title="All 8 branches missed.">        if ((access &amp; Opcodes.ACC_ENUM) != 0</span>
                &amp;&amp; ((access &amp; ACCESS_CLASS) != 0
                        || (access &amp; ACCESS_FIELD) != 0 || (access &amp; ACCESS_INNER) != 0)) {
<span class="nc bnc" id="L1060" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1061">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1063">            buf.append(&quot;ACC_ENUM&quot;);</span>
<span class="nc" id="L1064">            first = false;</span>
        }
<span class="nc bnc" id="L1066" title="All 6 branches missed.">        if ((access &amp; Opcodes.ACC_ANNOTATION) != 0</span>
                &amp;&amp; ((access &amp; ACCESS_CLASS) != 0 || (access &amp; ACCESS_INNER) != 0)) {
<span class="nc bnc" id="L1068" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1069">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1071">            buf.append(&quot;ACC_ANNOTATION&quot;);</span>
<span class="nc" id="L1072">            first = false;</span>
        }
<span class="nc bnc" id="L1074" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_ABSTRACT) != 0) {</span>
<span class="nc bnc" id="L1075" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1076">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1078">            buf.append(&quot;ACC_ABSTRACT&quot;);</span>
<span class="nc" id="L1079">            first = false;</span>
        }
<span class="nc bnc" id="L1081" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_INTERFACE) != 0) {</span>
<span class="nc bnc" id="L1082" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1083">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1085">            buf.append(&quot;ACC_INTERFACE&quot;);</span>
<span class="nc" id="L1086">            first = false;</span>
        }
<span class="nc bnc" id="L1088" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_STRICT) != 0) {</span>
<span class="nc bnc" id="L1089" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1090">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1092">            buf.append(&quot;ACC_STRICT&quot;);</span>
<span class="nc" id="L1093">            first = false;</span>
        }
<span class="nc bnc" id="L1095" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_SYNTHETIC) != 0) {</span>
<span class="nc bnc" id="L1096" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1097">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1099">            buf.append(&quot;ACC_SYNTHETIC&quot;);</span>
<span class="nc" id="L1100">            first = false;</span>
        }
<span class="nc bnc" id="L1102" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_DEPRECATED) != 0) {</span>
<span class="nc bnc" id="L1103" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1104">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1106">            buf.append(&quot;ACC_DEPRECATED&quot;);</span>
<span class="nc" id="L1107">            first = false;</span>
        }
<span class="nc bnc" id="L1109" title="All 2 branches missed.">        if ((access &amp; Opcodes.ACC_MANDATED) != 0) {</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">            if (!first) {</span>
<span class="nc" id="L1111">                buf.append(&quot; + &quot;);</span>
            }
<span class="nc" id="L1113">            buf.append(&quot;ACC_MANDATED&quot;);</span>
<span class="nc" id="L1114">            first = false;</span>
        }
<span class="nc bnc" id="L1116" title="All 2 branches missed.">        if (first) {</span>
<span class="nc" id="L1117">            buf.append('0');</span>
        }
<span class="nc" id="L1119">    }</span>

    /**
     * Appends a string representation of the given constant to the given
     * buffer.
     *
     * @param cst
     *            an {@link Integer}, {@link Float}, {@link Long},
     *            {@link Double} or {@link String} object. May be &lt;tt&gt;null&lt;/tt&gt;.
     */
    protected void appendConstant(final Object cst) {
<span class="nc" id="L1130">        appendConstant(buf, cst);</span>
<span class="nc" id="L1131">    }</span>

    /**
     * Appends a string representation of the given constant to the given
     * buffer.
     *
     * @param buf
     *            a string buffer.
     * @param cst
     *            an {@link Integer}, {@link Float}, {@link Long},
     *            {@link Double} or {@link String} object. May be &lt;tt&gt;null&lt;/tt&gt;.
     */
    static void appendConstant(final StringBuffer buf, final Object cst) {
<span class="nc bnc" id="L1144" title="All 2 branches missed.">        if (cst == null) {</span>
<span class="nc" id="L1145">            buf.append(&quot;null&quot;);</span>
<span class="nc bnc" id="L1146" title="All 2 branches missed.">        } else if (cst instanceof String) {</span>
<span class="nc" id="L1147">            appendString(buf, (String) cst);</span>
<span class="nc bnc" id="L1148" title="All 2 branches missed.">        } else if (cst instanceof Type) {</span>
<span class="nc" id="L1149">            buf.append(&quot;Type.getType(\&quot;&quot;);</span>
<span class="nc" id="L1150">            buf.append(((Type) cst).getDescriptor());</span>
<span class="nc" id="L1151">            buf.append(&quot;\&quot;)&quot;);</span>
<span class="nc bnc" id="L1152" title="All 2 branches missed.">        } else if (cst instanceof Handle) {</span>
<span class="nc" id="L1153">            buf.append(&quot;new Handle(&quot;);</span>
<span class="nc" id="L1154">            Handle h = (Handle) cst;</span>
<span class="nc" id="L1155">            buf.append(&quot;Opcodes.&quot;).append(HANDLE_TAG[h.getTag()])</span>
<span class="nc" id="L1156">                    .append(&quot;, \&quot;&quot;);</span>
<span class="nc" id="L1157">            buf.append(h.getOwner()).append(&quot;\&quot;, \&quot;&quot;);</span>
<span class="nc" id="L1158">            buf.append(h.getName()).append(&quot;\&quot;, \&quot;&quot;);</span>
<span class="nc" id="L1159">            buf.append(h.getDesc()).append(&quot;\&quot;)&quot;);</span>
<span class="nc bnc" id="L1160" title="All 2 branches missed.">        } else if (cst instanceof Byte) {</span>
<span class="nc" id="L1161">            buf.append(&quot;new Byte((byte)&quot;).append(cst).append(')');</span>
<span class="nc bnc" id="L1162" title="All 2 branches missed.">        } else if (cst instanceof Boolean) {</span>
<span class="nc bnc" id="L1163" title="All 2 branches missed.">            buf.append(((Boolean) cst).booleanValue() ? &quot;Boolean.TRUE&quot;</span>
                    : &quot;Boolean.FALSE&quot;);
<span class="nc bnc" id="L1165" title="All 2 branches missed.">        } else if (cst instanceof Short) {</span>
<span class="nc" id="L1166">            buf.append(&quot;new Short((short)&quot;).append(cst).append(')');</span>
<span class="nc bnc" id="L1167" title="All 2 branches missed.">        } else if (cst instanceof Character) {</span>
<span class="nc" id="L1168">            int c = ((Character) cst).charValue();</span>
<span class="nc" id="L1169">            buf.append(&quot;new Character((char)&quot;).append(c).append(')');</span>
<span class="nc bnc" id="L1170" title="All 2 branches missed.">        } else if (cst instanceof Integer) {</span>
<span class="nc" id="L1171">            buf.append(&quot;new Integer(&quot;).append(cst).append(')');</span>
<span class="nc bnc" id="L1172" title="All 2 branches missed.">        } else if (cst instanceof Float) {</span>
<span class="nc" id="L1173">            buf.append(&quot;new Float(\&quot;&quot;).append(cst).append(&quot;\&quot;)&quot;);</span>
<span class="nc bnc" id="L1174" title="All 2 branches missed.">        } else if (cst instanceof Long) {</span>
<span class="nc" id="L1175">            buf.append(&quot;new Long(&quot;).append(cst).append(&quot;L)&quot;);</span>
<span class="nc bnc" id="L1176" title="All 2 branches missed.">        } else if (cst instanceof Double) {</span>
<span class="nc" id="L1177">            buf.append(&quot;new Double(\&quot;&quot;).append(cst).append(&quot;\&quot;)&quot;);</span>
<span class="nc bnc" id="L1178" title="All 2 branches missed.">        } else if (cst instanceof byte[]) {</span>
<span class="nc" id="L1179">            byte[] v = (byte[]) cst;</span>
<span class="nc" id="L1180">            buf.append(&quot;new byte[] {&quot;);</span>
<span class="nc bnc" id="L1181" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1182" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]);</span>
            }
<span class="nc" id="L1184">            buf.append('}');</span>
<span class="nc bnc" id="L1185" title="All 2 branches missed.">        } else if (cst instanceof boolean[]) {</span>
<span class="nc" id="L1186">            boolean[] v = (boolean[]) cst;</span>
<span class="nc" id="L1187">            buf.append(&quot;new boolean[] {&quot;);</span>
<span class="nc bnc" id="L1188" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1189" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]);</span>
            }
<span class="nc" id="L1191">            buf.append('}');</span>
<span class="nc bnc" id="L1192" title="All 2 branches missed.">        } else if (cst instanceof short[]) {</span>
<span class="nc" id="L1193">            short[] v = (short[]) cst;</span>
<span class="nc" id="L1194">            buf.append(&quot;new short[] {&quot;);</span>
<span class="nc bnc" id="L1195" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(&quot;(short)&quot;).append(v[i]);</span>
            }
<span class="nc" id="L1198">            buf.append('}');</span>
<span class="nc bnc" id="L1199" title="All 2 branches missed.">        } else if (cst instanceof char[]) {</span>
<span class="nc" id="L1200">            char[] v = (char[]) cst;</span>
<span class="nc" id="L1201">            buf.append(&quot;new char[] {&quot;);</span>
<span class="nc bnc" id="L1202" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1203" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(&quot;(char)&quot;)</span>
<span class="nc" id="L1204">                        .append((int) v[i]);</span>
            }
<span class="nc" id="L1206">            buf.append('}');</span>
<span class="nc bnc" id="L1207" title="All 2 branches missed.">        } else if (cst instanceof int[]) {</span>
<span class="nc" id="L1208">            int[] v = (int[]) cst;</span>
<span class="nc" id="L1209">            buf.append(&quot;new int[] {&quot;);</span>
<span class="nc bnc" id="L1210" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1211" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]);</span>
            }
<span class="nc" id="L1213">            buf.append('}');</span>
<span class="nc bnc" id="L1214" title="All 2 branches missed.">        } else if (cst instanceof long[]) {</span>
<span class="nc" id="L1215">            long[] v = (long[]) cst;</span>
<span class="nc" id="L1216">            buf.append(&quot;new long[] {&quot;);</span>
<span class="nc bnc" id="L1217" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]).append('L');</span>
            }
<span class="nc" id="L1220">            buf.append('}');</span>
<span class="nc bnc" id="L1221" title="All 2 branches missed.">        } else if (cst instanceof float[]) {</span>
<span class="nc" id="L1222">            float[] v = (float[]) cst;</span>
<span class="nc" id="L1223">            buf.append(&quot;new float[] {&quot;);</span>
<span class="nc bnc" id="L1224" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1225" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]).append('f');</span>
            }
<span class="nc" id="L1227">            buf.append('}');</span>
<span class="nc bnc" id="L1228" title="All 2 branches missed.">        } else if (cst instanceof double[]) {</span>
<span class="nc" id="L1229">            double[] v = (double[]) cst;</span>
<span class="nc" id="L1230">            buf.append(&quot;new double[] {&quot;);</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">            for (int i = 0; i &lt; v.length; i++) {</span>
<span class="nc bnc" id="L1232" title="All 2 branches missed.">                buf.append(i == 0 ? &quot;&quot; : &quot;,&quot;).append(v[i]).append('d');</span>
            }
<span class="nc" id="L1234">            buf.append('}');</span>
        }
<span class="nc" id="L1236">    }</span>

    private void declareFrameTypes(final int n, final Object[] o) {
<span class="nc bnc" id="L1239" title="All 2 branches missed.">        for (int i = 0; i &lt; n; ++i) {</span>
<span class="nc bnc" id="L1240" title="All 2 branches missed.">            if (o[i] instanceof Label) {</span>
<span class="nc" id="L1241">                declareLabel((Label) o[i]);</span>
            }
        }
<span class="nc" id="L1244">    }</span>

    private void appendFrameTypes(final int n, final Object[] o) {
<span class="nc bnc" id="L1247" title="All 2 branches missed.">        for (int i = 0; i &lt; n; ++i) {</span>
<span class="nc bnc" id="L1248" title="All 2 branches missed.">            if (i &gt; 0) {</span>
<span class="nc" id="L1249">                buf.append(&quot;, &quot;);</span>
            }
<span class="nc bnc" id="L1251" title="All 2 branches missed.">            if (o[i] instanceof String) {</span>
<span class="nc" id="L1252">                appendConstant(o[i]);</span>
<span class="nc bnc" id="L1253" title="All 2 branches missed.">            } else if (o[i] instanceof Integer) {</span>
<span class="nc bnc" id="L1254" title="All 8 branches missed.">                switch (((Integer) o[i]).intValue()) {</span>
                case 0:
<span class="nc" id="L1256">                    buf.append(&quot;Opcodes.TOP&quot;);</span>
<span class="nc" id="L1257">                    break;</span>
                case 1:
<span class="nc" id="L1259">                    buf.append(&quot;Opcodes.INTEGER&quot;);</span>
<span class="nc" id="L1260">                    break;</span>
                case 2:
<span class="nc" id="L1262">                    buf.append(&quot;Opcodes.FLOAT&quot;);</span>
<span class="nc" id="L1263">                    break;</span>
                case 3:
<span class="nc" id="L1265">                    buf.append(&quot;Opcodes.DOUBLE&quot;);</span>
<span class="nc" id="L1266">                    break;</span>
                case 4:
<span class="nc" id="L1268">                    buf.append(&quot;Opcodes.LONG&quot;);</span>
<span class="nc" id="L1269">                    break;</span>
                case 5:
<span class="nc" id="L1271">                    buf.append(&quot;Opcodes.NULL&quot;);</span>
<span class="nc" id="L1272">                    break;</span>
                case 6:
<span class="nc" id="L1274">                    buf.append(&quot;Opcodes.UNINITIALIZED_THIS&quot;);</span>
<span class="nc" id="L1275">                    break;</span>
                }
            } else {
<span class="nc" id="L1278">                appendLabel((Label) o[i]);</span>
            }
        }
<span class="nc" id="L1281">    }</span>

    /**
     * Appends a declaration of the given label to {@link #buf buf}. This
     * declaration is of the form &quot;Label lXXX = new Label();&quot;. Does nothing if
     * the given label has already been declared.
     *
     * @param l
     *            a label.
     */
    protected void declareLabel(final Label l) {
<span class="nc bnc" id="L1292" title="All 2 branches missed.">        if (labelNames == null) {</span>
<span class="nc" id="L1293">            labelNames = new HashMap&lt;Label, String&gt;();</span>
        }
<span class="nc" id="L1295">        String name = labelNames.get(l);</span>
<span class="nc bnc" id="L1296" title="All 2 branches missed.">        if (name == null) {</span>
<span class="nc" id="L1297">            name = &quot;l&quot; + labelNames.size();</span>
<span class="nc" id="L1298">            labelNames.put(l, name);</span>
<span class="nc" id="L1299">            buf.append(&quot;Label &quot;).append(name).append(&quot; = new Label();\n&quot;);</span>
        }
<span class="nc" id="L1301">    }</span>

    /**
     * Appends the name of the given label to {@link #buf buf}. The given label
     * &lt;i&gt;must&lt;/i&gt; already have a name. One way to ensure this is to always call
     * {@link #declareLabel declared} before calling this method.
     *
     * @param l
     *            a label.
     */
    protected void appendLabel(final Label l) {
<span class="nc" id="L1312">        buf.append(labelNames.get(l));</span>
<span class="nc" id="L1313">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>