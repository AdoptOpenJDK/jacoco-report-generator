<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>EventSetDescriptor.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.beans</a> &gt; <span class="el_source">EventSetDescriptor.java</span></div><h1>EventSetDescriptor.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1996, 2012, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package java.beans;

import java.lang.ref.Reference;
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;

/**
 * An EventSetDescriptor describes a group of events that a given Java
 * bean fires.
 * &lt;P&gt;
 * The given group of events are all delivered as method calls on a single
 * event listener interface, and an event listener object can be registered
 * via a call on a registration method supplied by the event source.
 */
public class EventSetDescriptor extends FeatureDescriptor {

    private MethodDescriptor[] listenerMethodDescriptors;
    private MethodDescriptor addMethodDescriptor;
    private MethodDescriptor removeMethodDescriptor;
    private MethodDescriptor getMethodDescriptor;

    private Reference&lt;Method[]&gt; listenerMethodsRef;
    private Reference&lt;? extends Class&lt;?&gt;&gt; listenerTypeRef;

    private boolean unicast;
<span class="nc" id="L51">    private boolean inDefaultEventSet = true;</span>

    /**
     * Creates an &lt;TT&gt;EventSetDescriptor&lt;/TT&gt; assuming that you are
     * following the most simple standard design pattern where a named
     * event &amp;quot;fred&amp;quot; is (1) delivered as a call on the single method of
     * interface FredListener, (2) has a single argument of type FredEvent,
     * and (3) where the FredListener may be registered with a call on an
     * addFredListener method of the source component and removed with a
     * call on a removeFredListener method.
     *
     * @param sourceClass  The class firing the event.
     * @param eventSetName  The programmatic name of the event.  E.g. &amp;quot;fred&amp;quot;.
     *          Note that this should normally start with a lower-case character.
     * @param listenerType  The target interface that events
     *          will get delivered to.
     * @param listenerMethodName  The method that will get called when the event gets
     *          delivered to its target listener interface.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     */
    public EventSetDescriptor(Class&lt;?&gt; sourceClass, String eventSetName,
                Class&lt;?&gt; listenerType, String listenerMethodName)
                throws IntrospectionException {
<span class="nc" id="L75">        this(sourceClass, eventSetName, listenerType,</span>
             new String[] { listenerMethodName },
<span class="nc" id="L77">             Introspector.ADD_PREFIX + getListenerClassName(listenerType),</span>
<span class="nc" id="L78">             Introspector.REMOVE_PREFIX + getListenerClassName(listenerType),</span>
<span class="nc" id="L79">             Introspector.GET_PREFIX + getListenerClassName(listenerType) + &quot;s&quot;);</span>

<span class="nc" id="L81">        String eventName = NameGenerator.capitalize(eventSetName) + &quot;Event&quot;;</span>
<span class="nc" id="L82">        Method[] listenerMethods = getListenerMethods();</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (listenerMethods.length &gt; 0) {</span>
<span class="nc" id="L84">            Class[] args = getParameterTypes(getClass0(), listenerMethods[0]);</span>
            // Check for EventSet compliance. Special case for vetoableChange. See 4529996
<span class="nc bnc" id="L86" title="All 4 branches missed.">            if (!&quot;vetoableChange&quot;.equals(eventSetName) &amp;&amp; !args[0].getName().endsWith(eventName)) {</span>
<span class="nc" id="L87">                throw new IntrospectionException(&quot;Method \&quot;&quot; + listenerMethodName +</span>
                                                 &quot;\&quot; should have argument \&quot;&quot; +
                                                 eventName + &quot;\&quot;&quot;);
            }
        }
<span class="nc" id="L92">    }</span>

    private static String getListenerClassName(Class&lt;?&gt; cls) {
<span class="nc" id="L95">        String className = cls.getName();</span>
<span class="nc" id="L96">        return className.substring(className.lastIndexOf('.') + 1);</span>
    }

    /**
     * Creates an &lt;TT&gt;EventSetDescriptor&lt;/TT&gt; from scratch using
     * string names.
     *
     * @param sourceClass  The class firing the event.
     * @param eventSetName The programmatic name of the event set.
     *          Note that this should normally start with a lower-case character.
     * @param listenerType  The Class of the target interface that events
     *          will get delivered to.
     * @param listenerMethodNames The names of the methods that will get called
     *          when the event gets delivered to its target listener interface.
     * @param addListenerMethodName  The name of the method on the event source
     *          that can be used to register an event listener object.
     * @param removeListenerMethodName  The name of the method on the event source
     *          that can be used to de-register an event listener object.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     */
    public EventSetDescriptor(Class&lt;?&gt; sourceClass,
                String eventSetName,
                Class&lt;?&gt; listenerType,
                String listenerMethodNames[],
                String addListenerMethodName,
                String removeListenerMethodName)
                throws IntrospectionException {
<span class="nc" id="L124">        this(sourceClass, eventSetName, listenerType,</span>
             listenerMethodNames, addListenerMethodName,
             removeListenerMethodName, null);
<span class="nc" id="L127">    }</span>

    /**
     * This constructor creates an EventSetDescriptor from scratch using
     * string names.
     *
     * @param sourceClass  The class firing the event.
     * @param eventSetName The programmatic name of the event set.
     *          Note that this should normally start with a lower-case character.
     * @param listenerType  The Class of the target interface that events
     *          will get delivered to.
     * @param listenerMethodNames The names of the methods that will get called
     *          when the event gets delivered to its target listener interface.
     * @param addListenerMethodName  The name of the method on the event source
     *          that can be used to register an event listener object.
     * @param removeListenerMethodName  The name of the method on the event source
     *          that can be used to de-register an event listener object.
     * @param getListenerMethodName The method on the event source that
     *          can be used to access the array of event listener objects.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     * @since 1.4
     */
    public EventSetDescriptor(Class&lt;?&gt; sourceClass,
                String eventSetName,
                Class&lt;?&gt; listenerType,
                String listenerMethodNames[],
                String addListenerMethodName,
                String removeListenerMethodName,
                String getListenerMethodName)
<span class="nc" id="L157">                throws IntrospectionException {</span>
<span class="nc bnc" id="L158" title="All 6 branches missed.">        if (sourceClass == null || eventSetName == null || listenerType == null) {</span>
<span class="nc" id="L159">            throw new NullPointerException();</span>
        }
<span class="nc" id="L161">        setName(eventSetName);</span>
<span class="nc" id="L162">        setClass0(sourceClass);</span>
<span class="nc" id="L163">        setListenerType(listenerType);</span>

<span class="nc" id="L165">        Method[] listenerMethods = new Method[listenerMethodNames.length];</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">        for (int i = 0; i &lt; listenerMethodNames.length; i++) {</span>
            // Check for null names
<span class="nc bnc" id="L168" title="All 2 branches missed.">            if (listenerMethodNames[i] == null) {</span>
<span class="nc" id="L169">                throw new NullPointerException();</span>
            }
<span class="nc" id="L171">            listenerMethods[i] = getMethod(listenerType, listenerMethodNames[i], 1);</span>
        }
<span class="nc" id="L173">        setListenerMethods(listenerMethods);</span>

<span class="nc" id="L175">        setAddListenerMethod(getMethod(sourceClass, addListenerMethodName, 1));</span>
<span class="nc" id="L176">        setRemoveListenerMethod(getMethod(sourceClass, removeListenerMethodName, 1));</span>

        // Be more forgiving of not finding the getListener method.
<span class="nc" id="L179">        Method method = Introspector.findMethod(sourceClass, getListenerMethodName, 0);</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">        if (method != null) {</span>
<span class="nc" id="L181">            setGetListenerMethod(method);</span>
        }
<span class="nc" id="L183">    }</span>

    private static Method getMethod(Class&lt;?&gt; cls, String name, int args)
        throws IntrospectionException {
<span class="nc bnc" id="L187" title="All 2 branches missed.">        if (name == null) {</span>
<span class="nc" id="L188">            return null;</span>
        }
<span class="nc" id="L190">        Method method = Introspector.findMethod(cls, name, args);</span>
<span class="nc bnc" id="L191" title="All 4 branches missed.">        if ((method == null) || Modifier.isStatic(method.getModifiers())) {</span>
<span class="nc" id="L192">            throw new IntrospectionException(&quot;Method not found: &quot; + name +</span>
<span class="nc" id="L193">                                             &quot; on class &quot; + cls.getName());</span>
        }
<span class="nc" id="L195">        return method;</span>
    }

    /**
     * Creates an &lt;TT&gt;EventSetDescriptor&lt;/TT&gt; from scratch using
     * &lt;TT&gt;java.lang.reflect.Method&lt;/TT&gt; and &lt;TT&gt;java.lang.Class&lt;/TT&gt; objects.
     *
     * @param eventSetName The programmatic name of the event set.
     * @param listenerType The Class for the listener interface.
     * @param listenerMethods  An array of Method objects describing each
     *          of the event handling methods in the target listener.
     * @param addListenerMethod  The method on the event source
     *          that can be used to register an event listener object.
     * @param removeListenerMethod  The method on the event source
     *          that can be used to de-register an event listener object.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     */
    public EventSetDescriptor(String eventSetName,
                Class&lt;?&gt; listenerType,
                Method listenerMethods[],
                Method addListenerMethod,
                Method removeListenerMethod)
                throws IntrospectionException {
<span class="nc" id="L219">        this(eventSetName, listenerType, listenerMethods,</span>
             addListenerMethod, removeListenerMethod, null);
<span class="nc" id="L221">    }</span>

    /**
     * This constructor creates an EventSetDescriptor from scratch using
     * java.lang.reflect.Method and java.lang.Class objects.
     *
     * @param eventSetName The programmatic name of the event set.
     * @param listenerType The Class for the listener interface.
     * @param listenerMethods  An array of Method objects describing each
     *          of the event handling methods in the target listener.
     * @param addListenerMethod  The method on the event source
     *          that can be used to register an event listener object.
     * @param removeListenerMethod  The method on the event source
     *          that can be used to de-register an event listener object.
     * @param getListenerMethod The method on the event source
     *          that can be used to access the array of event listener objects.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     * @since 1.4
     */
    public EventSetDescriptor(String eventSetName,
                Class&lt;?&gt; listenerType,
                Method listenerMethods[],
                Method addListenerMethod,
                Method removeListenerMethod,
                Method getListenerMethod)
<span class="nc" id="L247">                throws IntrospectionException {</span>
<span class="nc" id="L248">        setName(eventSetName);</span>
<span class="nc" id="L249">        setListenerMethods(listenerMethods);</span>
<span class="nc" id="L250">        setAddListenerMethod(addListenerMethod);</span>
<span class="nc" id="L251">        setRemoveListenerMethod( removeListenerMethod);</span>
<span class="nc" id="L252">        setGetListenerMethod(getListenerMethod);</span>
<span class="nc" id="L253">        setListenerType(listenerType);</span>
<span class="nc" id="L254">    }</span>

    /**
     * Creates an &lt;TT&gt;EventSetDescriptor&lt;/TT&gt; from scratch using
     * &lt;TT&gt;java.lang.reflect.MethodDescriptor&lt;/TT&gt; and &lt;TT&gt;java.lang.Class&lt;/TT&gt;
     *  objects.
     *
     * @param eventSetName The programmatic name of the event set.
     * @param listenerType The Class for the listener interface.
     * @param listenerMethodDescriptors  An array of MethodDescriptor objects
     *           describing each of the event handling methods in the
     *           target listener.
     * @param addListenerMethod  The method on the event source
     *          that can be used to register an event listener object.
     * @param removeListenerMethod  The method on the event source
     *          that can be used to de-register an event listener object.
     * @exception IntrospectionException if an exception occurs during
     *              introspection.
     */
    public EventSetDescriptor(String eventSetName,
                Class&lt;?&gt; listenerType,
                MethodDescriptor listenerMethodDescriptors[],
                Method addListenerMethod,
                Method removeListenerMethod)
<span class="nc" id="L278">                throws IntrospectionException {</span>
<span class="nc" id="L279">        setName(eventSetName);</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">        this.listenerMethodDescriptors = (listenerMethodDescriptors != null)</span>
<span class="nc" id="L281">                ? listenerMethodDescriptors.clone()</span>
                : null;
<span class="nc" id="L283">        setAddListenerMethod(addListenerMethod);</span>
<span class="nc" id="L284">        setRemoveListenerMethod(removeListenerMethod);</span>
<span class="nc" id="L285">        setListenerType(listenerType);</span>
<span class="nc" id="L286">    }</span>

    /**
     * Gets the &lt;TT&gt;Class&lt;/TT&gt; object for the target interface.
     *
     * @return The Class object for the target interface that will
     * get invoked when the event is fired.
     */
    public Class&lt;?&gt; getListenerType() {
<span class="nc bnc" id="L295" title="All 2 branches missed.">        return (this.listenerTypeRef != null)</span>
<span class="nc" id="L296">                ? this.listenerTypeRef.get()</span>
                : null;
    }

    private void setListenerType(Class&lt;?&gt; cls) {
<span class="nc" id="L301">        this.listenerTypeRef = getWeakReference(cls);</span>
<span class="nc" id="L302">    }</span>

    /**
     * Gets the methods of the target listener interface.
     *
     * @return An array of &lt;TT&gt;Method&lt;/TT&gt; objects for the target methods
     * within the target listener interface that will get called when
     * events are fired.
     */
    public synchronized Method[] getListenerMethods() {
<span class="nc" id="L312">        Method[] methods = getListenerMethods0();</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">        if (methods == null) {</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">            if (listenerMethodDescriptors != null) {</span>
<span class="nc" id="L315">                methods = new Method[listenerMethodDescriptors.length];</span>
<span class="nc bnc" id="L316" title="All 2 branches missed.">                for (int i = 0; i &lt; methods.length; i++) {</span>
<span class="nc" id="L317">                    methods[i] = listenerMethodDescriptors[i].getMethod();</span>
                }
            }
<span class="nc" id="L320">            setListenerMethods(methods);</span>
        }
<span class="nc" id="L322">        return methods;</span>
    }

    private void setListenerMethods(Method[] methods) {
<span class="nc bnc" id="L326" title="All 2 branches missed.">        if (methods == null) {</span>
<span class="nc" id="L327">            return;</span>
        }
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (listenerMethodDescriptors == null) {</span>
<span class="nc" id="L330">            listenerMethodDescriptors = new MethodDescriptor[methods.length];</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">            for (int i = 0; i &lt; methods.length; i++) {</span>
<span class="nc" id="L332">                listenerMethodDescriptors[i] = new MethodDescriptor(methods[i]);</span>
            }
        }
<span class="nc" id="L335">        this.listenerMethodsRef = getSoftReference(methods);</span>
<span class="nc" id="L336">    }</span>

    private Method[] getListenerMethods0() {
<span class="nc bnc" id="L339" title="All 2 branches missed.">        return (this.listenerMethodsRef != null)</span>
<span class="nc" id="L340">                ? this.listenerMethodsRef.get()</span>
                : null;
    }

    /**
     * Gets the &lt;code&gt;MethodDescriptor&lt;/code&gt;s of the target listener interface.
     *
     * @return An array of &lt;code&gt;MethodDescriptor&lt;/code&gt; objects for the target methods
     * within the target listener interface that will get called when
     * events are fired.
     */
    public synchronized MethodDescriptor[] getListenerMethodDescriptors() {
<span class="nc bnc" id="L352" title="All 2 branches missed.">        return (this.listenerMethodDescriptors != null)</span>
<span class="nc" id="L353">                ? this.listenerMethodDescriptors.clone()</span>
                : null;
    }

    /**
     * Gets the method used to add event listeners.
     *
     * @return The method used to register a listener at the event source.
     */
    public synchronized Method getAddListenerMethod() {
<span class="nc" id="L363">        return getMethod(this.addMethodDescriptor);</span>
    }

    private synchronized void setAddListenerMethod(Method method) {
<span class="nc bnc" id="L367" title="All 2 branches missed.">        if (method == null) {</span>
<span class="nc" id="L368">            return;</span>
        }
<span class="nc bnc" id="L370" title="All 2 branches missed.">        if (getClass0() == null) {</span>
<span class="nc" id="L371">            setClass0(method.getDeclaringClass());</span>
        }
<span class="nc" id="L373">        addMethodDescriptor = new MethodDescriptor(method);</span>
<span class="nc" id="L374">        setTransient(method.getAnnotation(Transient.class));</span>
<span class="nc" id="L375">    }</span>

    /**
     * Gets the method used to remove event listeners.
     *
     * @return The method used to remove a listener at the event source.
     */
    public synchronized Method getRemoveListenerMethod() {
<span class="nc" id="L383">        return getMethod(this.removeMethodDescriptor);</span>
    }

    private synchronized void setRemoveListenerMethod(Method method) {
<span class="nc bnc" id="L387" title="All 2 branches missed.">        if (method == null) {</span>
<span class="nc" id="L388">            return;</span>
        }
<span class="nc bnc" id="L390" title="All 2 branches missed.">        if (getClass0() == null) {</span>
<span class="nc" id="L391">            setClass0(method.getDeclaringClass());</span>
        }
<span class="nc" id="L393">        removeMethodDescriptor = new MethodDescriptor(method);</span>
<span class="nc" id="L394">        setTransient(method.getAnnotation(Transient.class));</span>
<span class="nc" id="L395">    }</span>

    /**
     * Gets the method used to access the registered event listeners.
     *
     * @return The method used to access the array of listeners at the event
     *         source or null if it doesn't exist.
     * @since 1.4
     */
    public synchronized Method getGetListenerMethod() {
<span class="nc" id="L405">        return getMethod(this.getMethodDescriptor);</span>
    }

    private synchronized void setGetListenerMethod(Method method) {
<span class="nc bnc" id="L409" title="All 2 branches missed.">        if (method == null) {</span>
<span class="nc" id="L410">            return;</span>
        }
<span class="nc bnc" id="L412" title="All 2 branches missed.">        if (getClass0() == null) {</span>
<span class="nc" id="L413">            setClass0(method.getDeclaringClass());</span>
        }
<span class="nc" id="L415">        getMethodDescriptor = new MethodDescriptor(method);</span>
<span class="nc" id="L416">        setTransient(method.getAnnotation(Transient.class));</span>
<span class="nc" id="L417">    }</span>

    /**
     * Mark an event set as unicast (or not).
     *
     * @param unicast  True if the event set is unicast.
     */
    public void setUnicast(boolean unicast) {
<span class="nc" id="L425">        this.unicast = unicast;</span>
<span class="nc" id="L426">    }</span>

    /**
     * Normally event sources are multicast.  However there are some
     * exceptions that are strictly unicast.
     *
     * @return  &lt;TT&gt;true&lt;/TT&gt; if the event set is unicast.
     *          Defaults to &lt;TT&gt;false&lt;/TT&gt;.
     */
    public boolean isUnicast() {
<span class="nc" id="L436">        return unicast;</span>
    }

    /**
     * Marks an event set as being in the &amp;quot;default&amp;quot; set (or not).
     * By default this is &lt;TT&gt;true&lt;/TT&gt;.
     *
     * @param inDefaultEventSet &lt;code&gt;true&lt;/code&gt; if the event set is in
     *                          the &amp;quot;default&amp;quot; set,
     *                          &lt;code&gt;false&lt;/code&gt; if not
     */
    public void setInDefaultEventSet(boolean inDefaultEventSet) {
<span class="nc" id="L448">        this.inDefaultEventSet = inDefaultEventSet;</span>
<span class="nc" id="L449">    }</span>

    /**
     * Reports if an event set is in the &amp;quot;default&amp;quot; set.
     *
     * @return  &lt;TT&gt;true&lt;/TT&gt; if the event set is in
     *          the &amp;quot;default&amp;quot; set.  Defaults to &lt;TT&gt;true&lt;/TT&gt;.
     */
    public boolean isInDefaultEventSet() {
<span class="nc" id="L458">        return inDefaultEventSet;</span>
    }

    /*
     * Package-private constructor
     * Merge two event set descriptors.  Where they conflict, give the
     * second argument (y) priority over the first argument (x).
     *
     * @param x  The first (lower priority) EventSetDescriptor
     * @param y  The second (higher priority) EventSetDescriptor
     */
    EventSetDescriptor(EventSetDescriptor x, EventSetDescriptor y) {
<span class="nc" id="L470">        super(x,y);</span>
<span class="nc" id="L471">        listenerMethodDescriptors = x.listenerMethodDescriptors;</span>
<span class="nc bnc" id="L472" title="All 2 branches missed.">        if (y.listenerMethodDescriptors != null) {</span>
<span class="nc" id="L473">            listenerMethodDescriptors = y.listenerMethodDescriptors;</span>
        }

<span class="nc" id="L476">        listenerTypeRef = x.listenerTypeRef;</span>
<span class="nc bnc" id="L477" title="All 2 branches missed.">        if (y.listenerTypeRef != null) {</span>
<span class="nc" id="L478">            listenerTypeRef = y.listenerTypeRef;</span>
        }

<span class="nc" id="L481">        addMethodDescriptor = x.addMethodDescriptor;</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">        if (y.addMethodDescriptor != null) {</span>
<span class="nc" id="L483">            addMethodDescriptor = y.addMethodDescriptor;</span>
        }

<span class="nc" id="L486">        removeMethodDescriptor = x.removeMethodDescriptor;</span>
<span class="nc bnc" id="L487" title="All 2 branches missed.">        if (y.removeMethodDescriptor != null) {</span>
<span class="nc" id="L488">            removeMethodDescriptor = y.removeMethodDescriptor;</span>
        }

<span class="nc" id="L491">        getMethodDescriptor = x.getMethodDescriptor;</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">        if (y.getMethodDescriptor != null) {</span>
<span class="nc" id="L493">            getMethodDescriptor = y.getMethodDescriptor;</span>
        }

<span class="nc" id="L496">        unicast = y.unicast;</span>
<span class="nc bnc" id="L497" title="All 4 branches missed.">        if (!x.inDefaultEventSet || !y.inDefaultEventSet) {</span>
<span class="nc" id="L498">            inDefaultEventSet = false;</span>
        }
<span class="nc" id="L500">    }</span>

    /*
     * Package-private dup constructor
     * This must isolate the new object from any changes to the old object.
     */
    EventSetDescriptor(EventSetDescriptor old) {
<span class="nc" id="L507">        super(old);</span>
<span class="nc bnc" id="L508" title="All 2 branches missed.">        if (old.listenerMethodDescriptors != null) {</span>
<span class="nc" id="L509">            int len = old.listenerMethodDescriptors.length;</span>
<span class="nc" id="L510">            listenerMethodDescriptors = new MethodDescriptor[len];</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">            for (int i = 0; i &lt; len; i++) {</span>
<span class="nc" id="L512">                listenerMethodDescriptors[i] = new MethodDescriptor(</span>
                                        old.listenerMethodDescriptors[i]);
            }
        }
<span class="nc" id="L516">        listenerTypeRef = old.listenerTypeRef;</span>

<span class="nc" id="L518">        addMethodDescriptor = old.addMethodDescriptor;</span>
<span class="nc" id="L519">        removeMethodDescriptor = old.removeMethodDescriptor;</span>
<span class="nc" id="L520">        getMethodDescriptor = old.getMethodDescriptor;</span>

<span class="nc" id="L522">        unicast = old.unicast;</span>
<span class="nc" id="L523">        inDefaultEventSet = old.inDefaultEventSet;</span>
<span class="nc" id="L524">    }</span>

    void appendTo(StringBuilder sb) {
<span class="nc" id="L527">        appendTo(sb, &quot;unicast&quot;, this.unicast);</span>
<span class="nc" id="L528">        appendTo(sb, &quot;inDefaultEventSet&quot;, this.inDefaultEventSet);</span>
<span class="nc" id="L529">        appendTo(sb, &quot;listenerType&quot;, this.listenerTypeRef);</span>
<span class="nc" id="L530">        appendTo(sb, &quot;getListenerMethod&quot;, getMethod(this.getMethodDescriptor));</span>
<span class="nc" id="L531">        appendTo(sb, &quot;addListenerMethod&quot;, getMethod(this.addMethodDescriptor));</span>
<span class="nc" id="L532">        appendTo(sb, &quot;removeListenerMethod&quot;, getMethod(this.removeMethodDescriptor));</span>
<span class="nc" id="L533">    }</span>

    private static Method getMethod(MethodDescriptor descriptor) {
<span class="nc bnc" id="L536" title="All 2 branches missed.">        return (descriptor != null)</span>
<span class="nc" id="L537">                ? descriptor.getMethod()</span>
                : null;
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>