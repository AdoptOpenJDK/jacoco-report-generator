<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>ScrollPaneAdjustable.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.awt</a> &gt; <span class="el_source">ScrollPaneAdjustable.java</span></div><h1>ScrollPaneAdjustable.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2000, 2006, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package java.awt;

import sun.awt.AWTAccessor;

import java.awt.event.AdjustmentEvent;
import java.awt.event.AdjustmentListener;
import java.awt.peer.ScrollPanePeer;
import java.io.Serializable;


/**
 * This class represents the state of a horizontal or vertical
 * scrollbar of a &lt;code&gt;ScrollPane&lt;/code&gt;.  Objects of this class are
 * returned by &lt;code&gt;ScrollPane&lt;/code&gt; methods.
 *
 * @since       1.4
 */
public class ScrollPaneAdjustable implements Adjustable, Serializable {

    /**
     * The &lt;code&gt;ScrollPane&lt;/code&gt; this object is a scrollbar of.
     * @serial
     */
    private ScrollPane sp;

    /**
     * Orientation of this scrollbar.
     *
     * @serial
     * @see #getOrientation
     * @see java.awt.Adjustable#HORIZONTAL
     * @see java.awt.Adjustable#VERTICAL
     */
    private int orientation;

    /**
     * The value of this scrollbar.
     * &lt;code&gt;value&lt;/code&gt; should be greater than &lt;code&gt;minimum&lt;/code&gt;
     * and less than &lt;code&gt;maximum&lt;/code&gt;
     *
     * @serial
     * @see #getValue
     * @see #setValue
     */
    private int value;

    /**
     * The minimum value of this scrollbar.
     * This value can only be set by the &lt;code&gt;ScrollPane&lt;/code&gt;.
     * &lt;p&gt;
     * &lt;strong&gt;ATTN:&lt;/strong&gt; In current implementation
     * &lt;code&gt;minimum&lt;/code&gt; is always &lt;code&gt;0&lt;/code&gt;.  This field can
     * only be altered via &lt;code&gt;setSpan&lt;/code&gt; method and
     * &lt;code&gt;ScrollPane&lt;/code&gt; always calls that method with
     * &lt;code&gt;0&lt;/code&gt; for the minimum.  &lt;code&gt;getMinimum&lt;/code&gt; method
     * always returns &lt;code&gt;0&lt;/code&gt; without checking this field.
     *
     * @serial
     * @see #getMinimum
     * @see #setSpan(int, int, int)
     */
    private int minimum;

    /**
     * The maximum value of this scrollbar.
     * This value can only be set by the &lt;code&gt;ScrollPane&lt;/code&gt;.
     *
     * @serial
     * @see #getMaximum
     * @see #setSpan(int, int, int)
     */
    private int maximum;

    /**
     * The size of the visible portion of this scrollbar.
     * This value can only be set by the &lt;code&gt;ScrollPane&lt;/code&gt;.
     *
     * @serial
     * @see #getVisibleAmount
     * @see #setSpan(int, int, int)
     */
    private int visibleAmount;

    /**
     * The adjusting status of the &lt;code&gt;Scrollbar&lt;/code&gt;.
     * True if the value is in the process of changing as a result of
     * actions being taken by the user.
     *
     * @see #getValueIsAdjusting
     * @see #setValueIsAdjusting
     * @since 1.4
     */
    private transient boolean isAdjusting;

    /**
     * The amount by which the scrollbar value will change when going
     * up or down by a line.
     * This value should be a non negative integer.
     *
     * @serial
     * @see #getUnitIncrement
     * @see #setUnitIncrement
     */
<span class="nc" id="L128">    private int unitIncrement  = 1;</span>

    /**
     * The amount by which the scrollbar value will change when going
     * up or down by a page.
     * This value should be a non negative integer.
     *
     * @serial
     * @see #getBlockIncrement
     * @see #setBlockIncrement
     */
<span class="nc" id="L139">    private int blockIncrement = 1;</span>

    private AdjustmentListener adjustmentListener;

    /**
     * Error message for &lt;code&gt;AWTError&lt;/code&gt; reported when one of
     * the public but unsupported methods is called.
     */
    private static final String SCROLLPANE_ONLY =
        &quot;Can be set by scrollpane only&quot;;


    /**
     * Initialize JNI field and method ids.
     */
    private static native void initIDs();

    static {
<span class="nc" id="L157">        Toolkit.loadLibraries();</span>
<span class="nc bnc" id="L158" title="All 2 branches missed.">        if (!GraphicsEnvironment.isHeadless()) {</span>
<span class="nc" id="L159">            initIDs();</span>
        }
<span class="nc" id="L161">        AWTAccessor.setScrollPaneAdjustableAccessor(new AWTAccessor.ScrollPaneAdjustableAccessor() {</span>
            public void setTypedValue(final ScrollPaneAdjustable adj,
                                      final int v, final int type) {
<span class="nc" id="L164">                adj.setTypedValue(v, type);</span>
<span class="nc" id="L165">            }</span>
        });
<span class="nc" id="L167">    }</span>

    /**
     * JDK 1.1 serialVersionUID.
     */
    private static final long serialVersionUID = -3359745691033257079L;


    /**
     * Constructs a new object to represent specified scrollabar
     * of the specified &lt;code&gt;ScrollPane&lt;/code&gt;.
     * Only ScrollPane creates instances of this class.
     * @param sp           &lt;code&gt;ScrollPane&lt;/code&gt;
     * @param l            &lt;code&gt;AdjustmentListener&lt;/code&gt; to add upon creation.
     * @param orientation  specifies which scrollbar this object represents,
     *                     can be either  &lt;code&gt;Adjustable.HORIZONTAL&lt;/code&gt;
     *                     or &lt;code&gt;Adjustable.VERTICAL&lt;/code&gt;.
     */
<span class="nc" id="L185">    ScrollPaneAdjustable(ScrollPane sp, AdjustmentListener l, int orientation) {</span>
<span class="nc" id="L186">        this.sp = sp;</span>
<span class="nc" id="L187">        this.orientation = orientation;</span>
<span class="nc" id="L188">        addAdjustmentListener(l);</span>
<span class="nc" id="L189">    }</span>

    /**
     * This is called by the scrollpane itself to update the
     * &lt;code&gt;minimum&lt;/code&gt;, &lt;code&gt;maximum&lt;/code&gt; and
     * &lt;code&gt;visible&lt;/code&gt; values.  The scrollpane is the only one
     * that should be changing these since it is the source of these
     * values.
     */
    void setSpan(int min, int max, int visible) {
        // adjust the values to be reasonable
<span class="nc" id="L200">        minimum = min;</span>
<span class="nc" id="L201">        maximum = Math.max(max, minimum + 1);</span>
<span class="nc" id="L202">        visibleAmount = Math.min(visible, maximum - minimum);</span>
<span class="nc" id="L203">        visibleAmount = Math.max(visibleAmount, 1);</span>
<span class="nc" id="L204">        blockIncrement = Math.max((int)(visible * .90), 1);</span>
<span class="nc" id="L205">        setValue(value);</span>
<span class="nc" id="L206">    }</span>

    /**
     * Returns the orientation of this scrollbar.
     * @return    the orientation of this scrollbar, either
     *            &lt;code&gt;Adjustable.HORIZONTAL&lt;/code&gt; or
     *            &lt;code&gt;Adjustable.VERTICAL&lt;/code&gt;
     */
    public int getOrientation() {
<span class="nc" id="L215">        return orientation;</span>
    }

    /**
     * This method should &lt;strong&gt;NOT&lt;/strong&gt; be called by user code.
     * This method is public for this class to properly implement
     * &lt;code&gt;Adjustable&lt;/code&gt; interface.
     *
     * @throws AWTError Always throws an error when called.
     */
    public void setMinimum(int min) {
<span class="nc" id="L226">        throw new AWTError(SCROLLPANE_ONLY);</span>
    }

    public int getMinimum() {
        // XXX: This relies on setSpan always being called with 0 for
        // the minimum (which is currently true).
<span class="nc" id="L232">        return 0;</span>
    }

    /**
     * This method should &lt;strong&gt;NOT&lt;/strong&gt; be called by user code.
     * This method is public for this class to properly implement
     * &lt;code&gt;Adjustable&lt;/code&gt; interface.
     *
     * @throws AWTError Always throws an error when called.
     */
    public void setMaximum(int max) {
<span class="nc" id="L243">        throw new AWTError(SCROLLPANE_ONLY);</span>
    }

    public int getMaximum() {
<span class="nc" id="L247">        return maximum;</span>
    }

    public synchronized void setUnitIncrement(int u) {
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (u != unitIncrement) {</span>
<span class="nc" id="L252">            unitIncrement = u;</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">            if (sp.peer != null) {</span>
<span class="nc" id="L254">                ScrollPanePeer peer = (ScrollPanePeer) sp.peer;</span>
<span class="nc" id="L255">                peer.setUnitIncrement(this, u);</span>
            }
        }
<span class="nc" id="L258">    }</span>

    public int getUnitIncrement() {
<span class="nc" id="L261">        return unitIncrement;</span>
    }

    public synchronized void setBlockIncrement(int b) {
<span class="nc" id="L265">        blockIncrement = b;</span>
<span class="nc" id="L266">    }</span>

    public int getBlockIncrement() {
<span class="nc" id="L269">        return blockIncrement;</span>
    }

    /**
     * This method should &lt;strong&gt;NOT&lt;/strong&gt; be called by user code.
     * This method is public for this class to properly implement
     * &lt;code&gt;Adjustable&lt;/code&gt; interface.
     *
     * @throws AWTError Always throws an error when called.
     */
    public void setVisibleAmount(int v) {
<span class="nc" id="L280">        throw new AWTError(SCROLLPANE_ONLY);</span>
    }

    public int getVisibleAmount() {
<span class="nc" id="L284">        return visibleAmount;</span>
    }


    /**
     * Sets the &lt;code&gt;valueIsAdjusting&lt;/code&gt; property.
     *
     * @param b new adjustment-in-progress status
     * @see #getValueIsAdjusting
     * @since 1.4
     */
    public void setValueIsAdjusting(boolean b) {
<span class="nc bnc" id="L296" title="All 2 branches missed.">        if (isAdjusting != b) {</span>
<span class="nc" id="L297">            isAdjusting = b;</span>
<span class="nc" id="L298">            AdjustmentEvent e =</span>
                new AdjustmentEvent(this,
                        AdjustmentEvent.ADJUSTMENT_VALUE_CHANGED,
                        AdjustmentEvent.TRACK, value, b);
<span class="nc" id="L302">            adjustmentListener.adjustmentValueChanged(e);</span>
        }
<span class="nc" id="L304">    }</span>

    /**
     * Returns true if the value is in the process of changing as a
     * result of actions being taken by the user.
     *
     * @return the value of the &lt;code&gt;valueIsAdjusting&lt;/code&gt; property
     * @see #setValueIsAdjusting
     */
    public boolean getValueIsAdjusting() {
<span class="nc" id="L314">        return isAdjusting;</span>
    }

    /**
     * Sets the value of this scrollbar to the specified value.
     * &lt;p&gt;
     * If the value supplied is less than the current minimum or
     * greater than the current maximum, then one of those values is
     * substituted, as appropriate.
     *
     * @param v the new value of the scrollbar
     */
    public void setValue(int v) {
<span class="nc" id="L327">        setTypedValue(v, AdjustmentEvent.TRACK);</span>
<span class="nc" id="L328">    }</span>

    /**
     * Sets the value of this scrollbar to the specified value.
     * &lt;p&gt;
     * If the value supplied is less than the current minimum or
     * greater than the current maximum, then one of those values is
     * substituted, as appropriate. Also, creates and dispatches
     * the AdjustementEvent with specified type and value.
     *
     * @param v the new value of the scrollbar
     * @param type the type of the scrolling operation occurred
     */
    private void setTypedValue(int v, int type) {
<span class="nc" id="L342">        v = Math.max(v, minimum);</span>
<span class="nc" id="L343">        v = Math.min(v, maximum - visibleAmount);</span>

<span class="nc bnc" id="L345" title="All 2 branches missed.">        if (v != value) {</span>
<span class="nc" id="L346">            value = v;</span>
            // Synchronously notify the listeners so that they are
            // guaranteed to be up-to-date with the Adjustable before
            // it is mutated again.
<span class="nc" id="L350">            AdjustmentEvent e =</span>
                new AdjustmentEvent(this,
                        AdjustmentEvent.ADJUSTMENT_VALUE_CHANGED,
                        type, value, isAdjusting);
<span class="nc" id="L354">            adjustmentListener.adjustmentValueChanged(e);</span>
        }
<span class="nc" id="L356">    }</span>

    public int getValue() {
<span class="nc" id="L359">        return value;</span>
    }

    /**
     * Adds the specified adjustment listener to receive adjustment
     * events from this &lt;code&gt;ScrollPaneAdjustable&lt;/code&gt;.
     * If &lt;code&gt;l&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;, no exception is thrown
     * and no action is performed.
     * &lt;p&gt;Refer to &lt;a href=&quot;doc-files/AWTThreadIssues.html#ListenersThreads&quot;
     * &gt;AWT Threading Issues&lt;/a&gt; for details on AWT's threading model.
     *
     * @param    l   the adjustment listener.
     * @see      #removeAdjustmentListener
     * @see      #getAdjustmentListeners
     * @see      java.awt.event.AdjustmentListener
     * @see      java.awt.event.AdjustmentEvent
     */
    public synchronized void addAdjustmentListener(AdjustmentListener l) {
<span class="nc bnc" id="L377" title="All 2 branches missed.">        if (l == null) {</span>
<span class="nc" id="L378">            return;</span>
        }
<span class="nc" id="L380">        adjustmentListener = AWTEventMulticaster.add(adjustmentListener, l);</span>
<span class="nc" id="L381">    }</span>

    /**
     * Removes the specified adjustment listener so that it no longer
     * receives adjustment events from this &lt;code&gt;ScrollPaneAdjustable&lt;/code&gt;.
     * If &lt;code&gt;l&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;, no exception is thrown
     * and no action is performed.
     * &lt;p&gt;Refer to &lt;a href=&quot;doc-files/AWTThreadIssues.html#ListenersThreads&quot;
     * &gt;AWT Threading Issues&lt;/a&gt; for details on AWT's threading model.
     *
     * @param         l     the adjustment listener.
     * @see           #addAdjustmentListener
     * @see           #getAdjustmentListeners
     * @see           java.awt.event.AdjustmentListener
     * @see           java.awt.event.AdjustmentEvent
     * @since         JDK1.1
     */
    public synchronized void removeAdjustmentListener(AdjustmentListener l){
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (l == null) {</span>
<span class="nc" id="L400">            return;</span>
        }
<span class="nc" id="L402">        adjustmentListener = AWTEventMulticaster.remove(adjustmentListener, l);</span>
<span class="nc" id="L403">    }</span>

    /**
     * Returns an array of all the adjustment listeners
     * registered on this &lt;code&gt;ScrollPaneAdjustable&lt;/code&gt;.
     *
     * @return all of this &lt;code&gt;ScrollPaneAdjustable&lt;/code&gt;'s
     *         &lt;code&gt;AdjustmentListener&lt;/code&gt;s
     *         or an empty array if no adjustment
     *         listeners are currently registered
     *
     * @see           #addAdjustmentListener
     * @see           #removeAdjustmentListener
     * @see           java.awt.event.AdjustmentListener
     * @see           java.awt.event.AdjustmentEvent
     * @since 1.4
     */
    public synchronized AdjustmentListener[] getAdjustmentListeners() {
<span class="nc" id="L421">        return (AdjustmentListener[])(AWTEventMulticaster.getListeners(</span>
                                      adjustmentListener,
                                      AdjustmentListener.class));
    }

    /**
     * Returns a string representation of this scrollbar and its values.
     * @return    a string representation of this scrollbar.
     */
    public String toString() {
<span class="nc" id="L431">        return getClass().getName() + &quot;[&quot; + paramString() + &quot;]&quot;;</span>
    }

    /**
     * Returns a string representing the state of this scrollbar.
     * This method is intended to be used only for debugging purposes,
     * and the content and format of the returned string may vary
     * between implementations.  The returned string may be empty but
     * may not be &lt;code&gt;null&lt;/code&gt;.
     *
     * @return      the parameter string of this scrollbar.
     */
    public String paramString() {
<span class="nc bnc" id="L444" title="All 2 branches missed.">        return ((orientation == Adjustable.VERTICAL ? &quot;vertical,&quot;</span>
                                                    :&quot;horizontal,&quot;)
                + &quot;[0..&quot;+maximum+&quot;]&quot;
                + &quot;,val=&quot; + value
                + &quot;,vis=&quot; + visibleAmount
                + &quot;,unit=&quot; + unitIncrement
                + &quot;,block=&quot; + blockIncrement
                + &quot;,isAdjusting=&quot; + isAdjusting);
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>