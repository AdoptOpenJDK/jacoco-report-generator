<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SystemTray.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">java.awt</a> &gt; <span class="el_source">SystemTray.java</span></div><h1>SystemTray.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2005, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package java.awt;

import java.util.Vector;
import java.awt.peer.SystemTrayPeer;
import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeSupport;
import sun.awt.AppContext;
import sun.awt.SunToolkit;
import sun.awt.HeadlessToolkit;
import sun.security.util.SecurityConstants;
import sun.awt.AWTAccessor;

/**
 * The &lt;code&gt;SystemTray&lt;/code&gt; class represents the system tray for a
 * desktop.  On Microsoft Windows it is referred to as the &quot;Taskbar
 * Status Area&quot;, on Gnome it is referred to as the &quot;Notification
 * Area&quot;, on KDE it is referred to as the &quot;System Tray&quot;.  The system
 * tray is shared by all applications running on the desktop.
 *
 * &lt;p&gt; On some platforms the system tray may not be present or may not
 * be supported, in this case {@link SystemTray#getSystemTray()}
 * throws {@link UnsupportedOperationException}.  To detect whether the
 * system tray is supported, use {@link SystemTray#isSupported}.
 *
 * &lt;p&gt;The &lt;code&gt;SystemTray&lt;/code&gt; may contain one or more {@link
 * TrayIcon TrayIcons}, which are added to the tray using the {@link
 * #add} method, and removed when no longer needed, using the
 * {@link #remove}.  &lt;code&gt;TrayIcon&lt;/code&gt; consists of an
 * image, a popup menu and a set of associated listeners.  Please see
 * the {@link TrayIcon} class for details.
 *
 * &lt;p&gt;Every Java application has a single &lt;code&gt;SystemTray&lt;/code&gt;
 * instance that allows the app to interface with the system tray of
 * the desktop while the app is running.  The &lt;code&gt;SystemTray&lt;/code&gt;
 * instance can be obtained from the {@link #getSystemTray} method.
 * An application may not create its own instance of
 * &lt;code&gt;SystemTray&lt;/code&gt;.
 *
 * &lt;p&gt;The following code snippet demonstrates how to access
 * and customize the system tray:
 * &lt;pre&gt;
 * &lt;code&gt;
 *     {@link TrayIcon} trayIcon = null;
 *     if (SystemTray.isSupported()) {
 *         // get the SystemTray instance
 *         SystemTray tray = SystemTray.{@link #getSystemTray};
 *         // load an image
 *         {@link java.awt.Image} image = {@link java.awt.Toolkit#getImage(String) Toolkit.getDefaultToolkit().getImage}(...);
 *         // create a action listener to listen for default action executed on the tray icon
 *         {@link java.awt.event.ActionListener} listener = new {@link java.awt.event.ActionListener ActionListener}() {
 *             public void {@link java.awt.event.ActionListener#actionPerformed actionPerformed}({@link java.awt.event.ActionEvent} e) {
 *                 // execute default action of the application
 *                 // ...
 *             }
 *         };
 *         // create a popup menu
 *         {@link java.awt.PopupMenu} popup = new {@link java.awt.PopupMenu#PopupMenu PopupMenu}();
 *         // create menu item for the default action
 *         MenuItem defaultItem = new MenuItem(...);
 *         defaultItem.addActionListener(listener);
 *         popup.add(defaultItem);
 *         /// ... add other items
 *         // construct a TrayIcon
 *         trayIcon = new {@link TrayIcon#TrayIcon(java.awt.Image, String, java.awt.PopupMenu) TrayIcon}(image, &quot;Tray Demo&quot;, popup);
 *         // set the TrayIcon properties
 *         trayIcon.{@link TrayIcon#addActionListener(java.awt.event.ActionListener) addActionListener}(listener);
 *         // ...
 *         // add the tray image
 *         try {
 *             tray.{@link SystemTray#add(TrayIcon) add}(trayIcon);
 *         } catch (AWTException e) {
 *             System.err.println(e);
 *         }
 *         // ...
 *     } else {
 *         // disable tray option in your application or
 *         // perform other actions
 *         ...
 *     }
 *     // ...
 *     // some time later
 *     // the application state has changed - update the image
 *     if (trayIcon != null) {
 *         trayIcon.{@link TrayIcon#setImage(java.awt.Image) setImage}(updatedImage);
 *     }
 *     // ...
 * &lt;/code&gt;
 * &lt;/pre&gt;
 *
 * @since 1.6
 * @see TrayIcon
 *
 * @author Bino George
 * @author Denis Mikhalkin
 * @author Sharon Zakhour
 * @author Anton Tarasov
 */
public class SystemTray {
    private static SystemTray systemTray;
<span class="nc" id="L125">    private int currentIconID = 0; // each TrayIcon added gets a unique ID</span>

    transient private SystemTrayPeer peer;

<span class="nc" id="L129">    private static final TrayIcon[] EMPTY_TRAY_ARRAY = new TrayIcon[0];</span>

    static {
<span class="nc" id="L132">        AWTAccessor.setSystemTrayAccessor(</span>
<span class="nc" id="L133">            new AWTAccessor.SystemTrayAccessor() {</span>
                public void firePropertyChange(SystemTray tray,
                                               String propertyName,
                                               Object oldValue,
                                               Object newValue) {
<span class="nc" id="L138">                    tray.firePropertyChange(propertyName, oldValue, newValue);</span>
<span class="nc" id="L139">                }</span>
            });
<span class="nc" id="L141">    }</span>

    /**
     * Private &lt;code&gt;SystemTray&lt;/code&gt; constructor.
     *
     */
<span class="nc" id="L147">    private SystemTray() {</span>
<span class="nc" id="L148">        addNotify();</span>
<span class="nc" id="L149">    }</span>

    /**
     * Gets the &lt;code&gt;SystemTray&lt;/code&gt; instance that represents the
     * desktop's tray area.  This always returns the same instance per
     * application.  On some platforms the system tray may not be
     * supported.  You may use the {@link #isSupported} method to
     * check if the system tray is supported.
     *
     * &lt;p&gt;If a SecurityManager is installed, the AWTPermission
     * {@code accessSystemTray} must be granted in order to get the
     * {@code SystemTray} instance. Otherwise this method will throw a
     * SecurityException.
     *
     * @return the &lt;code&gt;SystemTray&lt;/code&gt; instance that represents
     * the desktop's tray area
     * @throws UnsupportedOperationException if the system tray isn't
     * supported by the current platform
     * @throws HeadlessException if
     * &lt;code&gt;GraphicsEnvironment.isHeadless()&lt;/code&gt; returns &lt;code&gt;true&lt;/code&gt;
     * @throws SecurityException if {@code accessSystemTray} permission
     * is not granted
     * @see #add(TrayIcon)
     * @see TrayIcon
     * @see #isSupported
     * @see SecurityManager#checkPermission
     * @see AWTPermission
     */
    public static SystemTray getSystemTray() {
<span class="nc" id="L178">        checkSystemTrayAllowed();</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">        if (GraphicsEnvironment.isHeadless()) {</span>
<span class="nc" id="L180">            throw new HeadlessException();</span>
        }

<span class="nc" id="L183">        initializeSystemTrayIfNeeded();</span>

<span class="nc bnc" id="L185" title="All 2 branches missed.">        if (!isSupported()) {</span>
<span class="nc" id="L186">            throw new UnsupportedOperationException(</span>
                &quot;The system tray is not supported on the current platform.&quot;);
        }

<span class="nc" id="L190">        return systemTray;</span>
    }

    /**
     * Returns whether the system tray is supported on the current
     * platform.  In addition to displaying the tray icon, minimal
     * system tray support includes either a popup menu (see {@link
     * TrayIcon#setPopupMenu(PopupMenu)}) or an action event (see
     * {@link TrayIcon#addActionListener(ActionListener)}).
     *
     * &lt;p&gt;Developers should not assume that all of the system tray
     * functionality is supported.  To guarantee that the tray icon's
     * default action is always accessible, add the default action to
     * both the action listener and the popup menu.  See the {@link
     * SystemTray example} for an example of how to do this.
     *
     * &lt;p&gt;&lt;b&gt;Note&lt;/b&gt;: When implementing &lt;code&gt;SystemTray&lt;/code&gt; and
     * &lt;code&gt;TrayIcon&lt;/code&gt; it is &lt;em&gt;strongly recommended&lt;/em&gt; that
     * you assign different gestures to the popup menu and an action
     * event.  Overloading a gesture for both purposes is confusing
     * and may prevent the user from accessing one or the other.
     *
     * @see #getSystemTray
     * @return &lt;code&gt;false&lt;/code&gt; if no system tray access is supported; this
     * method returns &lt;code&gt;true&lt;/code&gt; if the minimal system tray access is
     * supported but does not guarantee that all system tray
     * functionality is supported for the current platform
     */
    public static boolean isSupported() {
<span class="nc" id="L219">        Toolkit toolkit = Toolkit.getDefaultToolkit();</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (toolkit instanceof SunToolkit) {</span>
            // connecting tray to native resource
<span class="nc" id="L222">            initializeSystemTrayIfNeeded();</span>
<span class="nc" id="L223">            return ((SunToolkit)toolkit).isTraySupported();</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">        } else if (toolkit instanceof HeadlessToolkit) {</span>
            // skip initialization as the init routine
            // throws HeadlessException
<span class="nc" id="L227">            return ((HeadlessToolkit)toolkit).isTraySupported();</span>
        } else {
<span class="nc" id="L229">            return false;</span>
        }
    }

    /**
     * Adds a &lt;code&gt;TrayIcon&lt;/code&gt; to the &lt;code&gt;SystemTray&lt;/code&gt;.
     * The tray icon becomes visible in the system tray once it is
     * added.  The order in which icons are displayed in a tray is not
     * specified - it is platform and implementation-dependent.
     *
     * &lt;p&gt; All icons added by the application are automatically
     * removed from the &lt;code&gt;SystemTray&lt;/code&gt; upon application exit
     * and also when the desktop system tray becomes unavailable.
     *
     * @param trayIcon the &lt;code&gt;TrayIcon&lt;/code&gt; to be added
     * @throws NullPointerException if &lt;code&gt;trayIcon&lt;/code&gt; is
     * &lt;code&gt;null&lt;/code&gt;
     * @throws IllegalArgumentException if the same instance of
     * a &lt;code&gt;TrayIcon&lt;/code&gt; is added more than once
     * @throws AWTException if the desktop system tray is missing
     * @see #remove(TrayIcon)
     * @see #getSystemTray
     * @see TrayIcon
     * @see java.awt.Image
     */
    public void add(TrayIcon trayIcon) throws AWTException {
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (trayIcon == null) {</span>
<span class="nc" id="L256">            throw new NullPointerException(&quot;adding null TrayIcon&quot;);</span>
        }
<span class="nc" id="L258">        TrayIcon[] oldArray = null, newArray = null;</span>
<span class="nc" id="L259">        Vector&lt;TrayIcon&gt; icons = null;</span>
<span class="nc" id="L260">        synchronized (this) {</span>
<span class="nc" id="L261">            oldArray = systemTray.getTrayIcons();</span>
<span class="nc" id="L262">            icons = (Vector&lt;TrayIcon&gt;)AppContext.getAppContext().get(TrayIcon.class);</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">            if (icons == null) {</span>
<span class="nc" id="L264">                icons = new Vector&lt;TrayIcon&gt;(3);</span>
<span class="nc" id="L265">                AppContext.getAppContext().put(TrayIcon.class, icons);</span>

<span class="nc bnc" id="L267" title="All 2 branches missed.">            } else if (icons.contains(trayIcon)) {</span>
<span class="nc" id="L268">                throw new IllegalArgumentException(&quot;adding TrayIcon that is already added&quot;);</span>
            }
<span class="nc" id="L270">            icons.add(trayIcon);</span>
<span class="nc" id="L271">            newArray = systemTray.getTrayIcons();</span>

<span class="nc" id="L273">            trayIcon.setID(++currentIconID);</span>
<span class="nc" id="L274">        }</span>
        try {
<span class="nc" id="L276">            trayIcon.addNotify();</span>
<span class="nc" id="L277">        } catch (AWTException e) {</span>
<span class="nc" id="L278">            icons.remove(trayIcon);</span>
<span class="nc" id="L279">            throw e;</span>
<span class="nc" id="L280">        }</span>
<span class="nc" id="L281">        firePropertyChange(&quot;trayIcons&quot;, oldArray, newArray);</span>
<span class="nc" id="L282">    }</span>

    /**
     * Removes the specified &lt;code&gt;TrayIcon&lt;/code&gt; from the
     * &lt;code&gt;SystemTray&lt;/code&gt;.
     *
     * &lt;p&gt; All icons added by the application are automatically
     * removed from the &lt;code&gt;SystemTray&lt;/code&gt; upon application exit
     * and also when the desktop system tray becomes unavailable.
     *
     * &lt;p&gt; If &lt;code&gt;trayIcon&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt; or was not
     * added to the system tray, no exception is thrown and no action
     * is performed.
     *
     * @param trayIcon the &lt;code&gt;TrayIcon&lt;/code&gt; to be removed
     * @see #add(TrayIcon)
     * @see TrayIcon
     */
    public void remove(TrayIcon trayIcon) {
<span class="nc bnc" id="L301" title="All 2 branches missed.">        if (trayIcon == null) {</span>
<span class="nc" id="L302">            return;</span>
        }
<span class="nc" id="L304">        TrayIcon[] oldArray = null, newArray = null;</span>
<span class="nc" id="L305">        synchronized (this) {</span>
<span class="nc" id="L306">            oldArray = systemTray.getTrayIcons();</span>
<span class="nc" id="L307">            Vector&lt;TrayIcon&gt; icons = (Vector&lt;TrayIcon&gt;)AppContext.getAppContext().get(TrayIcon.class);</span>
            // TrayIcon with no peer is not contained in the array.
<span class="nc bnc" id="L309" title="All 4 branches missed.">            if (icons == null || !icons.remove(trayIcon)) {</span>
<span class="nc" id="L310">                return;</span>
            }
<span class="nc" id="L312">            trayIcon.removeNotify();</span>
<span class="nc" id="L313">            newArray = systemTray.getTrayIcons();</span>
<span class="nc" id="L314">        }</span>
<span class="nc" id="L315">        firePropertyChange(&quot;trayIcons&quot;, oldArray, newArray);</span>
<span class="nc" id="L316">    }</span>

    /**
     * Returns an array of all icons added to the tray by this
     * application.  You can't access the icons added by another
     * application.  Some browsers partition applets in different
     * code bases into separate contexts, and establish walls between
     * these contexts.  In such a scenario, only the tray icons added
     * from this context will be returned.
     *
     * &lt;p&gt; The returned array is a copy of the actual array and may be
     * modified in any way without affecting the system tray.  To
     * remove a &lt;code&gt;TrayIcon&lt;/code&gt; from the
     * &lt;code&gt;SystemTray&lt;/code&gt;, use the {@link
     * #remove(TrayIcon)} method.
     *
     * @return an array of all tray icons added to this tray, or an
     * empty array if none has been added
     * @see #add(TrayIcon)
     * @see TrayIcon
     */
    public TrayIcon[] getTrayIcons() {
<span class="nc" id="L338">        Vector&lt;TrayIcon&gt; icons = (Vector&lt;TrayIcon&gt;)AppContext.getAppContext().get(TrayIcon.class);</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">        if (icons != null) {</span>
<span class="nc" id="L340">            return (TrayIcon[])icons.toArray(new TrayIcon[icons.size()]);</span>
        }
<span class="nc" id="L342">        return EMPTY_TRAY_ARRAY;</span>
    }

    /**
     * Returns the size, in pixels, of the space that a tray icon will
     * occupy in the system tray.  Developers may use this methods to
     * acquire the preferred size for the image property of a tray icon
     * before it is created.  For convenience, there is a similar
     * method {@link TrayIcon#getSize} in the &lt;code&gt;TrayIcon&lt;/code&gt; class.
     *
     * @return the default size of a tray icon, in pixels
     * @see TrayIcon#setImageAutoSize(boolean)
     * @see java.awt.Image
     * @see TrayIcon#getSize()
     */
    public Dimension getTrayIconSize() {
<span class="nc" id="L358">        return peer.getTrayIconSize();</span>
    }

    /**
     * Adds a {@code PropertyChangeListener} to the list of listeners for the
     * specific property. The following properties are currently supported:
     * &lt;p&gt;
     * &lt;table border=1 summary=&quot;SystemTray properties&quot;&gt;
     * &lt;tr&gt;
     *    &lt;th&gt;Property&lt;/th&gt;
     *    &lt;th&gt;Description&lt;/th&gt;
     * &lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;{@code trayIcons}&lt;/td&gt;
     *    &lt;td&gt;The {@code SystemTray}'s array of {@code TrayIcon} objects.
     *        The array is accessed via the {@link #getTrayIcons} method.&lt;br&gt;
     *        This property is changed when a tray icon is added to (or removed
     *        from) the system tray.&lt;br&gt; For example, this property is changed
     *        when the system tray becomes unavailable on the desktop&lt;br&gt;
     *        and the tray icons are automatically removed.&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;{@code systemTray}&lt;/td&gt;
     *    &lt;td&gt;This property contains {@code SystemTray} instance when the system tray
     *        is available or &lt;code&gt;null&lt;/code&gt; otherwise.&lt;br&gt; This property is changed
     *        when the system tray becomes available or unavailable on the desktop.&lt;br&gt;
     *        The property is accessed by the {@link #getSystemTray} method.&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;/table&gt;
     * &lt;p&gt;
     * The {@code listener} listens to property changes only in this context.
     * &lt;p&gt;
     * If {@code listener} is {@code null}, no exception is thrown
     * and no action is performed.
     *
     * @param propertyName the specified property
     * @param listener the property change listener to be added
     *
     * @see #removePropertyChangeListener
     * @see #getPropertyChangeListeners
     */
    public synchronized void addPropertyChangeListener(String propertyName,
                                                       PropertyChangeListener listener)
    {
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (listener == null) {</span>
<span class="nc" id="L403">            return;</span>
        }
<span class="nc" id="L405">        getCurrentChangeSupport().addPropertyChangeListener(propertyName, listener);</span>
<span class="nc" id="L406">    }</span>

    /**
     * Removes a {@code PropertyChangeListener} from the listener list
     * for a specific property.
     * &lt;p&gt;
     * The {@code PropertyChangeListener} must be from this context.
     * &lt;p&gt;
     * If {@code propertyName} or {@code listener} is {@code null} or invalid,
     * no exception is thrown and no action is taken.
     *
     * @param propertyName the specified property
     * @param listener the PropertyChangeListener to be removed
     *
     * @see #addPropertyChangeListener
     * @see #getPropertyChangeListeners
     */
    public synchronized void removePropertyChangeListener(String propertyName,
                                                          PropertyChangeListener listener)
    {
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (listener == null) {</span>
<span class="nc" id="L427">            return;</span>
        }
<span class="nc" id="L429">        getCurrentChangeSupport().removePropertyChangeListener(propertyName, listener);</span>
<span class="nc" id="L430">    }</span>

    /**
     * Returns an array of all the listeners that have been associated
     * with the named property.
     * &lt;p&gt;
     * Only the listeners in this context are returned.
     *
     * @param propertyName the specified property
     * @return all of the {@code PropertyChangeListener}s associated with
     *         the named property; if no such listeners have been added or
     *         if {@code propertyName} is {@code null} or invalid, an empty
     *         array is returned
     *
     * @see #addPropertyChangeListener
     * @see #removePropertyChangeListener
     */
    public synchronized PropertyChangeListener[] getPropertyChangeListeners(String propertyName) {
<span class="nc" id="L448">        return getCurrentChangeSupport().getPropertyChangeListeners(propertyName);</span>
    }


    // ***************************************************************
    // ***************************************************************


    /**
     * Support for reporting bound property changes for Object properties.
     * This method can be called when a bound property has changed and it will
     * send the appropriate PropertyChangeEvent to any registered
     * PropertyChangeListeners.
     *
     * @param propertyName the property whose value has changed
     * @param oldValue the property's previous value
     * @param newValue the property's new value
     */
    private void firePropertyChange(String propertyName,
                                    Object oldValue, Object newValue)
    {
<span class="nc bnc" id="L469" title="All 6 branches missed.">        if (oldValue != null &amp;&amp; newValue != null &amp;&amp; oldValue.equals(newValue)) {</span>
<span class="nc" id="L470">            return;</span>
        }
<span class="nc" id="L472">        getCurrentChangeSupport().firePropertyChange(propertyName, oldValue, newValue);</span>
<span class="nc" id="L473">    }</span>

    /**
     * Returns the current PropertyChangeSupport instance for the
     * calling thread's context.
     *
     * @return this thread's context's PropertyChangeSupport
     */
    private synchronized PropertyChangeSupport getCurrentChangeSupport() {
        PropertyChangeSupport changeSupport =
<span class="nc" id="L483">            (PropertyChangeSupport)AppContext.getAppContext().get(SystemTray.class);</span>

<span class="nc bnc" id="L485" title="All 2 branches missed.">        if (changeSupport == null) {</span>
<span class="nc" id="L486">            changeSupport = new PropertyChangeSupport(this);</span>
<span class="nc" id="L487">            AppContext.getAppContext().put(SystemTray.class, changeSupport);</span>
        }
<span class="nc" id="L489">        return changeSupport;</span>
    }

    synchronized void addNotify() {
<span class="nc bnc" id="L493" title="All 2 branches missed.">        if (peer == null) {</span>
<span class="nc" id="L494">            Toolkit toolkit = Toolkit.getDefaultToolkit();</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">            if (toolkit instanceof SunToolkit) {</span>
<span class="nc" id="L496">                peer = ((SunToolkit)Toolkit.getDefaultToolkit()).createSystemTray(this);</span>
<span class="nc bnc" id="L497" title="All 2 branches missed.">            } else if (toolkit instanceof HeadlessToolkit) {</span>
<span class="nc" id="L498">                peer = ((HeadlessToolkit)Toolkit.getDefaultToolkit()).createSystemTray(this);</span>
            }
        }
<span class="nc" id="L501">    }</span>

    static void checkSystemTrayAllowed() {
<span class="nc" id="L504">        SecurityManager security = System.getSecurityManager();</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">        if (security != null) {</span>
<span class="nc" id="L506">            security.checkPermission(SecurityConstants.AWT.ACCESS_SYSTEM_TRAY_PERMISSION);</span>
        }
<span class="nc" id="L508">    }</span>

    private static void initializeSystemTrayIfNeeded() {
<span class="nc" id="L511">        synchronized (SystemTray.class) {</span>
<span class="nc bnc" id="L512" title="All 2 branches missed.">            if (systemTray == null) {</span>
<span class="nc" id="L513">                systemTray = new SystemTray();</span>
            }
<span class="nc" id="L515">        }</span>
<span class="nc" id="L516">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>