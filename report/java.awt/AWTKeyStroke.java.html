<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>AWTKeyStroke.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">java.awt</a> &gt; <span class="el_source">AWTKeyStroke.java</span></div><h1>AWTKeyStroke.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package java.awt;

import java.awt.event.KeyEvent;
import sun.awt.AppContext;
import java.awt.event.InputEvent;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.StringTokenizer;
import java.io.Serializable;
import java.security.AccessController;
import java.security.PrivilegedAction;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Modifier;
import java.lang.reflect.Field;

/**
 * An &lt;code&gt;AWTKeyStroke&lt;/code&gt; represents a key action on the
 * keyboard, or equivalent input device. &lt;code&gt;AWTKeyStroke&lt;/code&gt;s
 * can correspond to only a press or release of a
 * particular key, just as &lt;code&gt;KEY_PRESSED&lt;/code&gt; and
 * &lt;code&gt;KEY_RELEASED&lt;/code&gt; &lt;code&gt;KeyEvent&lt;/code&gt;s do;
 * alternately, they can correspond to typing a specific Java character, just
 * as &lt;code&gt;KEY_TYPED&lt;/code&gt; &lt;code&gt;KeyEvent&lt;/code&gt;s do.
 * In all cases, &lt;code&gt;AWTKeyStroke&lt;/code&gt;s can specify modifiers
 * (alt, shift, control, meta, altGraph, or a combination thereof) which must be present
 * during the action for an exact match.
 * &lt;p&gt;
 * &lt;code&gt;AWTKeyStrokes&lt;/code&gt; are immutable, and are intended
 * to be unique. Client code should never create an
 * &lt;code&gt;AWTKeyStroke&lt;/code&gt; on its own, but should instead use
 * a variant of &lt;code&gt;getAWTKeyStroke&lt;/code&gt;. Client use of these factory
 * methods allows the &lt;code&gt;AWTKeyStroke&lt;/code&gt; implementation
 * to cache and share instances efficiently.
 *
 * @see #getAWTKeyStroke
 *
 * @author Arnaud Weber
 * @author David Mendenhall
 * @since 1.4
 */
<span class="pc bpc" id="L67" title="1 of 2 branches missed.">public class AWTKeyStroke implements Serializable {</span>
    static final long serialVersionUID = -6430539691155161871L;

    private static Map&lt;String, Integer&gt; modifierKeywords;
    /**
     * Associates VK_XXX (as a String) with code (as Integer). This is
     * done to avoid the overhead of the reflective call to find the
     * constant.
     */
    private static VKCollection vks;

    //A key for the collection of AWTKeyStrokes within AppContext.
<span class="fc" id="L79">    private static Object APP_CONTEXT_CACHE_KEY = new Object();</span>
    //A key withing the cache
<span class="fc" id="L81">    private static AWTKeyStroke APP_CONTEXT_KEYSTROKE_KEY = new AWTKeyStroke();</span>

    /*
     * Reads keystroke class from AppContext and if null, puts there the
     * AWTKeyStroke class.
     * Must be called under locked AWTKeyStro
     */
    private static Class&lt;AWTKeyStroke&gt; getAWTKeyStrokeClass() {
<span class="fc" id="L89">        Class&lt;AWTKeyStroke&gt; clazz = (Class)AppContext.getAppContext().get(AWTKeyStroke.class);</span>
<span class="fc bfc" id="L90" title="All 2 branches covered.">        if (clazz == null) {</span>
<span class="fc" id="L91">            clazz = AWTKeyStroke.class;</span>
<span class="fc" id="L92">            AppContext.getAppContext().put(AWTKeyStroke.class, AWTKeyStroke.class);</span>
        }
<span class="fc" id="L94">        return clazz;</span>
    }

<span class="pc" id="L97">    private char keyChar = KeyEvent.CHAR_UNDEFINED;</span>
<span class="pc" id="L98">    private int keyCode = KeyEvent.VK_UNDEFINED;</span>
    private int modifiers;
    private boolean onKeyRelease;

    static {
        /* ensure that the necessary native libraries are loaded */
<span class="fc" id="L104">        Toolkit.loadLibraries();</span>
<span class="fc" id="L105">    }</span>

    /**
     * Constructs an &lt;code&gt;AWTKeyStroke&lt;/code&gt; with default values.
     * The default values used are:
     * &lt;table border=&quot;1&quot; summary=&quot;AWTKeyStroke default values&quot;&gt;
     * &lt;tr&gt;&lt;th&gt;Property&lt;/th&gt;&lt;th&gt;Default Value&lt;/th&gt;&lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;Key Char&lt;/td&gt;
     *    &lt;td&gt;&lt;code&gt;KeyEvent.CHAR_UNDEFINED&lt;/code&gt;&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;Key Code&lt;/td&gt;
     *    &lt;td&gt;&lt;code&gt;KeyEvent.VK_UNDEFINED&lt;/code&gt;&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;Modifiers&lt;/td&gt;
     *    &lt;td&gt;none&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;tr&gt;
     *    &lt;td&gt;On key release?&lt;/td&gt;
     *    &lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
     * &lt;/tr&gt;
     * &lt;/table&gt;
     *
     * &lt;code&gt;AWTKeyStroke&lt;/code&gt;s should not be constructed
     * by client code. Use a variant of &lt;code&gt;getAWTKeyStroke&lt;/code&gt;
     * instead.
     *
     * @see #getAWTKeyStroke
     */
<span class="fc" id="L136">    protected AWTKeyStroke() {</span>
<span class="fc" id="L137">    }</span>

    /**
     * Constructs an &lt;code&gt;AWTKeyStroke&lt;/code&gt; with the specified
     * values. &lt;code&gt;AWTKeyStroke&lt;/code&gt;s should not be constructed
     * by client code. Use a variant of &lt;code&gt;getAWTKeyStroke&lt;/code&gt;
     * instead.
     *
     * @param keyChar the character value for a keyboard key
     * @param keyCode the key code for this &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     * @param modifiers a bitwise-ored combination of any modifiers
     * @param onKeyRelease &lt;code&gt;true&lt;/code&gt; if this
     *        &lt;code&gt;AWTKeyStroke&lt;/code&gt; corresponds
     *        to a key release; &lt;code&gt;false&lt;/code&gt; otherwise
     * @see #getAWTKeyStroke
     */
    protected AWTKeyStroke(char keyChar, int keyCode, int modifiers,
<span class="nc" id="L154">                           boolean onKeyRelease) {</span>
<span class="nc" id="L155">        this.keyChar = keyChar;</span>
<span class="nc" id="L156">        this.keyCode = keyCode;</span>
<span class="nc" id="L157">        this.modifiers = modifiers;</span>
<span class="nc" id="L158">        this.onKeyRelease = onKeyRelease;</span>
<span class="nc" id="L159">    }</span>

    /**
     * Registers a new class which the factory methods in
     * &lt;code&gt;AWTKeyStroke&lt;/code&gt; will use when generating new
     * instances of &lt;code&gt;AWTKeyStroke&lt;/code&gt;s. After invoking this
     * method, the factory methods will return instances of the specified
     * Class. The specified Class must be either &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     * or derived from &lt;code&gt;AWTKeyStroke&lt;/code&gt;, and it must have a
     * no-arg constructor. The constructor can be of any accessibility,
     * including &lt;code&gt;private&lt;/code&gt;. This operation
     * flushes the current &lt;code&gt;AWTKeyStroke&lt;/code&gt; cache.
     *
     * @param subclass the new Class of which the factory methods should create
     *        instances
     * @throws IllegalArgumentException if subclass is &lt;code&gt;null&lt;/code&gt;,
     *         or if subclass does not have a no-arg constructor
     * @throws ClassCastException if subclass is not
     *         &lt;code&gt;AWTKeyStroke&lt;/code&gt;, or a class derived from
     *         &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     */
    protected static void registerSubclass(Class&lt;?&gt; subclass) {
<span class="nc bnc" id="L181" title="All 2 branches missed.">        if (subclass == null) {</span>
<span class="nc" id="L182">            throw new IllegalArgumentException(&quot;subclass cannot be null&quot;);</span>
        }
<span class="nc" id="L184">        synchronized (AWTKeyStroke.class) {</span>
<span class="nc" id="L185">            Class&lt;AWTKeyStroke&gt; keyStrokeClass = (Class)AppContext.getAppContext().get(AWTKeyStroke.class);</span>
<span class="nc bnc" id="L186" title="All 4 branches missed.">            if (keyStrokeClass != null &amp;&amp; keyStrokeClass.equals(subclass)){</span>
                // Already registered
<span class="nc" id="L188">                return;</span>
            }
<span class="nc" id="L190">        }</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">        if (!AWTKeyStroke.class.isAssignableFrom(subclass)) {</span>
<span class="nc" id="L192">            throw new ClassCastException(&quot;subclass is not derived from AWTKeyStroke&quot;);</span>
        }

<span class="nc" id="L195">        Constructor ctor = getCtor(subclass);</span>

<span class="nc" id="L197">        String couldNotInstantiate = &quot;subclass could not be instantiated&quot;;</span>

<span class="nc bnc" id="L199" title="All 2 branches missed.">        if (ctor == null) {</span>
<span class="nc" id="L200">            throw new IllegalArgumentException(couldNotInstantiate);</span>
        }
        try {
<span class="nc" id="L203">            AWTKeyStroke stroke = (AWTKeyStroke)ctor.newInstance((Object[]) null);</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">            if (stroke == null) {</span>
<span class="nc" id="L205">                throw new IllegalArgumentException(couldNotInstantiate);</span>
            }
<span class="nc" id="L207">        } catch (NoSuchMethodError e) {</span>
<span class="nc" id="L208">            throw new IllegalArgumentException(couldNotInstantiate);</span>
<span class="nc" id="L209">        } catch (ExceptionInInitializerError e) {</span>
<span class="nc" id="L210">            throw new IllegalArgumentException(couldNotInstantiate);</span>
<span class="nc" id="L211">        } catch (InstantiationException e) {</span>
<span class="nc" id="L212">            throw new IllegalArgumentException(couldNotInstantiate);</span>
<span class="nc" id="L213">        } catch (IllegalAccessException e) {</span>
<span class="nc" id="L214">            throw new IllegalArgumentException(couldNotInstantiate);</span>
<span class="nc" id="L215">        } catch (InvocationTargetException e) {</span>
<span class="nc" id="L216">            throw new IllegalArgumentException(couldNotInstantiate);</span>
<span class="nc" id="L217">        }</span>

<span class="nc" id="L219">        synchronized (AWTKeyStroke.class) {</span>
<span class="nc" id="L220">            AppContext.getAppContext().put(AWTKeyStroke.class, subclass);</span>
<span class="nc" id="L221">            AppContext.getAppContext().remove(APP_CONTEXT_CACHE_KEY);</span>
<span class="nc" id="L222">            AppContext.getAppContext().remove(APP_CONTEXT_KEYSTROKE_KEY);</span>
<span class="nc" id="L223">        }</span>
<span class="nc" id="L224">    }</span>

    /* returns noarg Constructor for class with accessible flag. No security
       threat as accessible flag is set only for this Constructor object,
       not for Class constructor.
     */
    private static Constructor getCtor(final Class clazz)
    {
<span class="fc" id="L232">        Constructor ctor = AccessController.doPrivileged(new PrivilegedAction&lt;Constructor&gt;() {</span>
            public Constructor run() {
                try {
<span class="fc" id="L235">                    Constructor ctor = clazz.getDeclaredConstructor((Class[]) null);</span>
<span class="pc bpc" id="L236" title="1 of 2 branches missed.">                    if (ctor != null) {</span>
<span class="fc" id="L237">                        ctor.setAccessible(true);</span>
                    }
<span class="fc" id="L239">                    return ctor;</span>
<span class="nc" id="L240">                } catch (SecurityException e) {</span>
<span class="nc" id="L241">                } catch (NoSuchMethodException e) {</span>
<span class="nc" id="L242">                }</span>
<span class="nc" id="L243">                return null;</span>
            }
        });
<span class="fc" id="L246">        return (Constructor)ctor;</span>
    }

    private static synchronized AWTKeyStroke getCachedStroke
        (char keyChar, int keyCode, int modifiers, boolean onKeyRelease)
    {
<span class="fc" id="L252">        Map&lt;AWTKeyStroke, AWTKeyStroke&gt; cache = (Map)AppContext.getAppContext().get(APP_CONTEXT_CACHE_KEY);</span>
<span class="fc" id="L253">        AWTKeyStroke cacheKey = (AWTKeyStroke)AppContext.getAppContext().get(APP_CONTEXT_KEYSTROKE_KEY);</span>

<span class="fc bfc" id="L255" title="All 2 branches covered.">        if (cache == null) {</span>
<span class="fc" id="L256">            cache = new HashMap&lt;&gt;();</span>
<span class="fc" id="L257">            AppContext.getAppContext().put(APP_CONTEXT_CACHE_KEY, cache);</span>
        }

<span class="pc bpc" id="L260" title="1 of 2 branches missed.">        if (cacheKey == null) {</span>
            try {
<span class="fc" id="L262">                Class&lt;AWTKeyStroke&gt; clazz = getAWTKeyStrokeClass();</span>
<span class="fc" id="L263">                cacheKey = (AWTKeyStroke)getCtor(clazz).newInstance((Object[]) null);</span>
<span class="fc" id="L264">                AppContext.getAppContext().put(APP_CONTEXT_KEYSTROKE_KEY, cacheKey);</span>
<span class="nc" id="L265">            } catch (InstantiationException e) {</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">                assert(false);</span>
<span class="nc" id="L267">            } catch (IllegalAccessException e) {</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">                assert(false);</span>
<span class="nc" id="L269">            } catch (InvocationTargetException e) {</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">                assert(false);</span>
<span class="pc" id="L271">            }</span>
        }
<span class="fc" id="L273">        cacheKey.keyChar = keyChar;</span>
<span class="fc" id="L274">        cacheKey.keyCode = keyCode;</span>
<span class="fc" id="L275">        cacheKey.modifiers = mapNewModifiers(mapOldModifiers(modifiers));</span>
<span class="fc" id="L276">        cacheKey.onKeyRelease = onKeyRelease;</span>

<span class="fc" id="L278">        AWTKeyStroke stroke = (AWTKeyStroke)cache.get(cacheKey);</span>
<span class="pc bpc" id="L279" title="1 of 2 branches missed.">        if (stroke == null) {</span>
<span class="fc" id="L280">            stroke = cacheKey;</span>
<span class="fc" id="L281">            cache.put(stroke, stroke);</span>
<span class="fc" id="L282">            AppContext.getAppContext().remove(APP_CONTEXT_KEYSTROKE_KEY);</span>
        }
<span class="fc" id="L284">        return stroke;</span>
    }

    /**
     * Returns a shared instance of an &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     * that represents a &lt;code&gt;KEY_TYPED&lt;/code&gt; event for the
     * specified character.
     *
     * @param keyChar the character value for a keyboard key
     * @return an &lt;code&gt;AWTKeyStroke&lt;/code&gt; object for that key
     */
    public static AWTKeyStroke getAWTKeyStroke(char keyChar) {
<span class="nc" id="L296">        return getCachedStroke(keyChar, KeyEvent.VK_UNDEFINED, 0, false);</span>
    }

    /**
     * Returns a shared instance of an {@code AWTKeyStroke}
     * that represents a {@code KEY_TYPED} event for the
     * specified Character object and a set of modifiers. Note
     * that the first parameter is of type Character rather than
     * char. This is to avoid inadvertent clashes with
     * calls to &lt;code&gt;getAWTKeyStroke(int keyCode, int modifiers)&lt;/code&gt;.
     *
     * The modifiers consist of any combination of following:&lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_DOWN_MASK
     * &lt;/ul&gt;
     * The old modifiers listed below also can be used, but they are
     * mapped to _DOWN_ modifiers. &lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_MASK
     * &lt;/ul&gt;
     * also can be used, but they are mapped to _DOWN_ modifiers.
     *
     * Since these numbers are all different powers of two, any combination of
     * them is an integer in which each bit represents a different modifier
     * key. Use 0 to specify no modifiers.
     *
     * @param keyChar the Character object for a keyboard character
     * @param modifiers a bitwise-ored combination of any modifiers
     * @return an &lt;code&gt;AWTKeyStroke&lt;/code&gt; object for that key
     * @throws IllegalArgumentException if &lt;code&gt;keyChar&lt;/code&gt; is
     *       &lt;code&gt;null&lt;/code&gt;
     *
     * @see java.awt.event.InputEvent
     */
    public static AWTKeyStroke getAWTKeyStroke(Character keyChar, int modifiers)
    {
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (keyChar == null) {</span>
<span class="nc" id="L339">            throw new IllegalArgumentException(&quot;keyChar cannot be null&quot;);</span>
        }
<span class="nc" id="L341">        return getCachedStroke(keyChar.charValue(), KeyEvent.VK_UNDEFINED,</span>
                               modifiers, false);
    }

    /**
     * Returns a shared instance of an &lt;code&gt;AWTKeyStroke&lt;/code&gt;,
     * given a numeric key code and a set of modifiers, specifying
     * whether the key is activated when it is pressed or released.
     * &lt;p&gt;
     * The &quot;virtual key&quot; constants defined in
     * &lt;code&gt;java.awt.event.KeyEvent&lt;/code&gt; can be
     * used to specify the key code. For example:&lt;ul&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_ENTER&lt;/code&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_TAB&lt;/code&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_SPACE&lt;/code&gt;
     * &lt;/ul&gt;
     * Alternatively, the key code may be obtained by calling
     * &lt;code&gt;java.awt.event.KeyEvent.getExtendedKeyCodeForChar&lt;/code&gt;.
     *
     * The modifiers consist of any combination of:&lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_DOWN_MASK
     * &lt;/ul&gt;
     * The old modifiers &lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_MASK
     * &lt;/ul&gt;
     * also can be used, but they are mapped to _DOWN_ modifiers.
     *
     * Since these numbers are all different powers of two, any combination of
     * them is an integer in which each bit represents a different modifier
     * key. Use 0 to specify no modifiers.
     *
     * @param keyCode an int specifying the numeric code for a keyboard key
     * @param modifiers a bitwise-ored combination of any modifiers
     * @param onKeyRelease &lt;code&gt;true&lt;/code&gt; if the &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     *        should represent a key release; &lt;code&gt;false&lt;/code&gt; otherwise
     * @return an AWTKeyStroke object for that key
     *
     * @see java.awt.event.KeyEvent
     * @see java.awt.event.InputEvent
     */
    public static AWTKeyStroke getAWTKeyStroke(int keyCode, int modifiers,
                                               boolean onKeyRelease) {
<span class="fc" id="L391">        return getCachedStroke(KeyEvent.CHAR_UNDEFINED, keyCode, modifiers,</span>
                               onKeyRelease);
    }

    /**
     * Returns a shared instance of an &lt;code&gt;AWTKeyStroke&lt;/code&gt;,
     * given a numeric key code and a set of modifiers. The returned
     * &lt;code&gt;AWTKeyStroke&lt;/code&gt; will correspond to a key press.
     * &lt;p&gt;
     * The &quot;virtual key&quot; constants defined in
     * &lt;code&gt;java.awt.event.KeyEvent&lt;/code&gt; can be
     * used to specify the key code. For example:&lt;ul&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_ENTER&lt;/code&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_TAB&lt;/code&gt;
     * &lt;li&gt;&lt;code&gt;java.awt.event.KeyEvent.VK_SPACE&lt;/code&gt;
     * &lt;/ul&gt;
     * The modifiers consist of any combination of:&lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_DOWN_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_DOWN_MASK
     * &lt;/ul&gt;
     * The old modifiers &lt;ul&gt;
     * &lt;li&gt;java.awt.event.InputEvent.SHIFT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.CTRL_MASK
     * &lt;li&gt;java.awt.event.InputEvent.META_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_MASK
     * &lt;li&gt;java.awt.event.InputEvent.ALT_GRAPH_MASK
     * &lt;/ul&gt;
     * also can be used, but they are mapped to _DOWN_ modifiers.
     *
     * Since these numbers are all different powers of two, any combination of
     * them is an integer in which each bit represents a different modifier
     * key. Use 0 to specify no modifiers.
     *
     * @param keyCode an int specifying the numeric code for a keyboard key
     * @param modifiers a bitwise-ored combination of any modifiers
     * @return an &lt;code&gt;AWTKeyStroke&lt;/code&gt; object for that key
     *
     * @see java.awt.event.KeyEvent
     * @see java.awt.event.InputEvent
     */
    public static AWTKeyStroke getAWTKeyStroke(int keyCode, int modifiers) {
<span class="nc" id="L435">        return getCachedStroke(KeyEvent.CHAR_UNDEFINED, keyCode, modifiers,</span>
                               false);
    }

    /**
     * Returns an &lt;code&gt;AWTKeyStroke&lt;/code&gt; which represents the
     * stroke which generated a given &lt;code&gt;KeyEvent&lt;/code&gt;.
     * &lt;p&gt;
     * This method obtains the keyChar from a &lt;code&gt;KeyTyped&lt;/code&gt;
     * event, and the keyCode from a &lt;code&gt;KeyPressed&lt;/code&gt; or
     * &lt;code&gt;KeyReleased&lt;/code&gt; event. The &lt;code&gt;KeyEvent&lt;/code&gt; modifiers are
     * obtained for all three types of &lt;code&gt;KeyEvent&lt;/code&gt;.
     *
     * @param anEvent the &lt;code&gt;KeyEvent&lt;/code&gt; from which to
     *      obtain the &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     * @throws NullPointerException if &lt;code&gt;anEvent&lt;/code&gt; is null
     * @return the &lt;code&gt;AWTKeyStroke&lt;/code&gt; that precipitated the event
     */
    public static AWTKeyStroke getAWTKeyStrokeForEvent(KeyEvent anEvent) {
<span class="nc" id="L454">        int id = anEvent.getID();</span>
<span class="nc bnc" id="L455" title="All 3 branches missed.">        switch(id) {</span>
          case KeyEvent.KEY_PRESSED:
          case KeyEvent.KEY_RELEASED:
<span class="nc" id="L458">            return getCachedStroke(KeyEvent.CHAR_UNDEFINED,</span>
<span class="nc" id="L459">                                   anEvent.getKeyCode(),</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">                                   anEvent.getModifiers(),</span>
                                   (id == KeyEvent.KEY_RELEASED));
          case KeyEvent.KEY_TYPED:
<span class="nc" id="L463">            return getCachedStroke(anEvent.getKeyChar(),</span>
                                   KeyEvent.VK_UNDEFINED,
<span class="nc" id="L465">                                   anEvent.getModifiers(),</span>
                                   false);
          default:
            // Invalid ID for this KeyEvent
<span class="nc" id="L469">            return null;</span>
        }
    }

    /**
     * Parses a string and returns an &lt;code&gt;AWTKeyStroke&lt;/code&gt;.
     * The string must have the following syntax:
     * &lt;pre&gt;
     *    &amp;lt;modifiers&amp;gt;* (&amp;lt;typedID&amp;gt; | &amp;lt;pressedReleasedID&amp;gt;)
     *
     *    modifiers := shift | control | ctrl | meta | alt | altGraph
     *    typedID := typed &amp;lt;typedKey&amp;gt;
     *    typedKey := string of length 1 giving Unicode character.
     *    pressedReleasedID := (pressed | released) key
     *    key := KeyEvent key code name, i.e. the name following &quot;VK_&quot;.
     * &lt;/pre&gt;
     * If typed, pressed or released is not specified, pressed is assumed. Here
     * are some examples:
     * &lt;pre&gt;
     *     &quot;INSERT&quot; =&amp;gt; getAWTKeyStroke(KeyEvent.VK_INSERT, 0);
     *     &quot;control DELETE&quot; =&amp;gt; getAWTKeyStroke(KeyEvent.VK_DELETE, InputEvent.CTRL_MASK);
     *     &quot;alt shift X&quot; =&amp;gt; getAWTKeyStroke(KeyEvent.VK_X, InputEvent.ALT_MASK | InputEvent.SHIFT_MASK);
     *     &quot;alt shift released X&quot; =&amp;gt; getAWTKeyStroke(KeyEvent.VK_X, InputEvent.ALT_MASK | InputEvent.SHIFT_MASK, true);
     *     &quot;typed a&quot; =&amp;gt; getAWTKeyStroke('a');
     * &lt;/pre&gt;
     *
     * @param s a String formatted as described above
     * @return an &lt;code&gt;AWTKeyStroke&lt;/code&gt; object for that String
     * @throws IllegalArgumentException if &lt;code&gt;s&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;,
     *        or is formatted incorrectly
     */
    public static AWTKeyStroke getAWTKeyStroke(String s) {
<span class="nc bnc" id="L501" title="All 2 branches missed.">        if (s == null) {</span>
<span class="nc" id="L502">            throw new IllegalArgumentException(&quot;String cannot be null&quot;);</span>
        }

        final String errmsg = &quot;String formatted incorrectly&quot;;

<span class="nc" id="L507">        StringTokenizer st = new StringTokenizer(s, &quot; &quot;);</span>

<span class="nc" id="L509">        int mask = 0;</span>
<span class="nc" id="L510">        boolean released = false;</span>
<span class="nc" id="L511">        boolean typed = false;</span>
<span class="nc" id="L512">        boolean pressed = false;</span>

<span class="nc" id="L514">        synchronized (AWTKeyStroke.class) {</span>
<span class="nc bnc" id="L515" title="All 2 branches missed.">            if (modifierKeywords == null) {</span>
<span class="nc" id="L516">                Map&lt;String, Integer&gt; uninitializedMap = new HashMap&lt;&gt;(8, 1.0f);</span>
<span class="nc" id="L517">                uninitializedMap.put(&quot;shift&quot;,</span>
<span class="nc" id="L518">                                     Integer.valueOf(InputEvent.SHIFT_DOWN_MASK</span>
                                                     |InputEvent.SHIFT_MASK));
<span class="nc" id="L520">                uninitializedMap.put(&quot;control&quot;,</span>
<span class="nc" id="L521">                                     Integer.valueOf(InputEvent.CTRL_DOWN_MASK</span>
                                                     |InputEvent.CTRL_MASK));
<span class="nc" id="L523">                uninitializedMap.put(&quot;ctrl&quot;,</span>
<span class="nc" id="L524">                                     Integer.valueOf(InputEvent.CTRL_DOWN_MASK</span>
                                                     |InputEvent.CTRL_MASK));
<span class="nc" id="L526">                uninitializedMap.put(&quot;meta&quot;,</span>
<span class="nc" id="L527">                                     Integer.valueOf(InputEvent.META_DOWN_MASK</span>
                                                     |InputEvent.META_MASK));
<span class="nc" id="L529">                uninitializedMap.put(&quot;alt&quot;,</span>
<span class="nc" id="L530">                                     Integer.valueOf(InputEvent.ALT_DOWN_MASK</span>
                                                     |InputEvent.ALT_MASK));
<span class="nc" id="L532">                uninitializedMap.put(&quot;altGraph&quot;,</span>
<span class="nc" id="L533">                                     Integer.valueOf(InputEvent.ALT_GRAPH_DOWN_MASK</span>
                                                     |InputEvent.ALT_GRAPH_MASK));
<span class="nc" id="L535">                uninitializedMap.put(&quot;button1&quot;,</span>
<span class="nc" id="L536">                                     Integer.valueOf(InputEvent.BUTTON1_DOWN_MASK));</span>
<span class="nc" id="L537">                uninitializedMap.put(&quot;button2&quot;,</span>
<span class="nc" id="L538">                                     Integer.valueOf(InputEvent.BUTTON2_DOWN_MASK));</span>
<span class="nc" id="L539">                uninitializedMap.put(&quot;button3&quot;,</span>
<span class="nc" id="L540">                                     Integer.valueOf(InputEvent.BUTTON3_DOWN_MASK));</span>
<span class="nc" id="L541">                modifierKeywords =</span>
<span class="nc" id="L542">                    Collections.synchronizedMap(uninitializedMap);</span>
            }
<span class="nc" id="L544">        }</span>

<span class="nc" id="L546">        int count = st.countTokens();</span>

<span class="nc bnc" id="L548" title="All 2 branches missed.">        for (int i = 1; i &lt;= count; i++) {</span>
<span class="nc" id="L549">            String token = st.nextToken();</span>

<span class="nc bnc" id="L551" title="All 2 branches missed.">            if (typed) {</span>
<span class="nc bnc" id="L552" title="All 4 branches missed.">                if (token.length() != 1 || i != count) {</span>
<span class="nc" id="L553">                    throw new IllegalArgumentException(errmsg);</span>
                }
<span class="nc" id="L555">                return getCachedStroke(token.charAt(0), KeyEvent.VK_UNDEFINED,</span>
                                       mask, false);
            }

<span class="nc bnc" id="L559" title="All 6 branches missed.">            if (pressed || released || i == count) {</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">                if (i != count) {</span>
<span class="nc" id="L561">                    throw new IllegalArgumentException(errmsg);</span>
                }

<span class="nc" id="L564">                String keyCodeName = &quot;VK_&quot; + token;</span>
<span class="nc" id="L565">                int keyCode = getVKValue(keyCodeName);</span>

<span class="nc" id="L567">                return getCachedStroke(KeyEvent.CHAR_UNDEFINED, keyCode,</span>
                                       mask, released);
            }

<span class="nc bnc" id="L571" title="All 2 branches missed.">            if (token.equals(&quot;released&quot;)) {</span>
<span class="nc" id="L572">                released = true;</span>
<span class="nc" id="L573">                continue;</span>
            }
<span class="nc bnc" id="L575" title="All 2 branches missed.">            if (token.equals(&quot;pressed&quot;)) {</span>
<span class="nc" id="L576">                pressed = true;</span>
<span class="nc" id="L577">                continue;</span>
            }
<span class="nc bnc" id="L579" title="All 2 branches missed.">            if (token.equals(&quot;typed&quot;)) {</span>
<span class="nc" id="L580">                typed = true;</span>
<span class="nc" id="L581">                continue;</span>
            }

<span class="nc" id="L584">            Integer tokenMask = (Integer)modifierKeywords.get(token);</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">            if (tokenMask != null) {</span>
<span class="nc" id="L586">                mask |= tokenMask.intValue();</span>
            } else {
<span class="nc" id="L588">                throw new IllegalArgumentException(errmsg);</span>
            }
        }

<span class="nc" id="L592">        throw new IllegalArgumentException(errmsg);</span>
    }

    private static VKCollection getVKCollection() {
<span class="nc bnc" id="L596" title="All 2 branches missed.">        if (vks == null) {</span>
<span class="nc" id="L597">            vks = new VKCollection();</span>
        }
<span class="nc" id="L599">        return vks;</span>
    }
    /**
     * Returns the integer constant for the KeyEvent.VK field named
     * &lt;code&gt;key&lt;/code&gt;. This will throw an
     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; if &lt;code&gt;key&lt;/code&gt; is
     * not a valid constant.
     */
    private static int getVKValue(String key) {
<span class="nc" id="L608">        VKCollection vkCollect = getVKCollection();</span>

<span class="nc" id="L610">        Integer value = vkCollect.findCode(key);</span>

<span class="nc bnc" id="L612" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L613">            int keyCode = 0;</span>
            final String errmsg = &quot;String formatted incorrectly&quot;;

            try {
<span class="nc" id="L617">                keyCode = KeyEvent.class.getField(key).getInt(KeyEvent.class);</span>
<span class="nc" id="L618">            } catch (NoSuchFieldException nsfe) {</span>
<span class="nc" id="L619">                throw new IllegalArgumentException(errmsg);</span>
<span class="nc" id="L620">            } catch (IllegalAccessException iae) {</span>
<span class="nc" id="L621">                throw new IllegalArgumentException(errmsg);</span>
<span class="nc" id="L622">            }</span>
<span class="nc" id="L623">            value = Integer.valueOf(keyCode);</span>
<span class="nc" id="L624">            vkCollect.put(key, value);</span>
        }
<span class="nc" id="L626">        return value.intValue();</span>
    }

    /**
     * Returns the character for this &lt;code&gt;AWTKeyStroke&lt;/code&gt;.
     *
     * @return a char value
     * @see #getAWTKeyStroke(char)
     * @see KeyEvent#getKeyChar
     */
    public final char getKeyChar() {
<span class="nc" id="L637">        return keyChar;</span>
    }

    /**
     * Returns the numeric key code for this &lt;code&gt;AWTKeyStroke&lt;/code&gt;.
     *
     * @return an int containing the key code value
     * @see #getAWTKeyStroke(int,int)
     * @see KeyEvent#getKeyCode
     */
    public final int getKeyCode() {
<span class="nc" id="L648">        return keyCode;</span>
    }

    /**
     * Returns the modifier keys for this &lt;code&gt;AWTKeyStroke&lt;/code&gt;.
     *
     * @return an int containing the modifiers
     * @see #getAWTKeyStroke(int,int)
     */
    public final int getModifiers() {
<span class="nc" id="L658">        return modifiers;</span>
    }

    /**
     * Returns whether this &lt;code&gt;AWTKeyStroke&lt;/code&gt; represents a key release.
     *
     * @return &lt;code&gt;true&lt;/code&gt; if this &lt;code&gt;AWTKeyStroke&lt;/code&gt;
     *          represents a key release; &lt;code&gt;false&lt;/code&gt; otherwise
     * @see #getAWTKeyStroke(int,int,boolean)
     */
    public final boolean isOnKeyRelease() {
<span class="nc" id="L669">        return onKeyRelease;</span>
    }

    /**
     * Returns the type of &lt;code&gt;KeyEvent&lt;/code&gt; which corresponds to
     * this &lt;code&gt;AWTKeyStroke&lt;/code&gt;.
     *
     * @return &lt;code&gt;KeyEvent.KEY_PRESSED&lt;/code&gt;,
     *         &lt;code&gt;KeyEvent.KEY_TYPED&lt;/code&gt;,
     *         or &lt;code&gt;KeyEvent.KEY_RELEASED&lt;/code&gt;
     * @see java.awt.event.KeyEvent
     */
    public final int getKeyEventType() {
<span class="nc bnc" id="L682" title="All 2 branches missed.">        if (keyCode == KeyEvent.VK_UNDEFINED) {</span>
<span class="nc" id="L683">            return KeyEvent.KEY_TYPED;</span>
        } else {
<span class="nc bnc" id="L685" title="All 2 branches missed.">            return (onKeyRelease)</span>
                ? KeyEvent.KEY_RELEASED
                : KeyEvent.KEY_PRESSED;
        }
    }

    /**
     * Returns a numeric value for this object that is likely to be unique,
     * making it a good choice as the index value in a hash table.
     *
     * @return an int that represents this object
     */
    public int hashCode() {
<span class="pc bpc" id="L698" title="1 of 2 branches missed.">        return (((int)keyChar) + 1) * (2 * (keyCode + 1)) * (modifiers + 1) +</span>
            (onKeyRelease ? 1 : 2);
    }

    /**
     * Returns true if this object is identical to the specified object.
     *
     * @param anObject the Object to compare this object to
     * @return true if the objects are identical
     */
    public final boolean equals(Object anObject) {
<span class="nc bnc" id="L709" title="All 2 branches missed.">        if (anObject instanceof AWTKeyStroke) {</span>
<span class="nc" id="L710">            AWTKeyStroke ks = (AWTKeyStroke)anObject;</span>
<span class="nc bnc" id="L711" title="All 8 branches missed.">            return (ks.keyChar == keyChar &amp;&amp; ks.keyCode == keyCode &amp;&amp;</span>
                    ks.onKeyRelease == onKeyRelease &amp;&amp;
                    ks.modifiers == modifiers);
        }
<span class="nc" id="L715">        return false;</span>
    }

    /**
     * Returns a string that displays and identifies this object's properties.
     * The &lt;code&gt;String&lt;/code&gt; returned by this method can be passed
     * as a parameter to &lt;code&gt;getAWTKeyStroke(String)&lt;/code&gt; to produce
     * a key stroke equal to this key stroke.
     *
     * @return a String representation of this object
     * @see #getAWTKeyStroke(String)
     */
    public String toString() {
<span class="nc bnc" id="L728" title="All 2 branches missed.">        if (keyCode == KeyEvent.VK_UNDEFINED) {</span>
<span class="nc" id="L729">            return getModifiersText(modifiers) + &quot;typed &quot; + keyChar;</span>
        } else {
<span class="nc bnc" id="L731" title="All 2 branches missed.">            return getModifiersText(modifiers) +</span>
                (onKeyRelease ? &quot;released&quot; : &quot;pressed&quot;) + &quot; &quot; +
<span class="nc" id="L733">                getVKText(keyCode);</span>
        }
    }

    static String getModifiersText(int modifiers) {
<span class="nc" id="L738">        StringBuilder buf = new StringBuilder();</span>

<span class="nc bnc" id="L740" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.SHIFT_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L741">            buf.append(&quot;shift &quot;);</span>
        }
<span class="nc bnc" id="L743" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.CTRL_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L744">            buf.append(&quot;ctrl &quot;);</span>
        }
<span class="nc bnc" id="L746" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.META_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L747">            buf.append(&quot;meta &quot;);</span>
        }
<span class="nc bnc" id="L749" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L750">            buf.append(&quot;alt &quot;);</span>
        }
<span class="nc bnc" id="L752" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_GRAPH_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L753">            buf.append(&quot;altGraph &quot;);</span>
        }
<span class="nc bnc" id="L755" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON1_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L756">            buf.append(&quot;button1 &quot;);</span>
        }
<span class="nc bnc" id="L758" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON2_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L759">            buf.append(&quot;button2 &quot;);</span>
        }
<span class="nc bnc" id="L761" title="All 2 branches missed.">        if ((modifiers &amp; InputEvent.BUTTON3_DOWN_MASK) != 0 ) {</span>
<span class="nc" id="L762">            buf.append(&quot;button3 &quot;);</span>
        }

<span class="nc" id="L765">        return buf.toString();</span>
    }

    static String getVKText(int keyCode) {
<span class="nc" id="L769">        VKCollection vkCollect = getVKCollection();</span>
<span class="nc" id="L770">        Integer key = Integer.valueOf(keyCode);</span>
<span class="nc" id="L771">        String name = vkCollect.findName(key);</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">        if (name != null) {</span>
<span class="nc" id="L773">            return name.substring(3);</span>
        }
<span class="nc" id="L775">        int expected_modifiers =</span>
            (Modifier.PUBLIC | Modifier.STATIC | Modifier.FINAL);

<span class="nc" id="L778">        Field[] fields = KeyEvent.class.getDeclaredFields();</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">        for (int i = 0; i &lt; fields.length; i++) {</span>
            try {
<span class="nc bnc" id="L781" title="All 2 branches missed.">                if (fields[i].getModifiers() == expected_modifiers</span>
<span class="nc bnc" id="L782" title="All 2 branches missed.">                    &amp;&amp; fields[i].getType() == Integer.TYPE</span>
<span class="nc bnc" id="L783" title="All 2 branches missed.">                    &amp;&amp; fields[i].getName().startsWith(&quot;VK_&quot;)</span>
<span class="nc bnc" id="L784" title="All 2 branches missed.">                    &amp;&amp; fields[i].getInt(KeyEvent.class) == keyCode)</span>
                {
<span class="nc" id="L786">                    name = fields[i].getName();</span>
<span class="nc" id="L787">                    vkCollect.put(name, key);</span>
<span class="nc" id="L788">                    return name.substring(3);</span>
                }
<span class="nc" id="L790">            } catch (IllegalAccessException e) {</span>
<span class="nc bnc" id="L791" title="All 2 branches missed.">                assert(false);</span>
<span class="nc" id="L792">            }</span>
        }
<span class="nc" id="L794">        return &quot;UNKNOWN&quot;;</span>
    }

    /**
     * Returns a cached instance of &lt;code&gt;AWTKeyStroke&lt;/code&gt; (or a subclass of
     * &lt;code&gt;AWTKeyStroke&lt;/code&gt;) which is equal to this instance.
     *
     * @return a cached instance which is equal to this instance
     */
    protected Object readResolve() throws java.io.ObjectStreamException {
<span class="nc" id="L804">        synchronized (AWTKeyStroke.class) {</span>
<span class="nc bnc" id="L805" title="All 2 branches missed.">            if (getClass().equals(getAWTKeyStrokeClass())) {</span>
<span class="nc" id="L806">                return  getCachedStroke(keyChar, keyCode, modifiers, onKeyRelease);</span>
            }
<span class="nc" id="L808">        }</span>
<span class="nc" id="L809">        return this;</span>
    }

    private static int mapOldModifiers(int modifiers) {
<span class="fc bfc" id="L813" title="All 2 branches covered.">        if ((modifiers &amp; InputEvent.SHIFT_MASK) != 0) {</span>
<span class="fc" id="L814">            modifiers |= InputEvent.SHIFT_DOWN_MASK;</span>
        }
<span class="pc bpc" id="L816" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_MASK) != 0) {</span>
<span class="nc" id="L817">            modifiers |= InputEvent.ALT_DOWN_MASK;</span>
        }
<span class="pc bpc" id="L819" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_GRAPH_MASK) != 0) {</span>
<span class="nc" id="L820">            modifiers |= InputEvent.ALT_GRAPH_DOWN_MASK;</span>
        }
<span class="fc bfc" id="L822" title="All 2 branches covered.">        if ((modifiers &amp; InputEvent.CTRL_MASK) != 0) {</span>
<span class="fc" id="L823">            modifiers |= InputEvent.CTRL_DOWN_MASK;</span>
        }
<span class="pc bpc" id="L825" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.META_MASK) != 0) {</span>
<span class="nc" id="L826">            modifiers |= InputEvent.META_DOWN_MASK;</span>
        }

<span class="fc" id="L829">        modifiers &amp;= InputEvent.SHIFT_DOWN_MASK</span>
            | InputEvent.ALT_DOWN_MASK
            | InputEvent.ALT_GRAPH_DOWN_MASK
            | InputEvent.CTRL_DOWN_MASK
            | InputEvent.META_DOWN_MASK
            | InputEvent.BUTTON1_DOWN_MASK
            | InputEvent.BUTTON2_DOWN_MASK
            | InputEvent.BUTTON3_DOWN_MASK;

<span class="fc" id="L838">        return modifiers;</span>
    }

    private static int mapNewModifiers(int modifiers) {
<span class="fc bfc" id="L842" title="All 2 branches covered.">        if ((modifiers &amp; InputEvent.SHIFT_DOWN_MASK) != 0) {</span>
<span class="fc" id="L843">            modifiers |= InputEvent.SHIFT_MASK;</span>
        }
<span class="pc bpc" id="L845" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_DOWN_MASK) != 0) {</span>
<span class="nc" id="L846">            modifiers |= InputEvent.ALT_MASK;</span>
        }
<span class="pc bpc" id="L848" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.ALT_GRAPH_DOWN_MASK) != 0) {</span>
<span class="nc" id="L849">            modifiers |= InputEvent.ALT_GRAPH_MASK;</span>
        }
<span class="fc bfc" id="L851" title="All 2 branches covered.">        if ((modifiers &amp; InputEvent.CTRL_DOWN_MASK) != 0) {</span>
<span class="fc" id="L852">            modifiers |= InputEvent.CTRL_MASK;</span>
        }
<span class="pc bpc" id="L854" title="1 of 2 branches missed.">        if ((modifiers &amp; InputEvent.META_DOWN_MASK) != 0) {</span>
<span class="nc" id="L855">            modifiers |= InputEvent.META_MASK;</span>
        }

<span class="fc" id="L858">        return modifiers;</span>
    }

}

<span class="nc bnc" id="L863" title="All 2 branches missed.">class VKCollection {</span>
    Map&lt;Integer, String&gt; code2name;
    Map&lt;String, Integer&gt; name2code;

<span class="nc" id="L867">    public VKCollection() {</span>
<span class="nc" id="L868">        code2name = new HashMap&lt;&gt;();</span>
<span class="nc" id="L869">        name2code = new HashMap&lt;&gt;();</span>
<span class="nc" id="L870">    }</span>

    public synchronized void put(String name, Integer code) {
<span class="nc bnc" id="L873" title="All 6 branches missed.">        assert((name != null) &amp;&amp; (code != null));</span>
<span class="nc bnc" id="L874" title="All 4 branches missed.">        assert(findName(code) == null);</span>
<span class="nc bnc" id="L875" title="All 4 branches missed.">        assert(findCode(name) == null);</span>
<span class="nc" id="L876">        code2name.put(code, name);</span>
<span class="nc" id="L877">        name2code.put(name, code);</span>
<span class="nc" id="L878">    }</span>

    public synchronized Integer findCode(String name) {
<span class="nc bnc" id="L881" title="All 4 branches missed.">        assert(name != null);</span>
<span class="nc" id="L882">        return (Integer)name2code.get(name);</span>
    }

    public synchronized String findName(Integer code) {
<span class="nc bnc" id="L886" title="All 4 branches missed.">        assert(code != null);</span>
<span class="nc" id="L887">        return (String)code2name.get(code);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>