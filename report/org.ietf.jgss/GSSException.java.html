<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GSSException.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">org.ietf.jgss</a> &gt; <span class="el_source">GSSException.java</span></div><h1>GSSException.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2000, 2003, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package org.ietf.jgss;

/**
 * This exception is thrown whenever a GSS-API error occurs, including
 * any mechanism specific error.  It may contain both the major and the
 * minor GSS-API status codes.  Major error codes are those defined at the
 * GSS-API level in this class. Minor error codes are mechanism specific
 * error codes that can provide additional information. The underlying
 * mechanism implementation is responsible for setting appropriate minor
 * status codes when throwing this exception.  Aside from delivering the
 * numeric error codes to the caller, this class performs the mapping from
 * their numeric values to textual representations. &lt;p&gt;
 *
 * @author Mayank Upadhyay
 * @since 1.4
 */
public class GSSException extends Exception {

    private static final long serialVersionUID = -2706218945227726672L;

    /**
     * Channel bindings mismatch.
     */
    public static final int BAD_BINDINGS = 1; //start with 1

    /**
     * Unsupported mechanism requested.
     */
    public static final int BAD_MECH = 2;

    /**
     * Invalid name provided.
     */
    public static final int BAD_NAME = 3;

    /**
     * Name of unsupported type provided.
     */
    public static final int BAD_NAMETYPE = 4;

    /**
     * Invalid status code.
     */
    /*
     * This is meant to be thrown by display_status which displays
     * major/minor status when an incorrect status type is passed in to it!
     */
    public static final int BAD_STATUS = 5;

    /**
     * Token had invalid integrity check.
     */
    public static final int BAD_MIC = 6;

    /**
     * Security context expired.
     */
    public static final int CONTEXT_EXPIRED = 7;

    /**
     * Expired credentials.
     */
    public static final int CREDENTIALS_EXPIRED  = 8;

    /**
     * Defective credentials.
     *
     */
    public static final int DEFECTIVE_CREDENTIAL = 9;

    /**
     * Defective token.
     *
     */
    public static final int DEFECTIVE_TOKEN = 10;

    /**
     * General failure, unspecified at GSS-API level.
     */
    public static final int FAILURE = 11;

    /**
     * Invalid security context.
     */
    public static final int NO_CONTEXT = 12;

    /**
     * Invalid credentials.
     */
    public static final int NO_CRED = 13;

    /**
     * Unsupported QOP value.
     */
    public static final int BAD_QOP = 14;

    /**
     * Operation unauthorized.
     */
    public static final int UNAUTHORIZED = 15;

    /**
     * Operation unavailable.
     */
    public static final int UNAVAILABLE = 16;

    /**
     * Duplicate credential element requested.
     */
    public static final int DUPLICATE_ELEMENT = 17;

    /**
     * Name contains multi-mechanism elements.
     */
    public static final int NAME_NOT_MN = 18;

    /**
     * The token was a duplicate of an earlier token.
     * This is a fatal error code that may occur during
     * context establishment.  It is not used to indicate
     * supplementary status values. The MessageProp object is
     * used for that purpose.
     */
    public static final int DUPLICATE_TOKEN = 19;

    /**
     * The token's validity period has expired.  This is a
     * fatal error code that may occur during context establishment.
     * It is not used to indicate supplementary status values.
     * The MessageProp object is used for that purpose.
     */
    public static final int OLD_TOKEN = 20;


    /**
     * A later token has already been processed.  This is a
     * fatal error code that may occur during context establishment.
     * It is not used to indicate supplementary status values.
     * The MessageProp object is used for that purpose.
     */
    public static final int UNSEQ_TOKEN = 21;


    /**
     * An expected per-message token was not received.  This is a
     * fatal error code that may occur during context establishment.
     * It is not used to indicate supplementary status values.
     * The MessageProp object is used for that purpose.
     */
    public static final int GAP_TOKEN = 22;


<span class="fc" id="L178">    private static String[] messages = {</span>
        &quot;Channel binding mismatch&quot;, // BAD_BINDINGS
        &quot;Unsupported mechanism requested&quot;, // BAD_MECH
        &quot;Invalid name provided&quot;, // BAD_NAME
        &quot;Name of unsupported type provided&quot;, //BAD_NAMETYPE
        &quot;Invalid input status selector&quot;, // BAD_STATUS
        &quot;Token had invalid integrity check&quot;, // BAD_SIG
        &quot;Specified security context expired&quot;, // CONTEXT_EXPIRED
        &quot;Expired credentials detected&quot;, // CREDENTIALS_EXPIRED
        &quot;Defective credential detected&quot;, // DEFECTIVE_CREDENTIAL
        &quot;Defective token detected&quot;, // DEFECTIVE_TOKEN
        &quot;Failure unspecified at GSS-API level&quot;, // FAILURE
        &quot;Security context init/accept not yet called or context deleted&quot;,
                                                // NO_CONTEXT
        &quot;No valid credentials provided&quot;, // NO_CRED
        &quot;Unsupported QOP value&quot;, // BAD_QOP
        &quot;Operation unauthorized&quot;, // UNAUTHORIZED
        &quot;Operation unavailable&quot;, // UNAVAILABLE
        &quot;Duplicate credential element requested&quot;, //DUPLICATE_ELEMENT
        &quot;Name contains multi-mechanism elements&quot;, // NAME_NOT_MN
        &quot;The token was a duplicate of an earlier token&quot;, //DUPLICATE_TOKEN
        &quot;The token's validity period has expired&quot;, //OLD_TOKEN
        &quot;A later token has already been processed&quot;, //UNSEQ_TOKEN
        &quot;An expected per-message token was not received&quot;, //GAP_TOKEN
    };

   /**
    * The major code for this exception
    *
    * @serial
    */
    private int major;

   /**
    * The minor code for this exception
    *
    * @serial
    */
<span class="pc" id="L216">    private int minor = 0;</span>

   /**
    * The text string for minor code
    *
    * @serial
    */
<span class="pc" id="L223">    private String minorMessage = null;</span>

   /**
    * Alternate text string for major code
    *
    * @serial
    */

<span class="pc" id="L231">    private String majorString = null;</span>

    /**
     *  Creates a GSSException object with a specified major code.
     *
     * @param majorCode the The GSS error code for the problem causing this
     * exception to be thrown.
     */
<span class="fc" id="L239">    public GSSException (int majorCode) {</span>

<span class="pc bpc" id="L241" title="1 of 2 branches missed.">        if (validateMajor(majorCode))</span>
<span class="fc" id="L242">            major = majorCode;</span>
        else
<span class="nc" id="L244">            major = FAILURE;</span>
<span class="fc" id="L245">    }</span>

    /**
     * Construct a GSSException object with a specified major code and a
     * specific major string for it.
     *
     * @param majorCode the fatal error code causing this exception.
     * @param majorString an expicit message to be included in this exception
     */
<span class="nc" id="L254">    GSSException (int majorCode, String majorString) {</span>

<span class="nc bnc" id="L256" title="All 2 branches missed.">        if (validateMajor(majorCode))</span>
<span class="nc" id="L257">            major = majorCode;</span>
        else
<span class="nc" id="L259">            major = FAILURE;</span>
<span class="nc" id="L260">        this.majorString = majorString;</span>
<span class="nc" id="L261">    }</span>


    /**
     * Creates a GSSException object with the specified major code, minor
     * code, and minor code textual explanation.  This constructor is to be
     * used when the exception is originating from the underlying mechanism
     * level. It allows the setting of both the GSS code and the mechanism
     * code.
     *
     * @param majorCode the GSS error code for the problem causing this
     * exception to be thrown.
     * @param minorCode the mechanism level error code for the problem
     * causing this exception to be thrown.
     * @param minorString the textual explanation of the mechanism error
     * code.
     */
<span class="fc" id="L278">    public GSSException (int majorCode, int minorCode, String minorString) {</span>

<span class="pc bpc" id="L280" title="1 of 2 branches missed.">        if (validateMajor(majorCode))</span>
<span class="fc" id="L281">            major = majorCode;</span>
        else
<span class="nc" id="L283">            major = FAILURE;</span>

<span class="fc" id="L285">        minor = minorCode;</span>
<span class="fc" id="L286">        minorMessage = minorString;</span>
<span class="fc" id="L287">    }</span>

    /**
     * Returns the GSS-API level major error code for the problem causing
     * this exception to be thrown. Major error codes are
     * defined at the mechanism independent GSS-API level in this
     * class. Mechanism specific error codes that might provide more
     * information are set as the minor error code.
     *
     * @return int the GSS-API level major error code causing this exception
     * @see #getMajorString
     * @see #getMinor
     * @see #getMinorString
     */
    public int getMajor() {
<span class="nc" id="L302">        return major;</span>
    }

    /**
     * Returns the mechanism level error code for the problem causing this
     * exception to be thrown. The minor code is set by the underlying
     * mechanism.
     *
     * @return int the mechanism error code; 0 indicates that it has not
     * been set.
     * @see #getMinorString
     * @see #setMinor
     */
    public int  getMinor(){
<span class="nc" id="L316">        return minor;</span>
    }

    /**
     * Returns a string explaining the GSS-API level major error code in
     * this exception.
     *
     * @return String explanation string for the major error code
     * @see #getMajor
     * @see #toString
     */
    public String getMajorString() {

<span class="pc bpc" id="L329" title="1 of 2 branches missed.">        if (majorString != null)</span>
<span class="nc" id="L330">            return majorString;</span>
        else
<span class="fc" id="L332">            return messages[major - 1];</span>
    }


    /**
     * Returns a string explaining the mechanism specific error code.
     * If the minor status code is 0, then no mechanism level error details
     * will be available.
     *
     * @return String a textual explanation of mechanism error code
     * @see #getMinor
     * @see #getMajorString
     * @see #toString
     */
    public String getMinorString() {

<span class="fc" id="L348">        return minorMessage;</span>
    }


    /**
     * Used by the exception thrower to set the mechanism
     * level minor error code and its string explanation.  This is used by
     * mechanism providers to indicate error details.
     *
     * @param minorCode the mechanism specific error code
     * @param message textual explanation of the mechanism error code
     * @see #getMinor
     */
    public void setMinor(int minorCode, String message) {

<span class="nc" id="L363">        minor = minorCode;</span>
<span class="nc" id="L364">        minorMessage = message;</span>
<span class="nc" id="L365">    }</span>


    /**
     * Returns a textual representation of both the major and the minor
     * status codes.
     *
     * @return a String with the error descriptions
     */
    public String toString() {
<span class="fc" id="L375">        return (&quot;GSSException: &quot; + getMessage());</span>
    }

    /**
     * Returns a textual representation of both the major and the minor
     * status codes.
     *
     * @return a String with the error descriptions
     */
    public String getMessage() {
<span class="fc bfc" id="L385" title="All 2 branches covered.">        if (minor == 0)</span>
<span class="fc" id="L386">            return (getMajorString());</span>

<span class="fc" id="L388">        return (getMajorString()</span>
<span class="fc" id="L389">                + &quot; (Mechanism level: &quot; + getMinorString() + &quot;)&quot;);</span>
    }


    /*
     * Validates the major code in the proper range.
     */
    private boolean validateMajor(int major) {

<span class="pc bpc" id="L398" title="2 of 4 branches missed.">        if (major &gt; 0 &amp;&amp; major &lt;= messages.length)</span>
<span class="fc" id="L399">            return (true);</span>

<span class="nc" id="L401">        return (false);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>