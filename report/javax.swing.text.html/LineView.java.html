<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>LineView.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing.text.html</a> &gt; <span class="el_source">LineView.java</span></div><h1>LineView.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2003, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package javax.swing.text.html;

import java.util.Enumeration;
import java.awt.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.event.*;
import javax.swing.text.*;

/**
 * A view implementation to display an unwrapped
 * preformatted line.&lt;p&gt;
 * This subclasses ParagraphView, but this really only contains one
 * Row of text.
 *
 * @author  Timothy Prinzing
 */
class LineView extends ParagraphView {
    /** Last place painted at. */
    int tabBase;

    /**
     * Creates a LineView object.
     *
     * @param elem the element to wrap in a view
     */
    public LineView(Element elem) {
<span class="nc" id="L52">        super(elem);</span>
<span class="nc" id="L53">    }</span>

    /**
     * Preformatted lines are not suppressed if they
     * have only whitespace, so they are always visible.
     */
    public boolean isVisible() {
<span class="nc" id="L60">        return true;</span>
    }

    /**
     * Determines the minimum span for this view along an
     * axis.  The preformatted line should refuse to be
     * sized less than the preferred size.
     *
     * @param axis may be either &lt;code&gt;View.X_AXIS&lt;/code&gt; or
     *  &lt;code&gt;View.Y_AXIS&lt;/code&gt;
     * @return  the minimum span the view can be rendered into
     * @see View#getPreferredSpan
     */
    public float getMinimumSpan(int axis) {
<span class="nc" id="L74">        return getPreferredSpan(axis);</span>
    }

    /**
     * Gets the resize weight for the specified axis.
     *
     * @param axis may be either X_AXIS or Y_AXIS
     * @return the weight
     */
    public int getResizeWeight(int axis) {
<span class="nc bnc" id="L84" title="All 3 branches missed.">        switch (axis) {</span>
        case View.X_AXIS:
<span class="nc" id="L86">            return 1;</span>
        case View.Y_AXIS:
<span class="nc" id="L88">            return 0;</span>
        default:
<span class="nc" id="L90">            throw new IllegalArgumentException(&quot;Invalid axis: &quot; + axis);</span>
        }
    }

    /**
     * Gets the alignment for an axis.
     *
     * @param axis may be either X_AXIS or Y_AXIS
     * @return the alignment
     */
    public float getAlignment(int axis) {
<span class="nc bnc" id="L101" title="All 2 branches missed.">        if (axis == View.X_AXIS) {</span>
<span class="nc" id="L102">            return 0;</span>
        }
<span class="nc" id="L104">        return super.getAlignment(axis);</span>
    }

    /**
     * Lays out the children.  If the layout span has changed,
     * the rows are rebuilt.  The superclass functionality
     * is called after checking and possibly rebuilding the
     * rows.  If the height has changed, the
     * &lt;code&gt;preferenceChanged&lt;/code&gt; method is called
     * on the parent since the vertical preference is
     * rigid.
     *
     * @param width  the width to lay out against &gt;= 0.  This is
     *   the width inside of the inset area.
     * @param height the height to lay out against &gt;= 0 (not used
     *   by paragraph, but used by the superclass).  This
     *   is the height inside of the inset area.
     */
    protected void layout(int width, int height) {
<span class="nc" id="L123">        super.layout(Integer.MAX_VALUE - 1, height);</span>
<span class="nc" id="L124">    }</span>

    /**
     * Returns the next tab stop position given a reference position.
     * This view implements the tab coordinate system, and calls
     * &lt;code&gt;getTabbedSpan&lt;/code&gt; on the logical children in the process
     * of layout to determine the desired span of the children.  The
     * logical children can delegate their tab expansion upward to
     * the paragraph which knows how to expand tabs.
     * &lt;code&gt;LabelView&lt;/code&gt; is an example of a view that delegates
     * its tab expansion needs upward to the paragraph.
     * &lt;p&gt;
     * This is implemented to try and locate a &lt;code&gt;TabSet&lt;/code&gt;
     * in the paragraph element's attribute set.  If one can be
     * found, its settings will be used, otherwise a default expansion
     * will be provided.  The base location for for tab expansion
     * is the left inset from the paragraphs most recent allocation
     * (which is what the layout of the children is based upon).
     *
     * @param x the X reference position
     * @param tabOffset the position within the text stream
     *   that the tab occurred at &gt;= 0.
     * @return the trailing end of the tab expansion &gt;= 0
     * @see TabSet
     * @see TabStop
     * @see LabelView
     */
    public float nextTabStop(float x, int tabOffset) {
        // If the text isn't left justified, offset by 10 pixels!
<span class="nc bnc" id="L153" title="All 2 branches missed.">        if (getTabSet() == null &amp;&amp;</span>
<span class="nc bnc" id="L154" title="All 2 branches missed.">            StyleConstants.getAlignment(getAttributes()) ==</span>
            StyleConstants.ALIGN_LEFT) {
<span class="nc" id="L156">            return getPreTab(x, tabOffset);</span>
        }
<span class="nc" id="L158">        return super.nextTabStop(x, tabOffset);</span>
    }

    /**
     * Returns the location for the tab.
     */
    protected float getPreTab(float x, int tabOffset) {
<span class="nc" id="L165">        Document d = getDocument();</span>
<span class="nc" id="L166">        View v = getViewAtPosition(tabOffset, null);</span>
<span class="nc bnc" id="L167" title="All 4 branches missed.">        if ((d instanceof StyledDocument) &amp;&amp; v != null) {</span>
            // Assume f is fixed point.
<span class="nc" id="L169">            Font f = ((StyledDocument)d).getFont(v.getAttributes());</span>
<span class="nc" id="L170">            Container c = getContainer();</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">            FontMetrics fm = (c != null) ? c.getFontMetrics(f) :</span>
<span class="nc" id="L172">                Toolkit.getDefaultToolkit().getFontMetrics(f);</span>
<span class="nc" id="L173">            int width = getCharactersPerTab() * fm.charWidth('W');</span>
<span class="nc" id="L174">            int tb = (int)getTabBase();</span>
<span class="nc" id="L175">            return (float)((((int)x - tb) / width + 1) * width + tb);</span>
        }
<span class="nc" id="L177">        return 10.0f + x;</span>
    }

    /**
     * @return number of characters per tab, 8.
     */
    protected int getCharactersPerTab() {
<span class="nc" id="L184">        return 8;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>