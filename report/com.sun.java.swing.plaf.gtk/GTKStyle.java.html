<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>GTKStyle.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">com.sun.java.swing.plaf.gtk</a> &gt; <span class="el_source">GTKStyle.java</span></div><h1>GTKStyle.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package com.sun.java.swing.plaf.gtk;

import java.awt.*;
import java.lang.reflect.*;
import java.security.*;
import java.util.*;
import javax.swing.*;
import javax.swing.plaf.*;
import javax.swing.plaf.synth.*;

import sun.awt.AppContext;
import sun.awt.UNIXToolkit;
import sun.swing.SwingUtilities2;
import sun.swing.plaf.synth.SynthIcon;

import com.sun.java.swing.plaf.gtk.GTKEngine.WidgetType;

/**
 *
 * @author Scott Violet
 */
class GTKStyle extends SynthStyle implements GTKConstants {

    private static native int nativeGetXThickness(int widgetType);
    private static native int nativeGetYThickness(int widgetType);
    private static native int nativeGetColorForState(int widgetType,
                                                     int state, int typeID);
    private static native Object nativeGetClassValue(int widgetType,
                                                     String key);
    private static native String nativeGetPangoFontName(int widgetType);

    private static final String ICON_PROPERTY_PREFIX = &quot;gtk.icon.&quot;;

<span class="nc" id="L59">    static final Color BLACK_COLOR = new ColorUIResource(Color.BLACK);</span>
<span class="nc" id="L60">    static final Color WHITE_COLOR = new ColorUIResource(Color.WHITE);</span>

<span class="nc" id="L62">    static final Font DEFAULT_FONT = new FontUIResource(&quot;sansserif&quot;,</span>
                                                        Font.PLAIN, 10  );
<span class="nc" id="L64">    static final Insets BUTTON_DEFAULT_BORDER_INSETS = new Insets(1, 1, 1, 1);</span>

<span class="nc" id="L66">    private static final GTKGraphicsUtils GTK_GRAPHICS = new GTKGraphicsUtils();</span>

    /**
     * Maps from a key that is passed to Style.get to the equivalent class
     * specific key.
     */
    private static final Map&lt;String,String&gt; CLASS_SPECIFIC_MAP;

    /**
     * Backing style properties that are used if the style does not
     * defined the property.
     */
    private static final Map&lt;String,GTKStockIcon&gt; ICONS_MAP;

    /**
     * The font used for this particular style, as determined at
     * construction time.
     */
    private final Font font;

    /** Widget type used when looking up class specific values. */
    private final int widgetType;

    /** The x/y thickness values for this particular style. */
    private final int xThickness, yThickness;

<span class="nc" id="L92">    GTKStyle(Font userFont, WidgetType widgetType) {</span>
<span class="nc" id="L93">        this.widgetType = widgetType.ordinal();</span>

        String pangoFontName;
<span class="nc" id="L96">        synchronized (sun.awt.UNIXToolkit.GTK_LOCK) {</span>
<span class="nc" id="L97">            xThickness = nativeGetXThickness(this.widgetType);</span>
<span class="nc" id="L98">            yThickness = nativeGetYThickness(this.widgetType);</span>
<span class="nc" id="L99">            pangoFontName = nativeGetPangoFontName(this.widgetType);</span>
<span class="nc" id="L100">        }</span>

<span class="nc" id="L102">        Font pangoFont = null;</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (pangoFontName != null) {</span>
<span class="nc" id="L104">            pangoFont = PangoFonts.lookupFont(pangoFontName);</span>
        }
<span class="nc bnc" id="L106" title="All 2 branches missed.">        if (pangoFont != null) {</span>
<span class="nc" id="L107">            this.font = pangoFont;</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">        } else if (userFont != null) {</span>
<span class="nc" id="L109">            this.font = userFont;</span>
        } else {
<span class="nc" id="L111">            this.font = DEFAULT_FONT;</span>
        }
<span class="nc" id="L113">    }</span>

    @Override
    public void installDefaults(SynthContext context) {
<span class="nc" id="L117">        super.installDefaults(context);</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">        if (!context.getRegion().isSubregion()) {</span>
<span class="nc" id="L119">            context.getComponent().putClientProperty(</span>
                SwingUtilities2.AA_TEXT_PROPERTY_KEY,
                GTKLookAndFeel.aaTextInfo);
        }
<span class="nc" id="L123">    }</span>

    @Override
    public SynthGraphicsUtils getGraphicsUtils(SynthContext context) {
<span class="nc" id="L127">        return GTK_GRAPHICS;</span>
    }

    /**
     * Returns a &lt;code&gt;SynthPainter&lt;/code&gt; that will route the appropriate
     * calls to a &lt;code&gt;GTKEngine&lt;/code&gt;.
     *
     * @param state SynthContext identifying requestor
     * @return SynthPainter
     */
    @Override
    public SynthPainter getPainter(SynthContext state) {
<span class="nc" id="L139">        return GTKPainter.INSTANCE;</span>
    }

    protected Color getColorForState(SynthContext context, ColorType type) {
<span class="nc bnc" id="L143" title="All 4 branches missed.">        if (type == ColorType.FOCUS || type == GTKColorType.BLACK) {</span>
<span class="nc" id="L144">            return BLACK_COLOR;</span>
        }
<span class="nc bnc" id="L146" title="All 2 branches missed.">        else if (type == GTKColorType.WHITE) {</span>
<span class="nc" id="L147">            return WHITE_COLOR;</span>
        }

<span class="nc" id="L150">        Region id = context.getRegion();</span>
<span class="nc" id="L151">        int state = context.getComponentState();</span>
<span class="nc" id="L152">        state = GTKLookAndFeel.synthStateToGTKState(id, state);</span>

<span class="nc bnc" id="L154" title="All 26 branches missed.">        if (type == ColorType.TEXT_FOREGROUND &amp;&amp;</span>
               (id == Region.BUTTON ||
                id == Region.CHECK_BOX ||
                id == Region.CHECK_BOX_MENU_ITEM ||
                id == Region.MENU ||
                id == Region.MENU_ITEM ||
                id == Region.RADIO_BUTTON ||
                id == Region.RADIO_BUTTON_MENU_ITEM ||
                id == Region.TABBED_PANE_TAB ||
                id == Region.TOGGLE_BUTTON ||
                id == Region.TOOL_TIP ||
                id == Region.MENU_ITEM_ACCELERATOR ||
                id == Region.TABBED_PANE_TAB)) {
<span class="nc" id="L167">            type = ColorType.FOREGROUND;</span>
<span class="nc bnc" id="L168" title="All 8 branches missed.">        } else if (id == Region.TABLE ||</span>
                   id == Region.LIST ||
                   id == Region.TREE ||
                   id == Region.TREE_CELL) {
<span class="nc bnc" id="L172" title="All 2 branches missed.">            if (type == ColorType.FOREGROUND) {</span>
<span class="nc" id="L173">                type = ColorType.TEXT_FOREGROUND;</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if (state == SynthConstants.PRESSED) {</span>
<span class="nc" id="L175">                    state = SynthConstants.SELECTED;</span>
                }
<span class="nc bnc" id="L177" title="All 2 branches missed.">            } else if (type == ColorType.BACKGROUND) {</span>
<span class="nc" id="L178">                type = ColorType.TEXT_BACKGROUND;</span>
            }
        }

<span class="nc" id="L182">        return getStyleSpecificColor(context, state, type);</span>
    }

    /**
     * Returns color specific to the current style. This method is
     * invoked when other variants don't fit.
     */
    private Color getStyleSpecificColor(SynthContext context, int state,
                                        ColorType type)
    {
<span class="nc" id="L192">        state = GTKLookAndFeel.synthStateToGTKStateType(state).ordinal();</span>
<span class="nc" id="L193">        synchronized (sun.awt.UNIXToolkit.GTK_LOCK) {</span>
<span class="nc" id="L194">            int rgb = nativeGetColorForState(widgetType, state,</span>
<span class="nc" id="L195">                                             type.getID());</span>
<span class="nc" id="L196">            return new ColorUIResource(rgb);</span>
<span class="nc" id="L197">        }</span>
    }

    Color getGTKColor(int state, ColorType type) {
<span class="nc" id="L201">        return getGTKColor(null, state, type);</span>
    }

    /**
     * Returns the color for the specified state.
     *
     * @param context SynthContext identifying requestor
     * @param state to get the color for
     * @param type of the color
     * @return Color to render with
     */
    Color getGTKColor(SynthContext context, int state, ColorType type) {
<span class="nc bnc" id="L213" title="All 2 branches missed.">        if (context != null) {</span>
<span class="nc" id="L214">            JComponent c = context.getComponent();</span>
<span class="nc" id="L215">            Region id = context.getRegion();</span>

<span class="nc" id="L217">            state = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc bnc" id="L218" title="All 4 branches missed.">            if (!id.isSubregion() &amp;&amp;</span>
                (state &amp; SynthConstants.ENABLED) != 0) {
<span class="nc bnc" id="L220" title="All 4 branches missed.">                if (type == ColorType.BACKGROUND ||</span>
                    type == ColorType.TEXT_BACKGROUND) {
<span class="nc" id="L222">                    Color bg = c.getBackground();</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">                    if (!(bg instanceof UIResource)) {</span>
<span class="nc" id="L224">                        return bg;</span>
                    }
<span class="nc" id="L226">                }</span>
<span class="nc bnc" id="L227" title="All 4 branches missed.">                else if (type == ColorType.FOREGROUND ||</span>
                         type == ColorType.TEXT_FOREGROUND) {
<span class="nc" id="L229">                    Color fg = c.getForeground();</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">                    if (!(fg instanceof UIResource)) {</span>
<span class="nc" id="L231">                        return fg;</span>
                    }
                }
            }
        }

<span class="nc" id="L237">        return getStyleSpecificColor(context, state, type);</span>
    }

    @Override
    public Color getColor(SynthContext context, ColorType type) {
<span class="nc" id="L242">        JComponent c = context.getComponent();</span>
<span class="nc" id="L243">        Region id = context.getRegion();</span>
<span class="nc" id="L244">        int state = context.getComponentState();</span>

<span class="nc bnc" id="L246" title="All 2 branches missed.">        if (c.getName() == &quot;Table.cellRenderer&quot;) {</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">             if (type == ColorType.BACKGROUND) {</span>
<span class="nc" id="L248">                 return c.getBackground();</span>
             }
<span class="nc bnc" id="L250" title="All 2 branches missed.">             if (type == ColorType.FOREGROUND) {</span>
<span class="nc" id="L251">                 return c.getForeground();</span>
             }
        }

<span class="nc bnc" id="L255" title="All 4 branches missed.">        if (id == Region.LABEL &amp;&amp; type == ColorType.TEXT_FOREGROUND) {</span>
<span class="nc" id="L256">            type = ColorType.FOREGROUND;</span>
        }

        // For the enabled state, prefer the widget's colors
<span class="nc bnc" id="L260" title="All 4 branches missed.">        if (!id.isSubregion() &amp;&amp; (state &amp; SynthConstants.ENABLED) != 0) {</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">            if (type == ColorType.BACKGROUND) {</span>
<span class="nc" id="L262">                return c.getBackground();</span>
            }
<span class="nc bnc" id="L264" title="All 2 branches missed.">            else if (type == ColorType.FOREGROUND) {</span>
<span class="nc" id="L265">                return c.getForeground();</span>
            }
<span class="nc bnc" id="L267" title="All 2 branches missed.">            else if (type == ColorType.TEXT_FOREGROUND) {</span>
                // If getForeground returns a non-UIResource it means the
                // developer has explicitly set the foreground, use it over
                // that of TEXT_FOREGROUND as that is typically the expected
                // behavior.
<span class="nc" id="L272">                Color color = c.getForeground();</span>
<span class="nc bnc" id="L273" title="All 4 branches missed.">                if (color != null &amp;&amp; !(color instanceof UIResource)) {</span>
<span class="nc" id="L274">                    return color;</span>
                }
            }
        }
<span class="nc" id="L278">        return getColorForState(context, type);</span>
    }

    protected Font getFontForState(SynthContext context) {
<span class="nc" id="L282">        return font;</span>
    }

    /**
     * Returns the X thickness to use for this GTKStyle.
     *
     * @return x thickness.
     */
    int getXThickness() {
<span class="nc" id="L291">        return xThickness;</span>
    }

    /**
     * Returns the Y thickness to use for this GTKStyle.
     *
     * @return y thickness.
     */
    int getYThickness() {
<span class="nc" id="L300">        return yThickness;</span>
    }

    /**
     * Returns the Insets. If &lt;code&gt;insets&lt;/code&gt; is non-null the resulting
     * insets will be placed in it, otherwise a new Insets object will be
     * created and returned.
     *
     * @param context SynthContext identifying requestor
     * @param insets Where to place Insets
     * @return Insets.
     */
    @Override
    public Insets getInsets(SynthContext state, Insets insets) {
<span class="nc" id="L314">        Region id = state.getRegion();</span>
<span class="nc" id="L315">        JComponent component = state.getComponent();</span>
<span class="nc bnc" id="L316" title="All 2 branches missed.">        String name = (id.isSubregion()) ? null : component.getName();</span>

<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (insets == null) {</span>
<span class="nc" id="L319">            insets = new Insets(0, 0, 0, 0);</span>
        } else {
<span class="nc" id="L321">            insets.top = insets.bottom = insets.left = insets.right = 0;</span>
        }

<span class="nc bnc" id="L324" title="All 6 branches missed.">        if (id == Region.ARROW_BUTTON || id == Region.BUTTON ||</span>
                id == Region.TOGGLE_BUTTON) {
<span class="nc bnc" id="L326" title="All 4 branches missed.">            if (&quot;Spinner.previousButton&quot; == name ||</span>
                    &quot;Spinner.nextButton&quot; == name) {
<span class="nc" id="L328">                return getSimpleInsets(state, insets, 1);</span>
            } else {
<span class="nc" id="L330">                return getButtonInsets(state, insets);</span>
            }
        }
<span class="nc bnc" id="L333" title="All 4 branches missed.">        else if (id == Region.CHECK_BOX || id == Region.RADIO_BUTTON) {</span>
<span class="nc" id="L334">            return getRadioInsets(state, insets);</span>
        }
<span class="nc bnc" id="L336" title="All 2 branches missed.">        else if (id == Region.MENU_BAR) {</span>
<span class="nc" id="L337">            return getMenuBarInsets(state, insets);</span>
        }
<span class="nc bnc" id="L339" title="All 8 branches missed.">        else if (id == Region.MENU ||</span>
                 id == Region.MENU_ITEM ||
                 id == Region.CHECK_BOX_MENU_ITEM ||
                 id == Region.RADIO_BUTTON_MENU_ITEM) {
<span class="nc" id="L343">            return getMenuItemInsets(state, insets);</span>
        }
<span class="nc bnc" id="L345" title="All 2 branches missed.">        else if (id == Region.FORMATTED_TEXT_FIELD) {</span>
<span class="nc" id="L346">            return getTextFieldInsets(state, insets);</span>
        }
<span class="nc bnc" id="L348" title="All 2 branches missed.">        else if (id == Region.INTERNAL_FRAME) {</span>
<span class="nc" id="L349">            insets = Metacity.INSTANCE.getBorderInsets(state, insets);</span>
        }
<span class="nc bnc" id="L351" title="All 2 branches missed.">        else if (id == Region.LABEL) {</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">            if (&quot;TableHeader.renderer&quot; == name) {</span>
<span class="nc" id="L353">                return getButtonInsets(state, insets);</span>
            }
<span class="nc bnc" id="L355" title="All 2 branches missed.">            else if (component instanceof ListCellRenderer) {</span>
<span class="nc" id="L356">                return getTextFieldInsets(state, insets);</span>
            }
<span class="nc bnc" id="L358" title="All 2 branches missed.">            else if (&quot;Tree.cellRenderer&quot; == name) {</span>
<span class="nc" id="L359">                return getSimpleInsets(state, insets, 1);</span>
            }
        }
<span class="nc bnc" id="L362" title="All 2 branches missed.">        else if (id == Region.OPTION_PANE) {</span>
<span class="nc" id="L363">            return getSimpleInsets(state, insets, 6);</span>
        }
<span class="nc bnc" id="L365" title="All 2 branches missed.">        else if (id == Region.POPUP_MENU) {</span>
<span class="nc" id="L366">            return getSimpleInsets(state, insets, 2);</span>
        }
<span class="nc bnc" id="L368" title="All 14 branches missed.">        else if (id == Region.PROGRESS_BAR || id == Region.SLIDER ||</span>
                 id == Region.TABBED_PANE  || id == Region.TABBED_PANE_CONTENT ||
                 id == Region.TOOL_BAR     ||
                 id == Region.TOOL_BAR_DRAG_WINDOW ||
                 id == Region.TOOL_TIP) {
<span class="nc" id="L373">            return getThicknessInsets(state, insets);</span>
        }
<span class="nc bnc" id="L375" title="All 2 branches missed.">        else if (id == Region.SCROLL_BAR) {</span>
<span class="nc" id="L376">            return getScrollBarInsets(state, insets);</span>
        }
<span class="nc bnc" id="L378" title="All 2 branches missed.">        else if (id == Region.SLIDER_TRACK) {</span>
<span class="nc" id="L379">            return getSliderTrackInsets(state, insets);</span>
        }
<span class="nc bnc" id="L381" title="All 2 branches missed.">        else if (id == Region.TABBED_PANE_TAB) {</span>
<span class="nc" id="L382">            return getTabbedPaneTabInsets(state, insets);</span>
        }
<span class="nc bnc" id="L384" title="All 4 branches missed.">        else if (id == Region.TEXT_FIELD || id == Region.PASSWORD_FIELD) {</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">            if (name == &quot;Tree.cellEditor&quot;) {</span>
<span class="nc" id="L386">                return getSimpleInsets(state, insets, 1);</span>
            }
<span class="nc" id="L388">            return getTextFieldInsets(state, insets);</span>
<span class="nc bnc" id="L389" title="All 6 branches missed.">        } else if (id == Region.SEPARATOR ||</span>
                   id == Region.POPUP_MENU_SEPARATOR ||
                   id == Region.TOOL_BAR_SEPARATOR) {
<span class="nc" id="L392">            return getSeparatorInsets(state, insets);</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">        } else if (id == GTKEngine.CustomRegion.TITLED_BORDER) {</span>
<span class="nc" id="L394">            return getThicknessInsets(state, insets);</span>
        }
<span class="nc" id="L396">        return insets;</span>
    }

    private Insets getButtonInsets(SynthContext context, Insets insets) {
        // The following calculations are derived from gtkbutton.c
        // (GTK+ version 2.8.20), gtk_button_size_allocate() method.
<span class="nc" id="L402">        int CHILD_SPACING = 1;</span>
<span class="nc" id="L403">        int focusSize = getClassSpecificIntValue(context, &quot;focus-line-width&quot;,1);</span>
<span class="nc" id="L404">        int focusPad = getClassSpecificIntValue(context, &quot;focus-padding&quot;, 1);</span>
<span class="nc" id="L405">        int xThickness = getXThickness();</span>
<span class="nc" id="L406">        int yThickness = getYThickness();</span>
<span class="nc" id="L407">        int w = focusSize + focusPad + xThickness + CHILD_SPACING;</span>
<span class="nc" id="L408">        int h = focusSize + focusPad + yThickness + CHILD_SPACING;</span>
<span class="nc" id="L409">        insets.left = insets.right = w;</span>
<span class="nc" id="L410">        insets.top = insets.bottom = h;</span>

<span class="nc" id="L412">        Component component = context.getComponent();</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">        if ((component instanceof JButton) &amp;&amp;</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">            !(component.getParent() instanceof JToolBar) &amp;&amp;</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">            ((JButton)component).isDefaultCapable())</span>
        {
            // Include the default border insets, but only for JButtons
            // that are default capable.  Note that
            // JButton.getDefaultCapable() returns true by default, but
            // GtkToolButtons are never default capable, so we skip this
            // step if the button is contained in a toolbar.
<span class="nc" id="L422">            Insets defaultInsets = getClassSpecificInsetsValue(context,</span>
                          &quot;default-border&quot;, BUTTON_DEFAULT_BORDER_INSETS);
<span class="nc" id="L424">            insets.left += defaultInsets.left;</span>
<span class="nc" id="L425">            insets.right += defaultInsets.right;</span>
<span class="nc" id="L426">            insets.top += defaultInsets.top;</span>
<span class="nc" id="L427">            insets.bottom += defaultInsets.bottom;</span>
        }

<span class="nc" id="L430">        return insets;</span>
    }

    /*
     * This is used for both RADIO_BUTTON and CHECK_BOX.
     */
    private Insets getRadioInsets(SynthContext context, Insets insets) {
        // The following calculations are derived from gtkcheckbutton.c
        // (GTK+ version 2.8.20), gtk_check_button_size_allocate() method.
<span class="nc" id="L439">        int focusSize =</span>
<span class="nc" id="L440">            getClassSpecificIntValue(context, &quot;focus-line-width&quot;, 1);</span>
<span class="nc" id="L441">        int focusPad =</span>
<span class="nc" id="L442">            getClassSpecificIntValue(context, &quot;focus-padding&quot;, 1);</span>
<span class="nc" id="L443">        int totalFocus = focusSize + focusPad;</span>

        // Note: GTKIconFactory.DelegateIcon will have already included the
        // &quot;indicator-spacing&quot; value in the size of the indicator icon,
        // which explains why we use zero as the left inset (or right inset
        // in the RTL case); see 6489585 for more details.
<span class="nc" id="L449">        insets.top    = totalFocus;</span>
<span class="nc" id="L450">        insets.bottom = totalFocus;</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">        if (context.getComponent().getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L452">            insets.left  = 0;</span>
<span class="nc" id="L453">            insets.right = totalFocus;</span>
        } else {
<span class="nc" id="L455">            insets.left  = totalFocus;</span>
<span class="nc" id="L456">            insets.right = 0;</span>
        }

<span class="nc" id="L459">        return insets;</span>
    }

    private Insets getMenuBarInsets(SynthContext context, Insets insets) {
        // The following calculations are derived from gtkmenubar.c
        // (GTK+ version 2.8.20), gtk_menu_bar_size_allocate() method.
<span class="nc" id="L465">        int internalPadding = getClassSpecificIntValue(context,</span>
                                                       &quot;internal-padding&quot;, 1);
<span class="nc" id="L467">        int xThickness = getXThickness();</span>
<span class="nc" id="L468">        int yThickness = getYThickness();</span>
<span class="nc" id="L469">        insets.left = insets.right = xThickness + internalPadding;</span>
<span class="nc" id="L470">        insets.top = insets.bottom = yThickness + internalPadding;</span>
<span class="nc" id="L471">        return insets;</span>
    }

    private Insets getMenuItemInsets(SynthContext context, Insets insets) {
        // The following calculations are derived from gtkmenuitem.c
        // (GTK+ version 2.8.20), gtk_menu_item_size_allocate() method.
<span class="nc" id="L477">        int horizPadding = getClassSpecificIntValue(context,</span>
                                                    &quot;horizontal-padding&quot;, 3);
<span class="nc" id="L479">        int xThickness = getXThickness();</span>
<span class="nc" id="L480">        int yThickness = getYThickness();</span>
<span class="nc" id="L481">        insets.left = insets.right = xThickness + horizPadding;</span>
<span class="nc" id="L482">        insets.top = insets.bottom = yThickness;</span>
<span class="nc" id="L483">        return insets;</span>
    }

    private Insets getThicknessInsets(SynthContext context, Insets insets) {
<span class="nc" id="L487">        insets.left = insets.right = getXThickness();</span>
<span class="nc" id="L488">        insets.top = insets.bottom = getYThickness();</span>
<span class="nc" id="L489">        return insets;</span>
    }

    private Insets getSeparatorInsets(SynthContext context, Insets insets) {
<span class="nc" id="L493">        int horizPadding = 0;</span>
<span class="nc bnc" id="L494" title="All 2 branches missed.">        if (context.getRegion() == Region.POPUP_MENU_SEPARATOR) {</span>
<span class="nc" id="L495">            horizPadding =</span>
<span class="nc" id="L496">                getClassSpecificIntValue(context, &quot;horizontal-padding&quot;, 3);</span>
        }
<span class="nc" id="L498">        insets.right = insets.left = getXThickness() + horizPadding;</span>
<span class="nc" id="L499">        insets.top = insets.bottom = getYThickness();</span>
<span class="nc" id="L500">        return insets;</span>
    }

    private Insets getSliderTrackInsets(SynthContext context, Insets insets) {
<span class="nc" id="L504">        int focusSize = getClassSpecificIntValue(context, &quot;focus-line-width&quot;, 1);</span>
<span class="nc" id="L505">        int focusPad = getClassSpecificIntValue(context, &quot;focus-padding&quot;, 1);</span>
<span class="nc" id="L506">        insets.top = insets.bottom =</span>
                insets.left = insets.right = focusSize + focusPad;
<span class="nc" id="L508">        return insets;</span>
    }

    private Insets getSimpleInsets(SynthContext context, Insets insets, int n) {
<span class="nc" id="L512">        insets.top = insets.bottom = insets.right = insets.left = n;</span>
<span class="nc" id="L513">        return insets;</span>
    }

    private Insets getTabbedPaneTabInsets(SynthContext context, Insets insets) {
<span class="nc" id="L517">        int xThickness = getXThickness();</span>
<span class="nc" id="L518">        int yThickness = getYThickness();</span>
<span class="nc" id="L519">        int focusSize = getClassSpecificIntValue(context, &quot;focus-line-width&quot;,1);</span>
<span class="nc" id="L520">        int pad = 2;</span>

<span class="nc" id="L522">        insets.left = insets.right = focusSize + pad + xThickness;</span>
<span class="nc" id="L523">        insets.top = insets.bottom = focusSize + pad + yThickness;</span>
<span class="nc" id="L524">        return insets;</span>
    }

    // NOTE: this is called for ComboBox, and FormattedTextField also
    private Insets getTextFieldInsets(SynthContext context, Insets insets) {
<span class="nc" id="L529">        insets = getClassSpecificInsetsValue(context, &quot;inner-border&quot;,</span>
<span class="nc" id="L530">                                    getSimpleInsets(context, insets, 2));</span>

<span class="nc" id="L532">        int xThickness = getXThickness();</span>
<span class="nc" id="L533">        int yThickness = getYThickness();</span>
<span class="nc" id="L534">        boolean interiorFocus =</span>
<span class="nc" id="L535">                getClassSpecificBoolValue(context, &quot;interior-focus&quot;, true);</span>
<span class="nc" id="L536">        int focusSize = 0;</span>

<span class="nc bnc" id="L538" title="All 2 branches missed.">        if (!interiorFocus) {</span>
<span class="nc" id="L539">            focusSize = getClassSpecificIntValue(context, &quot;focus-line-width&quot;,1);</span>
        }

<span class="nc" id="L542">        insets.left   += focusSize + xThickness;</span>
<span class="nc" id="L543">        insets.right  += focusSize + xThickness;</span>
<span class="nc" id="L544">        insets.top    += focusSize + yThickness;</span>
<span class="nc" id="L545">        insets.bottom += focusSize + yThickness;</span>
<span class="nc" id="L546">        return insets;</span>
    }

    private Insets getScrollBarInsets(SynthContext context, Insets insets) {
<span class="nc" id="L550">        int troughBorder =</span>
<span class="nc" id="L551">            getClassSpecificIntValue(context, &quot;trough-border&quot;, 1);</span>
<span class="nc" id="L552">        insets.left = insets.right = insets.top = insets.bottom = troughBorder;</span>

<span class="nc" id="L554">        JComponent c = context.getComponent();</span>
<span class="nc bnc" id="L555" title="All 2 branches missed.">        if (c.getParent() instanceof JScrollPane) {</span>
            // This scrollbar is part of a scrollpane; use only the
            // &quot;scrollbar-spacing&quot; style property to determine the padding
            // between the scrollbar and its parent scrollpane.
<span class="nc" id="L559">            int spacing =</span>
<span class="nc" id="L560">                getClassSpecificIntValue(WidgetType.SCROLL_PANE,</span>
                                         &quot;scrollbar-spacing&quot;, 3);
<span class="nc bnc" id="L562" title="All 2 branches missed.">            if (((JScrollBar)c).getOrientation() == JScrollBar.HORIZONTAL) {</span>
<span class="nc" id="L563">                insets.top += spacing;</span>
            } else {
<span class="nc bnc" id="L565" title="All 2 branches missed.">                if (c.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L566">                    insets.left += spacing;</span>
                } else {
<span class="nc" id="L568">                    insets.right += spacing;</span>
                }
            }
<span class="nc" id="L571">        } else {</span>
            // This is a standalone scrollbar; leave enough room for the
            // focus line in addition to the trough border.
<span class="nc bnc" id="L574" title="All 2 branches missed.">            if (c.isFocusable()) {</span>
<span class="nc" id="L575">                int focusSize =</span>
<span class="nc" id="L576">                    getClassSpecificIntValue(context, &quot;focus-line-width&quot;, 1);</span>
<span class="nc" id="L577">                int focusPad =</span>
<span class="nc" id="L578">                    getClassSpecificIntValue(context, &quot;focus-padding&quot;, 1);</span>
<span class="nc" id="L579">                int totalFocus = focusSize + focusPad;</span>
<span class="nc" id="L580">                insets.left   += totalFocus;</span>
<span class="nc" id="L581">                insets.right  += totalFocus;</span>
<span class="nc" id="L582">                insets.top    += totalFocus;</span>
<span class="nc" id="L583">                insets.bottom += totalFocus;</span>
            }
        }
<span class="nc" id="L586">        return insets;</span>
    }

    /**
     * Returns the value for a class specific property for a particular
     * WidgetType.  This method is useful in those cases where we need to
     * fetch a value for a Region that is not associated with the component
     * currently in use (e.g. we need to figure out the insets for a
     * SCROLL_BAR, but certain values can only be extracted from a
     * SCROLL_PANE region).
     *
     * @param wt WidgetType for which to fetch the value
     * @param key Key identifying class specific value
     * @return Value, or null if one has not been defined
     */
    private static Object getClassSpecificValue(WidgetType wt, String key) {
<span class="nc" id="L602">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc" id="L603">            return nativeGetClassValue(wt.ordinal(), key);</span>
<span class="nc" id="L604">        }</span>
    }

    /**
     * Convenience method to get a class specific integer value for
     * a particular WidgetType.
     *
     * @param wt WidgetType for which to fetch the value
     * @param key Key identifying class specific value
     * @param defaultValue Returned if there is no value for the specified
     *        type
     * @return Value, or defaultValue if &lt;code&gt;key&lt;/code&gt; is not defined
     */
    private static int getClassSpecificIntValue(WidgetType wt, String key,
                                                int defaultValue)
    {
<span class="nc" id="L620">        Object value = getClassSpecificValue(wt, key);</span>
<span class="nc bnc" id="L621" title="All 2 branches missed.">        if (value instanceof Number) {</span>
<span class="nc" id="L622">            return ((Number)value).intValue();</span>
        }
<span class="nc" id="L624">        return defaultValue;</span>
    }

    /**
     * Returns the value for a class specific property. A class specific value
     * is a value that will be picked up based on class hierarchy.
     *
     * @param key Key identifying class specific value
     * @return Value, or null if one has not been defined.
     */
    Object getClassSpecificValue(String key) {
<span class="nc" id="L635">        synchronized (sun.awt.UNIXToolkit.GTK_LOCK) {</span>
<span class="nc" id="L636">            return nativeGetClassValue(widgetType, key);</span>
<span class="nc" id="L637">        }</span>
    }

    /**
     * Convenience method to get a class specific integer value.
     *
     * @param context SynthContext identifying requestor
     * @param key Key identifying class specific value
     * @param defaultValue Returned if there is no value for the specified
     *        type
     * @return Value, or defaultValue if &lt;code&gt;key&lt;/code&gt; is not defined
     */
    int getClassSpecificIntValue(SynthContext context, String key,
                                 int defaultValue)
    {
<span class="nc" id="L652">        Object value = getClassSpecificValue(key);</span>

<span class="nc bnc" id="L654" title="All 2 branches missed.">        if (value instanceof Number) {</span>
<span class="nc" id="L655">            return ((Number)value).intValue();</span>
        }
<span class="nc" id="L657">        return defaultValue;</span>
    }

    /**
     * Convenience method to get a class specific Insets value.
     *
     * @param context SynthContext identifying requestor
     * @param key Key identifying class specific value
     * @param defaultValue Returned if there is no value for the specified
     *        type
     * @return Value, or defaultValue if &lt;code&gt;key&lt;/code&gt; is not defined
     */
    Insets getClassSpecificInsetsValue(SynthContext context, String key,
                                       Insets defaultValue)
    {
<span class="nc" id="L672">        Object value = getClassSpecificValue(key);</span>

<span class="nc bnc" id="L674" title="All 2 branches missed.">        if (value instanceof Insets) {</span>
<span class="nc" id="L675">            return (Insets)value;</span>
        }
<span class="nc" id="L677">        return defaultValue;</span>
    }

    /**
     * Convenience method to get a class specific Boolean value.
     *
     * @param context SynthContext identifying requestor
     * @param key Key identifying class specific value
     * @param defaultValue Returned if there is no value for the specified
     *        type
     * @return Value, or defaultValue if &lt;code&gt;key&lt;/code&gt; is not defined
     */
    boolean getClassSpecificBoolValue(SynthContext context, String key,
                                      boolean defaultValue)
    {
<span class="nc" id="L692">        Object value = getClassSpecificValue(key);</span>

<span class="nc bnc" id="L694" title="All 2 branches missed.">        if (value instanceof Boolean) {</span>
<span class="nc" id="L695">            return ((Boolean)value).booleanValue();</span>
        }
<span class="nc" id="L697">        return defaultValue;</span>
    }

    /**
     * Returns the value to initialize the opacity property of the Component
     * to. A Style should NOT assume the opacity will remain this value, the
     * developer may reset it or override it.
     *
     * @param context SynthContext identifying requestor
     * @return opaque Whether or not the JComponent is opaque.
     */
    @Override
    public boolean isOpaque(SynthContext context) {
<span class="nc" id="L710">        Region region = context.getRegion();</span>
<span class="nc bnc" id="L711" title="All 48 branches missed.">        if (region == Region.COMBO_BOX ||</span>
              region == Region.DESKTOP_PANE ||
              region == Region.DESKTOP_ICON ||
              region == Region.EDITOR_PANE ||
              region == Region.FORMATTED_TEXT_FIELD ||
              region == Region.INTERNAL_FRAME ||
              region == Region.LIST ||
              region == Region.MENU_BAR ||
              region == Region.PANEL ||
              region == Region.PASSWORD_FIELD ||
              region == Region.POPUP_MENU ||
              region == Region.PROGRESS_BAR ||
              region == Region.ROOT_PANE ||
              region == Region.SCROLL_PANE ||
              region == Region.SPINNER ||
              region == Region.SPLIT_PANE_DIVIDER ||
              region == Region.TABLE ||
              region == Region.TEXT_AREA ||
              region == Region.TEXT_FIELD ||
              region == Region.TEXT_PANE ||
              region == Region.TOOL_BAR_DRAG_WINDOW ||
              region == Region.TOOL_TIP ||
              region == Region.TREE ||
              region == Region.VIEWPORT) {
<span class="nc" id="L735">            return true;</span>
        }
<span class="nc" id="L737">        Component c = context.getComponent();</span>
<span class="nc" id="L738">        String name = c.getName();</span>
<span class="nc bnc" id="L739" title="All 4 branches missed.">        if (name == &quot;ComboBox.renderer&quot; || name == &quot;ComboBox.listRenderer&quot;) {</span>
<span class="nc" id="L740">            return true;</span>
        }
<span class="nc" id="L742">        return false;</span>
    }

    @Override
    public Object get(SynthContext context, Object key) {
        // See if this is a class specific value.
<span class="nc" id="L748">        String classKey = CLASS_SPECIFIC_MAP.get(key);</span>
<span class="nc bnc" id="L749" title="All 2 branches missed.">        if (classKey != null) {</span>
<span class="nc" id="L750">            Object value = getClassSpecificValue(classKey);</span>
<span class="nc bnc" id="L751" title="All 2 branches missed.">            if (value != null) {</span>
<span class="nc" id="L752">                return value;</span>
            }
        }

        // Is it a specific value ?
<span class="nc bnc" id="L757" title="All 2 branches missed.">        if (key == &quot;ScrollPane.viewportBorderInsets&quot;) {</span>
<span class="nc" id="L758">            return getThicknessInsets(context, new Insets(0, 0, 0, 0));</span>
        }
<span class="nc bnc" id="L760" title="All 2 branches missed.">        else if (key == &quot;Slider.tickColor&quot;) {</span>
<span class="nc" id="L761">            return getColorForState(context, ColorType.FOREGROUND);</span>
        }
<span class="nc bnc" id="L763" title="All 2 branches missed.">        else if (key == &quot;ScrollBar.minimumThumbSize&quot;) {</span>
<span class="nc" id="L764">            int len =</span>
<span class="nc" id="L765">                getClassSpecificIntValue(context, &quot;min-slider-length&quot;, 21);</span>
<span class="nc" id="L766">            JScrollBar sb = (JScrollBar)context.getComponent();</span>
<span class="nc bnc" id="L767" title="All 2 branches missed.">            if (sb.getOrientation() == JScrollBar.HORIZONTAL) {</span>
<span class="nc" id="L768">                return new DimensionUIResource(len, 0);</span>
            } else {
<span class="nc" id="L770">                return new DimensionUIResource(0, len);</span>
            }
        }
<span class="nc bnc" id="L773" title="All 2 branches missed.">        else if (key == &quot;Separator.thickness&quot;) {</span>
<span class="nc" id="L774">            JSeparator sep = (JSeparator)context.getComponent();</span>
<span class="nc bnc" id="L775" title="All 2 branches missed.">            if (sep.getOrientation() == JSeparator.HORIZONTAL) {</span>
<span class="nc" id="L776">                return getYThickness();</span>
            } else {
<span class="nc" id="L778">                return getXThickness();</span>
            }
        }
<span class="nc bnc" id="L781" title="All 2 branches missed.">        else if (key == &quot;ToolBar.separatorSize&quot;) {</span>
<span class="nc" id="L782">            int size = getClassSpecificIntValue(WidgetType.TOOL_BAR,</span>
                                                &quot;space-size&quot;, 12);
<span class="nc" id="L784">            return new DimensionUIResource(size, size);</span>
        }
<span class="nc bnc" id="L786" title="All 2 branches missed.">        else if (key == &quot;ScrollBar.buttonSize&quot;) {</span>
<span class="nc" id="L787">            JScrollBar sb = (JScrollBar)context.getComponent().getParent();</span>
<span class="nc bnc" id="L788" title="All 2 branches missed.">            boolean horiz = (sb.getOrientation() == JScrollBar.HORIZONTAL);</span>
<span class="nc bnc" id="L789" title="All 2 branches missed.">            WidgetType wt = horiz ?</span>
                WidgetType.HSCROLL_BAR : WidgetType.VSCROLL_BAR;
<span class="nc" id="L791">            int sliderWidth = getClassSpecificIntValue(wt, &quot;slider-width&quot;, 14);</span>
<span class="nc" id="L792">            int stepperSize = getClassSpecificIntValue(wt, &quot;stepper-size&quot;, 14);</span>
<span class="nc bnc" id="L793" title="All 2 branches missed.">            return horiz ?</span>
                new DimensionUIResource(stepperSize, sliderWidth) :
                new DimensionUIResource(sliderWidth, stepperSize);
        }
<span class="nc bnc" id="L797" title="All 2 branches missed.">        else if (key == &quot;ArrowButton.size&quot;) {</span>
<span class="nc" id="L798">            String name = context.getComponent().getName();</span>
<span class="nc bnc" id="L799" title="All 4 branches missed.">            if (name != null &amp;&amp; name.startsWith(&quot;Spinner&quot;)) {</span>
                // Believe it or not, the size of a spinner arrow button is
                // dependent upon the size of the spinner's font.  These
                // calculations come from gtkspinbutton.c (version 2.8.20),
                // spin_button_get_arrow_size() method.
                String pangoFontName;
<span class="nc" id="L805">                synchronized (sun.awt.UNIXToolkit.GTK_LOCK) {</span>
<span class="nc" id="L806">                    pangoFontName =</span>
<span class="nc" id="L807">                        nativeGetPangoFontName(WidgetType.SPINNER.ordinal());</span>
<span class="nc" id="L808">                }</span>
<span class="nc bnc" id="L809" title="All 2 branches missed.">                int arrowSize = (pangoFontName != null) ?</span>
<span class="nc" id="L810">                    PangoFonts.getFontSize(pangoFontName) : 10;</span>
<span class="nc" id="L811">                return (arrowSize + (getXThickness() * 2));</span>
            }
            // For all other kinds of arrow buttons (e.g. combobox arrow
            // buttons), we will simply fall back on the value of
            // ArrowButton.size as defined in the UIDefaults for
            // GTKLookAndFeel when we call UIManager.get() below...
<span class="nc" id="L817">        }</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">        else if (&quot;CheckBox.iconTextGap&quot;.equals(key) ||</span>
<span class="nc bnc" id="L819" title="All 2 branches missed.">                 &quot;RadioButton.iconTextGap&quot;.equals(key))</span>
        {
            // The iconTextGap value needs to include &quot;indicator-spacing&quot;
            // and it also needs to leave enough space for the focus line,
            // which falls between the indicator icon and the text.
            // See getRadioInsets() and 6489585 for more details.
<span class="nc" id="L825">            int indicatorSpacing =</span>
<span class="nc" id="L826">                getClassSpecificIntValue(context, &quot;indicator-spacing&quot;, 2);</span>
<span class="nc" id="L827">            int focusSize =</span>
<span class="nc" id="L828">                getClassSpecificIntValue(context, &quot;focus-line-width&quot;, 1);</span>
<span class="nc" id="L829">            int focusPad =</span>
<span class="nc" id="L830">                getClassSpecificIntValue(context, &quot;focus-padding&quot;, 1);</span>
<span class="nc" id="L831">            return indicatorSpacing + focusSize + focusPad;</span>
        }

        // Is it a stock icon ?
<span class="nc" id="L835">        GTKStockIcon stockIcon = null;</span>
<span class="nc" id="L836">        synchronized (ICONS_MAP) {</span>
<span class="nc" id="L837">            stockIcon = ICONS_MAP.get(key);</span>
<span class="nc" id="L838">        }</span>

<span class="nc bnc" id="L840" title="All 2 branches missed.">        if (stockIcon != null) {</span>
<span class="nc" id="L841">            return stockIcon;</span>
        }

        // Is it another kind of value ?
<span class="nc bnc" id="L845" title="All 2 branches missed.">        if (key != &quot;engine&quot;) {</span>
            // For backward compatibility we'll fallback to the UIManager.
            // We don't go to the UIManager for engine as the engine is GTK
            // specific.
<span class="nc" id="L849">            Object value = UIManager.get(key);</span>
<span class="nc bnc" id="L850" title="All 2 branches missed.">            if (key == &quot;Table.rowHeight&quot;) {</span>
<span class="nc" id="L851">                int focusLineWidth = getClassSpecificIntValue(context,</span>
                        &quot;focus-line-width&quot;, 0);
<span class="nc bnc" id="L853" title="All 4 branches missed.">                if (value == null &amp;&amp; focusLineWidth &gt; 0) {</span>
<span class="nc" id="L854">                    value = Integer.valueOf(16 + 2 * focusLineWidth);</span>
                }
            }
<span class="nc" id="L857">            return value;</span>
        }

        // Don't call super, we don't want to pick up defaults from
        // SynthStyle.
<span class="nc" id="L862">        return null;</span>
    }

    private Icon getStockIcon(SynthContext context, String key, int type) {
<span class="nc" id="L866">        TextDirection direction = TextDirection.LTR;</span>

<span class="nc bnc" id="L868" title="All 2 branches missed.">        if (context != null) {</span>
<span class="nc" id="L869">            ComponentOrientation co = context.getComponent().</span>
<span class="nc" id="L870">                                              getComponentOrientation();</span>

<span class="nc bnc" id="L872" title="All 4 branches missed.">            if (co != null &amp;&amp; !co.isLeftToRight()) {</span>
<span class="nc" id="L873">                direction = TextDirection.RTL;</span>
            }
        }

        // First try loading a theme-specific icon using the native
        // GTK libraries (native GTK handles the resizing for us).
<span class="nc" id="L879">        Icon icon = getStyleSpecificIcon(key, direction, type);</span>
<span class="nc bnc" id="L880" title="All 2 branches missed.">        if (icon != null) {</span>
<span class="nc" id="L881">            return icon;</span>
        }

        // In a failure case where native GTK (unexpectedly) returns a
        // null icon, we can try loading a default icon as a fallback.
<span class="nc bnc" id="L886" title="All 2 branches missed.">        String propName = ICON_PROPERTY_PREFIX + key + '.' + type + '.' +</span>
                          (direction == TextDirection.RTL ? &quot;rtl&quot; : &quot;ltr&quot;);
        Image img = (Image)
<span class="nc" id="L889">            Toolkit.getDefaultToolkit().getDesktopProperty(propName);</span>
<span class="nc bnc" id="L890" title="All 2 branches missed.">        if (img != null) {</span>
<span class="nc" id="L891">            return new ImageIcon(img);</span>
        }

        // In an extreme failure situation, just return null (callers are
        // already prepared to handle a null icon, so the worst that can
        // happen is that an icon won't be included in the button/dialog).
<span class="nc" id="L897">        return null;</span>
    }

    private Icon getStyleSpecificIcon(String key,
                                      TextDirection direction, int type)
    {
<span class="nc" id="L903">        UNIXToolkit tk = (UNIXToolkit)Toolkit.getDefaultToolkit();</span>
<span class="nc" id="L904">        Image img =</span>
<span class="nc" id="L905">            tk.getStockIcon(widgetType, key, type, direction.ordinal(), null);</span>
<span class="nc bnc" id="L906" title="All 2 branches missed.">        return (img != null) ? new ImageIcon(img) : null;</span>
    }

<span class="nc" id="L909">    static class GTKStockIconInfo {</span>
        private static Map&lt;String,Integer&gt; ICON_TYPE_MAP;
<span class="nc" id="L911">        private static final Object ICON_SIZE_KEY = new StringBuffer(&quot;IconSize&quot;);</span>

        private static Dimension[] getIconSizesMap() {
<span class="nc" id="L914">            AppContext appContext = AppContext.getAppContext();</span>
<span class="nc" id="L915">            Dimension[] iconSizes = (Dimension[])appContext.get(ICON_SIZE_KEY);</span>

<span class="nc bnc" id="L917" title="All 2 branches missed.">            if (iconSizes == null) {</span>
<span class="nc" id="L918">                iconSizes = new Dimension[7];</span>
<span class="nc" id="L919">                iconSizes[0] = null;                  // GTK_ICON_SIZE_INVALID</span>
<span class="nc" id="L920">                iconSizes[1] = new Dimension(16, 16); // GTK_ICON_SIZE_MENU</span>
<span class="nc" id="L921">                iconSizes[2] = new Dimension(18, 18); // GTK_ICON_SIZE_SMALL_TOOLBAR</span>
<span class="nc" id="L922">                iconSizes[3] = new Dimension(24, 24); // GTK_ICON_SIZE_LARGE_TOOLBAR</span>
<span class="nc" id="L923">                iconSizes[4] = new Dimension(20, 20); // GTK_ICON_SIZE_BUTTON</span>
<span class="nc" id="L924">                iconSizes[5] = new Dimension(32, 32); // GTK_ICON_SIZE_DND</span>
<span class="nc" id="L925">                iconSizes[6] = new Dimension(48, 48); // GTK_ICON_SIZE_DIALOG</span>
<span class="nc" id="L926">                appContext.put(ICON_SIZE_KEY, iconSizes);</span>
            }
<span class="nc" id="L928">            return iconSizes;</span>
        }

        /**
         * Return the size of a particular icon type (logical size)
         *
         * @param type icon type (GtkIconSize value)
         * @return a Dimension object, or null if lsize is invalid
         */
        public static Dimension getIconSize(int type) {
<span class="nc" id="L938">            Dimension[] iconSizes = getIconSizesMap();</span>
<span class="nc bnc" id="L939" title="All 4 branches missed.">            return type &gt;= 0 &amp;&amp; type &lt; iconSizes.length ?</span>
                iconSizes[type] : null;
        }

        /**
         * Change icon size in a type to size mapping. This is called by code
         * that parses the gtk-icon-sizes setting
         *
         * @param type icon type (GtkIconSize value)
         * @param w the new icon width
         * @param h the new icon height
         */
        public static void setIconSize(int type, int w, int h) {
<span class="nc" id="L952">            Dimension[] iconSizes = getIconSizesMap();</span>
<span class="nc bnc" id="L953" title="All 4 branches missed.">            if (type &gt;= 0 &amp;&amp; type &lt; iconSizes.length) {</span>
<span class="nc" id="L954">                iconSizes[type] = new Dimension(w, h);</span>
            }
<span class="nc" id="L956">        }</span>

        /**
         * Return icon type (GtkIconSize value) given a symbolic name which can
         * occur in a theme file.
         *
         * @param size symbolic name, e.g. gtk-button
         * @return icon type. Valid types are 1 to 6
         */
        public static int getIconType(String size) {
<span class="nc bnc" id="L966" title="All 2 branches missed.">            if (size == null) {</span>
<span class="nc" id="L967">                return UNDEFINED;</span>
            }
<span class="nc bnc" id="L969" title="All 2 branches missed.">            if (ICON_TYPE_MAP == null) {</span>
<span class="nc" id="L970">                initIconTypeMap();</span>
            }
<span class="nc" id="L972">            Integer n = ICON_TYPE_MAP.get(size);</span>
<span class="nc bnc" id="L973" title="All 2 branches missed.">            return n != null ? n.intValue() : UNDEFINED;</span>
        }

        private static void initIconTypeMap() {
<span class="nc" id="L977">            ICON_TYPE_MAP = new HashMap&lt;String,Integer&gt;();</span>
<span class="nc" id="L978">            ICON_TYPE_MAP.put(&quot;gtk-menu&quot;, Integer.valueOf(1));</span>
<span class="nc" id="L979">            ICON_TYPE_MAP.put(&quot;gtk-small-toolbar&quot;, Integer.valueOf(2));</span>
<span class="nc" id="L980">            ICON_TYPE_MAP.put(&quot;gtk-large-toolbar&quot;, Integer.valueOf(3));</span>
<span class="nc" id="L981">            ICON_TYPE_MAP.put(&quot;gtk-button&quot;, Integer.valueOf(4));</span>
<span class="nc" id="L982">            ICON_TYPE_MAP.put(&quot;gtk-dnd&quot;, Integer.valueOf(5));</span>
<span class="nc" id="L983">            ICON_TYPE_MAP.put(&quot;gtk-dialog&quot;, Integer.valueOf(6));</span>
<span class="nc" id="L984">        }</span>

    }

    /**
     * An Icon that is fetched using getStockIcon.
     */
    private static class GTKStockIcon extends SynthIcon {
        private String key;
        private int size;
        private boolean loadedLTR;
        private boolean loadedRTL;
        private Icon ltrIcon;
        private Icon rtlIcon;
        private SynthStyle style;

<span class="nc" id="L1000">        GTKStockIcon(String key, int size) {</span>
<span class="nc" id="L1001">            this.key = key;</span>
<span class="nc" id="L1002">            this.size = size;</span>
<span class="nc" id="L1003">        }</span>

        public void paintIcon(SynthContext context, Graphics g, int x,
                              int y, int w, int h) {
<span class="nc" id="L1007">            Icon icon = getIcon(context);</span>

<span class="nc bnc" id="L1009" title="All 2 branches missed.">            if (icon != null) {</span>
<span class="nc bnc" id="L1010" title="All 2 branches missed.">                if (context == null) {</span>
<span class="nc" id="L1011">                    icon.paintIcon(null, g, x, y);</span>
                }
                else {
<span class="nc" id="L1014">                    icon.paintIcon(context.getComponent(), g, x, y);</span>
                }
            }
<span class="nc" id="L1017">        }</span>

        public int getIconWidth(SynthContext context) {
<span class="nc" id="L1020">            Icon icon = getIcon(context);</span>

<span class="nc bnc" id="L1022" title="All 2 branches missed.">            if (icon != null) {</span>
<span class="nc" id="L1023">                return icon.getIconWidth();</span>
            }
<span class="nc" id="L1025">            return 0;</span>
        }

        public int getIconHeight(SynthContext context) {
<span class="nc" id="L1029">            Icon icon = getIcon(context);</span>

<span class="nc bnc" id="L1031" title="All 2 branches missed.">            if (icon != null) {</span>
<span class="nc" id="L1032">                return icon.getIconHeight();</span>
            }
<span class="nc" id="L1034">            return 0;</span>
        }

        private Icon getIcon(SynthContext context) {
<span class="nc bnc" id="L1038" title="All 2 branches missed.">            if (context != null) {</span>
<span class="nc" id="L1039">                ComponentOrientation co = context.getComponent().</span>
<span class="nc" id="L1040">                                                  getComponentOrientation();</span>
<span class="nc" id="L1041">                SynthStyle style = context.getStyle();</span>

<span class="nc bnc" id="L1043" title="All 2 branches missed.">                if (style != this.style) {</span>
<span class="nc" id="L1044">                    this.style = style;</span>
<span class="nc" id="L1045">                    loadedLTR = loadedRTL = false;</span>
                }
<span class="nc bnc" id="L1047" title="All 4 branches missed.">                if (co == null || co.isLeftToRight()) {</span>
<span class="nc bnc" id="L1048" title="All 2 branches missed.">                    if (!loadedLTR) {</span>
<span class="nc" id="L1049">                        loadedLTR = true;</span>
<span class="nc" id="L1050">                        ltrIcon = ((GTKStyle)context.getStyle()).</span>
                                  getStockIcon(context, key, size);
                    }
<span class="nc" id="L1053">                    return ltrIcon;</span>
                }
<span class="nc bnc" id="L1055" title="All 2 branches missed.">                else if (!loadedRTL) {</span>
<span class="nc" id="L1056">                    loadedRTL = true;</span>
<span class="nc" id="L1057">                    rtlIcon = ((GTKStyle)context.getStyle()).</span>
                              getStockIcon(context, key,size);
                }
<span class="nc" id="L1060">                return rtlIcon;</span>
            }
<span class="nc" id="L1062">            return ltrIcon;</span>
        }
    }

    /**
     * GTKLazyValue is a slimmed down version of &lt;code&gt;ProxyLaxyValue&lt;/code&gt;.
     * The code is duplicate so that it can get at the package private
     * classes in gtk.
     */
    static class GTKLazyValue implements UIDefaults.LazyValue {
        /**
         * Name of the class to create.
         */
        private String className;
        private String methodName;

        GTKLazyValue(String name) {
<span class="nc" id="L1079">            this(name, null);</span>
<span class="nc" id="L1080">        }</span>

<span class="nc" id="L1082">        GTKLazyValue(String name, String methodName) {</span>
<span class="nc" id="L1083">            this.className = name;</span>
<span class="nc" id="L1084">            this.methodName = methodName;</span>
<span class="nc" id="L1085">        }</span>

        public Object createValue(UIDefaults table) {
            try {
<span class="nc" id="L1089">                Class c = Class.forName(className, true,Thread.currentThread().</span>
<span class="nc" id="L1090">                                        getContextClassLoader());</span>

<span class="nc bnc" id="L1092" title="All 2 branches missed.">                if (methodName == null) {</span>
<span class="nc" id="L1093">                    return c.newInstance();</span>
                }
<span class="nc" id="L1095">                Method m = c.getMethod(methodName, (Class[])null);</span>

<span class="nc" id="L1097">                return m.invoke(c, (Object[])null);</span>
<span class="nc" id="L1098">            } catch (ClassNotFoundException cnfe) {</span>
<span class="nc" id="L1099">            } catch (IllegalAccessException iae) {</span>
<span class="nc" id="L1100">            } catch (InvocationTargetException ite) {</span>
<span class="nc" id="L1101">            } catch (NoSuchMethodException nsme) {</span>
<span class="nc" id="L1102">            } catch (InstantiationException ie) {</span>
<span class="nc" id="L1103">            }</span>
<span class="nc" id="L1104">            return null;</span>
        }
    }

    static {
<span class="nc" id="L1109">        CLASS_SPECIFIC_MAP = new HashMap&lt;String,String&gt;();</span>
<span class="nc" id="L1110">        CLASS_SPECIFIC_MAP.put(&quot;Slider.thumbHeight&quot;, &quot;slider-width&quot;);</span>
<span class="nc" id="L1111">        CLASS_SPECIFIC_MAP.put(&quot;Slider.trackBorder&quot;, &quot;trough-border&quot;);</span>
<span class="nc" id="L1112">        CLASS_SPECIFIC_MAP.put(&quot;SplitPane.size&quot;, &quot;handle-size&quot;);</span>
<span class="nc" id="L1113">        CLASS_SPECIFIC_MAP.put(&quot;Tree.expanderSize&quot;, &quot;expander-size&quot;);</span>
<span class="nc" id="L1114">        CLASS_SPECIFIC_MAP.put(&quot;ScrollBar.thumbHeight&quot;, &quot;slider-width&quot;);</span>
<span class="nc" id="L1115">        CLASS_SPECIFIC_MAP.put(&quot;ScrollBar.width&quot;, &quot;slider-width&quot;);</span>
<span class="nc" id="L1116">        CLASS_SPECIFIC_MAP.put(&quot;TextArea.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1117">        CLASS_SPECIFIC_MAP.put(&quot;TextArea.caretAspectRatio&quot;, &quot;cursor-aspect-ratio&quot;);</span>
<span class="nc" id="L1118">        CLASS_SPECIFIC_MAP.put(&quot;TextField.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1119">        CLASS_SPECIFIC_MAP.put(&quot;TextField.caretAspectRatio&quot;, &quot;cursor-aspect-ratio&quot;);</span>
<span class="nc" id="L1120">        CLASS_SPECIFIC_MAP.put(&quot;PasswordField.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1121">        CLASS_SPECIFIC_MAP.put(&quot;PasswordField.caretAspectRatio&quot;, &quot;cursor-aspect-ratio&quot;);</span>
<span class="nc" id="L1122">        CLASS_SPECIFIC_MAP.put(&quot;FormattedTextField.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1123">        CLASS_SPECIFIC_MAP.put(&quot;FormattedTextField.caretAspectRatio&quot;, &quot;cursor-aspect-&quot;);</span>
<span class="nc" id="L1124">        CLASS_SPECIFIC_MAP.put(&quot;TextPane.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1125">        CLASS_SPECIFIC_MAP.put(&quot;TextPane.caretAspectRatio&quot;, &quot;cursor-aspect-ratio&quot;);</span>
<span class="nc" id="L1126">        CLASS_SPECIFIC_MAP.put(&quot;EditorPane.caretForeground&quot;, &quot;cursor-color&quot;);</span>
<span class="nc" id="L1127">        CLASS_SPECIFIC_MAP.put(&quot;EditorPane.caretAspectRatio&quot;, &quot;cursor-aspect-ratio&quot;);</span>

<span class="nc" id="L1129">        ICONS_MAP = new HashMap&lt;String, GTKStockIcon&gt;();</span>
<span class="nc" id="L1130">        ICONS_MAP.put(&quot;FileChooser.cancelIcon&quot;, new GTKStockIcon(&quot;gtk-cancel&quot;, 4));</span>
<span class="nc" id="L1131">        ICONS_MAP.put(&quot;FileChooser.okIcon&quot;,     new GTKStockIcon(&quot;gtk-ok&quot;,     4));</span>
<span class="nc" id="L1132">        ICONS_MAP.put(&quot;OptionPane.errorIcon&quot;, new GTKStockIcon(&quot;gtk-dialog-error&quot;, 6));</span>
<span class="nc" id="L1133">        ICONS_MAP.put(&quot;OptionPane.informationIcon&quot;, new GTKStockIcon(&quot;gtk-dialog-info&quot;, 6));</span>
<span class="nc" id="L1134">        ICONS_MAP.put(&quot;OptionPane.warningIcon&quot;, new GTKStockIcon(&quot;gtk-dialog-warning&quot;, 6));</span>
<span class="nc" id="L1135">        ICONS_MAP.put(&quot;OptionPane.questionIcon&quot;, new GTKStockIcon(&quot;gtk-dialog-question&quot;, 6));</span>
<span class="nc" id="L1136">        ICONS_MAP.put(&quot;OptionPane.yesIcon&quot;, new GTKStockIcon(&quot;gtk-yes&quot;, 4));</span>
<span class="nc" id="L1137">        ICONS_MAP.put(&quot;OptionPane.noIcon&quot;, new GTKStockIcon(&quot;gtk-no&quot;, 4));</span>
<span class="nc" id="L1138">        ICONS_MAP.put(&quot;OptionPane.cancelIcon&quot;, new GTKStockIcon(&quot;gtk-cancel&quot;, 4));</span>
<span class="nc" id="L1139">        ICONS_MAP.put(&quot;OptionPane.okIcon&quot;, new GTKStockIcon(&quot;gtk-ok&quot;, 4));</span>
<span class="nc" id="L1140">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>