<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GTKPainter.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">com.sun.java.swing.plaf.gtk</a> &gt; <span class="el_source">GTKPainter.java</span></div><h1>GTKPainter.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package com.sun.java.swing.plaf.gtk;

import sun.awt.UNIXToolkit;

import javax.swing.plaf.synth.*;
import java.awt.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.plaf.*;
import com.sun.java.swing.plaf.gtk.GTKConstants.ArrowType;
import com.sun.java.swing.plaf.gtk.GTKConstants.ExpanderStyle;
import com.sun.java.swing.plaf.gtk.GTKConstants.Orientation;
import com.sun.java.swing.plaf.gtk.GTKConstants.PositionType;
import com.sun.java.swing.plaf.gtk.GTKConstants.ShadowType;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

/**
 * @author Joshua Outwater
 * @author Scott Violet
 */
// Need to support:
// default_outside_border: Insets when default.
// interior_focus: Indicates if focus should appear inside border, or
//                       outside border.
// focus-line-width: Integer giving size of focus border
// focus-padding: Integer giving padding between border and focus
//        indicator.
// focus-line-pattern:
//
<span class="nc bnc" id="L55" title="All 2 branches missed.">class GTKPainter extends SynthPainter {</span>
<span class="nc" id="L56">    private static final PositionType[] POSITIONS = {</span>
        PositionType.BOTTOM, PositionType.RIGHT,
        PositionType.TOP, PositionType.LEFT
    };

<span class="nc" id="L61">    private static final ShadowType SHADOWS[] = {</span>
        ShadowType.NONE, ShadowType.IN, ShadowType.OUT,
        ShadowType.ETCHED_IN, ShadowType.OUT
    };

<span class="nc" id="L66">    private final static GTKEngine ENGINE = GTKEngine.INSTANCE;</span>
<span class="nc" id="L67">    final static GTKPainter INSTANCE = new GTKPainter();</span>

<span class="nc" id="L69">    private GTKPainter() {</span>
<span class="nc" id="L70">    }</span>

    private String getName(SynthContext context) {
<span class="nc bnc" id="L73" title="All 2 branches missed.">        return (context.getRegion().isSubregion()) ? null :</span>
<span class="nc" id="L74">               context.getComponent().getName();</span>
    }

    public void paintCheckBoxBackground(SynthContext context,
            Graphics g, int x, int y, int w, int h) {
<span class="nc" id="L79">        paintRadioButtonBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L80">    }</span>

    public void paintCheckBoxMenuItemBackground(SynthContext context,
            Graphics g, int x, int y, int w, int h) {
<span class="nc" id="L84">        paintRadioButtonMenuItemBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L85">    }</span>

    // FORMATTED_TEXT_FIELD
    public void paintFormattedTextFieldBackground(SynthContext context,
                                          Graphics g, int x, int y,
                                          int w, int h) {
<span class="nc" id="L91">        paintTextBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L92">    }</span>

    //
    // TOOL_BAR_DRAG_WINDOW
    //
    public void paintToolBarDragWindowBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L100">        paintToolBarBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L101">    }</span>


    //
    // TOOL_BAR
    //
    public void paintToolBarBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L110">        Region id = context.getRegion();</span>
<span class="nc" id="L111">        int state = context.getComponentState();</span>
<span class="nc" id="L112">        int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L113">        int orientation = ((JToolBar)context.getComponent()).getOrientation();</span>
<span class="nc" id="L114">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id,</span>
<span class="nc" id="L116">                                          state, orientation))</span>
            {
<span class="nc" id="L118">                ENGINE.startPainting(g, x, y, w, h, id, state, orientation);</span>
<span class="nc" id="L119">                ENGINE.paintBox(g, context, id, gtkState, ShadowType.OUT,</span>
                                &quot;handlebox_bin&quot;, x, y, w, h);
<span class="nc" id="L121">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L123">        }</span>
<span class="nc" id="L124">    }</span>

    public void paintToolBarContentBackground(SynthContext context,
                                              Graphics g,
                                              int x, int y, int w, int h) {
<span class="nc" id="L129">        Region id = context.getRegion();</span>
<span class="nc" id="L130">        int orientation = ((JToolBar)context.getComponent()).getOrientation();</span>
<span class="nc" id="L131">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, orientation)) {</span>
<span class="nc" id="L133">                ENGINE.startPainting(g, x, y, w, h, id, orientation);</span>
<span class="nc" id="L134">                ENGINE.paintBox(g, context, id, SynthConstants.ENABLED,</span>
                                ShadowType.OUT, &quot;toolbar&quot;, x, y, w, h);
<span class="nc" id="L136">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L138">        }</span>
<span class="nc" id="L139">    }</span>

    //
    // PASSWORD_FIELD
    //
    public void paintPasswordFieldBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L147">        paintTextBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L148">    }</span>

    //
    // TEXT_FIELD
    //
    public void paintTextFieldBackground(SynthContext context, Graphics g,
                                         int x, int y, int w, int h) {
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (getName(context) == &quot;Tree.cellEditor&quot;) {</span>
<span class="nc" id="L156">            paintTreeCellEditorBackground(context, g, x, y, w, h);</span>
        } else {
<span class="nc" id="L158">            paintTextBackground(context, g, x, y, w, h);</span>
        }
<span class="nc" id="L160">    }</span>

    //
    // RADIO_BUTTON
    //
    // NOTE: this is called for JCheckBox too
    public void paintRadioButtonBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L169">        Region id = context.getRegion();</span>
<span class="nc" id="L170">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L171">                id, context.getComponentState());</span>
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (gtkState == SynthConstants.MOUSE_OVER) {</span>
<span class="nc" id="L173">            synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L175">                    ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L176">                    ENGINE.paintFlatBox(g, context, id,</span>
                            SynthConstants.MOUSE_OVER, ShadowType.ETCHED_OUT,
                            &quot;checkbutton&quot;, x, y, w, h, ColorType.BACKGROUND);
<span class="nc" id="L179">                    ENGINE.finishPainting();</span>
                }
<span class="nc" id="L181">            }</span>
        }
<span class="nc" id="L183">    }</span>

    //
    // RADIO_BUTTON_MENU_ITEM
    //
    // NOTE: this is called for JCheckBoxMenuItem too
    public void paintRadioButtonMenuItemBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L192">        Region id = context.getRegion();</span>
<span class="nc" id="L193">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L194">                id, context.getComponentState());</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (gtkState == SynthConstants.MOUSE_OVER) {</span>
<span class="nc" id="L196">            synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">                if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">                    ShadowType shadow = (GTKLookAndFeel.is2_2() ?</span>
                        ShadowType.NONE : ShadowType.OUT);
<span class="nc" id="L200">                    ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L201">                    ENGINE.paintBox(g, context, id, gtkState,</span>
                            shadow, &quot;menuitem&quot;, x, y, w, h);
<span class="nc" id="L203">                    ENGINE.finishPainting();</span>
                }
<span class="nc" id="L205">            }</span>
        }
<span class="nc" id="L207">    }</span>

    //
    // LABEL
    //
    public void paintLabelBackground(SynthContext context,
                                     Graphics g, int x, int y,
                                     int w, int h) {
<span class="nc" id="L215">        String name = getName(context);</span>
<span class="nc" id="L216">        JComponent c = context.getComponent();</span>
<span class="nc" id="L217">        Container  container = c.getParent();</span>

<span class="nc bnc" id="L219" title="All 6 branches missed.">        if (name == &quot;TableHeader.renderer&quot; ||</span>
            name == &quot;GTKFileChooser.directoryListLabel&quot; ||
            name == &quot;GTKFileChooser.fileListLabel&quot;) {

<span class="nc" id="L223">            paintButtonBackgroundImpl(context, g, Region.BUTTON, &quot;button&quot;,</span>
                    x, y, w, h, true, false, false, false);
        }
        /*
         * If the label is a ListCellRenderer and it's in a container
         * (CellRendererPane) which is in a JComboBox then we paint the label
         * as a TextField like a gtk_entry for a combobox.
         */
<span class="nc bnc" id="L231" title="All 4 branches missed.">        else if (c instanceof ListCellRenderer &amp;&amp;</span>
                 container != null &amp;&amp;
<span class="nc bnc" id="L233" title="All 2 branches missed.">                 container.getParent() instanceof JComboBox ) {</span>
<span class="nc" id="L234">            paintTextBackground(context, g, x, y, w, h);</span>
        }
<span class="nc" id="L236">    }</span>

    //
    // INTERNAL_FRAME
    //
    public void paintInternalFrameBorder(SynthContext context,
                                      Graphics g, int x, int y,
                                      int w, int h) {
<span class="nc" id="L244">        Metacity.INSTANCE.paintFrameBorder(context, g, x, y, w, h);</span>
<span class="nc" id="L245">    }</span>

    //
    // DESKTOP_PANE
    //
    public void paintDesktopPaneBackground(SynthContext context,
                                           Graphics g, int x, int y,
                                           int w, int h) {
        // Does not call into ENGINE for better performance
<span class="nc" id="L254">        fillArea(context, g, x, y, w, h, ColorType.BACKGROUND);</span>
<span class="nc" id="L255">    }</span>

    //
    // DESKTOP_ICON
    //
    public void paintDesktopIconBorder(SynthContext context,
                                           Graphics g, int x, int y,
                                           int w, int h) {
<span class="nc" id="L263">        Metacity.INSTANCE.paintFrameBorder(context, g, x, y, w, h);</span>
<span class="nc" id="L264">    }</span>

    public void paintButtonBackground(SynthContext context, Graphics g,
                                      int x, int y, int w, int h) {
<span class="nc" id="L268">        String name = getName(context);</span>
<span class="nc bnc" id="L269" title="All 4 branches missed.">        if (name != null &amp;&amp; name.startsWith(&quot;InternalFrameTitlePane.&quot;)) {</span>
<span class="nc" id="L270">            Metacity.INSTANCE.paintButtonBackground(context, g, x, y, w, h);</span>

        } else {
<span class="nc" id="L273">            AbstractButton button = (AbstractButton)context.getComponent();</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">            boolean paintBG = button.isContentAreaFilled() &amp;&amp;</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">                              button.isBorderPainted();</span>
<span class="nc" id="L276">            boolean paintFocus = button.isFocusPainted();</span>
<span class="nc bnc" id="L277" title="All 2 branches missed.">            boolean defaultCapable = (button instanceof JButton) &amp;&amp;</span>
<span class="nc bnc" id="L278" title="All 2 branches missed.">                    ((JButton)button).isDefaultCapable();</span>
<span class="nc" id="L279">            boolean toolButton = (button.getParent() instanceof JToolBar);</span>
<span class="nc" id="L280">            paintButtonBackgroundImpl(context, g, Region.BUTTON, &quot;button&quot;,</span>
                    x, y, w, h, paintBG, paintFocus, defaultCapable, toolButton);
        }
<span class="nc" id="L283">    }</span>

    private void paintButtonBackgroundImpl(SynthContext context, Graphics g,
            Region id, String detail, int x, int y, int w, int h,
            boolean paintBackground, boolean paintFocus,
            boolean defaultCapable, boolean toolButton) {
<span class="nc" id="L289">        int state = context.getComponentState();</span>
<span class="nc" id="L290">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id, state, detail,</span>
<span class="nc" id="L292">                    paintBackground, paintFocus, defaultCapable, toolButton)) {</span>
<span class="nc" id="L293">                return;</span>
            }
<span class="nc" id="L295">            ENGINE.startPainting(g, x, y, w, h, id, state, detail,</span>
<span class="nc" id="L296">                paintBackground, paintFocus, defaultCapable, toolButton);</span>

            // Paint the default indicator
<span class="nc" id="L299">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc bnc" id="L300" title="All 4 branches missed.">            if (defaultCapable &amp;&amp; !toolButton) {</span>
<span class="nc" id="L301">                Insets defaultInsets = style.getClassSpecificInsetsValue(</span>
                        context, &quot;default-border&quot;,
                        GTKStyle.BUTTON_DEFAULT_BORDER_INSETS);

<span class="nc bnc" id="L305" title="All 4 branches missed.">                if (paintBackground &amp;&amp; (state &amp; SynthConstants.DEFAULT) != 0) {</span>
<span class="nc" id="L306">                    ENGINE.paintBox(g, context, id, SynthConstants.ENABLED,</span>
                            ShadowType.IN, &quot;buttondefault&quot;, x, y, w, h);
                }
<span class="nc" id="L309">                x += defaultInsets.left;</span>
<span class="nc" id="L310">                y += defaultInsets.top;</span>
<span class="nc" id="L311">                w -= (defaultInsets.left + defaultInsets.right);</span>
<span class="nc" id="L312">                h -= (defaultInsets.top + defaultInsets.bottom);</span>
            }

<span class="nc" id="L315">            boolean interiorFocus = style.getClassSpecificBoolValue(</span>
                    context, &quot;interior-focus&quot;, true);
<span class="nc" id="L317">            int focusSize = style.getClassSpecificIntValue(</span>
                    context, &quot;focus-line-width&quot;,1);
<span class="nc" id="L319">            int focusPad = style.getClassSpecificIntValue(</span>
                    context, &quot;focus-padding&quot;, 1);

<span class="nc" id="L322">            int totalFocusSize = focusSize + focusPad;</span>
<span class="nc" id="L323">            int xThickness = style.getXThickness();</span>
<span class="nc" id="L324">            int yThickness = style.getYThickness();</span>

            // Render the box.
<span class="nc bnc" id="L327" title="All 4 branches missed.">            if (!interiorFocus &amp;&amp;</span>
                    (state &amp; SynthConstants.FOCUSED) == SynthConstants.FOCUSED) {
<span class="nc" id="L329">                x += totalFocusSize;</span>
<span class="nc" id="L330">                y += totalFocusSize;</span>
<span class="nc" id="L331">                w -= 2 * totalFocusSize;</span>
<span class="nc" id="L332">                h -= 2 * totalFocusSize;</span>
            }

<span class="nc" id="L335">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
            boolean paintBg;
<span class="nc bnc" id="L337" title="All 2 branches missed.">            if (toolButton) {</span>
                // Toolbar buttons should only have their background painted
                // in the PRESSED, SELECTED, or MOUSE_OVER states.
<span class="nc bnc" id="L340" title="All 4 branches missed.">                paintBg =</span>
                    (gtkState != SynthConstants.ENABLED) &amp;&amp;
                    (gtkState != SynthConstants.DISABLED);
            } else {
                // Otherwise, always paint the button's background, unless
                // the user has overridden it and we're in the ENABLED state.
<span class="nc bnc" id="L346" title="All 4 branches missed.">                paintBg =</span>
                    paintBackground ||
                    (gtkState != SynthConstants.ENABLED);
            }
<span class="nc bnc" id="L350" title="All 2 branches missed.">            if (paintBg) {</span>
<span class="nc" id="L351">                ShadowType shadowType = ShadowType.OUT;</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">                if ((state &amp; (SynthConstants.PRESSED |</span>
                              SynthConstants.SELECTED)) != 0) {
<span class="nc" id="L354">                    shadowType = ShadowType.IN;</span>
                }
<span class="nc" id="L356">                ENGINE.paintBox(g, context, id, gtkState,</span>
                        shadowType, detail, x, y, w, h);
            }

            // focus
<span class="nc bnc" id="L361" title="All 4 branches missed.">            if (paintFocus &amp;&amp; (state &amp; SynthConstants.FOCUSED) != 0) {</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">                if (interiorFocus) {</span>
<span class="nc" id="L363">                    x += xThickness + focusPad;</span>
<span class="nc" id="L364">                    y += yThickness + focusPad;</span>
<span class="nc" id="L365">                    w -= 2 * (xThickness + focusPad);</span>
<span class="nc" id="L366">                    h -= 2 * (yThickness + focusPad);</span>
                } else {
<span class="nc" id="L368">                    x -= totalFocusSize;</span>
<span class="nc" id="L369">                    y -= totalFocusSize;</span>
<span class="nc" id="L370">                    w += 2 * totalFocusSize;</span>
<span class="nc" id="L371">                    h += 2 * totalFocusSize;</span>
                }
<span class="nc" id="L373">                ENGINE.paintFocus(g, context, id, gtkState, detail, x, y, w, h);</span>
            }
<span class="nc" id="L375">            ENGINE.finishPainting();</span>
<span class="nc" id="L376">        }</span>
<span class="nc" id="L377">    }</span>

    //
    // ARROW_BUTTON
    //
    public void paintArrowButtonForeground(SynthContext context, Graphics g,
                                           int x, int y, int w, int h,
                                           int direction) {
<span class="nc" id="L385">        Region id = context.getRegion();</span>
<span class="nc" id="L386">        Component c = context.getComponent();</span>
<span class="nc" id="L387">        String name = c.getName();</span>

<span class="nc" id="L389">        ArrowType arrowType = null;</span>
<span class="nc bnc" id="L390" title="All 5 branches missed.">        switch (direction) {</span>
            case SwingConstants.NORTH:
<span class="nc" id="L392">                arrowType = ArrowType.UP; break;</span>
            case SwingConstants.SOUTH:
<span class="nc" id="L394">                arrowType = ArrowType.DOWN; break;</span>
            case SwingConstants.EAST:
<span class="nc" id="L396">                arrowType = ArrowType.RIGHT; break;</span>
            case SwingConstants.WEST:
<span class="nc" id="L398">                arrowType = ArrowType.LEFT; break;</span>
        }

<span class="nc" id="L401">        String detail = &quot;arrow&quot;;</span>
<span class="nc bnc" id="L402" title="All 4 branches missed.">        if ((name == &quot;ScrollBar.button&quot;) || (name == &quot;TabbedPane.button&quot;)) {</span>
<span class="nc bnc" id="L403" title="All 4 branches missed.">            if (arrowType == ArrowType.UP || arrowType == ArrowType.DOWN) {</span>
<span class="nc" id="L404">                detail = &quot;vscrollbar&quot;;</span>
            } else {
<span class="nc" id="L406">                detail = &quot;hscrollbar&quot;;</span>
            }
<span class="nc bnc" id="L408" title="All 4 branches missed.">        } else if (name == &quot;Spinner.nextButton&quot; ||</span>
                   name == &quot;Spinner.previousButton&quot;) {
<span class="nc" id="L410">            detail = &quot;spinbutton&quot;;</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">        } else if (name != &quot;ComboBox.arrowButton&quot;) {</span>
<span class="nc bnc" id="L412" title="All 2 branches missed.">            assert false : &quot;unexpected name: &quot; + name;</span>
        }

<span class="nc" id="L415">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L416">                id, context.getComponentState());</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">        ShadowType shadowType = (gtkState == SynthConstants.PRESSED ?</span>
            ShadowType.IN : ShadowType.OUT);
<span class="nc" id="L419">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h,</span>
<span class="nc" id="L421">                    gtkState, name, direction)) {</span>
<span class="nc" id="L422">                return;</span>
            }
<span class="nc" id="L424">            ENGINE.startPainting(g, x, y, w, h, gtkState, name, direction);</span>
<span class="nc" id="L425">            ENGINE.paintArrow(g, context, id, gtkState,</span>
                    shadowType, arrowType, detail, x, y, w, h);
<span class="nc" id="L427">            ENGINE.finishPainting();</span>
<span class="nc" id="L428">        }</span>
<span class="nc" id="L429">    }</span>

    public void paintArrowButtonBackground(SynthContext context,
            Graphics g, int x, int y, int w, int h) {
<span class="nc" id="L433">        Region id = context.getRegion();</span>
<span class="nc" id="L434">        AbstractButton button = (AbstractButton)context.getComponent();</span>

<span class="nc" id="L436">        String name = button.getName();</span>
<span class="nc" id="L437">        String detail = &quot;button&quot;;</span>
<span class="nc" id="L438">        int direction = SwingConstants.CENTER;</span>
<span class="nc bnc" id="L439" title="All 4 branches missed.">        if ((name == &quot;ScrollBar.button&quot;) || (name == &quot;TabbedPane.button&quot;)) {</span>
<span class="nc" id="L440">            Integer prop = (Integer)</span>
<span class="nc" id="L441">                button.getClientProperty(&quot;__arrow_direction__&quot;);</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">            direction = (prop != null) ?</span>
<span class="nc" id="L443">                prop.intValue() : SwingConstants.WEST;</span>
<span class="nc bnc" id="L444" title="All 2 branches missed.">            switch (direction) {</span>
            default:
            case SwingConstants.EAST:
            case SwingConstants.WEST:
<span class="nc" id="L448">                detail = &quot;hscrollbar&quot;;</span>
<span class="nc" id="L449">                break;</span>
            case SwingConstants.NORTH:
            case SwingConstants.SOUTH:
<span class="nc" id="L452">                detail = &quot;vscrollbar&quot;;</span>
                break;
            }
<span class="nc bnc" id="L455" title="All 2 branches missed.">        } else if (name == &quot;Spinner.previousButton&quot;) {</span>
<span class="nc" id="L456">            detail = &quot;spinbutton_down&quot;;</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">        } else if (name == &quot;Spinner.nextButton&quot;) {</span>
<span class="nc" id="L458">            detail = &quot;spinbutton_up&quot;;</span>
<span class="nc bnc" id="L459" title="All 2 branches missed.">        } else if (name != &quot;ComboBox.arrowButton&quot;) {</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">            assert false : &quot;unexpected name: &quot; + name;</span>
        }

<span class="nc" id="L463">        int state = context.getComponentState();</span>
<span class="nc" id="L464">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L465" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id,</span>
<span class="nc" id="L466">                                        state, detail, direction))</span>
            {
<span class="nc" id="L468">                return;</span>
            }
<span class="nc" id="L470">            ENGINE.startPainting(g, x, y, w, h, id,</span>
<span class="nc" id="L471">                                 state, detail, direction);</span>

<span class="nc bnc" id="L473" title="All 2 branches missed.">            if (detail.startsWith(&quot;spin&quot;)) {</span>
                /*
                 * The ubuntulooks engine (and presumably others) expect us to
                 * first draw the full &quot;spinbutton&quot; background, and then draw
                 * the individual &quot;spinbutton_up/down&quot; buttons on top of that.
                 * Note that it is the state of the JSpinner (not its arrow
                 * button) that determines how we draw this background.
                 */
<span class="nc bnc" id="L481" title="All 2 branches missed.">                int spinState = button.getParent().isEnabled() ?</span>
                    SynthConstants.ENABLED : SynthConstants.DISABLED;
<span class="nc bnc" id="L483" title="All 2 branches missed.">                int mody = (detail == &quot;spinbutton_up&quot;) ? y : y-h;</span>
<span class="nc" id="L484">                int modh = h*2;</span>
<span class="nc" id="L485">                ENGINE.paintBox(g, context, id, spinState,</span>
                                ShadowType.IN, &quot;spinbutton&quot;,
                                x, mody, w, modh);
            }

<span class="nc" id="L490">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L491">            ShadowType shadowType = ShadowType.OUT;</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">            if ((gtkState &amp; (SynthConstants.PRESSED |</span>
                             SynthConstants.SELECTED)) != 0)
            {
<span class="nc" id="L495">                shadowType = ShadowType.IN;</span>
            }
<span class="nc" id="L497">            ENGINE.paintBox(g, context, id, gtkState,</span>
                            shadowType, detail,
                            x, y, w, h);

<span class="nc" id="L501">            ENGINE.finishPainting();</span>
<span class="nc" id="L502">        }</span>
<span class="nc" id="L503">    }</span>


    //
    // LIST
    //
    public void paintListBackground(SynthContext context, Graphics g,
                                    int x, int y, int w, int h) {
        // Does not call into ENGINE for better performance
<span class="nc" id="L512">        fillArea(context, g, x, y, w, h, GTKColorType.TEXT_BACKGROUND);</span>
<span class="nc" id="L513">    }</span>

    public void paintMenuBarBackground(SynthContext context, Graphics g,
                                       int x, int y, int w, int h) {
<span class="nc" id="L517">        Region id = context.getRegion();</span>
<span class="nc" id="L518">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L520">                return;</span>
            }
<span class="nc" id="L522">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L523">            int shadow = style.getClassSpecificIntValue(</span>
                    context, &quot;shadow-type&quot;, 2);
<span class="nc" id="L525">            ShadowType shadowType = SHADOWS[shadow];</span>
<span class="nc" id="L526">            int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L527">                    id, context.getComponentState());</span>
<span class="nc" id="L528">            ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L529">            ENGINE.paintBox(g, context, id, gtkState,</span>
                shadowType, &quot;menubar&quot;, x, y, w, h);
<span class="nc" id="L531">            ENGINE.finishPainting();</span>
<span class="nc" id="L532">        }</span>
<span class="nc" id="L533">    }</span>

    //
    // MENU
    //
    public void paintMenuBackground(SynthContext context,
                                     Graphics g,
                                     int x, int y, int w, int h) {
<span class="nc" id="L541">        paintMenuItemBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L542">    }</span>

    // This is called for both MENU and MENU_ITEM
    public void paintMenuItemBackground(SynthContext context,
                                     Graphics g,
                                     int x, int y, int w, int h) {
<span class="nc" id="L548">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L549">                context.getRegion(), context.getComponentState());</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">        if (gtkState == SynthConstants.MOUSE_OVER) {</span>
<span class="nc" id="L551">            Region id = Region.MENU_ITEM;</span>
<span class="nc" id="L552">            synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L553" title="All 2 branches missed.">                if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc bnc" id="L554" title="All 2 branches missed.">                    ShadowType shadow = (GTKLookAndFeel.is2_2() ?</span>
                        ShadowType.NONE : ShadowType.OUT);
<span class="nc" id="L556">                    ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L557">                    ENGINE.paintBox(g, context, id, gtkState, shadow,</span>
                            &quot;menuitem&quot;, x, y, w, h);
<span class="nc" id="L559">                    ENGINE.finishPainting();</span>
                }
<span class="nc" id="L561">            }</span>
        }
<span class="nc" id="L563">    }</span>

    public void paintPopupMenuBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
<span class="nc" id="L567">        Region id = context.getRegion();</span>
<span class="nc" id="L568">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L569">                id, context.getComponentState());</span>
<span class="nc" id="L570">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L571" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id, gtkState)) {</span>
<span class="nc" id="L572">                return;</span>
            }
<span class="nc" id="L574">            ENGINE.startPainting(g, x, y, w, h, id, gtkState);</span>
<span class="nc" id="L575">            ENGINE.paintBox(g, context, id, gtkState,</span>
                    ShadowType.OUT, &quot;menu&quot;, x, y, w, h);

<span class="nc" id="L578">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L579">            int xThickness = style.getXThickness();</span>
<span class="nc" id="L580">            int yThickness = style.getYThickness();</span>
<span class="nc" id="L581">            ENGINE.paintBackground(g, context, id, gtkState,</span>
<span class="nc" id="L582">                    style.getGTKColor(context, gtkState, GTKColorType.BACKGROUND),</span>
                    x + xThickness, y + yThickness,
                    w - xThickness - xThickness, h - yThickness - yThickness);
<span class="nc" id="L585">            ENGINE.finishPainting();</span>
<span class="nc" id="L586">        }</span>
<span class="nc" id="L587">    }</span>

    public void paintProgressBarBackground(SynthContext context,
                                            Graphics g,
                                            int x, int y, int w, int h) {
<span class="nc" id="L592">        Region id = context.getRegion();</span>
<span class="nc" id="L593">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L594" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L595">                ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L596">                ENGINE.paintBox(g, context, id, SynthConstants.ENABLED,</span>
                        ShadowType.IN, &quot;trough&quot;, x, y, w, h);
<span class="nc" id="L598">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L600">        }</span>
<span class="nc" id="L601">    }</span>

    public void paintProgressBarForeground(SynthContext context, Graphics g,
                                            int x, int y, int w, int h,
                                            int orientation) {
<span class="nc" id="L606">        Region id = context.getRegion();</span>
<span class="nc" id="L607">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
            // Note that we don't call paintCachedImage() here.  Since the
            // progress bar foreground is painted differently for each value
            // it would be wasteful to try to cache an image for each state,
            // so instead we simply avoid caching in this case.
<span class="nc bnc" id="L612" title="All 4 branches missed.">            if (w &lt;= 0 || h &lt;= 0) {</span>
<span class="nc" id="L613">                return;</span>
            }
<span class="nc" id="L615">            ENGINE.startPainting(g, x, y, w, h, id, &quot;fg&quot;);</span>
<span class="nc" id="L616">            ENGINE.paintBox(g, context, id, SynthConstants.MOUSE_OVER,</span>
                            ShadowType.OUT, &quot;bar&quot;, x, y, w, h);
<span class="nc" id="L618">            ENGINE.finishPainting(false); // don't bother caching the image</span>
<span class="nc" id="L619">        }</span>
<span class="nc" id="L620">    }</span>

    public void paintViewportBorder(SynthContext context, Graphics g,
                                           int x, int y, int w, int h) {
<span class="nc" id="L624">        Region id = context.getRegion();</span>
<span class="nc" id="L625">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L626" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L627">                ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L628">                ENGINE.paintShadow(g, context, id, SynthConstants.ENABLED,</span>
                        ShadowType.IN, &quot;scrolled_window&quot;, x, y, w, h);
<span class="nc" id="L630">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L632">        }</span>
<span class="nc" id="L633">    }</span>

    public void paintSeparatorBackground(SynthContext context,
                                          Graphics g,
                                          int x, int y, int w, int h,
                                         int orientation) {
<span class="nc" id="L639">        Region id = context.getRegion();</span>
<span class="nc" id="L640">        int state = context.getComponentState();</span>
<span class="nc" id="L641">        JComponent c = context.getComponent();</span>

        /*
         * Note: In theory, the style's x/y thickness values would determine
         * the width of the separator content.  In practice, however, some
         * engines will render a line that is wider than the corresponding
         * thickness value.  For example, ubuntulooks reports x/y thickness
         * values of 1 for separators, but always renders a 2-pixel wide line.
         * As a result of all this, we need to be careful not to restrict
         * the w/h values below too much, so that the full thickness of the
         * rendered line will be captured by our image caching code.
         */
        String detail;
<span class="nc bnc" id="L654" title="All 2 branches missed.">        if (c instanceof JToolBar.Separator) {</span>
            /*
             * GTK renders toolbar separators differently in that an
             * artificial padding is added to each end of the separator.
             * The value of 0.2f below is derived from the source code of
             * gtktoolbar.c in the current version of GTK+ (2.8.20 at the
             * time of this writing).  Specifically, the relevant values are:
             *     SPACE_LINE_DIVISION 10.0
             *     SPACE_LINE_START     2.0
             *     SPACE_LINE_END       8.0
             * These are used to determine the distance from the top (or left)
             * edge of the toolbar to the other edge.  So for example, the
             * starting/top point of a vertical separator is 2/10 of the
             * height of a horizontal toolbar away from the top edge, which
             * is how we arrive at 0.2f below.  Likewise, the ending/bottom
             * point is 8/10 of the height away from the top edge, or in other
             * words, it is 2/10 away from the bottom edge, which is again
             * how we arrive at the 0.2f value below.
             *
             * The separator is also centered horizontally or vertically,
             * depending on its orientation.  This was determined empirically
             * and by examining the code referenced above.
             */
<span class="nc" id="L677">            detail = &quot;toolbar&quot;;</span>
<span class="nc" id="L678">            float pct = 0.2f;</span>
<span class="nc" id="L679">            JToolBar.Separator sep = (JToolBar.Separator)c;</span>
<span class="nc" id="L680">            Dimension size = sep.getSeparatorSize();</span>
<span class="nc" id="L681">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc bnc" id="L682" title="All 2 branches missed.">            if (orientation == JSeparator.HORIZONTAL) {</span>
<span class="nc" id="L683">                x += (int)(w * pct);</span>
<span class="nc" id="L684">                w -= (int)(w * pct * 2);</span>
<span class="nc" id="L685">                y += (size.height - style.getYThickness()) / 2;</span>
            } else {
<span class="nc" id="L687">                y += (int)(h * pct);</span>
<span class="nc" id="L688">                h -= (int)(h * pct * 2);</span>
<span class="nc" id="L689">                x += (size.width - style.getXThickness()) / 2;</span>
            }
<span class="nc" id="L691">        } else {</span>
            // For regular/menu separators, we simply subtract out the insets.
<span class="nc" id="L693">            detail = &quot;separator&quot;;</span>
<span class="nc" id="L694">            Insets insets = c.getInsets();</span>
<span class="nc" id="L695">            x += insets.left;</span>
<span class="nc" id="L696">            y += insets.top;</span>
<span class="nc bnc" id="L697" title="All 2 branches missed.">            if (orientation == JSeparator.HORIZONTAL) {</span>
<span class="nc" id="L698">                w -= (insets.left + insets.right);</span>
            } else {
<span class="nc" id="L700">                h -= (insets.top + insets.bottom);</span>
            }
        }

<span class="nc" id="L704">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L705" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id,</span>
<span class="nc" id="L706">                                          state, detail, orientation)) {</span>
<span class="nc" id="L707">                ENGINE.startPainting(g, x, y, w, h, id,</span>
<span class="nc" id="L708">                                     state, detail, orientation);</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">                if (orientation == JSeparator.HORIZONTAL) {</span>
<span class="nc" id="L710">                    ENGINE.paintHline(g, context, id, state,</span>
                                      detail, x, y, w, h);
                } else {
<span class="nc" id="L713">                    ENGINE.paintVline(g, context, id, state,</span>
                                      detail, x, y, w, h);
                }
<span class="nc" id="L716">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L718">        }</span>
<span class="nc" id="L719">    }</span>

    public void paintSliderTrackBackground(SynthContext context,
                                       Graphics g,
                                       int x, int y, int w,int h) {
<span class="nc" id="L724">        Region id = context.getRegion();</span>
<span class="nc" id="L725">        int state = context.getComponentState();</span>

        // For focused sliders, we paint focus rect outside the bounds passed.
        // Need to adjust for that.
<span class="nc bnc" id="L729" title="All 2 branches missed.">        boolean focused = ((state &amp; SynthConstants.FOCUSED) != 0);</span>
<span class="nc" id="L730">        int focusSize = 0;</span>
<span class="nc bnc" id="L731" title="All 2 branches missed.">        if (focused) {</span>
<span class="nc" id="L732">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L733">            focusSize = style.getClassSpecificIntValue(</span>
                                context, &quot;focus-line-width&quot;, 1) +
<span class="nc" id="L735">                        style.getClassSpecificIntValue(</span>
                                context, &quot;focus-padding&quot;, 1);
<span class="nc" id="L737">            x -= focusSize;</span>
<span class="nc" id="L738">            y -= focusSize;</span>
<span class="nc" id="L739">            w += focusSize * 2;</span>
<span class="nc" id="L740">            h += focusSize * 2;</span>
        }

        // The ubuntulooks engine paints slider troughs differently depending
        // on the current slider value and its component orientation.
<span class="nc" id="L745">        JSlider slider = (JSlider)context.getComponent();</span>
<span class="nc" id="L746">        double value = slider.getValue();</span>
<span class="nc" id="L747">        double min = slider.getMinimum();</span>
<span class="nc" id="L748">        double max = slider.getMaximum();</span>
<span class="nc" id="L749">        double visible = 20; // not used for sliders; any value will work</span>

<span class="nc" id="L751">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
            // Note that we don't call paintCachedImage() here.  Since some
            // engines (e.g. ubuntulooks) paint the slider background
            // differently for any given slider value, it would be wasteful
            // to try to cache an image for each state, so instead we simply
            // avoid caching in this case.
<span class="nc bnc" id="L757" title="All 4 branches missed.">            if (w &lt;= 0 || h &lt;= 0) {</span>
<span class="nc" id="L758">                return;</span>
            }
<span class="nc" id="L760">            ENGINE.startPainting(g, x, y, w, h, id, state, value);</span>
<span class="nc" id="L761">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L762">            ENGINE.setRangeValue(context, id, value, min, max, visible);</span>
<span class="nc" id="L763">            ENGINE.paintBox(g, context, id, gtkState, ShadowType.IN,</span>
                            &quot;trough&quot;, x + focusSize, y + focusSize,
                            w - 2 * focusSize, h - 2 * focusSize);
<span class="nc bnc" id="L766" title="All 2 branches missed.">            if (focused) {</span>
<span class="nc" id="L767">                ENGINE.paintFocus(g, context, id, SynthConstants.ENABLED,</span>
                                  &quot;trough&quot;, x, y, w, h);
            }
<span class="nc" id="L770">            ENGINE.finishPainting(false); // don't bother caching the image</span>
<span class="nc" id="L771">        }</span>
<span class="nc" id="L772">    }</span>

    public void paintSliderThumbBackground(SynthContext context,
            Graphics g, int x, int y, int w, int h, int dir) {
<span class="nc" id="L776">        Region id = context.getRegion();</span>
<span class="nc" id="L777">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L778">                id, context.getComponentState());</span>
<span class="nc" id="L779">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L780" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, gtkState, dir)) {</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">                Orientation orientation = (dir == JSlider.HORIZONTAL ?</span>
                    Orientation.HORIZONTAL : Orientation.VERTICAL);
<span class="nc bnc" id="L783" title="All 2 branches missed.">                String detail = (dir == JSlider.HORIZONTAL ?</span>
                    &quot;hscale&quot; : &quot;vscale&quot;);
<span class="nc" id="L785">                ENGINE.startPainting(g, x, y, w, h, id, gtkState, dir);</span>
<span class="nc" id="L786">                ENGINE.paintSlider(g, context, id, gtkState,</span>
                        ShadowType.OUT, detail, x, y, w, h, orientation);
<span class="nc" id="L788">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L790">        }</span>
<span class="nc" id="L791">    }</span>

    //
    // SPINNER
    //
    public void paintSpinnerBackground(SynthContext context,
                                        Graphics g,
                                        int x, int y, int w, int h) {
        // This is handled in paintTextFieldBackground
<span class="nc" id="L800">    }</span>

    //
    // SPLIT_PANE_DIVIDER
    //
    public void paintSplitPaneDividerBackground(SynthContext context,
                                       Graphics g,
                                       int x, int y, int w, int h) {
<span class="nc" id="L808">        Region id = context.getRegion();</span>
<span class="nc" id="L809">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L810">                id, context.getComponentState());</span>
<span class="nc" id="L811">        JSplitPane splitPane = (JSplitPane)context.getComponent();</span>
<span class="nc" id="L812">        Orientation orientation =</span>
<span class="nc bnc" id="L813" title="All 2 branches missed.">                (splitPane.getOrientation() == JSplitPane.HORIZONTAL_SPLIT ?</span>
                    Orientation.VERTICAL : Orientation.HORIZONTAL);
<span class="nc" id="L815">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L816" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h,</span>
<span class="nc" id="L817">                    id, gtkState, orientation)) {</span>
<span class="nc" id="L818">                ENGINE.startPainting(g, x, y, w, h, id, gtkState, orientation);</span>
<span class="nc" id="L819">                ENGINE.paintHandle(g, context, id, gtkState,</span>
                        ShadowType.OUT, &quot;paned&quot;, x, y, w, h, orientation);
<span class="nc" id="L821">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L823">        }</span>
<span class="nc" id="L824">    }</span>

    public void paintSplitPaneDragDivider(SynthContext context,
                                       Graphics g,int x, int y, int w, int h,
                                       int orientation) {
<span class="nc" id="L829">        paintSplitPaneDividerForeground(context, g, x, y, w, h, orientation);</span>
<span class="nc" id="L830">    }</span>

    public void paintTabbedPaneContentBackground(SynthContext context,
                                      Graphics g, int x, int y, int w, int h) {
<span class="nc" id="L834">        JTabbedPane pane = (JTabbedPane)context.getComponent();</span>
<span class="nc" id="L835">        int selectedIndex = pane.getSelectedIndex();</span>
<span class="nc" id="L836">        PositionType placement = GTKLookAndFeel.SwingOrientationConstantToGTK(</span>
<span class="nc" id="L837">                                                        pane.getTabPlacement());</span>

<span class="nc" id="L839">        int gapStart = 0;</span>
<span class="nc" id="L840">        int gapSize = 0;</span>
<span class="nc bnc" id="L841" title="All 2 branches missed.">        if (selectedIndex != -1) {</span>
<span class="nc" id="L842">            Rectangle tabBounds = pane.getBoundsAt(selectedIndex);</span>

<span class="nc bnc" id="L844" title="All 4 branches missed.">            if (placement == PositionType.TOP ||</span>
                placement == PositionType.BOTTOM) {

<span class="nc" id="L847">                gapStart = tabBounds.x - x;</span>
<span class="nc" id="L848">                gapSize = tabBounds.width;</span>
            }
            else {
<span class="nc" id="L851">                gapStart = tabBounds.y - y;</span>
<span class="nc" id="L852">                gapSize = tabBounds.height;</span>
            }
        }

<span class="nc" id="L856">        Region id = context.getRegion();</span>
<span class="nc" id="L857">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L858">                id, context.getComponentState());</span>
<span class="nc" id="L859">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L860" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h,</span>
<span class="nc" id="L861">                    id, gtkState, placement, gapStart, gapSize)) {</span>
<span class="nc" id="L862">                ENGINE.startPainting(g, x, y, w, h,</span>
<span class="nc" id="L863">                        id, gtkState, placement, gapStart, gapSize);</span>
<span class="nc" id="L864">                ENGINE.paintBoxGap(g, context, id, gtkState, ShadowType.OUT,</span>
                        &quot;notebook&quot;, x, y, w, h, placement, gapStart, gapSize);
<span class="nc" id="L866">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L868">        }</span>
<span class="nc" id="L869">    }</span>

    public void paintTabbedPaneTabBackground(SynthContext context,
                                           Graphics g,
                                           int x, int y, int w, int h,
                                           int tabIndex) {
<span class="nc" id="L875">        Region id = context.getRegion();</span>
<span class="nc" id="L876">        int state = context.getComponentState();</span>
<span class="nc bnc" id="L877" title="All 2 branches missed.">        int gtkState = ((state &amp; SynthConstants.SELECTED) != 0 ?</span>
            SynthConstants.ENABLED : SynthConstants.PRESSED);
<span class="nc" id="L879">        JTabbedPane pane = (JTabbedPane)context.getComponent();</span>
<span class="nc" id="L880">        int placement = pane.getTabPlacement();</span>

<span class="nc" id="L882">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h,</span>
<span class="nc" id="L884">                    id, gtkState, placement, tabIndex)) {</span>
<span class="nc" id="L885">                PositionType side = POSITIONS[placement - 1];</span>
<span class="nc" id="L886">                ENGINE.startPainting(g, x, y, w, h,</span>
<span class="nc" id="L887">                        id, gtkState, placement, tabIndex);</span>
<span class="nc" id="L888">                ENGINE.paintExtension(g, context, id, gtkState,</span>
                        ShadowType.OUT, &quot;tab&quot;, x, y, w, h, side, tabIndex);
<span class="nc" id="L890">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L892">        }</span>
<span class="nc" id="L893">    }</span>

    //
    // TEXT_PANE
    //
    public void paintTextPaneBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
<span class="nc" id="L900">        paintTextAreaBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L901">    }</span>

    //
    // EDITOR_PANE
    //
    public void paintEditorPaneBackground(SynthContext context, Graphics g,
                                          int x, int y, int w, int h) {
<span class="nc" id="L908">        paintTextAreaBackground(context, g, x, y, w, h);</span>
<span class="nc" id="L909">    }</span>

    //
    // TEXT_AREA
    //
    public void paintTextAreaBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
        // Does not call into ENGINE for better performance
<span class="nc" id="L917">        fillArea(context, g, x, y, w, h, GTKColorType.TEXT_BACKGROUND);</span>
<span class="nc" id="L918">    }</span>

    //
    // TEXT_FIELD
    //
    // NOTE: Combobox and Label, Password and FormattedTextField calls this
    // too.
    private void paintTextBackground(SynthContext context, Graphics g,
                                     int x, int y, int w, int h) {
        // Text is odd in that it uses the TEXT_BACKGROUND vs BACKGROUND.
<span class="nc" id="L928">        JComponent c = context.getComponent();</span>
<span class="nc" id="L929">        Container container = c.getParent();</span>
<span class="nc" id="L930">        Container containerParent = null;</span>
<span class="nc" id="L931">        GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L932">        Region id = context.getRegion();</span>
<span class="nc" id="L933">        int state = context.getComponentState();</span>

<span class="nc bnc" id="L935" title="All 4 branches missed.">        if (c instanceof ListCellRenderer &amp;&amp; container != null) {</span>
<span class="nc" id="L936">            containerParent = container.getParent();</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">            if (containerParent instanceof JComboBox</span>
<span class="nc bnc" id="L938" title="All 2 branches missed.">                    &amp;&amp; containerParent.hasFocus()) {</span>
<span class="nc" id="L939">                state |= SynthConstants.FOCUSED;</span>
            }
        }

<span class="nc" id="L943">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L944" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id, state)) {</span>
<span class="nc" id="L945">                return;</span>
            }

<span class="nc" id="L948">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L949">            int focusSize = 0;</span>
<span class="nc" id="L950">            boolean interiorFocus = style.getClassSpecificBoolValue(</span>
                    context, &quot;interior-focus&quot;, true);

<span class="nc" id="L953">            focusSize = style.getClassSpecificIntValue(context,</span>
                    &quot;focus-line-width&quot;,1);
<span class="nc bnc" id="L955" title="All 4 branches missed.">            if (!interiorFocus &amp;&amp; (state &amp; SynthConstants.FOCUSED) != 0) {</span>
<span class="nc" id="L956">                x += focusSize;</span>
<span class="nc" id="L957">                y += focusSize;</span>
<span class="nc" id="L958">                w -= 2 * focusSize;</span>
<span class="nc" id="L959">                h -= 2 * focusSize;</span>
            }

<span class="nc" id="L962">            int xThickness = style.getXThickness();</span>
<span class="nc" id="L963">            int yThickness = style.getYThickness();</span>

<span class="nc" id="L965">            ENGINE.startPainting(g, x, y, w, h, id, state);</span>
<span class="nc" id="L966">            ENGINE.paintShadow(g, context, id, gtkState,</span>
                               ShadowType.IN, &quot;entry&quot;, x, y, w, h);
<span class="nc" id="L968">            ENGINE.paintFlatBox(g, context, id,</span>
                                gtkState, ShadowType.NONE, &quot;entry_bg&quot;,
                                x + xThickness,
                                y + yThickness,
                                w - (2 * xThickness),
                                h - (2 * yThickness),
                                ColorType.TEXT_BACKGROUND);

<span class="nc bnc" id="L976" title="All 4 branches missed.">            if (focusSize &gt; 0 &amp;&amp; (state &amp; SynthConstants.FOCUSED) != 0) {</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">                if (!interiorFocus) {</span>
<span class="nc" id="L978">                    x -=  focusSize;</span>
<span class="nc" id="L979">                    y -=  focusSize;</span>
<span class="nc" id="L980">                    w +=  2 * focusSize;</span>
<span class="nc" id="L981">                    h +=  2 * focusSize;</span>
                } else {
<span class="nc bnc" id="L983" title="All 2 branches missed.">                    if (containerParent instanceof JComboBox) {</span>
<span class="nc" id="L984">                        x += (focusSize + 2);</span>
<span class="nc" id="L985">                        y += (focusSize + 1);</span>
<span class="nc" id="L986">                        w -= (2 * focusSize + 1);</span>
<span class="nc" id="L987">                        h -= (2 * focusSize + 2);</span>
                    } else {
<span class="nc" id="L989">                        x += focusSize;</span>
<span class="nc" id="L990">                        y += focusSize;</span>
<span class="nc" id="L991">                        w -= 2 * focusSize;</span>
<span class="nc" id="L992">                        h -= 2 * focusSize;</span>
                    }
                }
<span class="nc" id="L995">                ENGINE.paintFocus(g, context, id, gtkState,</span>
                        &quot;entry&quot;, x, y, w, h);
            }
<span class="nc" id="L998">            ENGINE.finishPainting();</span>
<span class="nc" id="L999">        }</span>
<span class="nc" id="L1000">    }</span>

    private void paintTreeCellEditorBackground(SynthContext context, Graphics g,
                                               int x, int y, int w, int h) {
<span class="nc" id="L1004">        Region id = context.getRegion();</span>
<span class="nc" id="L1005">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L1006">                id, context.getComponentState());</span>
<span class="nc" id="L1007">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1008" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, gtkState)) {</span>
<span class="nc" id="L1009">                ENGINE.startPainting(g, x, y, w, h, id, gtkState);</span>
<span class="nc" id="L1010">                ENGINE.paintFlatBox(g, context, id, gtkState, ShadowType.NONE,</span>
                        &quot;entry_bg&quot;, x, y, w, h, ColorType.TEXT_BACKGROUND);
<span class="nc" id="L1012">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1014">        }</span>
<span class="nc" id="L1015">    }</span>


    //
    // ROOT_PANE
    //
    public void paintRootPaneBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
        // Does not call into ENGINE for better performance
<span class="nc" id="L1024">        fillArea(context, g, x, y, w, h, GTKColorType.BACKGROUND);</span>
<span class="nc" id="L1025">    }</span>

    //
    // TOGGLE_BUTTON
    //
    public void paintToggleButtonBackground(SynthContext context,
                                            Graphics g,
                                            int x, int y, int w, int h) {
<span class="nc" id="L1033">        Region id = context.getRegion();</span>
<span class="nc" id="L1034">        JToggleButton toggleButton = (JToggleButton)context.getComponent();</span>
<span class="nc bnc" id="L1035" title="All 2 branches missed.">        boolean paintBG = toggleButton.isContentAreaFilled() &amp;&amp;</span>
<span class="nc bnc" id="L1036" title="All 2 branches missed.">                          toggleButton.isBorderPainted();</span>
<span class="nc" id="L1037">        boolean paintFocus = toggleButton.isFocusPainted();</span>
<span class="nc" id="L1038">        boolean toolButton = (toggleButton.getParent() instanceof JToolBar);</span>
<span class="nc" id="L1039">        paintButtonBackgroundImpl(context, g, id, &quot;button&quot;,</span>
                                  x, y, w, h,
                                  paintBG, paintFocus, false, toolButton);
<span class="nc" id="L1042">    }</span>


    //
    // SCROLL_BAR
    //
    public void paintScrollBarBackground(SynthContext context,
                                          Graphics g,
                                          int x, int y, int w,int h) {
<span class="nc" id="L1051">        Region id = context.getRegion();</span>
<span class="nc" id="L1052">        boolean focused =</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">                (context.getComponentState() &amp; SynthConstants.FOCUSED) != 0;</span>
<span class="nc" id="L1054">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1055" title="All 2 branches missed.">            if (ENGINE.paintCachedImage(g, x, y, w, h, id, focused)) {</span>
<span class="nc" id="L1056">                return;</span>
            }
<span class="nc" id="L1058">            ENGINE.startPainting(g, x, y, w, h, id, focused);</span>

            // Note: the scrollbar insets already include the &quot;trough-border&quot;,
            // which is needed to position the scrollbar buttons properly.
            // But when we render, we need to take the trough border out
            // of the equation so that we paint the entire area covered by
            // the trough border and the scrollbar content itself.
<span class="nc" id="L1065">            Insets insets = context.getComponent().getInsets();</span>
<span class="nc" id="L1066">            GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L1067">            int troughBorder =</span>
<span class="nc" id="L1068">                style.getClassSpecificIntValue(context, &quot;trough-border&quot;, 1);</span>
<span class="nc" id="L1069">            insets.left   -= troughBorder;</span>
<span class="nc" id="L1070">            insets.right  -= troughBorder;</span>
<span class="nc" id="L1071">            insets.top    -= troughBorder;</span>
<span class="nc" id="L1072">            insets.bottom -= troughBorder;</span>

<span class="nc" id="L1074">            ENGINE.paintBox(g, context, id, SynthConstants.PRESSED,</span>
                            ShadowType.IN, &quot;trough&quot;,
                            x + insets.left,
                            y + insets.top,
                            w - insets.left - insets.right,
                            h - insets.top - insets.bottom);

<span class="nc bnc" id="L1081" title="All 2 branches missed.">            if (focused) {</span>
<span class="nc" id="L1082">                ENGINE.paintFocus(g, context, id,</span>
                        SynthConstants.ENABLED, &quot;trough&quot;, x, y, w, h);
            }
<span class="nc" id="L1085">            ENGINE.finishPainting();</span>
<span class="nc" id="L1086">        }</span>
<span class="nc" id="L1087">    }</span>


    //
    // SCROLL_BAR_THUMB
    //
    public void paintScrollBarThumbBackground(SynthContext context,
            Graphics g, int x, int y, int w, int h, int dir) {
<span class="nc" id="L1095">        Region id = context.getRegion();</span>
<span class="nc" id="L1096">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L1097">                id, context.getComponentState());</span>

        // The clearlooks engine paints scrollbar thumbs differently
        // depending on the current scroll value (specifically, it will avoid
        // rendering a certain line when the thumb is at the starting or
        // ending position).  Therefore, we normalize the current value to
        // the range [0,100] here and then pass it down to setRangeValue()
        // so that the native widget is configured appropriately.  Note that
        // there are really only four values that matter (min, middle, max,
        // or fill) so we restrict to one of those four values to avoid
        // blowing out the image cache.
<span class="nc" id="L1108">        JScrollBar sb = (JScrollBar)context.getComponent();</span>
<span class="nc" id="L1109">        boolean rtl =</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">            sb.getOrientation() == JScrollBar.HORIZONTAL &amp;&amp;</span>
<span class="nc bnc" id="L1111" title="All 2 branches missed.">            !sb.getComponentOrientation().isLeftToRight();</span>
<span class="nc" id="L1112">        double min = 0;</span>
<span class="nc" id="L1113">        double max = 100;</span>
<span class="nc" id="L1114">        double visible = 20;</span>
        double value;
<span class="nc bnc" id="L1116" title="All 2 branches missed.">        if (sb.getMaximum() - sb.getMinimum() == sb.getVisibleAmount()) {</span>
            // In this case, the thumb fills the entire track, so it is
            // touching both ends at the same time
<span class="nc" id="L1119">            value = 0;</span>
<span class="nc" id="L1120">            visible = 100;</span>
<span class="nc bnc" id="L1121" title="All 2 branches missed.">        } else if (sb.getValue() == sb.getMinimum()) {</span>
            // At minimum
<span class="nc bnc" id="L1123" title="All 2 branches missed.">            value = rtl ? 100 : 0;</span>
<span class="nc bnc" id="L1124" title="All 2 branches missed.">        } else if (sb.getValue() &gt;= sb.getMaximum() - sb.getVisibleAmount()) {</span>
            // At maximum
<span class="nc bnc" id="L1126" title="All 2 branches missed.">            value = rtl ? 0 : 100;</span>
        } else {
            // Somewhere in between
<span class="nc" id="L1129">            value = 50;</span>
        }

<span class="nc" id="L1132">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1133" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, gtkState,</span>
<span class="nc" id="L1134">                                          dir, value, visible, rtl))</span>
            {
<span class="nc" id="L1136">                ENGINE.startPainting(g, x, y, w, h, id, gtkState,</span>
<span class="nc" id="L1137">                                     dir, value, visible, rtl);</span>
<span class="nc bnc" id="L1138" title="All 2 branches missed.">                Orientation orientation = (dir == JScrollBar.HORIZONTAL ?</span>
                    Orientation.HORIZONTAL : Orientation.VERTICAL);
<span class="nc" id="L1140">                ENGINE.setRangeValue(context, id, value, min, max, visible);</span>
<span class="nc" id="L1141">                ENGINE.paintSlider(g, context, id, gtkState,</span>
                        ShadowType.OUT, &quot;slider&quot;, x, y, w, h, orientation);
<span class="nc" id="L1143">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1145">        }</span>
<span class="nc" id="L1146">    }</span>

    //
    // TOOL_TIP
    //
    public void paintToolTipBackground(SynthContext context, Graphics g,
                                        int x, int y, int w,int h) {
<span class="nc" id="L1153">        Region id = context.getRegion();</span>
<span class="nc" id="L1154">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1155" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L1156">                ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L1157">                ENGINE.paintFlatBox(g, context, id, SynthConstants.ENABLED,</span>
                        ShadowType.OUT, &quot;tooltip&quot;, x, y, w, h,
                        ColorType.BACKGROUND);
<span class="nc" id="L1160">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1162">        }</span>
<span class="nc" id="L1163">    }</span>


    //
    // TREE_CELL
    //
    public void paintTreeCellBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
<span class="nc" id="L1171">        Region id = context.getRegion();</span>
<span class="nc" id="L1172">        int state = context.getComponentState();</span>
<span class="nc" id="L1173">        int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L1174">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1175" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, state)) {</span>
<span class="nc" id="L1176">                ENGINE.startPainting(g, x, y, w, h, id, state);</span>
                // the string arg should alternate based on row being painted,
                // but we currently don't pass that in.
<span class="nc" id="L1179">                ENGINE.paintFlatBox(g, context, id, gtkState, ShadowType.NONE,</span>
                        &quot;cell_odd&quot;, x, y, w, h, ColorType.TEXT_BACKGROUND);
<span class="nc" id="L1181">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1183">        }</span>
<span class="nc" id="L1184">    }</span>

    public void paintTreeCellFocus(SynthContext context, Graphics g,
                                    int x, int y, int w, int h) {
<span class="nc" id="L1188">        Region id = Region.TREE_CELL;</span>
<span class="nc" id="L1189">        int state = context.getComponentState();</span>
<span class="nc" id="L1190">        paintFocus(context, g, id, state, &quot;treeview&quot;, x, y, w, h);</span>
<span class="nc" id="L1191">    }</span>


    //
    // TREE
    //
    public void paintTreeBackground(SynthContext context, Graphics g,
                                    int x, int y, int w, int h) {
        // As far as I can tell, these don't call into the ENGINE.
<span class="nc" id="L1200">        fillArea(context, g, x, y, w, h, GTKColorType.TEXT_BACKGROUND);</span>
<span class="nc" id="L1201">    }</span>


    //
    // VIEWPORT
    //
    public void paintViewportBackground(SynthContext context, Graphics g,
                                        int x, int y, int w, int h) {
        // As far as I can tell, these don't call into the ENGINE.
        // Also note that you don't want this to call into the ENGINE
        // as if it where to paint a background JViewport wouldn't scroll
        // correctly.
<span class="nc" id="L1213">        fillArea(context, g, x, y, w, h, GTKColorType.TEXT_BACKGROUND);</span>
<span class="nc" id="L1214">    }</span>

    void paintFocus(SynthContext context, Graphics g, Region id,
            int state, String detail, int x, int y, int w, int h) {
<span class="nc" id="L1218">        int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>
<span class="nc" id="L1219">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1220" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, id, gtkState, &quot;focus&quot;)) {</span>
<span class="nc" id="L1221">                ENGINE.startPainting(g, x, y, w, h, id, gtkState, &quot;focus&quot;);</span>
<span class="nc" id="L1222">                ENGINE.paintFocus(g, context, id, gtkState, detail, x, y, w, h);</span>
<span class="nc" id="L1223">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1225">        }</span>
<span class="nc" id="L1226">    }</span>

    void paintMetacityElement(SynthContext context, Graphics g,
            int gtkState, String detail, int x, int y, int w, int h,
            ShadowType shadow, ArrowType direction) {
<span class="nc" id="L1231">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1232" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(</span>
<span class="nc" id="L1233">                    g, x, y, w, h, gtkState, detail, shadow, direction)) {</span>
<span class="nc" id="L1234">                ENGINE.startPainting(</span>
<span class="nc" id="L1235">                        g, x, y, w, h, gtkState, detail, shadow, direction);</span>
<span class="nc bnc" id="L1236" title="All 2 branches missed.">                if (detail == &quot;metacity-arrow&quot;) {</span>
<span class="nc" id="L1237">                    ENGINE.paintArrow(g, context, Region.INTERNAL_FRAME_TITLE_PANE,</span>
                            gtkState, shadow, direction, &quot;&quot;, x, y, w, h);

<span class="nc bnc" id="L1240" title="All 2 branches missed.">                } else if (detail == &quot;metacity-box&quot;) {</span>
<span class="nc" id="L1241">                    ENGINE.paintBox(g, context, Region.INTERNAL_FRAME_TITLE_PANE,</span>
                            gtkState, shadow, &quot;&quot;, x, y, w, h);

<span class="nc bnc" id="L1244" title="All 2 branches missed.">                } else if (detail == &quot;metacity-vline&quot;) {</span>
<span class="nc" id="L1245">                    ENGINE.paintVline(g, context, Region.INTERNAL_FRAME_TITLE_PANE,</span>
                            gtkState, &quot;&quot;, x, y, w, h);
                }
<span class="nc" id="L1248">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1250">        }</span>
<span class="nc" id="L1251">    }</span>

    void paintIcon(SynthContext context, Graphics g,
            Method paintMethod, int x, int y, int w, int h) {
<span class="nc" id="L1255">        int state = context.getComponentState();</span>
<span class="nc" id="L1256">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1257" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g, x, y, w, h, state, paintMethod)) {</span>
<span class="nc" id="L1258">                ENGINE.startPainting(g, x, y, w, h, state, paintMethod);</span>
                try {
<span class="nc" id="L1260">                    paintMethod.invoke(this, context, g, state, x, y, w, h);</span>
<span class="nc" id="L1261">                } catch (IllegalAccessException iae) {</span>
<span class="nc bnc" id="L1262" title="All 2 branches missed.">                    assert false;</span>
<span class="nc" id="L1263">                } catch (InvocationTargetException ite) {</span>
<span class="nc bnc" id="L1264" title="All 2 branches missed.">                    assert false;</span>
<span class="nc" id="L1265">                }</span>
<span class="nc" id="L1266">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1268">        }</span>
<span class="nc" id="L1269">    }</span>

    void paintIcon(SynthContext context, Graphics g,
            Method paintMethod, int x, int y, int w, int h, Object direction) {
<span class="nc" id="L1273">        int state = context.getComponentState();</span>
<span class="nc" id="L1274">        synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1275" title="All 2 branches missed.">            if (! ENGINE.paintCachedImage(g,</span>
<span class="nc" id="L1276">                    x, y, w, h, state, paintMethod, direction)) {</span>
<span class="nc" id="L1277">                ENGINE.startPainting(g,</span>
<span class="nc" id="L1278">                        x, y, w, h, state, paintMethod, direction);</span>
                try {
<span class="nc" id="L1280">                    paintMethod.invoke(this, context,</span>
<span class="nc" id="L1281">                            g, state, x, y, w, h, direction);</span>
<span class="nc" id="L1282">                } catch (IllegalAccessException iae) {</span>
<span class="nc bnc" id="L1283" title="All 2 branches missed.">                    assert false;</span>
<span class="nc" id="L1284">                } catch (InvocationTargetException ite) {</span>
<span class="nc bnc" id="L1285" title="All 2 branches missed.">                    assert false;</span>
<span class="nc" id="L1286">                }</span>
<span class="nc" id="L1287">                ENGINE.finishPainting();</span>
            }
<span class="nc" id="L1289">        }</span>
<span class="nc" id="L1290">    }</span>

    // All icon painting methods are called from under GTK_LOCK

    public void paintTreeExpandedIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1296">        ENGINE.paintExpander(g, context, Region.TREE,</span>
<span class="nc" id="L1297">                GTKLookAndFeel.synthStateToGTKState(context.getRegion(), state),</span>
                ExpanderStyle.EXPANDED, &quot;treeview&quot;, x, y, w, h);
<span class="nc" id="L1299">    }</span>

    public void paintTreeCollapsedIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1303">        ENGINE.paintExpander(g, context, Region.TREE,</span>
<span class="nc" id="L1304">                GTKLookAndFeel.synthStateToGTKState(context.getRegion(), state),</span>
                ExpanderStyle.COLLAPSED, &quot;treeview&quot;, x, y, w, h);
<span class="nc" id="L1306">    }</span>

    public void paintCheckBoxIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1310">        GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L1311">        int size = style.getClassSpecificIntValue(context,</span>
                        &quot;indicator-size&quot;, GTKIconFactory.DEFAULT_ICON_SIZE);
<span class="nc" id="L1313">        int offset = style.getClassSpecificIntValue(context,</span>
                        &quot;indicator-spacing&quot;, GTKIconFactory.DEFAULT_ICON_SPACING);

<span class="nc" id="L1316">        ENGINE.paintCheck(g, context, Region.CHECK_BOX, &quot;checkbutton&quot;,</span>
                x+offset, y+offset, size, size);
<span class="nc" id="L1318">    }</span>

    public void paintRadioButtonIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1322">        GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L1323">        int size = style.getClassSpecificIntValue(context,</span>
                        &quot;indicator-size&quot;, GTKIconFactory.DEFAULT_ICON_SIZE);
<span class="nc" id="L1325">        int offset = style.getClassSpecificIntValue(context,</span>
                        &quot;indicator-spacing&quot;, GTKIconFactory.DEFAULT_ICON_SPACING);

<span class="nc" id="L1328">        ENGINE.paintOption(g, context, Region.RADIO_BUTTON, &quot;radiobutton&quot;,</span>
                x+offset, y+offset, size, size);
<span class="nc" id="L1330">    }</span>

    public void paintMenuArrowIcon(SynthContext context, Graphics g,
            int state, int x, int y, int w, int h, ArrowType dir) {
<span class="nc" id="L1334">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L1335">                context.getRegion(), state);</span>
<span class="nc" id="L1336">        ShadowType shadow = ShadowType.OUT;</span>
<span class="nc bnc" id="L1337" title="All 2 branches missed.">        if (gtkState == SynthConstants.MOUSE_OVER) {</span>
<span class="nc" id="L1338">            shadow = ShadowType.IN;</span>
        }
<span class="nc" id="L1340">        ENGINE.paintArrow(g, context, Region.MENU_ITEM, gtkState, shadow,</span>
                dir, &quot;menuitem&quot;, x + 3, y + 3, 7, 7);
<span class="nc" id="L1342">    }</span>

    public void paintCheckBoxMenuItemCheckIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {

<span class="nc" id="L1347">        GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L1348">        int size = style.getClassSpecificIntValue(context,&quot;indicator-size&quot;,</span>
                GTKIconFactory.DEFAULT_TOGGLE_MENU_ITEM_SIZE);

<span class="nc" id="L1351">        ENGINE.paintCheck(g, context, Region.CHECK_BOX_MENU_ITEM, &quot;check&quot;,</span>
                x + GTKIconFactory.CHECK_ICON_EXTRA_INSET,
                y + GTKIconFactory.CHECK_ICON_EXTRA_INSET,
                size, size);
<span class="nc" id="L1355">    }</span>

    public void paintRadioButtonMenuItemCheckIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {

<span class="nc" id="L1360">        GTKStyle style = (GTKStyle)context.getStyle();</span>
<span class="nc" id="L1361">        int size = style.getClassSpecificIntValue(context,&quot;indicator-size&quot;,</span>
                GTKIconFactory.DEFAULT_TOGGLE_MENU_ITEM_SIZE);

<span class="nc" id="L1364">        ENGINE.paintOption(g, context, Region.RADIO_BUTTON_MENU_ITEM, &quot;option&quot;,</span>
                x + GTKIconFactory.CHECK_ICON_EXTRA_INSET,
                y + GTKIconFactory.CHECK_ICON_EXTRA_INSET,
                size, size);
<span class="nc" id="L1368">    }</span>

    public void paintToolBarHandleIcon(SynthContext context, Graphics g,
            int state, int x, int y, int w, int h, Orientation orientation) {
<span class="nc" id="L1372">        int gtkState = GTKLookAndFeel.synthStateToGTKState(</span>
<span class="nc" id="L1373">                context.getRegion(), state);</span>

        // The orientation parameter passed down by Synth refers to the
        // orientation of the toolbar, but the one we pass to GTK refers
        // to the orientation of the handle.  Therefore, we need to swap
        // the value here: horizontal toolbars have vertical handles, and
        // vice versa.
<span class="nc bnc" id="L1380" title="All 2 branches missed.">        orientation = (orientation == Orientation.HORIZONTAL) ?</span>
            Orientation.VERTICAL : Orientation.HORIZONTAL;

<span class="nc" id="L1383">        ENGINE.paintHandle(g, context, Region.TOOL_BAR, gtkState,</span>
                ShadowType.OUT, &quot;handlebox&quot;, x, y, w, h, orientation);
<span class="nc" id="L1385">    }</span>

    public void paintAscendingSortIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1389">        ENGINE.paintArrow(g, context, Region.TABLE, SynthConstants.ENABLED,</span>
                ShadowType.IN, ArrowType.UP, &quot;arrow&quot;, x, y, w, h);
<span class="nc" id="L1391">    }</span>

    public void paintDescendingSortIcon(SynthContext context,
            Graphics g, int state, int x, int y, int w, int h) {
<span class="nc" id="L1395">        ENGINE.paintArrow(g, context, Region.TABLE, SynthConstants.ENABLED,</span>
                ShadowType.IN, ArrowType.DOWN, &quot;arrow&quot;, x, y, w, h);
<span class="nc" id="L1397">    }</span>

    /*
     * Fill an area with color determined from this context's Style using the
     * specified GTKColorType
     */
    private void fillArea(SynthContext context, Graphics g,
                          int x, int y, int w, int h, ColorType colorType) {
<span class="nc bnc" id="L1405" title="All 2 branches missed.">        if (context.getComponent().isOpaque()) {</span>
<span class="nc" id="L1406">            Region id = context.getRegion();</span>
<span class="nc" id="L1407">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id,</span>
<span class="nc" id="L1408">                    context.getComponentState());</span>
<span class="nc" id="L1409">            GTKStyle style = (GTKStyle)context.getStyle();</span>

<span class="nc" id="L1411">            g.setColor(style.getGTKColor(context, gtkState, colorType));</span>
<span class="nc" id="L1412">            g.fillRect(x, y, w, h);</span>
        }
<span class="nc" id="L1414">    }</span>

    // Refer to GTKLookAndFeel for details on this.
    static class ListTableFocusBorder extends AbstractBorder implements
                          UIResource {

        private boolean selectedCell;
        private boolean focusedCell;

        public static ListTableFocusBorder getSelectedCellBorder() {
<span class="nc" id="L1424">            return new ListTableFocusBorder(true, true);</span>
        }

        public static ListTableFocusBorder getUnselectedCellBorder() {
<span class="nc" id="L1428">            return new ListTableFocusBorder(false, true);</span>
        }

        public static ListTableFocusBorder getNoFocusCellBorder() {
<span class="nc" id="L1432">            return new ListTableFocusBorder(false, false);</span>
        }

<span class="nc" id="L1435">        public ListTableFocusBorder(boolean selectedCell, boolean focusedCell) {</span>
<span class="nc" id="L1436">            this.selectedCell = selectedCell;</span>
<span class="nc" id="L1437">            this.focusedCell = focusedCell;</span>
<span class="nc" id="L1438">        }</span>

        private SynthContext getContext(Component c) {
<span class="nc" id="L1441">            SynthContext context = null;</span>

<span class="nc" id="L1443">            ComponentUI ui = null;</span>
<span class="nc bnc" id="L1444" title="All 2 branches missed.">            if (c instanceof JLabel) {</span>
<span class="nc" id="L1445">                ui = ((JLabel)c).getUI();</span>
            }

<span class="nc bnc" id="L1448" title="All 2 branches missed.">            if (ui instanceof SynthUI) {</span>
<span class="nc" id="L1449">                context = ((SynthUI)ui).getContext((JComponent)c);</span>
            }

<span class="nc" id="L1452">            return context;</span>
        }

        public void paintBorder(Component c, Graphics g, int x, int y,
                                int w, int h) {
<span class="nc bnc" id="L1457" title="All 2 branches missed.">            if (focusedCell) {</span>
<span class="nc" id="L1458">                SynthContext context = getContext(c);</span>
<span class="nc bnc" id="L1459" title="All 2 branches missed.">                int state = (selectedCell? SynthConstants.SELECTED:</span>
                             SynthConstants.FOCUSED | SynthConstants.ENABLED);

<span class="nc bnc" id="L1462" title="All 2 branches missed.">                if (context != null) {</span>
<span class="nc" id="L1463">                    GTKPainter.INSTANCE.paintFocus(context, g,</span>
                            Region.TABLE, state, &quot;&quot;, x, y, w, h);
                }
            }
<span class="nc" id="L1467">        }</span>

        public Insets getBorderInsets(Component c, Insets i) {
<span class="nc" id="L1470">            SynthContext context = getContext(c);</span>

<span class="nc bnc" id="L1472" title="All 2 branches missed.">            if (context != null) {</span>
<span class="nc" id="L1473">                i = context.getStyle().getInsets(context, i);</span>
            }

<span class="nc" id="L1476">            return i;</span>
        }

        public boolean isBorderOpaque() {
<span class="nc" id="L1480">            return true;</span>
        }
    }

    // TitledBorder implementation for GTK L&amp;F
<span class="nc" id="L1485">    static class TitledBorder extends AbstractBorder implements UIResource {</span>

        public void paintBorder(Component c, Graphics g, int x, int y,
                                int w, int h) {
<span class="nc" id="L1489">            SynthContext context = getContext((JComponent)c);</span>
<span class="nc" id="L1490">            Region id = context.getRegion();</span>
<span class="nc" id="L1491">            int state = context.getComponentState();</span>
<span class="nc" id="L1492">            int gtkState = GTKLookAndFeel.synthStateToGTKState(id, state);</span>

<span class="nc" id="L1494">            synchronized (UNIXToolkit.GTK_LOCK) {</span>
<span class="nc bnc" id="L1495" title="All 2 branches missed.">                if (! ENGINE.paintCachedImage(g, x, y, w, h, id)) {</span>
<span class="nc" id="L1496">                    ENGINE.startPainting(g, x, y, w, h, id);</span>
<span class="nc" id="L1497">                    ENGINE.paintShadow(g, context, id, gtkState, ShadowType.ETCHED_IN,</span>
                                      &quot;frame&quot;, x, y, w, h);
<span class="nc" id="L1499">                    ENGINE.finishPainting();</span>
                }
<span class="nc" id="L1501">            }</span>
<span class="nc" id="L1502">        }</span>

        public Insets getBorderInsets(Component c, Insets i) {
<span class="nc" id="L1505">            SynthContext context = getContext((JComponent)c);</span>
<span class="nc" id="L1506">            return context.getStyle().getInsets(context, i);</span>
        }

        public boolean isBorderOpaque() {
<span class="nc" id="L1510">            return true;</span>
        }

        private SynthStyle getStyle(JComponent c) {
<span class="nc" id="L1514">            return SynthLookAndFeel.getStyle(c, GTKEngine.CustomRegion.TITLED_BORDER);</span>
        }

        private SynthContext getContext(JComponent c) {
<span class="nc" id="L1518">            int state = SynthConstants.DEFAULT;</span>
<span class="nc" id="L1519">            return new SynthContext(c, GTKEngine.CustomRegion.TITLED_BORDER,</span>
<span class="nc" id="L1520">                                    getStyle(c), state);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>