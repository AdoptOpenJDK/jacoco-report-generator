<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>BasicInternalFrameUI.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.basic</a> &gt; <span class="el_source">BasicInternalFrameUI.java</span></div><h1>BasicInternalFrameUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2009, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.basic;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.plaf.*;
import javax.swing.event.*;
import java.beans.*;
import sun.swing.DefaultLookup;
import sun.swing.UIAction;

/**
 * A basic L&amp;amp;F implementation of JInternalFrame.
 *
 * @author David Kloba
 * @author Rich Schiavi
 */
public class BasicInternalFrameUI extends InternalFrameUI
{

    protected JInternalFrame frame;

    private Handler handler;
    protected MouseInputAdapter          borderListener;
    protected PropertyChangeListener     propertyChangeListener;
    protected LayoutManager              internalFrameLayout;
    protected ComponentListener          componentListener;
    protected MouseInputListener         glassPaneDispatcher;
    private InternalFrameListener        internalFrameListener;

    protected JComponent northPane;
    protected JComponent southPane;
    protected JComponent westPane;
    protected JComponent eastPane;

    protected BasicInternalFrameTitlePane titlePane; // access needs this

    private static DesktopManager sharedDesktopManager;
<span class="nc" id="L64">    private boolean componentListenerAdded = false;</span>

    private Rectangle parentBounds;

<span class="nc" id="L68">    private boolean dragging = false;</span>
<span class="nc" id="L69">    private boolean resizing = false;</span>

    /**
     * As of Java 2 platform v1.3 this previously undocumented field is no
     * longer used.
     * Key bindings are now defined by the LookAndFeel, please refer to
     * the key bindings specification for further details.
     *
     * @deprecated As of Java 2 platform v1.3.
     */
    @Deprecated
    protected KeyStroke openMenuKey;

<span class="nc" id="L82">    private boolean keyBindingRegistered = false;</span>
<span class="nc" id="L83">    private boolean keyBindingActive = false;</span>

/////////////////////////////////////////////////////////////////////////////
// ComponentUI Interface Implementation methods
/////////////////////////////////////////////////////////////////////////////
    public static ComponentUI createUI(JComponent b)    {
<span class="nc" id="L89">        return new BasicInternalFrameUI((JInternalFrame)b);</span>
    }

<span class="nc" id="L92">    public BasicInternalFrameUI(JInternalFrame b)   {</span>
<span class="nc" id="L93">        LookAndFeel laf = UIManager.getLookAndFeel();</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">        if (laf instanceof BasicLookAndFeel) {</span>
<span class="nc" id="L95">            ((BasicLookAndFeel)laf).installAWTEventListener();</span>
        }
<span class="nc" id="L97">    }</span>

    public void installUI(JComponent c)   {

<span class="nc" id="L101">        frame = (JInternalFrame)c;</span>

<span class="nc" id="L103">        installDefaults();</span>
<span class="nc" id="L104">        installListeners();</span>
<span class="nc" id="L105">        installComponents();</span>
<span class="nc" id="L106">        installKeyboardActions();</span>

<span class="nc" id="L108">        LookAndFeel.installProperty(frame, &quot;opaque&quot;, Boolean.TRUE);</span>
<span class="nc" id="L109">    }</span>

    public void uninstallUI(JComponent c) {
<span class="nc bnc" id="L112" title="All 2 branches missed.">        if(c != frame)</span>
<span class="nc" id="L113">            throw new IllegalComponentStateException(</span>
                this + &quot; was asked to deinstall() &quot;
                + c + &quot; when it only knows about &quot;
                + frame + &quot;.&quot;);

<span class="nc" id="L118">        uninstallKeyboardActions();</span>
<span class="nc" id="L119">        uninstallComponents();</span>
<span class="nc" id="L120">        uninstallListeners();</span>
<span class="nc" id="L121">        uninstallDefaults();</span>
<span class="nc" id="L122">        updateFrameCursor();</span>
<span class="nc" id="L123">        handler = null;</span>
<span class="nc" id="L124">        frame = null;</span>
<span class="nc" id="L125">    }</span>

    protected void installDefaults(){
<span class="nc" id="L128">        Icon frameIcon = frame.getFrameIcon();</span>
<span class="nc bnc" id="L129" title="All 4 branches missed.">        if (frameIcon == null || frameIcon instanceof UIResource) {</span>
<span class="nc" id="L130">            frame.setFrameIcon(UIManager.getIcon(&quot;InternalFrame.icon&quot;));</span>
        }

        // Enable the content pane to inherit background color from its
        // parent by setting its background color to null.
<span class="nc" id="L135">        Container contentPane = frame.getContentPane();</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if (contentPane != null) {</span>
<span class="nc" id="L137">          Color bg = contentPane.getBackground();</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">          if (bg instanceof UIResource)</span>
<span class="nc" id="L139">            contentPane.setBackground(null);</span>
        }
<span class="nc" id="L141">        frame.setLayout(internalFrameLayout = createLayoutManager());</span>
<span class="nc" id="L142">        frame.setBackground(UIManager.getLookAndFeelDefaults().getColor(&quot;control&quot;));</span>

<span class="nc" id="L144">        LookAndFeel.installBorder(frame, &quot;InternalFrame.border&quot;);</span>

<span class="nc" id="L146">    }</span>
    protected void installKeyboardActions(){
<span class="nc" id="L148">        createInternalFrameListener();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">        if (internalFrameListener != null) {</span>
<span class="nc" id="L150">            frame.addInternalFrameListener(internalFrameListener);</span>
        }

<span class="nc" id="L153">        LazyActionMap.installLazyActionMap(frame, BasicInternalFrameUI.class,</span>
            &quot;InternalFrame.actionMap&quot;);
<span class="nc" id="L155">    }</span>

    static void loadActionMap(LazyActionMap map) {
<span class="nc" id="L158">        map.put(new UIAction(&quot;showSystemMenu&quot;) {</span>
            public void actionPerformed(ActionEvent evt) {
<span class="nc" id="L160">                JInternalFrame iFrame = (JInternalFrame)evt.getSource();</span>
<span class="nc bnc" id="L161" title="All 2 branches missed.">                if (iFrame.getUI() instanceof BasicInternalFrameUI) {</span>
<span class="nc" id="L162">                    JComponent comp = ((BasicInternalFrameUI)</span>
<span class="nc" id="L163">                        iFrame.getUI()).getNorthPane();</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                    if (comp instanceof BasicInternalFrameTitlePane) {</span>
<span class="nc" id="L165">                        ((BasicInternalFrameTitlePane)comp).</span>
<span class="nc" id="L166">                            showSystemMenu();</span>
                    }
                }
<span class="nc" id="L169">            }</span>

            public boolean isEnabled(Object sender){
<span class="nc bnc" id="L172" title="All 2 branches missed.">                if (sender instanceof JInternalFrame) {</span>
<span class="nc" id="L173">                    JInternalFrame iFrame = (JInternalFrame)sender;</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">                    if (iFrame.getUI() instanceof BasicInternalFrameUI) {</span>
<span class="nc" id="L175">                        return ((BasicInternalFrameUI)iFrame.getUI()).</span>
<span class="nc" id="L176">                            isKeyBindingActive();</span>
                    }
                }
<span class="nc" id="L179">                return false;</span>
            }
        });

        // Set the ActionMap's parent to the Auditory Feedback Action Map
<span class="nc" id="L184">        BasicLookAndFeel.installAudioActionMap(map);</span>
<span class="nc" id="L185">    }</span>

    protected void installComponents(){
<span class="nc" id="L188">        setNorthPane(createNorthPane(frame));</span>
<span class="nc" id="L189">        setSouthPane(createSouthPane(frame));</span>
<span class="nc" id="L190">        setEastPane(createEastPane(frame));</span>
<span class="nc" id="L191">        setWestPane(createWestPane(frame));</span>
<span class="nc" id="L192">    }</span>

    /**
     * @since 1.3
     */
    protected void installListeners() {
<span class="nc" id="L198">        borderListener = createBorderListener(frame);</span>
<span class="nc" id="L199">        propertyChangeListener = createPropertyChangeListener();</span>
<span class="nc" id="L200">        frame.addPropertyChangeListener(propertyChangeListener);</span>
<span class="nc" id="L201">        installMouseHandlers(frame);</span>
<span class="nc" id="L202">        glassPaneDispatcher = createGlassPaneDispatcher();</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">        if (glassPaneDispatcher != null) {</span>
<span class="nc" id="L204">            frame.getGlassPane().addMouseListener(glassPaneDispatcher);</span>
<span class="nc" id="L205">            frame.getGlassPane().addMouseMotionListener(glassPaneDispatcher);</span>
        }
<span class="nc" id="L207">        componentListener =  createComponentListener();</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (frame.getParent() != null) {</span>
<span class="nc" id="L209">          parentBounds = frame.getParent().getBounds();</span>
        }
<span class="nc bnc" id="L211" title="All 4 branches missed.">        if ((frame.getParent() != null) &amp;&amp; !componentListenerAdded) {</span>
<span class="nc" id="L212">            frame.getParent().addComponentListener(componentListener);</span>
<span class="nc" id="L213">            componentListenerAdded = true;</span>
        }
<span class="nc" id="L215">    }</span>

    // Provide a FocusListener to listen for a WINDOW_LOST_FOCUS event,
    // so that a resize can be cancelled if the focus is lost while resizing
    // when an Alt-Tab, modal dialog popup, iconify, dispose, or remove
    // of the internal frame occurs.
    private WindowFocusListener getWindowFocusListener(){
<span class="nc" id="L222">        return getHandler();</span>
    }

    // Cancel a resize in progress by calling finishMouseReleased().
    private void cancelResize() {
<span class="nc bnc" id="L227" title="All 2 branches missed.">        if (resizing) {</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">            if (borderListener instanceof BorderListener) {</span>
<span class="nc" id="L229">                ((BorderListener)borderListener).finishMouseReleased();</span>
            }
        }
<span class="nc" id="L232">    }</span>

    private Handler getHandler() {
<span class="nc bnc" id="L235" title="All 2 branches missed.">        if (handler == null) {</span>
<span class="nc" id="L236">            handler = new Handler();</span>
        }
<span class="nc" id="L238">        return handler;</span>
    }

    InputMap getInputMap(int condition) {
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (condition == JComponent.WHEN_IN_FOCUSED_WINDOW) {</span>
<span class="nc" id="L243">            return createInputMap(condition);</span>
        }
<span class="nc" id="L245">        return null;</span>
    }

    InputMap createInputMap(int condition) {
<span class="nc bnc" id="L249" title="All 2 branches missed.">        if (condition == JComponent.WHEN_IN_FOCUSED_WINDOW) {</span>
<span class="nc" id="L250">            Object[] bindings = (Object[])DefaultLookup.get(</span>
                    frame, this, &quot;InternalFrame.windowBindings&quot;);

<span class="nc bnc" id="L253" title="All 2 branches missed.">            if (bindings != null) {</span>
<span class="nc" id="L254">                return LookAndFeel.makeComponentInputMap(frame, bindings);</span>
            }
        }
<span class="nc" id="L257">        return null;</span>
    }

    protected void uninstallDefaults() {
<span class="nc" id="L261">        Icon frameIcon = frame.getFrameIcon();</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">        if (frameIcon instanceof UIResource) {</span>
<span class="nc" id="L263">            frame.setFrameIcon(null);</span>
        }
<span class="nc" id="L265">        internalFrameLayout = null;</span>
<span class="nc" id="L266">        frame.setLayout(null);</span>
<span class="nc" id="L267">        LookAndFeel.uninstallBorder(frame);</span>
<span class="nc" id="L268">    }</span>

    protected void uninstallComponents(){
<span class="nc" id="L271">        setNorthPane(null);</span>
<span class="nc" id="L272">        setSouthPane(null);</span>
<span class="nc" id="L273">        setEastPane(null);</span>
<span class="nc" id="L274">        setWestPane(null);</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">        if(titlePane != null) {</span>
<span class="nc" id="L276">            titlePane.uninstallDefaults();</span>
        }
<span class="nc" id="L278">        titlePane = null;</span>
<span class="nc" id="L279">    }</span>

    /**
     * @since 1.3
     */
    protected void uninstallListeners() {
<span class="nc bnc" id="L285" title="All 4 branches missed.">        if ((frame.getParent() != null) &amp;&amp; componentListenerAdded) {</span>
<span class="nc" id="L286">            frame.getParent().removeComponentListener(componentListener);</span>
<span class="nc" id="L287">            componentListenerAdded = false;</span>
        }
<span class="nc" id="L289">        componentListener = null;</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">      if (glassPaneDispatcher != null) {</span>
<span class="nc" id="L291">          frame.getGlassPane().removeMouseListener(glassPaneDispatcher);</span>
<span class="nc" id="L292">          frame.getGlassPane().removeMouseMotionListener(glassPaneDispatcher);</span>
<span class="nc" id="L293">          glassPaneDispatcher = null;</span>
      }
<span class="nc" id="L295">      deinstallMouseHandlers(frame);</span>
<span class="nc" id="L296">      frame.removePropertyChangeListener(propertyChangeListener);</span>
<span class="nc" id="L297">      propertyChangeListener = null;</span>
<span class="nc" id="L298">      borderListener = null;</span>
<span class="nc" id="L299">    }</span>

    protected void uninstallKeyboardActions(){
<span class="nc bnc" id="L302" title="All 2 branches missed.">        if (internalFrameListener != null) {</span>
<span class="nc" id="L303">            frame.removeInternalFrameListener(internalFrameListener);</span>
        }
<span class="nc" id="L305">        internalFrameListener = null;</span>

<span class="nc" id="L307">        SwingUtilities.replaceUIInputMap(frame, JComponent.</span>
                                         WHEN_IN_FOCUSED_WINDOW, null);
<span class="nc" id="L309">        SwingUtilities.replaceUIActionMap(frame, null);</span>

<span class="nc" id="L311">    }</span>

    void updateFrameCursor() {
<span class="nc bnc" id="L314" title="All 2 branches missed.">        if (resizing) {</span>
<span class="nc" id="L315">            return;</span>
        }
<span class="nc" id="L317">        Cursor s = frame.getLastCursor();</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (s == null) {</span>
<span class="nc" id="L319">            s = Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR);</span>
        }
<span class="nc" id="L321">        frame.setCursor(s);</span>
<span class="nc" id="L322">    }</span>

    protected LayoutManager createLayoutManager(){
<span class="nc" id="L325">        return getHandler();</span>
    }

    protected PropertyChangeListener createPropertyChangeListener(){
<span class="nc" id="L329">        return getHandler();</span>
    }



    public Dimension getPreferredSize(JComponent x)    {
<span class="nc bnc" id="L335" title="All 2 branches missed.">        if(frame == x)</span>
<span class="nc" id="L336">            return frame.getLayout().preferredLayoutSize(x);</span>
<span class="nc" id="L337">        return new Dimension(100, 100);</span>
    }

    public Dimension getMinimumSize(JComponent x)  {
<span class="nc bnc" id="L341" title="All 2 branches missed.">        if(frame == x) {</span>
<span class="nc" id="L342">            return frame.getLayout().minimumLayoutSize(x);</span>
        }
<span class="nc" id="L344">        return new Dimension(0, 0);</span>
    }

    public Dimension getMaximumSize(JComponent x) {
<span class="nc" id="L348">        return new Dimension(Integer.MAX_VALUE, Integer.MAX_VALUE);</span>
    }



    /**
      * Installs necessary mouse handlers on &lt;code&gt;newPane&lt;/code&gt;
      * and adds it to the frame.
      * Reverse process for the &lt;code&gt;currentPane&lt;/code&gt;.
      */
    protected void replacePane(JComponent currentPane, JComponent newPane) {
<span class="nc bnc" id="L359" title="All 2 branches missed.">        if(currentPane != null) {</span>
<span class="nc" id="L360">            deinstallMouseHandlers(currentPane);</span>
<span class="nc" id="L361">            frame.remove(currentPane);</span>
        }
<span class="nc bnc" id="L363" title="All 2 branches missed.">        if(newPane != null) {</span>
<span class="nc" id="L364">           frame.add(newPane);</span>
<span class="nc" id="L365">           installMouseHandlers(newPane);</span>
        }
<span class="nc" id="L367">    }</span>

    protected void deinstallMouseHandlers(JComponent c) {
<span class="nc" id="L370">      c.removeMouseListener(borderListener);</span>
<span class="nc" id="L371">      c.removeMouseMotionListener(borderListener);</span>
<span class="nc" id="L372">    }</span>

    protected void installMouseHandlers(JComponent c) {
<span class="nc" id="L375">      c.addMouseListener(borderListener);</span>
<span class="nc" id="L376">      c.addMouseMotionListener(borderListener);</span>
<span class="nc" id="L377">    }</span>

    protected JComponent createNorthPane(JInternalFrame w) {
<span class="nc" id="L380">      titlePane = new BasicInternalFrameTitlePane(w);</span>
<span class="nc" id="L381">      return titlePane;</span>
    }


    protected JComponent createSouthPane(JInternalFrame w) {
<span class="nc" id="L386">        return null;</span>
    }

    protected JComponent createWestPane(JInternalFrame w) {
<span class="nc" id="L390">        return null;</span>
    }

    protected JComponent createEastPane(JInternalFrame w) {
<span class="nc" id="L394">        return null;</span>
    }


    protected MouseInputAdapter createBorderListener(JInternalFrame w) {
<span class="nc" id="L399">        return new BorderListener();</span>
    }

    protected void createInternalFrameListener(){
<span class="nc" id="L403">        internalFrameListener = getHandler();</span>
<span class="nc" id="L404">    }</span>

    protected final boolean isKeyBindingRegistered(){
<span class="nc" id="L407">      return keyBindingRegistered;</span>
    }

    protected final void setKeyBindingRegistered(boolean b){
<span class="nc" id="L411">      keyBindingRegistered = b;</span>
<span class="nc" id="L412">    }</span>

    public final boolean isKeyBindingActive(){
<span class="nc" id="L415">      return keyBindingActive;</span>
    }

    protected final void setKeyBindingActive(boolean b){
<span class="nc" id="L419">      keyBindingActive = b;</span>
<span class="nc" id="L420">    }</span>


    protected void setupMenuOpenKey(){
        // PENDING(hania): Why are these WHEN_IN_FOCUSED_WINDOWs? Shouldn't
        // they be WHEN_ANCESTOR_OF_FOCUSED_COMPONENT?
        // Also, no longer registering on the desktopicon, the previous
        // action did nothing.
<span class="nc" id="L428">        InputMap map = getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);</span>
<span class="nc" id="L429">        SwingUtilities.replaceUIInputMap(frame,</span>
                                      JComponent.WHEN_IN_FOCUSED_WINDOW, map);
        //ActionMap actionMap = getActionMap();
        //SwingUtilities.replaceUIActionMap(frame, actionMap);
<span class="nc" id="L433">    }</span>

    protected void setupMenuCloseKey(){
<span class="nc" id="L436">    }</span>

    public JComponent getNorthPane() {
<span class="nc" id="L439">        return northPane;</span>
    }

    public void setNorthPane(JComponent c) {
<span class="nc bnc" id="L443" title="All 4 branches missed.">        if (northPane != null &amp;&amp;</span>
                northPane instanceof BasicInternalFrameTitlePane) {
<span class="nc" id="L445">            ((BasicInternalFrameTitlePane)northPane).uninstallListeners();</span>
        }
<span class="nc" id="L447">        replacePane(northPane, c);</span>
<span class="nc" id="L448">        northPane = c;</span>
<span class="nc bnc" id="L449" title="All 2 branches missed.">        if (c instanceof BasicInternalFrameTitlePane) {</span>
<span class="nc" id="L450">          titlePane = (BasicInternalFrameTitlePane)c;</span>
        }
<span class="nc" id="L452">    }</span>

    public JComponent getSouthPane() {
<span class="nc" id="L455">        return southPane;</span>
    }

    public void setSouthPane(JComponent c) {
<span class="nc" id="L459">        southPane = c;</span>
<span class="nc" id="L460">    }</span>

    public JComponent getWestPane() {
<span class="nc" id="L463">        return westPane;</span>
    }

    public void setWestPane(JComponent c) {
<span class="nc" id="L467">        westPane = c;</span>
<span class="nc" id="L468">    }</span>

    public JComponent getEastPane() {
<span class="nc" id="L471">        return eastPane;</span>
    }

    public void setEastPane(JComponent c) {
<span class="nc" id="L475">        eastPane = c;</span>
<span class="nc" id="L476">    }</span>

<span class="nc" id="L478">    public class InternalFramePropertyChangeListener implements</span>
        PropertyChangeListener {
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        /**
         * Detects changes in state from the JInternalFrame and handles
         * actions.
         */
        public void propertyChange(PropertyChangeEvent evt) {
<span class="nc" id="L489">            getHandler().propertyChange(evt);</span>
<span class="nc" id="L490">        }</span>
    }

<span class="nc" id="L493">  public class InternalFrameLayout implements LayoutManager {</span>
    // NOTE: This class exists only for backward compatibility. All
    // its functionality has been moved into Handler. If you need to add
    // new functionality add it to the Handler, but make sure this
    // class calls into the Handler.
    public void addLayoutComponent(String name, Component c) {
<span class="nc" id="L499">        getHandler().addLayoutComponent(name, c);</span>
<span class="nc" id="L500">    }</span>

    public void removeLayoutComponent(Component c) {
<span class="nc" id="L503">        getHandler().removeLayoutComponent(c);</span>
<span class="nc" id="L504">    }</span>

    public Dimension preferredLayoutSize(Container c)  {
<span class="nc" id="L507">        return getHandler().preferredLayoutSize(c);</span>
    }

    public Dimension minimumLayoutSize(Container c) {
<span class="nc" id="L511">        return getHandler().minimumLayoutSize(c);</span>
    }

    public void layoutContainer(Container c) {
<span class="nc" id="L515">        getHandler().layoutContainer(c);</span>
<span class="nc" id="L516">    }</span>
  }

/// DesktopManager methods
    /** Returns the proper DesktopManager. Calls getDesktopPane() to
      * find the JDesktop component and returns the desktopManager from
      * it. If this fails, it will return a default DesktopManager that
      * should work in arbitrary parents.
      */
    protected DesktopManager getDesktopManager() {
<span class="nc bnc" id="L526" title="All 2 branches missed.">        if(frame.getDesktopPane() != null</span>
<span class="nc bnc" id="L527" title="All 2 branches missed.">           &amp;&amp; frame.getDesktopPane().getDesktopManager() != null)</span>
<span class="nc" id="L528">            return frame.getDesktopPane().getDesktopManager();</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">        if(sharedDesktopManager == null)</span>
<span class="nc" id="L530">          sharedDesktopManager = createDesktopManager();</span>
<span class="nc" id="L531">        return sharedDesktopManager;</span>
    }

    protected DesktopManager createDesktopManager(){
<span class="nc" id="L535">      return new DefaultDesktopManager();</span>
    }

    /**
     * This method is called when the user wants to close the frame.
     * The &lt;code&gt;playCloseSound&lt;/code&gt; Action is fired.
     * This action is delegated to the desktopManager.
     */
    protected void closeFrame(JInternalFrame f) {
        // Internal Frame Auditory Cue Activation
<span class="nc" id="L545">        BasicLookAndFeel.playSound(frame,&quot;InternalFrame.closeSound&quot;);</span>
        // delegate to desktop manager
<span class="nc" id="L547">        getDesktopManager().closeFrame(f);</span>
<span class="nc" id="L548">    }</span>

    /**
     * This method is called when the user wants to maximize the frame.
     * The &lt;code&gt;playMaximizeSound&lt;/code&gt; Action is fired.
     * This action is delegated to the desktopManager.
     */
    protected void maximizeFrame(JInternalFrame f) {
        // Internal Frame Auditory Cue Activation
<span class="nc" id="L557">        BasicLookAndFeel.playSound(frame,&quot;InternalFrame.maximizeSound&quot;);</span>
        // delegate to desktop manager
<span class="nc" id="L559">        getDesktopManager().maximizeFrame(f);</span>
<span class="nc" id="L560">    }</span>

    /**
     * This method is called when the user wants to minimize the frame.
     * The &lt;code&gt;playRestoreDownSound&lt;/code&gt; Action is fired.
     * This action is delegated to the desktopManager.
     */
    protected void minimizeFrame(JInternalFrame f) {
        // Internal Frame Auditory Cue Activation
<span class="nc bnc" id="L569" title="All 2 branches missed.">        if ( ! f.isIcon() ) {</span>
            // This method seems to regularly get called after an
            // internal frame is iconified. Don't play this sound then.
<span class="nc" id="L572">            BasicLookAndFeel.playSound(frame,&quot;InternalFrame.restoreDownSound&quot;);</span>
        }
        // delegate to desktop manager
<span class="nc" id="L575">        getDesktopManager().minimizeFrame(f);</span>
<span class="nc" id="L576">    }</span>

    /**
     * This method is called when the user wants to iconify the frame.
     * The &lt;code&gt;playMinimizeSound&lt;/code&gt; Action is fired.
     * This action is delegated to the desktopManager.
     */
    protected void iconifyFrame(JInternalFrame f) {
        // Internal Frame Auditory Cue Activation
<span class="nc" id="L585">        BasicLookAndFeel.playSound(frame, &quot;InternalFrame.minimizeSound&quot;);</span>
        // delegate to desktop manager
<span class="nc" id="L587">        getDesktopManager().iconifyFrame(f);</span>
<span class="nc" id="L588">    }</span>

    /**
     * This method is called when the user wants to deiconify the frame.
     * The &lt;code&gt;playRestoreUpSound&lt;/code&gt; Action is fired.
     * This action is delegated to the desktopManager.
     */
    protected void deiconifyFrame(JInternalFrame f) {
        // Internal Frame Auditory Cue Activation
<span class="nc bnc" id="L597" title="All 2 branches missed.">        if ( ! f.isMaximum() ) {</span>
            // This method seems to regularly get called after an
            // internal frame is maximized. Don't play this sound then.
<span class="nc" id="L600">            BasicLookAndFeel.playSound(frame, &quot;InternalFrame.restoreUpSound&quot;);</span>
        }
        // delegate to desktop manager
<span class="nc" id="L603">        getDesktopManager().deiconifyFrame(f);</span>
<span class="nc" id="L604">    }</span>

    /** This method is called when the frame becomes selected.
      * This action is delegated to the desktopManager.
      */
    protected void activateFrame(JInternalFrame f) {
<span class="nc" id="L610">        getDesktopManager().activateFrame(f);</span>
<span class="nc" id="L611">    }</span>
    /** This method is called when the frame is no longer selected.
      * This action is delegated to the desktopManager.
      */
    protected void deactivateFrame(JInternalFrame f) {
<span class="nc" id="L616">        getDesktopManager().deactivateFrame(f);</span>
<span class="nc" id="L617">    }</span>

    /////////////////////////////////////////////////////////////////////////
    /// Border Listener Class
    /////////////////////////////////////////////////////////////////////////
    /**
     * Listens for border adjustments.
     */
<span class="nc" id="L625">    protected class BorderListener extends MouseInputAdapter implements SwingConstants</span>
    {
        // _x &amp; _y are the mousePressed location in absolute coordinate system
        int _x, _y;
        // __x &amp; __y are the mousePressed location in source view's coordinate system
        int __x, __y;
        Rectangle startingBounds;
        int resizeDir;


<span class="nc" id="L635">        protected final int RESIZE_NONE  = 0;</span>
<span class="nc" id="L636">        private boolean discardRelease = false;</span>

<span class="nc" id="L638">        int resizeCornerSize = 16;</span>

        public void mouseClicked(MouseEvent e) {
<span class="nc bnc" id="L641" title="All 4 branches missed.">            if(e.getClickCount() &gt; 1 &amp;&amp; e.getSource() == getNorthPane()) {</span>
<span class="nc bnc" id="L642" title="All 4 branches missed.">                if(frame.isIconifiable() &amp;&amp; frame.isIcon()) {</span>
<span class="nc" id="L643">                    try { frame.setIcon(false); } catch (PropertyVetoException e2) { }</span>
<span class="nc bnc" id="L644" title="All 2 branches missed.">                } else if(frame.isMaximizable()) {</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">                    if(!frame.isMaximum())</span>
<span class="nc" id="L646">                        try { frame.setMaximum(true); } catch (PropertyVetoException e2) { }</span>
                    else
<span class="nc" id="L648">                        try { frame.setMaximum(false); } catch (PropertyVetoException e3) { }</span>
                }
            }
<span class="nc" id="L651">        }</span>

        // Factor out finishMouseReleased() from mouseReleased(), so that
        // it can be called by cancelResize() without passing it a null
        // MouseEvent.
        void finishMouseReleased() {
<span class="nc bnc" id="L657" title="All 2 branches missed.">           if (discardRelease) {</span>
<span class="nc" id="L658">             discardRelease = false;</span>
<span class="nc" id="L659">             return;</span>
          }
<span class="nc bnc" id="L661" title="All 2 branches missed.">            if (resizeDir == RESIZE_NONE) {</span>
<span class="nc" id="L662">                getDesktopManager().endDraggingFrame(frame);</span>
<span class="nc" id="L663">                dragging = false;</span>
            } else {
                // Remove the WindowFocusListener for handling a
                // WINDOW_LOST_FOCUS event with a cancelResize().
<span class="nc" id="L667">                Window windowAncestor =</span>
<span class="nc" id="L668">                    SwingUtilities.getWindowAncestor(frame);</span>
<span class="nc bnc" id="L669" title="All 2 branches missed.">                if (windowAncestor != null) {</span>
<span class="nc" id="L670">                    windowAncestor.removeWindowFocusListener(</span>
<span class="nc" id="L671">                        getWindowFocusListener());</span>
                }
<span class="nc" id="L673">                Container c = frame.getTopLevelAncestor();</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">                if (c instanceof RootPaneContainer) {</span>
<span class="nc" id="L675">                    Component glassPane = ((RootPaneContainer)c).getGlassPane();</span>
<span class="nc" id="L676">                    glassPane.setCursor(Cursor.getPredefinedCursor(</span>
                        Cursor.DEFAULT_CURSOR));
<span class="nc" id="L678">                    glassPane.setVisible(false);</span>
                }
<span class="nc" id="L680">                getDesktopManager().endResizingFrame(frame);</span>
<span class="nc" id="L681">                resizing = false;</span>
<span class="nc" id="L682">                updateFrameCursor();</span>
            }
<span class="nc" id="L684">            _x = 0;</span>
<span class="nc" id="L685">            _y = 0;</span>
<span class="nc" id="L686">            __x = 0;</span>
<span class="nc" id="L687">            __y = 0;</span>
<span class="nc" id="L688">            startingBounds = null;</span>
<span class="nc" id="L689">            resizeDir = RESIZE_NONE;</span>
            // Set discardRelease to true, so that only a mousePressed()
            // which sets it to false, will allow entry to the above code
            // for finishing a resize.
<span class="nc" id="L693">            discardRelease = true;</span>
<span class="nc" id="L694">        }</span>

        public void mouseReleased(MouseEvent e) {
<span class="nc" id="L697">            finishMouseReleased();</span>
<span class="nc" id="L698">        }</span>

        public void mousePressed(MouseEvent e) {
<span class="nc" id="L701">            Point p = SwingUtilities.convertPoint((Component)e.getSource(),</span>
<span class="nc" id="L702">                        e.getX(), e.getY(), null);</span>
<span class="nc" id="L703">            __x = e.getX();</span>
<span class="nc" id="L704">            __y = e.getY();</span>
<span class="nc" id="L705">            _x = p.x;</span>
<span class="nc" id="L706">            _y = p.y;</span>
<span class="nc" id="L707">            startingBounds = frame.getBounds();</span>
<span class="nc" id="L708">            resizeDir = RESIZE_NONE;</span>
<span class="nc" id="L709">            discardRelease = false;</span>

<span class="nc" id="L711">            try { frame.setSelected(true); }</span>
<span class="nc" id="L712">            catch (PropertyVetoException e1) { }</span>

<span class="nc" id="L714">            Insets i = frame.getInsets();</span>

<span class="nc" id="L716">            Point ep = new Point(__x, __y);</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">            if (e.getSource() == getNorthPane()) {</span>
<span class="nc" id="L718">                Point np = getNorthPane().getLocation();</span>
<span class="nc" id="L719">                ep.x += np.x;</span>
<span class="nc" id="L720">                ep.y += np.y;</span>
            }

<span class="nc bnc" id="L723" title="All 2 branches missed.">            if (e.getSource() == getNorthPane()) {</span>
<span class="nc bnc" id="L724" title="All 6 branches missed.">                if (ep.x &gt; i.left &amp;&amp; ep.y &gt; i.top &amp;&amp; ep.x &lt; frame.getWidth() - i.right) {</span>
<span class="nc" id="L725">                    getDesktopManager().beginDraggingFrame(frame);</span>
<span class="nc" id="L726">                    dragging = true;</span>
<span class="nc" id="L727">                    return;</span>
                }
            }
<span class="nc bnc" id="L730" title="All 2 branches missed.">            if (!frame.isResizable()) {</span>
<span class="nc" id="L731">              return;</span>
            }

<span class="nc bnc" id="L734" title="All 4 branches missed.">            if (e.getSource() == frame || e.getSource() == getNorthPane()) {</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">                if (ep.x &lt;= i.left) {</span>
<span class="nc bnc" id="L736" title="All 2 branches missed.">                    if (ep.y &lt; resizeCornerSize + i.top) {</span>
<span class="nc" id="L737">                        resizeDir = NORTH_WEST;</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">                    } else if (ep.y &gt; frame.getHeight()</span>
                              - resizeCornerSize - i.bottom) {
<span class="nc" id="L740">                        resizeDir = SOUTH_WEST;</span>
                    } else {
<span class="nc" id="L742">                        resizeDir = WEST;</span>
}
<span class="nc bnc" id="L744" title="All 2 branches missed.">                } else if (ep.x &gt;= frame.getWidth() - i.right) {</span>
<span class="nc bnc" id="L745" title="All 2 branches missed.">                    if (ep.y &lt; resizeCornerSize + i.top) {</span>
<span class="nc" id="L746">                        resizeDir = NORTH_EAST;</span>
<span class="nc bnc" id="L747" title="All 2 branches missed.">                    } else if (ep.y &gt; frame.getHeight()</span>
                              - resizeCornerSize - i.bottom) {
<span class="nc" id="L749">                        resizeDir = SOUTH_EAST;</span>
                    } else {
<span class="nc" id="L751">                        resizeDir = EAST;</span>
                    }
<span class="nc bnc" id="L753" title="All 2 branches missed.">                } else if (ep.y &lt;= i.top) {</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">                    if (ep.x &lt; resizeCornerSize + i.left) {</span>
<span class="nc" id="L755">                        resizeDir = NORTH_WEST;</span>
<span class="nc bnc" id="L756" title="All 2 branches missed.">                    } else if (ep.x &gt; frame.getWidth()</span>
                              - resizeCornerSize - i.right) {
<span class="nc" id="L758">                        resizeDir = NORTH_EAST;</span>
                    } else {
<span class="nc" id="L760">                        resizeDir = NORTH;</span>
                    }
<span class="nc bnc" id="L762" title="All 2 branches missed.">                } else if (ep.y &gt;= frame.getHeight() - i.bottom) {</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">                    if (ep.x &lt; resizeCornerSize + i.left) {</span>
<span class="nc" id="L764">                        resizeDir = SOUTH_WEST;</span>
<span class="nc bnc" id="L765" title="All 2 branches missed.">                    } else if (ep.x &gt; frame.getWidth()</span>
                              - resizeCornerSize - i.right) {
<span class="nc" id="L767">                        resizeDir = SOUTH_EAST;</span>
                    } else {
<span class="nc" id="L769">                      resizeDir = SOUTH;</span>
                    }
                } else {
                  /* the mouse press happened inside the frame, not in the
                     border */
<span class="nc" id="L774">                  discardRelease = true;</span>
<span class="nc" id="L775">                  return;</span>
                }
<span class="nc" id="L777">                Cursor s = Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR);</span>
<span class="nc bnc" id="L778" title="All 9 branches missed.">                switch (resizeDir) {</span>
                case SOUTH:
<span class="nc" id="L780">                  s = Cursor.getPredefinedCursor(Cursor.S_RESIZE_CURSOR);</span>
<span class="nc" id="L781">                  break;</span>
                case NORTH:
<span class="nc" id="L783">                  s = Cursor.getPredefinedCursor(Cursor.N_RESIZE_CURSOR);</span>
<span class="nc" id="L784">                  break;</span>
                case WEST:
<span class="nc" id="L786">                  s = Cursor.getPredefinedCursor(Cursor.W_RESIZE_CURSOR);</span>
<span class="nc" id="L787">                  break;</span>
                case EAST:
<span class="nc" id="L789">                  s = Cursor.getPredefinedCursor(Cursor.E_RESIZE_CURSOR);</span>
<span class="nc" id="L790">                  break;</span>
                case SOUTH_EAST:
<span class="nc" id="L792">                  s = Cursor.getPredefinedCursor(Cursor.SE_RESIZE_CURSOR);</span>
<span class="nc" id="L793">                  break;</span>
                case SOUTH_WEST:
<span class="nc" id="L795">                  s = Cursor.getPredefinedCursor(Cursor.SW_RESIZE_CURSOR);</span>
<span class="nc" id="L796">                  break;</span>
                case NORTH_WEST:
<span class="nc" id="L798">                  s = Cursor.getPredefinedCursor(Cursor.NW_RESIZE_CURSOR);</span>
<span class="nc" id="L799">                  break;</span>
                case NORTH_EAST:
<span class="nc" id="L801">                  s = Cursor.getPredefinedCursor(Cursor.NE_RESIZE_CURSOR);</span>
                  break;
                }
<span class="nc" id="L804">                Container c = frame.getTopLevelAncestor();</span>
<span class="nc bnc" id="L805" title="All 2 branches missed.">                if (c instanceof RootPaneContainer) {</span>
<span class="nc" id="L806">                    Component glassPane = ((RootPaneContainer)c).getGlassPane();</span>
<span class="nc" id="L807">                    glassPane.setVisible(true);</span>
<span class="nc" id="L808">                    glassPane.setCursor(s);</span>
                }
<span class="nc" id="L810">                getDesktopManager().beginResizingFrame(frame, resizeDir);</span>
<span class="nc" id="L811">                resizing = true;</span>
                // Add the WindowFocusListener for handling a
                // WINDOW_LOST_FOCUS event with a cancelResize().
<span class="nc" id="L814">                Window windowAncestor = SwingUtilities.getWindowAncestor(frame);</span>
<span class="nc bnc" id="L815" title="All 2 branches missed.">                if (windowAncestor != null) {</span>
<span class="nc" id="L816">                    windowAncestor.addWindowFocusListener(</span>
<span class="nc" id="L817">                        getWindowFocusListener());</span>
                }
<span class="nc" id="L819">                return;</span>
            }
<span class="nc" id="L821">        }</span>

        public void mouseDragged(MouseEvent e) {

<span class="nc bnc" id="L825" title="All 2 branches missed.">            if ( startingBounds == null ) {</span>
              // (STEVE) Yucky work around for bug ID 4106552
<span class="nc" id="L827">                 return;</span>
            }

<span class="nc" id="L830">            Point p = SwingUtilities.convertPoint((Component)e.getSource(),</span>
<span class="nc" id="L831">                    e.getX(), e.getY(), null);</span>
<span class="nc" id="L832">            int deltaX = _x - p.x;</span>
<span class="nc" id="L833">            int deltaY = _y - p.y;</span>
<span class="nc" id="L834">            Dimension min = frame.getMinimumSize();</span>
<span class="nc" id="L835">            Dimension max = frame.getMaximumSize();</span>
            int newX, newY, newW, newH;
<span class="nc" id="L837">            Insets i = frame.getInsets();</span>

            // Handle a MOVE
<span class="nc bnc" id="L840" title="All 2 branches missed.">            if (dragging) {</span>
<span class="nc bnc" id="L841" title="All 4 branches missed.">                if (frame.isMaximum() || ((e.getModifiers() &amp;</span>
                        InputEvent.BUTTON1_MASK) !=
                        InputEvent.BUTTON1_MASK)) {
                    // don't allow moving of frames if maximixed or left mouse
                    // button was not used.
<span class="nc" id="L846">                    return;</span>
                }
                int pWidth, pHeight;
<span class="nc" id="L849">                Dimension s = frame.getParent().getSize();</span>
<span class="nc" id="L850">                pWidth = s.width;</span>
<span class="nc" id="L851">                pHeight = s.height;</span>


<span class="nc" id="L854">                newX = startingBounds.x - deltaX;</span>
<span class="nc" id="L855">                newY = startingBounds.y - deltaY;</span>

                // Make sure we stay in-bounds
<span class="nc bnc" id="L858" title="All 2 branches missed.">                if(newX + i.left &lt;= -__x)</span>
<span class="nc" id="L859">                    newX = -__x - i.left + 1;</span>
<span class="nc bnc" id="L860" title="All 2 branches missed.">                if(newY + i.top &lt;= -__y)</span>
<span class="nc" id="L861">                    newY = -__y - i.top + 1;</span>
<span class="nc bnc" id="L862" title="All 2 branches missed.">                if(newX + __x + i.right &gt;= pWidth)</span>
<span class="nc" id="L863">                    newX = pWidth - __x - i.right - 1;</span>
<span class="nc bnc" id="L864" title="All 2 branches missed.">                if(newY + __y + i.bottom &gt;= pHeight)</span>
<span class="nc" id="L865">                    newY =  pHeight - __y - i.bottom - 1;</span>

<span class="nc" id="L867">                getDesktopManager().dragFrame(frame, newX, newY);</span>
<span class="nc" id="L868">                return;</span>
            }

<span class="nc bnc" id="L871" title="All 2 branches missed.">            if(!frame.isResizable()) {</span>
<span class="nc" id="L872">                return;</span>
            }

<span class="nc" id="L875">            newX = frame.getX();</span>
<span class="nc" id="L876">            newY = frame.getY();</span>
<span class="nc" id="L877">            newW = frame.getWidth();</span>
<span class="nc" id="L878">            newH = frame.getHeight();</span>

<span class="nc" id="L880">            parentBounds = frame.getParent().getBounds();</span>

<span class="nc bnc" id="L882" title="All 10 branches missed.">            switch(resizeDir) {</span>
            case RESIZE_NONE:
<span class="nc" id="L884">                return;</span>
            case NORTH:
<span class="nc bnc" id="L886" title="All 2 branches missed.">                if(startingBounds.height + deltaY &lt; min.height)</span>
<span class="nc" id="L887">                    deltaY = -(startingBounds.height - min.height);</span>
<span class="nc bnc" id="L888" title="All 2 branches missed.">                else if(startingBounds.height + deltaY &gt; max.height)</span>
<span class="nc" id="L889">                    deltaY = max.height - startingBounds.height;</span>
<span class="nc bnc" id="L890" title="All 2 branches missed.">                if (startingBounds.y - deltaY &lt; 0) {deltaY = startingBounds.y;}</span>

<span class="nc" id="L892">                newX = startingBounds.x;</span>
<span class="nc" id="L893">                newY = startingBounds.y - deltaY;</span>
<span class="nc" id="L894">                newW = startingBounds.width;</span>
<span class="nc" id="L895">                newH = startingBounds.height + deltaY;</span>
<span class="nc" id="L896">                break;</span>
            case NORTH_EAST:
<span class="nc bnc" id="L898" title="All 2 branches missed.">                if(startingBounds.height + deltaY &lt; min.height)</span>
<span class="nc" id="L899">                    deltaY = -(startingBounds.height - min.height);</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">                else if(startingBounds.height + deltaY &gt; max.height)</span>
<span class="nc" id="L901">                    deltaY = max.height - startingBounds.height;</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">                if (startingBounds.y - deltaY &lt; 0) {deltaY = startingBounds.y;}</span>

<span class="nc bnc" id="L904" title="All 2 branches missed.">                if(startingBounds.width - deltaX &lt; min.width)</span>
<span class="nc" id="L905">                    deltaX = startingBounds.width - min.width;</span>
<span class="nc bnc" id="L906" title="All 2 branches missed.">                else if(startingBounds.width - deltaX &gt; max.width)</span>
<span class="nc" id="L907">                    deltaX = -(max.width - startingBounds.width);</span>
<span class="nc" id="L908">                if (startingBounds.x + startingBounds.width - deltaX &gt;</span>
<span class="nc bnc" id="L909" title="All 2 branches missed.">                    parentBounds.width) {</span>
<span class="nc" id="L910">                  deltaX = startingBounds.x + startingBounds.width -</span>
<span class="nc" id="L911">                    parentBounds.width;</span>
                }

<span class="nc" id="L914">                newX = startingBounds.x;</span>
<span class="nc" id="L915">                newY = startingBounds.y - deltaY;</span>
<span class="nc" id="L916">                newW = startingBounds.width - deltaX;</span>
<span class="nc" id="L917">                newH = startingBounds.height + deltaY;</span>
<span class="nc" id="L918">                break;</span>
            case EAST:
<span class="nc bnc" id="L920" title="All 2 branches missed.">                if(startingBounds.width - deltaX &lt; min.width)</span>
<span class="nc" id="L921">                    deltaX = startingBounds.width - min.width;</span>
<span class="nc bnc" id="L922" title="All 2 branches missed.">                else if(startingBounds.width - deltaX &gt; max.width)</span>
<span class="nc" id="L923">                    deltaX = -(max.width - startingBounds.width);</span>
<span class="nc" id="L924">                if (startingBounds.x + startingBounds.width - deltaX &gt;</span>
<span class="nc bnc" id="L925" title="All 2 branches missed.">                    parentBounds.width) {</span>
<span class="nc" id="L926">                  deltaX = startingBounds.x + startingBounds.width -</span>
<span class="nc" id="L927">                    parentBounds.width;</span>
                }

<span class="nc" id="L930">                newW = startingBounds.width - deltaX;</span>
<span class="nc" id="L931">                newH = startingBounds.height;</span>
<span class="nc" id="L932">                break;</span>
            case SOUTH_EAST:
<span class="nc bnc" id="L934" title="All 2 branches missed.">                if(startingBounds.width - deltaX &lt; min.width)</span>
<span class="nc" id="L935">                    deltaX = startingBounds.width - min.width;</span>
<span class="nc bnc" id="L936" title="All 2 branches missed.">                else if(startingBounds.width - deltaX &gt; max.width)</span>
<span class="nc" id="L937">                    deltaX = -(max.width - startingBounds.width);</span>
<span class="nc" id="L938">                if (startingBounds.x + startingBounds.width - deltaX &gt;</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">                    parentBounds.width) {</span>
<span class="nc" id="L940">                  deltaX = startingBounds.x + startingBounds.width -</span>
<span class="nc" id="L941">                    parentBounds.width;</span>
                }

<span class="nc bnc" id="L944" title="All 2 branches missed.">                if(startingBounds.height - deltaY &lt; min.height)</span>
<span class="nc" id="L945">                    deltaY = startingBounds.height - min.height;</span>
<span class="nc bnc" id="L946" title="All 2 branches missed.">                else if(startingBounds.height - deltaY &gt; max.height)</span>
<span class="nc" id="L947">                    deltaY = -(max.height - startingBounds.height);</span>
<span class="nc" id="L948">                if (startingBounds.y + startingBounds.height - deltaY &gt;</span>
<span class="nc bnc" id="L949" title="All 2 branches missed.">                     parentBounds.height) {</span>
<span class="nc" id="L950">                  deltaY = startingBounds.y + startingBounds.height -</span>
<span class="nc" id="L951">                    parentBounds.height ;</span>
                }

<span class="nc" id="L954">                newW = startingBounds.width - deltaX;</span>
<span class="nc" id="L955">                newH = startingBounds.height - deltaY;</span>
<span class="nc" id="L956">                break;</span>
            case SOUTH:
<span class="nc bnc" id="L958" title="All 2 branches missed.">                if(startingBounds.height - deltaY &lt; min.height)</span>
<span class="nc" id="L959">                    deltaY = startingBounds.height - min.height;</span>
<span class="nc bnc" id="L960" title="All 2 branches missed.">                else if(startingBounds.height - deltaY &gt; max.height)</span>
<span class="nc" id="L961">                    deltaY = -(max.height - startingBounds.height);</span>
<span class="nc" id="L962">                if (startingBounds.y + startingBounds.height - deltaY &gt;</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">                     parentBounds.height) {</span>
<span class="nc" id="L964">                  deltaY = startingBounds.y + startingBounds.height -</span>
<span class="nc" id="L965">                    parentBounds.height ;</span>
                }

<span class="nc" id="L968">                newW = startingBounds.width;</span>
<span class="nc" id="L969">                newH = startingBounds.height - deltaY;</span>
<span class="nc" id="L970">                break;</span>
            case SOUTH_WEST:
<span class="nc bnc" id="L972" title="All 2 branches missed.">                if(startingBounds.height - deltaY &lt; min.height)</span>
<span class="nc" id="L973">                    deltaY = startingBounds.height - min.height;</span>
<span class="nc bnc" id="L974" title="All 2 branches missed.">                else if(startingBounds.height - deltaY &gt; max.height)</span>
<span class="nc" id="L975">                    deltaY = -(max.height - startingBounds.height);</span>
<span class="nc" id="L976">                if (startingBounds.y + startingBounds.height - deltaY &gt;</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">                     parentBounds.height) {</span>
<span class="nc" id="L978">                  deltaY = startingBounds.y + startingBounds.height -</span>
<span class="nc" id="L979">                    parentBounds.height ;</span>
                }

<span class="nc bnc" id="L982" title="All 2 branches missed.">                if(startingBounds.width + deltaX &lt; min.width)</span>
<span class="nc" id="L983">                    deltaX = -(startingBounds.width - min.width);</span>
<span class="nc bnc" id="L984" title="All 2 branches missed.">                else if(startingBounds.width + deltaX &gt; max.width)</span>
<span class="nc" id="L985">                    deltaX = max.width - startingBounds.width;</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">                if (startingBounds.x - deltaX &lt; 0) {</span>
<span class="nc" id="L987">                  deltaX = startingBounds.x;</span>
                }

<span class="nc" id="L990">                newX = startingBounds.x - deltaX;</span>
<span class="nc" id="L991">                newY = startingBounds.y;</span>
<span class="nc" id="L992">                newW = startingBounds.width + deltaX;</span>
<span class="nc" id="L993">                newH = startingBounds.height - deltaY;</span>
<span class="nc" id="L994">                break;</span>
            case WEST:
<span class="nc bnc" id="L996" title="All 2 branches missed.">                if(startingBounds.width + deltaX &lt; min.width)</span>
<span class="nc" id="L997">                    deltaX = -(startingBounds.width - min.width);</span>
<span class="nc bnc" id="L998" title="All 2 branches missed.">                else if(startingBounds.width + deltaX &gt; max.width)</span>
<span class="nc" id="L999">                    deltaX = max.width - startingBounds.width;</span>
<span class="nc bnc" id="L1000" title="All 2 branches missed.">                if (startingBounds.x - deltaX &lt; 0) {</span>
<span class="nc" id="L1001">                  deltaX = startingBounds.x;</span>
                }

<span class="nc" id="L1004">                newX = startingBounds.x - deltaX;</span>
<span class="nc" id="L1005">                newY = startingBounds.y;</span>
<span class="nc" id="L1006">                newW = startingBounds.width + deltaX;</span>
<span class="nc" id="L1007">                newH = startingBounds.height;</span>
<span class="nc" id="L1008">                break;</span>
            case NORTH_WEST:
<span class="nc bnc" id="L1010" title="All 2 branches missed.">                if(startingBounds.width + deltaX &lt; min.width)</span>
<span class="nc" id="L1011">                    deltaX = -(startingBounds.width - min.width);</span>
<span class="nc bnc" id="L1012" title="All 2 branches missed.">                else if(startingBounds.width + deltaX &gt; max.width)</span>
<span class="nc" id="L1013">                    deltaX = max.width - startingBounds.width;</span>
<span class="nc bnc" id="L1014" title="All 2 branches missed.">                if (startingBounds.x - deltaX &lt; 0) {</span>
<span class="nc" id="L1015">                  deltaX = startingBounds.x;</span>
                }

<span class="nc bnc" id="L1018" title="All 2 branches missed.">                if(startingBounds.height + deltaY &lt; min.height)</span>
<span class="nc" id="L1019">                    deltaY = -(startingBounds.height - min.height);</span>
<span class="nc bnc" id="L1020" title="All 2 branches missed.">                else if(startingBounds.height + deltaY &gt; max.height)</span>
<span class="nc" id="L1021">                    deltaY = max.height - startingBounds.height;</span>
<span class="nc bnc" id="L1022" title="All 2 branches missed.">                if (startingBounds.y - deltaY &lt; 0) {deltaY = startingBounds.y;}</span>

<span class="nc" id="L1024">                newX = startingBounds.x - deltaX;</span>
<span class="nc" id="L1025">                newY = startingBounds.y - deltaY;</span>
<span class="nc" id="L1026">                newW = startingBounds.width + deltaX;</span>
<span class="nc" id="L1027">                newH = startingBounds.height + deltaY;</span>
<span class="nc" id="L1028">                break;</span>
            default:
<span class="nc" id="L1030">                return;</span>
            }
<span class="nc" id="L1032">            getDesktopManager().resizeFrame(frame, newX, newY, newW, newH);</span>
<span class="nc" id="L1033">        }</span>

        public void mouseMoved(MouseEvent e)    {

<span class="nc bnc" id="L1037" title="All 2 branches missed.">            if(!frame.isResizable())</span>
<span class="nc" id="L1038">                return;</span>

<span class="nc bnc" id="L1040" title="All 4 branches missed.">            if (e.getSource() == frame || e.getSource() == getNorthPane()) {</span>
<span class="nc" id="L1041">                Insets i = frame.getInsets();</span>
<span class="nc" id="L1042">                Point ep = new Point(e.getX(), e.getY());</span>
<span class="nc bnc" id="L1043" title="All 2 branches missed.">                if (e.getSource() == getNorthPane()) {</span>
<span class="nc" id="L1044">                    Point np = getNorthPane().getLocation();</span>
<span class="nc" id="L1045">                    ep.x += np.x;</span>
<span class="nc" id="L1046">                    ep.y += np.y;</span>
                }
<span class="nc bnc" id="L1048" title="All 2 branches missed.">                if(ep.x &lt;= i.left) {</span>
<span class="nc bnc" id="L1049" title="All 2 branches missed.">                    if(ep.y &lt; resizeCornerSize + i.top)</span>
<span class="nc" id="L1050">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.NW_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1051" title="All 2 branches missed.">                    else if(ep.y &gt; frame.getHeight() - resizeCornerSize - i.bottom)</span>
<span class="nc" id="L1052">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.SW_RESIZE_CURSOR));</span>
                    else
<span class="nc" id="L1054">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.W_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1055" title="All 2 branches missed.">                } else if(ep.x &gt;= frame.getWidth() - i.right) {</span>
<span class="nc bnc" id="L1056" title="All 2 branches missed.">                    if(e.getY() &lt; resizeCornerSize + i.top)</span>
<span class="nc" id="L1057">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.NE_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">                    else if(ep.y &gt; frame.getHeight() - resizeCornerSize - i.bottom)</span>
<span class="nc" id="L1059">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.SE_RESIZE_CURSOR));</span>
                    else
<span class="nc" id="L1061">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.E_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1062" title="All 2 branches missed.">                } else if(ep.y &lt;= i.top) {</span>
<span class="nc bnc" id="L1063" title="All 2 branches missed.">                    if(ep.x &lt; resizeCornerSize + i.left)</span>
<span class="nc" id="L1064">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.NW_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1065" title="All 2 branches missed.">                    else if(ep.x &gt; frame.getWidth() - resizeCornerSize - i.right)</span>
<span class="nc" id="L1066">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.NE_RESIZE_CURSOR));</span>
                    else
<span class="nc" id="L1068">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.N_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1069" title="All 2 branches missed.">                } else if(ep.y &gt;= frame.getHeight() - i.bottom) {</span>
<span class="nc bnc" id="L1070" title="All 2 branches missed.">                    if(ep.x &lt; resizeCornerSize + i.left)</span>
<span class="nc" id="L1071">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.SW_RESIZE_CURSOR));</span>
<span class="nc bnc" id="L1072" title="All 2 branches missed.">                    else if(ep.x &gt; frame.getWidth() - resizeCornerSize - i.right)</span>
<span class="nc" id="L1073">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.SE_RESIZE_CURSOR));</span>
                    else
<span class="nc" id="L1075">                        frame.setCursor(Cursor.getPredefinedCursor(Cursor.S_RESIZE_CURSOR));</span>
                }
                else
<span class="nc" id="L1078">                    updateFrameCursor();</span>
<span class="nc" id="L1079">                return;</span>
            }

<span class="nc" id="L1082">            updateFrameCursor();</span>
<span class="nc" id="L1083">        }</span>

        public void mouseEntered(MouseEvent e)    {
<span class="nc" id="L1086">            updateFrameCursor();</span>
<span class="nc" id="L1087">        }</span>

        public void mouseExited(MouseEvent e)    {
<span class="nc" id="L1090">            updateFrameCursor();</span>
<span class="nc" id="L1091">        }</span>

    }    /// End BorderListener Class

<span class="nc" id="L1095">    protected class ComponentHandler implements ComponentListener {</span>
      // NOTE: This class exists only for backward compatibility. All
      // its functionality has been moved into Handler. If you need to add
      // new functionality add it to the Handler, but make sure this
      // class calls into the Handler.
      /** Invoked when a JInternalFrame's parent's size changes. */
      public void componentResized(ComponentEvent e) {
<span class="nc" id="L1102">          getHandler().componentResized(e);</span>
<span class="nc" id="L1103">      }</span>

      public void componentMoved(ComponentEvent e) {
<span class="nc" id="L1106">          getHandler().componentMoved(e);</span>
<span class="nc" id="L1107">      }</span>
      public void componentShown(ComponentEvent e) {
<span class="nc" id="L1109">          getHandler().componentShown(e);</span>
<span class="nc" id="L1110">      }</span>
      public void componentHidden(ComponentEvent e) {
<span class="nc" id="L1112">          getHandler().componentHidden(e);</span>
<span class="nc" id="L1113">      }</span>
    }

    protected ComponentListener createComponentListener() {
<span class="nc" id="L1117">      return getHandler();</span>
    }


<span class="nc" id="L1121">    protected class GlassPaneDispatcher implements MouseInputListener {</span>
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        public void mousePressed(MouseEvent e) {
<span class="nc" id="L1127">            getHandler().mousePressed(e);</span>
<span class="nc" id="L1128">        }</span>

        public void mouseEntered(MouseEvent e) {
<span class="nc" id="L1131">            getHandler().mouseEntered(e);</span>
<span class="nc" id="L1132">        }</span>

        public void mouseMoved(MouseEvent e) {
<span class="nc" id="L1135">            getHandler().mouseMoved(e);</span>
<span class="nc" id="L1136">        }</span>

        public void mouseExited(MouseEvent e) {
<span class="nc" id="L1139">            getHandler().mouseExited(e);</span>
<span class="nc" id="L1140">        }</span>

        public void mouseClicked(MouseEvent e) {
<span class="nc" id="L1143">            getHandler().mouseClicked(e);</span>
<span class="nc" id="L1144">        }</span>

        public void mouseReleased(MouseEvent e) {
<span class="nc" id="L1147">            getHandler().mouseReleased(e);</span>
<span class="nc" id="L1148">        }</span>

        public void mouseDragged(MouseEvent e) {
<span class="nc" id="L1151">            getHandler().mouseDragged(e);</span>
<span class="nc" id="L1152">        }</span>
    }

    protected MouseInputListener createGlassPaneDispatcher() {
<span class="nc" id="L1156">        return null;</span>
    }


<span class="nc" id="L1160">    protected class BasicInternalFrameListener implements InternalFrameListener</span>
    {
      // NOTE: This class exists only for backward compatibility. All
      // its functionality has been moved into Handler. If you need to add
      // new functionality add it to the Handler, but make sure this
      // class calls into the Handler.
      public void internalFrameClosing(InternalFrameEvent e) {
<span class="nc" id="L1167">          getHandler().internalFrameClosing(e);</span>
<span class="nc" id="L1168">      }</span>

      public void internalFrameClosed(InternalFrameEvent e) {
<span class="nc" id="L1171">          getHandler().internalFrameClosed(e);</span>
<span class="nc" id="L1172">      }</span>

      public void internalFrameOpened(InternalFrameEvent e) {
<span class="nc" id="L1175">          getHandler().internalFrameOpened(e);</span>
<span class="nc" id="L1176">      }</span>

      public void internalFrameIconified(InternalFrameEvent e) {
<span class="nc" id="L1179">          getHandler().internalFrameIconified(e);</span>
<span class="nc" id="L1180">      }</span>

      public void internalFrameDeiconified(InternalFrameEvent e) {
<span class="nc" id="L1183">          getHandler().internalFrameDeiconified(e);</span>
<span class="nc" id="L1184">      }</span>

      public void internalFrameActivated(InternalFrameEvent e) {
<span class="nc" id="L1187">          getHandler().internalFrameActivated(e);</span>
<span class="nc" id="L1188">      }</span>


      public void internalFrameDeactivated(InternalFrameEvent e) {
<span class="nc" id="L1192">          getHandler().internalFrameDeactivated(e);</span>
<span class="nc" id="L1193">      }</span>
    }

<span class="nc" id="L1196">    private class Handler implements ComponentListener, InternalFrameListener,</span>
            LayoutManager, MouseInputListener, PropertyChangeListener,
            WindowFocusListener, SwingConstants {

        public void windowGainedFocus(WindowEvent e) {
<span class="nc" id="L1201">        }</span>

        public void windowLostFocus(WindowEvent e) {
            // Cancel a resize which may be in progress, when a
            // WINDOW_LOST_FOCUS event occurs, which may be
            // caused by an Alt-Tab or a modal dialog popup.
<span class="nc" id="L1207">            cancelResize();</span>
<span class="nc" id="L1208">        }</span>

        // ComponentHandler methods
        /** Invoked when a JInternalFrame's parent's size changes. */
        public void componentResized(ComponentEvent e) {
            // Get the JInternalFrame's parent container size
<span class="nc" id="L1214">            Rectangle parentNewBounds = ((Component) e.getSource()).getBounds();</span>
<span class="nc" id="L1215">            JInternalFrame.JDesktopIcon icon = null;</span>

<span class="nc bnc" id="L1217" title="All 2 branches missed.">            if (frame != null) {</span>
<span class="nc" id="L1218">                icon = frame.getDesktopIcon();</span>
                // Resize the internal frame if it is maximized and relocate
                // the associated icon as well.
<span class="nc bnc" id="L1221" title="All 2 branches missed.">                if (frame.isMaximum()) {</span>
<span class="nc" id="L1222">                    frame.setBounds(0, 0, parentNewBounds.width,</span>
                        parentNewBounds.height);
                }
            }

            // Relocate the icon base on the new parent bounds.
<span class="nc bnc" id="L1228" title="All 2 branches missed.">            if (icon != null) {</span>
<span class="nc" id="L1229">                Rectangle iconBounds = icon.getBounds();</span>
<span class="nc" id="L1230">                int y = iconBounds.y +</span>
<span class="nc" id="L1231">                        (parentNewBounds.height - parentBounds.height);</span>
<span class="nc" id="L1232">                icon.setBounds(iconBounds.x, y,</span>
                        iconBounds.width, iconBounds.height);
            }

            // Update the new parent bounds for next resize.
<span class="nc bnc" id="L1237" title="All 2 branches missed.">            if (!parentBounds.equals(parentNewBounds)) {</span>
<span class="nc" id="L1238">                parentBounds = parentNewBounds;</span>
            }

            // Validate the component tree for this container.
<span class="nc bnc" id="L1242" title="All 2 branches missed.">            if (frame != null) frame.validate();</span>
<span class="nc" id="L1243">        }</span>

<span class="nc" id="L1245">        public void componentMoved(ComponentEvent e) {}</span>
<span class="nc" id="L1246">        public void componentShown(ComponentEvent e) {}</span>
<span class="nc" id="L1247">        public void componentHidden(ComponentEvent e) {}</span>


        // InternalFrameListener
        public void internalFrameClosed(InternalFrameEvent e) {
<span class="nc" id="L1252">            frame.removeInternalFrameListener(getHandler());</span>
<span class="nc" id="L1253">        }</span>

        public void internalFrameActivated(InternalFrameEvent e) {
<span class="nc bnc" id="L1256" title="All 2 branches missed.">            if (!isKeyBindingRegistered()){</span>
<span class="nc" id="L1257">                setKeyBindingRegistered(true);</span>
<span class="nc" id="L1258">                setupMenuOpenKey();</span>
<span class="nc" id="L1259">                setupMenuCloseKey();</span>
            }
<span class="nc bnc" id="L1261" title="All 2 branches missed.">            if (isKeyBindingRegistered())</span>
<span class="nc" id="L1262">                setKeyBindingActive(true);</span>
<span class="nc" id="L1263">        }</span>

        public void internalFrameDeactivated(InternalFrameEvent e) {
<span class="nc" id="L1266">            setKeyBindingActive(false);</span>
<span class="nc" id="L1267">        }</span>

<span class="nc" id="L1269">        public void internalFrameClosing(InternalFrameEvent e) { }</span>
<span class="nc" id="L1270">        public void internalFrameOpened(InternalFrameEvent e) { }</span>
<span class="nc" id="L1271">        public void internalFrameIconified(InternalFrameEvent e) { }</span>
<span class="nc" id="L1272">        public void internalFrameDeiconified(InternalFrameEvent e) { }</span>


        // LayoutManager
<span class="nc" id="L1276">        public void addLayoutComponent(String name, Component c) {}</span>
<span class="nc" id="L1277">        public void removeLayoutComponent(Component c) {}</span>
        public Dimension preferredLayoutSize(Container c)  {
            Dimension result;
<span class="nc" id="L1280">            Insets i = frame.getInsets();</span>

<span class="nc" id="L1282">            result = new Dimension(frame.getRootPane().getPreferredSize());</span>
<span class="nc" id="L1283">            result.width += i.left + i.right;</span>
<span class="nc" id="L1284">            result.height += i.top + i.bottom;</span>

<span class="nc bnc" id="L1286" title="All 2 branches missed.">            if(getNorthPane() != null) {</span>
<span class="nc" id="L1287">                Dimension d = getNorthPane().getPreferredSize();</span>
<span class="nc" id="L1288">                result.width = Math.max(d.width, result.width);</span>
<span class="nc" id="L1289">                result.height += d.height;</span>
            }

<span class="nc bnc" id="L1292" title="All 2 branches missed.">            if(getSouthPane() != null) {</span>
<span class="nc" id="L1293">                Dimension d = getSouthPane().getPreferredSize();</span>
<span class="nc" id="L1294">                result.width = Math.max(d.width, result.width);</span>
<span class="nc" id="L1295">                result.height += d.height;</span>
            }

<span class="nc bnc" id="L1298" title="All 2 branches missed.">            if(getEastPane() != null) {</span>
<span class="nc" id="L1299">                Dimension d = getEastPane().getPreferredSize();</span>
<span class="nc" id="L1300">                result.width += d.width;</span>
<span class="nc" id="L1301">                result.height = Math.max(d.height, result.height);</span>
            }

<span class="nc bnc" id="L1304" title="All 2 branches missed.">            if(getWestPane() != null) {</span>
<span class="nc" id="L1305">                Dimension d = getWestPane().getPreferredSize();</span>
<span class="nc" id="L1306">                result.width += d.width;</span>
<span class="nc" id="L1307">                result.height = Math.max(d.height, result.height);</span>
            }
<span class="nc" id="L1309">            return result;</span>
        }

        public Dimension minimumLayoutSize(Container c) {
            // The minimum size of the internal frame only takes into
            // account the title pane since you are allowed to resize
            // the frames to the point where just the title pane is visible.
<span class="nc" id="L1316">            Dimension result = new Dimension();</span>
<span class="nc bnc" id="L1317" title="All 2 branches missed.">            if (getNorthPane() != null &amp;&amp;</span>
<span class="nc bnc" id="L1318" title="All 2 branches missed.">                getNorthPane() instanceof BasicInternalFrameTitlePane) {</span>
<span class="nc" id="L1319">                  result = new Dimension(getNorthPane().getMinimumSize());</span>
            }
<span class="nc" id="L1321">            Insets i = frame.getInsets();</span>
<span class="nc" id="L1322">            result.width += i.left + i.right;</span>
<span class="nc" id="L1323">            result.height += i.top + i.bottom;</span>

<span class="nc" id="L1325">            return result;</span>
        }

        public void layoutContainer(Container c) {
<span class="nc" id="L1329">            Insets i = frame.getInsets();</span>
            int cx, cy, cw, ch;

<span class="nc" id="L1332">            cx = i.left;</span>
<span class="nc" id="L1333">            cy = i.top;</span>
<span class="nc" id="L1334">            cw = frame.getWidth() - i.left - i.right;</span>
<span class="nc" id="L1335">            ch = frame.getHeight() - i.top - i.bottom;</span>

<span class="nc bnc" id="L1337" title="All 2 branches missed.">            if(getNorthPane() != null) {</span>
<span class="nc" id="L1338">                Dimension size = getNorthPane().getPreferredSize();</span>
<span class="nc bnc" id="L1339" title="All 2 branches missed.">                if (DefaultLookup.getBoolean(frame, BasicInternalFrameUI.this,</span>
                          &quot;InternalFrame.layoutTitlePaneAtOrigin&quot;, false)) {
<span class="nc" id="L1341">                    cy = 0;</span>
<span class="nc" id="L1342">                    ch += i.top;</span>
<span class="nc" id="L1343">                    getNorthPane().setBounds(0, 0, frame.getWidth(),</span>
                                             size.height);
                }
                else {
<span class="nc" id="L1347">                    getNorthPane().setBounds(cx, cy, cw, size.height);</span>
                }
<span class="nc" id="L1349">                cy += size.height;</span>
<span class="nc" id="L1350">                ch -= size.height;</span>
            }

<span class="nc bnc" id="L1353" title="All 2 branches missed.">            if(getSouthPane() != null) {</span>
<span class="nc" id="L1354">                Dimension size = getSouthPane().getPreferredSize();</span>
<span class="nc" id="L1355">                getSouthPane().setBounds(cx, frame.getHeight()</span>
                                                    - i.bottom - size.height,
                                                    cw, size.height);
<span class="nc" id="L1358">                ch -= size.height;</span>
            }

<span class="nc bnc" id="L1361" title="All 2 branches missed.">            if(getWestPane() != null) {</span>
<span class="nc" id="L1362">                Dimension size = getWestPane().getPreferredSize();</span>
<span class="nc" id="L1363">                getWestPane().setBounds(cx, cy, size.width, ch);</span>
<span class="nc" id="L1364">                cw -= size.width;</span>
<span class="nc" id="L1365">                cx += size.width;</span>
            }

<span class="nc bnc" id="L1368" title="All 2 branches missed.">            if(getEastPane() != null) {</span>
<span class="nc" id="L1369">                Dimension size = getEastPane().getPreferredSize();</span>
<span class="nc" id="L1370">                getEastPane().setBounds(cw - size.width, cy, size.width, ch);</span>
<span class="nc" id="L1371">                cw -= size.width;</span>
            }

<span class="nc bnc" id="L1374" title="All 2 branches missed.">            if(frame.getRootPane() != null) {</span>
<span class="nc" id="L1375">                frame.getRootPane().setBounds(cx, cy, cw, ch);</span>
            }
<span class="nc" id="L1377">        }</span>


        // MouseInputListener
<span class="nc" id="L1381">        public void mousePressed(MouseEvent e) { }</span>

<span class="nc" id="L1383">        public void mouseEntered(MouseEvent e) { }</span>

<span class="nc" id="L1385">        public void mouseMoved(MouseEvent e) { }</span>

<span class="nc" id="L1387">        public void mouseExited(MouseEvent e) { }</span>

<span class="nc" id="L1389">        public void mouseClicked(MouseEvent e) { }</span>

<span class="nc" id="L1391">        public void mouseReleased(MouseEvent e) { }</span>

<span class="nc" id="L1393">        public void mouseDragged(MouseEvent e) { }</span>

        // PropertyChangeListener
        public void propertyChange(PropertyChangeEvent evt) {
<span class="nc" id="L1397">            String prop = evt.getPropertyName();</span>
<span class="nc" id="L1398">            JInternalFrame f = (JInternalFrame)evt.getSource();</span>
<span class="nc" id="L1399">            Object newValue = evt.getNewValue();</span>
<span class="nc" id="L1400">            Object oldValue = evt.getOldValue();</span>

<span class="nc bnc" id="L1402" title="All 2 branches missed.">            if (JInternalFrame.IS_CLOSED_PROPERTY == prop) {</span>
<span class="nc bnc" id="L1403" title="All 2 branches missed.">                if (newValue == Boolean.TRUE) {</span>
                    // Cancel a resize in progress if the internal frame
                    // gets a setClosed(true) or dispose().
<span class="nc" id="L1406">                    cancelResize();</span>
<span class="nc bnc" id="L1407" title="All 4 branches missed.">                    if ((frame.getParent() != null) &amp;&amp; componentListenerAdded) {</span>
<span class="nc" id="L1408">                        frame.getParent().removeComponentListener(componentListener);</span>
                    }
<span class="nc" id="L1410">                    closeFrame(f);</span>
                }
<span class="nc bnc" id="L1412" title="All 2 branches missed.">            } else if (JInternalFrame.IS_MAXIMUM_PROPERTY == prop) {</span>
<span class="nc bnc" id="L1413" title="All 2 branches missed.">                if(newValue == Boolean.TRUE) {</span>
<span class="nc" id="L1414">                    maximizeFrame(f);</span>
                } else {
<span class="nc" id="L1416">                    minimizeFrame(f);</span>
                }
<span class="nc bnc" id="L1418" title="All 2 branches missed.">            } else if(JInternalFrame.IS_ICON_PROPERTY == prop) {</span>
<span class="nc bnc" id="L1419" title="All 2 branches missed.">                if (newValue == Boolean.TRUE) {</span>
<span class="nc" id="L1420">                    iconifyFrame(f);</span>
                } else {
<span class="nc" id="L1422">                    deiconifyFrame(f);</span>
                }
<span class="nc bnc" id="L1424" title="All 2 branches missed.">            } else if (JInternalFrame.IS_SELECTED_PROPERTY == prop) {</span>
<span class="nc bnc" id="L1425" title="All 4 branches missed.">                if (newValue == Boolean.TRUE &amp;&amp; oldValue == Boolean.FALSE) {</span>
<span class="nc" id="L1426">                    activateFrame(f);</span>
<span class="nc bnc" id="L1427" title="All 4 branches missed.">                } else if (newValue == Boolean.FALSE &amp;&amp;</span>
                           oldValue == Boolean.TRUE) {
<span class="nc" id="L1429">                    deactivateFrame(f);</span>
                }
<span class="nc bnc" id="L1431" title="All 2 branches missed.">            } else if (prop == &quot;ancestor&quot;) {</span>
<span class="nc bnc" id="L1432" title="All 2 branches missed.">                if (newValue == null) {</span>
                    // Cancel a resize in progress, if the internal frame
                    // gets a remove(), removeNotify() or setIcon(true).
<span class="nc" id="L1435">                    cancelResize();</span>
                }
<span class="nc bnc" id="L1437" title="All 2 branches missed.">                if (frame.getParent() != null) {</span>
<span class="nc" id="L1438">                    parentBounds = f.getParent().getBounds();</span>
                } else {
<span class="nc" id="L1440">                    parentBounds = null;</span>
                }
<span class="nc bnc" id="L1442" title="All 4 branches missed.">                if ((frame.getParent() != null) &amp;&amp; !componentListenerAdded) {</span>
<span class="nc" id="L1443">                    f.getParent().addComponentListener(componentListener);</span>
<span class="nc" id="L1444">                    componentListenerAdded = true;</span>
                }
<span class="nc bnc" id="L1446" title="All 8 branches missed.">            } else if (JInternalFrame.TITLE_PROPERTY == prop ||</span>
                    prop == &quot;closable&quot; || prop == &quot;iconable&quot; ||
                    prop == &quot;maximizable&quot;) {
<span class="nc" id="L1449">                Dimension dim = frame.getMinimumSize();</span>
<span class="nc" id="L1450">                Dimension frame_dim = frame.getSize();</span>
<span class="nc bnc" id="L1451" title="All 2 branches missed.">                if (dim.width &gt; frame_dim.width) {</span>
<span class="nc" id="L1452">                    frame.setSize(dim.width, frame_dim.height);</span>
                }
            }
<span class="nc" id="L1455">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>