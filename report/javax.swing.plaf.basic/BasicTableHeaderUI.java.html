<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>BasicTableHeaderUI.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.basic</a> &gt; <span class="el_source">BasicTableHeaderUI.java</span></div><h1>BasicTableHeaderUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.basic;

import java.awt.*;
import java.awt.event.*;
import java.util.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.plaf.*;
import javax.swing.table.*;

import sun.swing.*;

/**
 * BasicTableHeaderUI implementation
 *
 * @author Alan Chung
 * @author Philip Milne
 */
<span class="nc" id="L44">public class BasicTableHeaderUI extends TableHeaderUI {</span>

<span class="nc" id="L46">    private static Cursor resizeCursor = Cursor.getPredefinedCursor(Cursor.E_RESIZE_CURSOR);</span>

//
// Instance Variables
//

    /** The JTableHeader that is delegating the painting to this UI. */
    protected JTableHeader header;
    protected CellRendererPane rendererPane;

    // Listeners that are attached to the JTable
    protected MouseInputListener mouseInputListener;

    // The column header over which the mouse currently is.
<span class="nc" id="L60">    private int rolloverColumn = -1;</span>

    // The column that should be highlighted when the table header has the focus.
<span class="nc" id="L63">    private int selectedColumnIndex = 0; // Read ONLY via getSelectedColumnIndex!</span>

<span class="nc" id="L65">    private static FocusListener focusListener = new FocusListener() {</span>
        public void focusGained(FocusEvent e) {
<span class="nc" id="L67">            repaintHeader(e.getSource());</span>
<span class="nc" id="L68">        }</span>

        public void focusLost(FocusEvent e) {
<span class="nc" id="L71">            repaintHeader(e.getSource());</span>
<span class="nc" id="L72">        }</span>

        private void repaintHeader(Object source) {
<span class="nc bnc" id="L75" title="All 2 branches missed.">            if (source instanceof JTableHeader) {</span>
<span class="nc" id="L76">                JTableHeader th = (JTableHeader)source;</span>
<span class="nc" id="L77">                BasicTableHeaderUI ui =</span>
                   (BasicTableHeaderUI)BasicLookAndFeel.
<span class="nc" id="L79">                                        getUIOfType(th.getUI(),</span>
                                            BasicTableHeaderUI.class);
<span class="nc bnc" id="L81" title="All 2 branches missed.">                if (ui == null) {</span>
<span class="nc" id="L82">                    return;</span>
                }

<span class="nc" id="L85">                th.repaint(th.getHeaderRect(ui.getSelectedColumnIndex()));</span>
            }
<span class="nc" id="L87">        }</span>
    };

    /**
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of {@code BasicTableHeaderUI}.
     */
<span class="nc" id="L94">    public class MouseInputHandler implements MouseInputListener {</span>

        private int mouseXOffset;
<span class="nc" id="L97">        private Cursor otherCursor = resizeCursor;</span>

        public void mouseClicked(MouseEvent e) {
<span class="nc bnc" id="L100" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L101">                return;</span>
            }
<span class="nc bnc" id="L103" title="All 2 branches missed.">            if (e.getClickCount() % 2 == 1 &amp;&amp;</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">                    SwingUtilities.isLeftMouseButton(e)) {</span>
<span class="nc" id="L105">                JTable table = header.getTable();</span>
                RowSorter sorter;
<span class="nc bnc" id="L107" title="All 4 branches missed.">                if (table != null &amp;&amp; (sorter = table.getRowSorter()) != null) {</span>
<span class="nc" id="L108">                    int columnIndex = header.columnAtPoint(e.getPoint());</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">                    if (columnIndex != -1) {</span>
<span class="nc" id="L110">                        columnIndex = table.convertColumnIndexToModel(</span>
                                columnIndex);
<span class="nc" id="L112">                        sorter.toggleSortOrder(columnIndex);</span>
                    }
                }
            }
<span class="nc" id="L116">        }</span>

        private TableColumn getResizingColumn(Point p) {
<span class="nc" id="L119">            return getResizingColumn(p, header.columnAtPoint(p));</span>
        }

        private TableColumn getResizingColumn(Point p, int column) {
<span class="nc bnc" id="L123" title="All 2 branches missed.">            if (column == -1) {</span>
<span class="nc" id="L124">                 return null;</span>
            }
<span class="nc" id="L126">            Rectangle r = header.getHeaderRect(column);</span>
<span class="nc" id="L127">            r.grow(-3, 0);</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">            if (r.contains(p)) {</span>
<span class="nc" id="L129">                return null;</span>
            }
<span class="nc" id="L131">            int midPoint = r.x + r.width/2;</span>
            int columnIndex;
<span class="nc bnc" id="L133" title="All 2 branches missed.">            if( header.getComponentOrientation().isLeftToRight() ) {</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">                columnIndex = (p.x &lt; midPoint) ? column - 1 : column;</span>
            } else {
<span class="nc bnc" id="L136" title="All 2 branches missed.">                columnIndex = (p.x &lt; midPoint) ? column : column - 1;</span>
            }
<span class="nc bnc" id="L138" title="All 2 branches missed.">            if (columnIndex == -1) {</span>
<span class="nc" id="L139">                return null;</span>
            }
<span class="nc" id="L141">            return header.getColumnModel().getColumn(columnIndex);</span>
        }

        public void mousePressed(MouseEvent e) {
<span class="nc bnc" id="L145" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L146">                return;</span>
            }
<span class="nc" id="L148">            header.setDraggedColumn(null);</span>
<span class="nc" id="L149">            header.setResizingColumn(null);</span>
<span class="nc" id="L150">            header.setDraggedDistance(0);</span>

<span class="nc" id="L152">            Point p = e.getPoint();</span>

            // First find which header cell was hit
<span class="nc" id="L155">            TableColumnModel columnModel = header.getColumnModel();</span>
<span class="nc" id="L156">            int index = header.columnAtPoint(p);</span>

<span class="nc bnc" id="L158" title="All 2 branches missed.">            if (index != -1) {</span>
                // The last 3 pixels + 3 pixels of next column are for resizing
<span class="nc" id="L160">                TableColumn resizingColumn = getResizingColumn(p, index);</span>
<span class="nc bnc" id="L161" title="All 2 branches missed.">                if (canResize(resizingColumn, header)) {</span>
<span class="nc" id="L162">                    header.setResizingColumn(resizingColumn);</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">                    if( header.getComponentOrientation().isLeftToRight() ) {</span>
<span class="nc" id="L164">                        mouseXOffset = p.x - resizingColumn.getWidth();</span>
                    } else {
<span class="nc" id="L166">                        mouseXOffset = p.x + resizingColumn.getWidth();</span>
                    }
                }
<span class="nc bnc" id="L169" title="All 2 branches missed.">                else if (header.getReorderingAllowed()) {</span>
<span class="nc" id="L170">                    TableColumn hitColumn = columnModel.getColumn(index);</span>
<span class="nc" id="L171">                    header.setDraggedColumn(hitColumn);</span>
<span class="nc" id="L172">                    mouseXOffset = p.x;</span>
                }
            }

<span class="nc bnc" id="L176" title="All 2 branches missed.">            if (header.getReorderingAllowed()) {</span>
<span class="nc" id="L177">                int oldRolloverColumn = rolloverColumn;</span>
<span class="nc" id="L178">                rolloverColumn = -1;</span>
<span class="nc" id="L179">                rolloverColumnUpdated(oldRolloverColumn, rolloverColumn);</span>
            }
<span class="nc" id="L181">        }</span>

        private void swapCursor() {
<span class="nc" id="L184">            Cursor tmp = header.getCursor();</span>
<span class="nc" id="L185">            header.setCursor(otherCursor);</span>
<span class="nc" id="L186">            otherCursor = tmp;</span>
<span class="nc" id="L187">        }</span>

        public void mouseMoved(MouseEvent e) {
<span class="nc bnc" id="L190" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L191">                return;</span>
            }
<span class="nc" id="L193">            if (canResize(getResizingColumn(e.getPoint()), header) !=</span>
<span class="nc bnc" id="L194" title="All 4 branches missed.">                (header.getCursor() == resizeCursor)) {</span>
<span class="nc" id="L195">                swapCursor();</span>
            }
<span class="nc" id="L197">            updateRolloverColumn(e);</span>
<span class="nc" id="L198">       }</span>

        public void mouseDragged(MouseEvent e) {
<span class="nc bnc" id="L201" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L202">                return;</span>
            }
<span class="nc" id="L204">            int mouseX = e.getX();</span>

<span class="nc" id="L206">            TableColumn resizingColumn  = header.getResizingColumn();</span>
<span class="nc" id="L207">            TableColumn draggedColumn  = header.getDraggedColumn();</span>

<span class="nc" id="L209">            boolean headerLeftToRight = header.getComponentOrientation().isLeftToRight();</span>

<span class="nc bnc" id="L211" title="All 2 branches missed.">            if (resizingColumn != null) {</span>
<span class="nc" id="L212">                int oldWidth = resizingColumn.getWidth();</span>
                int newWidth;
<span class="nc bnc" id="L214" title="All 2 branches missed.">                if (headerLeftToRight) {</span>
<span class="nc" id="L215">                    newWidth = mouseX - mouseXOffset;</span>
                } else  {
<span class="nc" id="L217">                    newWidth = mouseXOffset - mouseX;</span>
                }
<span class="nc" id="L219">                mouseXOffset += changeColumnWidth(resizingColumn, header,</span>
                                                  oldWidth, newWidth);
<span class="nc" id="L221">            }</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">            else if (draggedColumn != null) {</span>
<span class="nc" id="L223">                TableColumnModel cm = header.getColumnModel();</span>
<span class="nc" id="L224">                int draggedDistance = mouseX - mouseXOffset;</span>
<span class="nc bnc" id="L225" title="All 2 branches missed.">                int direction = (draggedDistance &lt; 0) ? -1 : 1;</span>
<span class="nc" id="L226">                int columnIndex = viewIndexForColumn(draggedColumn);</span>
<span class="nc bnc" id="L227" title="All 2 branches missed.">                int newColumnIndex = columnIndex + (headerLeftToRight ? direction : -direction);</span>
<span class="nc bnc" id="L228" title="All 4 branches missed.">                if (0 &lt;= newColumnIndex &amp;&amp; newColumnIndex &lt; cm.getColumnCount()) {</span>
<span class="nc" id="L229">                    int width = cm.getColumn(newColumnIndex).getWidth();</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">                    if (Math.abs(draggedDistance) &gt; (width / 2)) {</span>

<span class="nc" id="L232">                        mouseXOffset = mouseXOffset + direction * width;</span>
<span class="nc" id="L233">                        header.setDraggedDistance(draggedDistance - direction * width);</span>

                        //Cache the selected column.
<span class="nc" id="L236">                        int selectedIndex =</span>
<span class="nc" id="L237">                                SwingUtilities2.convertColumnIndexToModel(</span>
<span class="nc" id="L238">                                        header.getColumnModel(),</span>
<span class="nc" id="L239">                                        getSelectedColumnIndex());</span>

                        //Now do the move.
<span class="nc" id="L242">                        cm.moveColumn(columnIndex, newColumnIndex);</span>

                        //Update the selected index.
<span class="nc" id="L245">                        selectColumn(</span>
<span class="nc" id="L246">                            SwingUtilities2.convertColumnIndexToView(</span>
<span class="nc" id="L247">                                    header.getColumnModel(), selectedIndex),</span>
                            false);

<span class="nc" id="L250">                        return;</span>
                    }
                }
<span class="nc" id="L253">                setDraggedDistance(draggedDistance, columnIndex);</span>
            }

<span class="nc" id="L256">            updateRolloverColumn(e);</span>
<span class="nc" id="L257">        }</span>

        public void mouseReleased(MouseEvent e) {
<span class="nc bnc" id="L260" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L261">                return;</span>
            }
<span class="nc" id="L263">            setDraggedDistance(0, viewIndexForColumn(header.getDraggedColumn()));</span>

<span class="nc" id="L265">            header.setResizingColumn(null);</span>
<span class="nc" id="L266">            header.setDraggedColumn(null);</span>

<span class="nc" id="L268">            updateRolloverColumn(e);</span>
<span class="nc" id="L269">        }</span>

        public void mouseEntered(MouseEvent e) {
<span class="nc bnc" id="L272" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L273">                return;</span>
            }
<span class="nc" id="L275">            updateRolloverColumn(e);</span>
<span class="nc" id="L276">        }</span>

        public void mouseExited(MouseEvent e) {
<span class="nc bnc" id="L279" title="All 2 branches missed.">            if (!header.isEnabled()) {</span>
<span class="nc" id="L280">                return;</span>
            }
<span class="nc" id="L282">            int oldRolloverColumn = rolloverColumn;</span>
<span class="nc" id="L283">            rolloverColumn = -1;</span>
<span class="nc" id="L284">            rolloverColumnUpdated(oldRolloverColumn, rolloverColumn);</span>
<span class="nc" id="L285">        }</span>
//
// Protected &amp; Private Methods
//

        private void setDraggedDistance(int draggedDistance, int column) {
<span class="nc" id="L291">            header.setDraggedDistance(draggedDistance);</span>
<span class="nc bnc" id="L292" title="All 2 branches missed.">            if (column != -1) {</span>
<span class="nc" id="L293">                header.getColumnModel().moveColumn(column, column);</span>
            }
<span class="nc" id="L295">        }</span>
    }

//
//  Factory methods for the Listeners
//

    /**
     * Creates the mouse listener for the JTableHeader.
     */
    protected MouseInputListener createMouseInputListener() {
<span class="nc" id="L306">        return new MouseInputHandler();</span>
    }

//
//  The installation/uninstall procedures and support
//

    public static ComponentUI createUI(JComponent h) {
<span class="nc" id="L314">        return new BasicTableHeaderUI();</span>
    }

//  Installation

    public void installUI(JComponent c) {
<span class="nc" id="L320">        header = (JTableHeader)c;</span>

<span class="nc" id="L322">        rendererPane = new CellRendererPane();</span>
<span class="nc" id="L323">        header.add(rendererPane);</span>

<span class="nc" id="L325">        installDefaults();</span>
<span class="nc" id="L326">        installListeners();</span>
<span class="nc" id="L327">        installKeyboardActions();</span>
<span class="nc" id="L328">    }</span>

    /**
     * Initializes JTableHeader properties such as font, foreground, and background.
     * The font, foreground, and background properties are only set if their
     * current value is either null or a UIResource, other properties are set
     * if the current value is null.
     *
     * @see #installUI
     */
    protected void installDefaults() {
<span class="nc" id="L339">        LookAndFeel.installColorsAndFont(header, &quot;TableHeader.background&quot;,</span>
                                         &quot;TableHeader.foreground&quot;, &quot;TableHeader.font&quot;);
<span class="nc" id="L341">        LookAndFeel.installProperty(header, &quot;opaque&quot;, Boolean.TRUE);</span>
<span class="nc" id="L342">    }</span>

    /**
     * Attaches listeners to the JTableHeader.
     */
    protected void installListeners() {
<span class="nc" id="L348">        mouseInputListener = createMouseInputListener();</span>

<span class="nc" id="L350">        header.addMouseListener(mouseInputListener);</span>
<span class="nc" id="L351">        header.addMouseMotionListener(mouseInputListener);</span>
<span class="nc" id="L352">        header.addFocusListener(focusListener);</span>
<span class="nc" id="L353">    }</span>

    /**
     * Register all keyboard actions on the JTableHeader.
     */
    protected void installKeyboardActions() {
<span class="nc" id="L359">        InputMap keyMap = (InputMap)DefaultLookup.get(header, this,</span>
                &quot;TableHeader.ancestorInputMap&quot;);
<span class="nc" id="L361">        SwingUtilities.replaceUIInputMap(header,</span>
                                JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT, keyMap);
<span class="nc" id="L363">        LazyActionMap.installLazyActionMap(header, BasicTableHeaderUI.class,</span>
                &quot;TableHeader.actionMap&quot;);
<span class="nc" id="L365">    }</span>

// Uninstall methods

    public void uninstallUI(JComponent c) {
<span class="nc" id="L370">        uninstallDefaults();</span>
<span class="nc" id="L371">        uninstallListeners();</span>
<span class="nc" id="L372">        uninstallKeyboardActions();</span>

<span class="nc" id="L374">        header.remove(rendererPane);</span>
<span class="nc" id="L375">        rendererPane = null;</span>
<span class="nc" id="L376">        header = null;</span>
<span class="nc" id="L377">    }</span>

<span class="nc" id="L379">    protected void uninstallDefaults() {}</span>

    protected void uninstallListeners() {
<span class="nc" id="L382">        header.removeMouseListener(mouseInputListener);</span>
<span class="nc" id="L383">        header.removeMouseMotionListener(mouseInputListener);</span>

<span class="nc" id="L385">        mouseInputListener = null;</span>
<span class="nc" id="L386">    }</span>

    /**
     * Unregisters default key actions.
     */
    protected void uninstallKeyboardActions() {
<span class="nc" id="L392">        SwingUtilities.replaceUIInputMap(header, JComponent.WHEN_FOCUSED, null);</span>
<span class="nc" id="L393">        SwingUtilities.replaceUIActionMap(header, null);</span>
<span class="nc" id="L394">    }</span>

    /**
     * Populates TableHeader's actions.
     */
    static void loadActionMap(LazyActionMap map) {
<span class="nc" id="L400">        map.put(new Actions(Actions.TOGGLE_SORT_ORDER));</span>
<span class="nc" id="L401">        map.put(new Actions(Actions.SELECT_COLUMN_TO_LEFT));</span>
<span class="nc" id="L402">        map.put(new Actions(Actions.SELECT_COLUMN_TO_RIGHT));</span>
<span class="nc" id="L403">        map.put(new Actions(Actions.MOVE_COLUMN_LEFT));</span>
<span class="nc" id="L404">        map.put(new Actions(Actions.MOVE_COLUMN_RIGHT));</span>
<span class="nc" id="L405">        map.put(new Actions(Actions.RESIZE_LEFT));</span>
<span class="nc" id="L406">        map.put(new Actions(Actions.RESIZE_RIGHT));</span>
<span class="nc" id="L407">        map.put(new Actions(Actions.FOCUS_TABLE));</span>
<span class="nc" id="L408">    }</span>

//
// Support for mouse rollover
//

    /**
     * Returns the index of the column header over which the mouse
     * currently is. When the mouse is not over the table header,
     * -1 is returned.
     *
     * @see #rolloverColumnUpdated(int, int)
     * @return the index of the current rollover column
     * @since 1.6
     */
    protected int getRolloverColumn() {
<span class="nc" id="L424">        return rolloverColumn;</span>
    }

    /**
     * This method gets called every time when a rollover column in the table
     * header is updated. Every look and feel that supports a rollover effect
     * in a table header should override this method and repaint the header.
     *
     * @param oldColumn the index of the previous rollover column or -1 if the
     * mouse was not over a column
     * @param newColumn the index of the new rollover column or -1 if the mouse
     * is not over a column
     * @see #getRolloverColumn()
     * @see JTableHeader#getHeaderRect(int)
     * @since 1.6
     */
    protected void rolloverColumnUpdated(int oldColumn, int newColumn) {
<span class="nc" id="L441">    }</span>

    private void updateRolloverColumn(MouseEvent e) {
<span class="nc bnc" id="L444" title="All 2 branches missed.">        if (header.getDraggedColumn() == null &amp;&amp;</span>
<span class="nc bnc" id="L445" title="All 2 branches missed.">            header.contains(e.getPoint())) {</span>

<span class="nc" id="L447">            int col = header.columnAtPoint(e.getPoint());</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">            if (col != rolloverColumn) {</span>
<span class="nc" id="L449">                int oldRolloverColumn = rolloverColumn;</span>
<span class="nc" id="L450">                rolloverColumn = col;</span>
<span class="nc" id="L451">                rolloverColumnUpdated(oldRolloverColumn, rolloverColumn);</span>
            }
        }
<span class="nc" id="L454">    }</span>

//
// Support for keyboard and mouse access
//
    private int selectNextColumn(boolean doIt) {
<span class="nc" id="L460">        int newIndex = getSelectedColumnIndex();</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">        if (newIndex &lt; header.getColumnModel().getColumnCount() - 1) {</span>
<span class="nc" id="L462">            newIndex++;</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">            if (doIt) {</span>
<span class="nc" id="L464">                selectColumn(newIndex);</span>
            }
        }
<span class="nc" id="L467">        return newIndex;</span>
    }

    private int selectPreviousColumn(boolean doIt) {
<span class="nc" id="L471">        int newIndex = getSelectedColumnIndex();</span>
<span class="nc bnc" id="L472" title="All 2 branches missed.">        if (newIndex &gt; 0) {</span>
<span class="nc" id="L473">            newIndex--;</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">            if (doIt) {</span>
<span class="nc" id="L475">                selectColumn(newIndex);</span>
            }
        }
<span class="nc" id="L478">        return newIndex;</span>
    }

    /**
     * Selects the specified column in the table header. Repaints the
     * affected header cells and makes sure the newly selected one is visible.
     */
    void selectColumn(int newColIndex) {
<span class="nc" id="L486">        selectColumn(newColIndex, true);</span>
<span class="nc" id="L487">    }</span>

    void selectColumn(int newColIndex, boolean doScroll) {
<span class="nc" id="L490">        Rectangle repaintRect = header.getHeaderRect(selectedColumnIndex);</span>
<span class="nc" id="L491">        header.repaint(repaintRect);</span>
<span class="nc" id="L492">        selectedColumnIndex = newColIndex;</span>
<span class="nc" id="L493">        repaintRect = header.getHeaderRect(newColIndex);</span>
<span class="nc" id="L494">        header.repaint(repaintRect);</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">        if (doScroll) {</span>
<span class="nc" id="L496">            scrollToColumn(newColIndex);</span>
        }
<span class="nc" id="L498">        return;</span>
    }
    /**
     * Used by selectColumn to scroll horizontally, if necessary,
     * to ensure that the newly selected column is visible.
     */
    private void scrollToColumn(int col) {
        Container container;
        JTable table;

        //Test whether the header is in a scroll pane and has a table.
<span class="nc bnc" id="L509" title="All 2 branches missed.">        if ((header.getParent() == null) ||</span>
<span class="nc bnc" id="L510" title="All 4 branches missed.">            ((container = header.getParent().getParent()) == null) ||</span>
            !(container instanceof JScrollPane) ||
<span class="nc bnc" id="L512" title="All 2 branches missed.">            ((table = header.getTable()) == null)) {</span>
<span class="nc" id="L513">            return;</span>
        }

        //Now scroll, if necessary.
<span class="nc" id="L517">        Rectangle vis = table.getVisibleRect();</span>
<span class="nc" id="L518">        Rectangle cellBounds = table.getCellRect(0, col, true);</span>
<span class="nc" id="L519">        vis.x = cellBounds.x;</span>
<span class="nc" id="L520">        vis.width = cellBounds.width;</span>
<span class="nc" id="L521">        table.scrollRectToVisible(vis);</span>
<span class="nc" id="L522">    }</span>

    private int getSelectedColumnIndex() {
<span class="nc" id="L525">        int numCols = header.getColumnModel().getColumnCount();</span>
<span class="nc bnc" id="L526" title="All 4 branches missed.">        if (selectedColumnIndex &gt;= numCols &amp;&amp; numCols &gt; 0) {</span>
<span class="nc" id="L527">            selectedColumnIndex = numCols - 1;</span>
        }
<span class="nc" id="L529">        return selectedColumnIndex;</span>
    }

    private static boolean canResize(TableColumn column,
                                     JTableHeader header) {
<span class="nc bnc" id="L534" title="All 4 branches missed.">        return (column != null) &amp;&amp; header.getResizingAllowed()</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">                                &amp;&amp; column.getResizable();</span>
    }

    private int changeColumnWidth(TableColumn resizingColumn,
                                  JTableHeader th,
                                  int oldWidth, int newWidth) {
<span class="nc" id="L541">        resizingColumn.setWidth(newWidth);</span>

        Container container;
        JTable table;

<span class="nc bnc" id="L546" title="All 2 branches missed.">        if ((th.getParent() == null) ||</span>
<span class="nc bnc" id="L547" title="All 4 branches missed.">            ((container = th.getParent().getParent()) == null) ||</span>
            !(container instanceof JScrollPane) ||
<span class="nc bnc" id="L549" title="All 2 branches missed.">            ((table = th.getTable()) == null)) {</span>
<span class="nc" id="L550">            return 0;</span>
        }

<span class="nc bnc" id="L553" title="All 2 branches missed.">        if (!container.getComponentOrientation().isLeftToRight() &amp;&amp;</span>
<span class="nc bnc" id="L554" title="All 2 branches missed.">                !th.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L555">                JViewport viewport = ((JScrollPane)container).getViewport();</span>
<span class="nc" id="L556">                int viewportWidth = viewport.getWidth();</span>
<span class="nc" id="L557">                int diff = newWidth - oldWidth;</span>
<span class="nc" id="L558">                int newHeaderWidth = table.getWidth() + diff;</span>

                /* Resize a table */
<span class="nc" id="L561">                Dimension tableSize = table.getSize();</span>
<span class="nc" id="L562">                tableSize.width += diff;</span>
<span class="nc" id="L563">                table.setSize(tableSize);</span>

                /* If this table is in AUTO_RESIZE_OFF mode and
                 * has a horizontal scrollbar, we need to update
                 * a view's position.
                 */
<span class="nc bnc" id="L569" title="All 2 branches missed.">                if ((newHeaderWidth &gt;= viewportWidth) &amp;&amp;</span>
<span class="nc bnc" id="L570" title="All 2 branches missed.">                    (table.getAutoResizeMode() == JTable.AUTO_RESIZE_OFF)) {</span>
<span class="nc" id="L571">                    Point p = viewport.getViewPosition();</span>
<span class="nc" id="L572">                    p.x = Math.max(0, Math.min(newHeaderWidth - viewportWidth,</span>
                                               p.x + diff));
<span class="nc" id="L574">                    viewport.setViewPosition(p);</span>
<span class="nc" id="L575">                    return diff;</span>
            }
        }
<span class="nc" id="L578">        return 0;</span>
    }

//
// Baseline
//

    /**
     * Returns the baseline.
     *
     * @throws NullPointerException {@inheritDoc}
     * @throws IllegalArgumentException {@inheritDoc}
     * @see javax.swing.JComponent#getBaseline(int, int)
     * @since 1.6
     */
    public int getBaseline(JComponent c, int width, int height) {
<span class="nc" id="L594">        super.getBaseline(c, width, height);</span>
<span class="nc" id="L595">        int baseline = -1;</span>
<span class="nc" id="L596">        TableColumnModel columnModel = header.getColumnModel();</span>
<span class="nc bnc" id="L597" title="All 2 branches missed.">        for(int column = 0; column &lt; columnModel.getColumnCount();</span>
<span class="nc" id="L598">            column++) {</span>
<span class="nc" id="L599">            TableColumn aColumn = columnModel.getColumn(column);</span>
<span class="nc" id="L600">            Component comp = getHeaderRenderer(column);</span>
<span class="nc" id="L601">            Dimension pref = comp.getPreferredSize();</span>
<span class="nc" id="L602">            int columnBaseline = comp.getBaseline(pref.width, height);</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">            if (columnBaseline &gt;= 0) {</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">                if (baseline == -1) {</span>
<span class="nc" id="L605">                    baseline = columnBaseline;</span>
                }
<span class="nc bnc" id="L607" title="All 2 branches missed.">                else if (baseline != columnBaseline) {</span>
<span class="nc" id="L608">                    baseline = -1;</span>
<span class="nc" id="L609">                    break;</span>
                }
            }
        }
<span class="nc" id="L613">        return baseline;</span>
    }

//
// Paint Methods and support
//

    public void paint(Graphics g, JComponent c) {
<span class="nc bnc" id="L621" title="All 2 branches missed.">        if (header.getColumnModel().getColumnCount() &lt;= 0) {</span>
<span class="nc" id="L622">            return;</span>
        }
<span class="nc" id="L624">        boolean ltr = header.getComponentOrientation().isLeftToRight();</span>

<span class="nc" id="L626">        Rectangle clip = g.getClipBounds();</span>
<span class="nc" id="L627">        Point left = clip.getLocation();</span>
<span class="nc" id="L628">        Point right = new Point( clip.x + clip.width - 1, clip.y );</span>
<span class="nc" id="L629">        TableColumnModel cm = header.getColumnModel();</span>
<span class="nc bnc" id="L630" title="All 2 branches missed.">        int cMin = header.columnAtPoint( ltr ? left : right );</span>
<span class="nc bnc" id="L631" title="All 2 branches missed.">        int cMax = header.columnAtPoint( ltr ? right : left );</span>
        // This should never happen.
<span class="nc bnc" id="L633" title="All 2 branches missed.">        if (cMin == -1) {</span>
<span class="nc" id="L634">            cMin =  0;</span>
        }
        // If the table does not have enough columns to fill the view we'll get -1.
        // Replace this with the index of the last column.
<span class="nc bnc" id="L638" title="All 2 branches missed.">        if (cMax == -1) {</span>
<span class="nc" id="L639">            cMax = cm.getColumnCount()-1;</span>
        }

<span class="nc" id="L642">        TableColumn draggedColumn = header.getDraggedColumn();</span>
        int columnWidth;
<span class="nc bnc" id="L644" title="All 2 branches missed.">        Rectangle cellRect = header.getHeaderRect(ltr ? cMin : cMax);</span>
        TableColumn aColumn;
<span class="nc bnc" id="L646" title="All 2 branches missed.">        if (ltr) {</span>
<span class="nc bnc" id="L647" title="All 2 branches missed.">            for(int column = cMin; column &lt;= cMax ; column++) {</span>
<span class="nc" id="L648">                aColumn = cm.getColumn(column);</span>
<span class="nc" id="L649">                columnWidth = aColumn.getWidth();</span>
<span class="nc" id="L650">                cellRect.width = columnWidth;</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">                if (aColumn != draggedColumn) {</span>
<span class="nc" id="L652">                    paintCell(g, cellRect, column);</span>
                }
<span class="nc" id="L654">                cellRect.x += columnWidth;</span>
            }
        } else {
<span class="nc bnc" id="L657" title="All 2 branches missed.">            for(int column = cMax; column &gt;= cMin; column--) {</span>
<span class="nc" id="L658">                aColumn = cm.getColumn(column);</span>
<span class="nc" id="L659">                columnWidth = aColumn.getWidth();</span>
<span class="nc" id="L660">                cellRect.width = columnWidth;</span>
<span class="nc bnc" id="L661" title="All 2 branches missed.">                if (aColumn != draggedColumn) {</span>
<span class="nc" id="L662">                    paintCell(g, cellRect, column);</span>
                }
<span class="nc" id="L664">                cellRect.x += columnWidth;</span>
            }
        }

        // Paint the dragged column if we are dragging.
<span class="nc bnc" id="L669" title="All 2 branches missed.">        if (draggedColumn != null) {</span>
<span class="nc" id="L670">            int draggedColumnIndex = viewIndexForColumn(draggedColumn);</span>
<span class="nc" id="L671">            Rectangle draggedCellRect = header.getHeaderRect(draggedColumnIndex);</span>

            // Draw a gray well in place of the moving column.
<span class="nc" id="L674">            g.setColor(header.getParent().getBackground());</span>
<span class="nc" id="L675">            g.fillRect(draggedCellRect.x, draggedCellRect.y,</span>
                               draggedCellRect.width, draggedCellRect.height);

<span class="nc" id="L678">            draggedCellRect.x += header.getDraggedDistance();</span>

            // Fill the background.
<span class="nc" id="L681">            g.setColor(header.getBackground());</span>
<span class="nc" id="L682">            g.fillRect(draggedCellRect.x, draggedCellRect.y,</span>
                       draggedCellRect.width, draggedCellRect.height);

<span class="nc" id="L685">            paintCell(g, draggedCellRect, draggedColumnIndex);</span>
        }

        // Remove all components in the rendererPane.
<span class="nc" id="L689">        rendererPane.removeAll();</span>
<span class="nc" id="L690">    }</span>

    private Component getHeaderRenderer(int columnIndex) {
<span class="nc" id="L693">        TableColumn aColumn = header.getColumnModel().getColumn(columnIndex);</span>
<span class="nc" id="L694">        TableCellRenderer renderer = aColumn.getHeaderRenderer();</span>
<span class="nc bnc" id="L695" title="All 2 branches missed.">        if (renderer == null) {</span>
<span class="nc" id="L696">            renderer = header.getDefaultRenderer();</span>
        }

<span class="nc bnc" id="L699" title="All 2 branches missed.">        boolean hasFocus = !header.isPaintingForPrint()</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">                           &amp;&amp; (columnIndex == getSelectedColumnIndex())</span>
<span class="nc bnc" id="L701" title="All 2 branches missed.">                           &amp;&amp; header.hasFocus();</span>
<span class="nc" id="L702">        return renderer.getTableCellRendererComponent(header.getTable(),</span>
<span class="nc" id="L703">                                                aColumn.getHeaderValue(),</span>
                                                false, hasFocus,
                                                -1, columnIndex);
    }

    private void paintCell(Graphics g, Rectangle cellRect, int columnIndex) {
<span class="nc" id="L709">        Component component = getHeaderRenderer(columnIndex);</span>
<span class="nc" id="L710">        rendererPane.paintComponent(g, component, header, cellRect.x, cellRect.y,</span>
                            cellRect.width, cellRect.height, true);
<span class="nc" id="L712">    }</span>

    private int viewIndexForColumn(TableColumn aColumn) {
<span class="nc" id="L715">        TableColumnModel cm = header.getColumnModel();</span>
<span class="nc bnc" id="L716" title="All 2 branches missed.">        for (int column = 0; column &lt; cm.getColumnCount(); column++) {</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">            if (cm.getColumn(column) == aColumn) {</span>
<span class="nc" id="L718">                return column;</span>
            }
        }
<span class="nc" id="L721">        return -1;</span>
    }

//
// Size Methods
//

    private int getHeaderHeight() {
<span class="nc" id="L729">        int height = 0;</span>
<span class="nc" id="L730">        boolean accomodatedDefault = false;</span>
<span class="nc" id="L731">        TableColumnModel columnModel = header.getColumnModel();</span>
<span class="nc bnc" id="L732" title="All 2 branches missed.">        for(int column = 0; column &lt; columnModel.getColumnCount(); column++) {</span>
<span class="nc" id="L733">            TableColumn aColumn = columnModel.getColumn(column);</span>
<span class="nc bnc" id="L734" title="All 2 branches missed.">            boolean isDefault = (aColumn.getHeaderRenderer() == null);</span>

<span class="nc bnc" id="L736" title="All 4 branches missed.">            if (!isDefault || !accomodatedDefault) {</span>
<span class="nc" id="L737">                Component comp = getHeaderRenderer(column);</span>
<span class="nc" id="L738">                int rendererHeight = comp.getPreferredSize().height;</span>
<span class="nc" id="L739">                height = Math.max(height, rendererHeight);</span>

                // Configuring the header renderer to calculate its preferred size
                // is expensive. Optimise this by assuming the default renderer
                // always has the same height as the first non-zero height that
                // it returns for a non-null/non-empty value.
<span class="nc bnc" id="L745" title="All 4 branches missed.">                if (isDefault &amp;&amp; rendererHeight &gt; 0) {</span>
<span class="nc" id="L746">                    Object headerValue = aColumn.getHeaderValue();</span>
<span class="nc bnc" id="L747" title="All 2 branches missed.">                    if (headerValue != null) {</span>
<span class="nc" id="L748">                        headerValue = headerValue.toString();</span>

<span class="nc bnc" id="L750" title="All 4 branches missed.">                        if (headerValue != null &amp;&amp; !headerValue.equals(&quot;&quot;)) {</span>
<span class="nc" id="L751">                            accomodatedDefault = true;</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L757">        return height;</span>
    }

    private Dimension createHeaderSize(long width) {
        // None of the callers include the intercell spacing, do it here.
<span class="nc bnc" id="L762" title="All 2 branches missed.">        if (width &gt; Integer.MAX_VALUE) {</span>
<span class="nc" id="L763">            width = Integer.MAX_VALUE;</span>
        }
<span class="nc" id="L765">        return new Dimension((int)width, getHeaderHeight());</span>
    }


    /**
     * Return the minimum size of the header. The minimum width is the sum
     * of the minimum widths of each column (plus inter-cell spacing).
     */
    public Dimension getMinimumSize(JComponent c) {
<span class="nc" id="L774">        long width = 0;</span>
<span class="nc" id="L775">        Enumeration enumeration = header.getColumnModel().getColumns();</span>
<span class="nc bnc" id="L776" title="All 2 branches missed.">        while (enumeration.hasMoreElements()) {</span>
<span class="nc" id="L777">            TableColumn aColumn = (TableColumn)enumeration.nextElement();</span>
<span class="nc" id="L778">            width = width + aColumn.getMinWidth();</span>
<span class="nc" id="L779">        }</span>
<span class="nc" id="L780">        return createHeaderSize(width);</span>
    }

    /**
     * Return the preferred size of the header. The preferred height is the
     * maximum of the preferred heights of all of the components provided
     * by the header renderers. The preferred width is the sum of the
     * preferred widths of each column (plus inter-cell spacing).
     */
    public Dimension getPreferredSize(JComponent c) {
<span class="nc" id="L790">        long width = 0;</span>
<span class="nc" id="L791">        Enumeration enumeration = header.getColumnModel().getColumns();</span>
<span class="nc bnc" id="L792" title="All 2 branches missed.">        while (enumeration.hasMoreElements()) {</span>
<span class="nc" id="L793">            TableColumn aColumn = (TableColumn)enumeration.nextElement();</span>
<span class="nc" id="L794">            width = width + aColumn.getPreferredWidth();</span>
<span class="nc" id="L795">        }</span>
<span class="nc" id="L796">        return createHeaderSize(width);</span>
    }

    /**
     * Return the maximum size of the header. The maximum width is the sum
     * of the maximum widths of each column (plus inter-cell spacing).
     */
    public Dimension getMaximumSize(JComponent c) {
<span class="nc" id="L804">        long width = 0;</span>
<span class="nc" id="L805">        Enumeration enumeration = header.getColumnModel().getColumns();</span>
<span class="nc bnc" id="L806" title="All 2 branches missed.">        while (enumeration.hasMoreElements()) {</span>
<span class="nc" id="L807">            TableColumn aColumn = (TableColumn)enumeration.nextElement();</span>
<span class="nc" id="L808">            width = width + aColumn.getMaxWidth();</span>
<span class="nc" id="L809">        }</span>
<span class="nc" id="L810">        return createHeaderSize(width);</span>
    }

<span class="nc" id="L813">    private static class Actions extends UIAction {</span>
        public static final String TOGGLE_SORT_ORDER =
            &quot;toggleSortOrder&quot;;
        public static final String SELECT_COLUMN_TO_LEFT =
            &quot;selectColumnToLeft&quot;;
        public static final String SELECT_COLUMN_TO_RIGHT =
            &quot;selectColumnToRight&quot;;
        public static final String MOVE_COLUMN_LEFT =
            &quot;moveColumnLeft&quot;;
        public static final String MOVE_COLUMN_RIGHT =
            &quot;moveColumnRight&quot;;
        public static final String RESIZE_LEFT =
            &quot;resizeLeft&quot;;
        public static final String RESIZE_RIGHT =
            &quot;resizeRight&quot;;
        public static final String FOCUS_TABLE =
            &quot;focusTable&quot;;

        public Actions(String name) {
<span class="nc" id="L832">            super(name);</span>
<span class="nc" id="L833">        }</span>

        public boolean isEnabled(Object sender) {
<span class="nc bnc" id="L836" title="All 2 branches missed.">            if (sender instanceof JTableHeader) {</span>
<span class="nc" id="L837">                JTableHeader th = (JTableHeader)sender;</span>
<span class="nc" id="L838">                TableColumnModel cm = th.getColumnModel();</span>
<span class="nc bnc" id="L839" title="All 2 branches missed.">                if (cm.getColumnCount() &lt;= 0) {</span>
<span class="nc" id="L840">                    return false;</span>
                }

<span class="nc" id="L843">                String key = getName();</span>
<span class="nc" id="L844">                BasicTableHeaderUI ui =</span>
<span class="nc" id="L845">                    (BasicTableHeaderUI)BasicLookAndFeel.getUIOfType(th.getUI(),</span>
                                                      BasicTableHeaderUI.class);
<span class="nc bnc" id="L847" title="All 2 branches missed.">                if (ui != null) {</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">                    if (key == MOVE_COLUMN_LEFT) {</span>
<span class="nc bnc" id="L849" title="All 2 branches missed.">                        return th.getReorderingAllowed()</span>
<span class="nc bnc" id="L850" title="All 2 branches missed.">                            &amp;&amp; maybeMoveColumn(true, th, ui, false);</span>
<span class="nc bnc" id="L851" title="All 2 branches missed.">                    } else if (key == MOVE_COLUMN_RIGHT) {</span>
<span class="nc bnc" id="L852" title="All 2 branches missed.">                        return th.getReorderingAllowed()</span>
<span class="nc bnc" id="L853" title="All 2 branches missed.">                            &amp;&amp; maybeMoveColumn(false, th, ui, false);</span>
<span class="nc bnc" id="L854" title="All 4 branches missed.">                    } else if (key == RESIZE_LEFT ||</span>
                               key == RESIZE_RIGHT) {
<span class="nc" id="L856">                        return canResize(cm.getColumn(ui.getSelectedColumnIndex()), th);</span>
<span class="nc bnc" id="L857" title="All 2 branches missed.">                    } else if (key == FOCUS_TABLE) {</span>
<span class="nc bnc" id="L858" title="All 2 branches missed.">                        return (th.getTable() != null);</span>
                    }
                }
            }
<span class="nc" id="L862">            return true;</span>
        }

        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L866">            JTableHeader th = (JTableHeader)e.getSource();</span>
<span class="nc" id="L867">            BasicTableHeaderUI ui =</span>
                (BasicTableHeaderUI)BasicLookAndFeel.
<span class="nc" id="L869">                                        getUIOfType(th.getUI(),</span>
                                            BasicTableHeaderUI.class);
<span class="nc bnc" id="L871" title="All 2 branches missed.">            if (ui == null) {</span>
<span class="nc" id="L872">                return;</span>
            }

<span class="nc" id="L875">            String name = getName();</span>
<span class="nc bnc" id="L876" title="All 2 branches missed.">            if (TOGGLE_SORT_ORDER == name) {</span>
<span class="nc" id="L877">                JTable table = th.getTable();</span>
<span class="nc bnc" id="L878" title="All 2 branches missed.">                RowSorter sorter = table == null ? null : table.getRowSorter();</span>
<span class="nc bnc" id="L879" title="All 2 branches missed.">                if (sorter != null) {</span>
<span class="nc" id="L880">                    int columnIndex = ui.getSelectedColumnIndex();</span>
<span class="nc" id="L881">                    columnIndex = table.convertColumnIndexToModel(</span>
                                                      columnIndex);
<span class="nc" id="L883">                    sorter.toggleSortOrder(columnIndex);</span>
                }
<span class="nc bnc" id="L885" title="All 2 branches missed.">            } else if (SELECT_COLUMN_TO_LEFT == name) {</span>
<span class="nc bnc" id="L886" title="All 2 branches missed.">                if (th.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L887">                    ui.selectPreviousColumn(true);</span>
                } else {
<span class="nc" id="L889">                    ui.selectNextColumn(true);</span>
                }
<span class="nc bnc" id="L891" title="All 2 branches missed.">            } else if (SELECT_COLUMN_TO_RIGHT == name) {</span>
<span class="nc bnc" id="L892" title="All 2 branches missed.">                if (th.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L893">                    ui.selectNextColumn(true);</span>
                } else {
<span class="nc" id="L895">                    ui.selectPreviousColumn(true);</span>
                }
<span class="nc bnc" id="L897" title="All 2 branches missed.">            } else if (MOVE_COLUMN_LEFT == name) {</span>
<span class="nc" id="L898">                moveColumn(true, th, ui);</span>
<span class="nc bnc" id="L899" title="All 2 branches missed.">            } else if (MOVE_COLUMN_RIGHT == name) {</span>
<span class="nc" id="L900">                moveColumn(false, th, ui);</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">            } else if (RESIZE_LEFT == name) {</span>
<span class="nc" id="L902">                resize(true, th, ui);</span>
<span class="nc bnc" id="L903" title="All 2 branches missed.">            } else if (RESIZE_RIGHT == name) {</span>
<span class="nc" id="L904">                resize(false, th, ui);</span>
<span class="nc bnc" id="L905" title="All 2 branches missed.">            } else if (FOCUS_TABLE == name) {</span>
<span class="nc" id="L906">                JTable table = th.getTable();</span>
<span class="nc bnc" id="L907" title="All 2 branches missed.">                if (table != null) {</span>
<span class="nc" id="L908">                    table.requestFocusInWindow();</span>
                }
            }
<span class="nc" id="L911">        }</span>

        private void moveColumn(boolean leftArrow, JTableHeader th,
                                BasicTableHeaderUI ui) {
<span class="nc" id="L915">            maybeMoveColumn(leftArrow, th, ui, true);</span>
<span class="nc" id="L916">        }</span>

        private boolean maybeMoveColumn(boolean leftArrow, JTableHeader th,
                                        BasicTableHeaderUI ui, boolean doIt) {
<span class="nc" id="L920">            int oldIndex = ui.getSelectedColumnIndex();</span>
            int newIndex;

<span class="nc bnc" id="L923" title="All 2 branches missed.">            if (th.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc bnc" id="L924" title="All 2 branches missed.">                newIndex = leftArrow ? ui.selectPreviousColumn(doIt)</span>
<span class="nc" id="L925">                                     : ui.selectNextColumn(doIt);</span>
            } else {
<span class="nc bnc" id="L927" title="All 2 branches missed.">                newIndex = leftArrow ? ui.selectNextColumn(doIt)</span>
<span class="nc" id="L928">                                     : ui.selectPreviousColumn(doIt);</span>
            }

<span class="nc bnc" id="L931" title="All 2 branches missed.">            if (newIndex != oldIndex) {</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">                if (doIt) {</span>
<span class="nc" id="L933">                    th.getColumnModel().moveColumn(oldIndex, newIndex);</span>
                } else {
<span class="nc" id="L935">                    return true; // we'd do the move if asked</span>
                }
            }

<span class="nc" id="L939">            return false;</span>
        }

        private void resize(boolean leftArrow, JTableHeader th,
                            BasicTableHeaderUI ui) {
<span class="nc" id="L944">            int columnIndex = ui.getSelectedColumnIndex();</span>
<span class="nc" id="L945">            TableColumn resizingColumn =</span>
<span class="nc" id="L946">                th.getColumnModel().getColumn(columnIndex);</span>

<span class="nc" id="L948">            th.setResizingColumn(resizingColumn);</span>
<span class="nc" id="L949">            int oldWidth = resizingColumn.getWidth();</span>
<span class="nc" id="L950">            int newWidth = oldWidth;</span>

<span class="nc bnc" id="L952" title="All 2 branches missed.">            if (th.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc bnc" id="L953" title="All 2 branches missed.">                newWidth = newWidth + (leftArrow ? -1 : 1);</span>
            } else {
<span class="nc bnc" id="L955" title="All 2 branches missed.">                newWidth = newWidth + (leftArrow ? 1 : -1);</span>
            }

<span class="nc" id="L958">            ui.changeColumnWidth(resizingColumn, th, oldWidth, newWidth);</span>
<span class="nc" id="L959">        }</span>
    }
}  // End of Class BasicTableHeaderUI
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>