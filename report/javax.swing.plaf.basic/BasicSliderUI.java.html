<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>BasicSliderUI.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.basic</a> &gt; <span class="el_source">BasicSliderUI.java</span></div><h1>BasicSliderUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.basic;

import java.awt.event.*;
import java.awt.*;
import java.beans.*;
import java.util.Dictionary;
import java.util.Enumeration;

import javax.swing.*;
import javax.swing.event.*;
import javax.swing.plaf.*;
import sun.swing.DefaultLookup;
import sun.swing.UIAction;


/**
 * A Basic L&amp;amp;F implementation of SliderUI.
 *
 * @author Tom Santos
 */
public class BasicSliderUI extends SliderUI{
    // Old actions forward to an instance of this.
<span class="nc" id="L48">    private static final Actions SHARED_ACTION = new Actions();</span>

    public static final int POSITIVE_SCROLL = +1;
    public static final int NEGATIVE_SCROLL = -1;
    public static final int MIN_SCROLL = -2;
    public static final int MAX_SCROLL = +2;

    protected Timer scrollTimer;
    protected JSlider slider;

<span class="nc" id="L58">    protected Insets focusInsets = null;</span>
<span class="nc" id="L59">    protected Insets insetCache = null;</span>
<span class="nc" id="L60">    protected boolean leftToRightCache = true;</span>
<span class="nc" id="L61">    protected Rectangle focusRect = null;</span>
<span class="nc" id="L62">    protected Rectangle contentRect = null;</span>
<span class="nc" id="L63">    protected Rectangle labelRect = null;</span>
<span class="nc" id="L64">    protected Rectangle tickRect = null;</span>
<span class="nc" id="L65">    protected Rectangle trackRect = null;</span>
<span class="nc" id="L66">    protected Rectangle thumbRect = null;</span>

<span class="nc" id="L68">    protected int trackBuffer = 0;  // The distance that the track is from the side of the control</span>

    private transient boolean isDragging;

    protected TrackListener trackListener;
    protected ChangeListener changeListener;
    protected ComponentListener componentListener;
    protected FocusListener focusListener;
    protected ScrollListener scrollListener;
    protected PropertyChangeListener propertyChangeListener;
    private Handler handler;
    private int lastValue;

    // Colors
    private Color shadowColor;
    private Color highlightColor;
    private Color focusColor;

    /**
     * Whther or not sameLabelBaselines is up to date.
     */
    private boolean checkedLabelBaselines;
    /**
     * Whether or not all the entries in the labeltable have the same
     * baseline.
     */
    private boolean sameLabelBaselines;


    protected Color getShadowColor() {
<span class="nc" id="L98">        return shadowColor;</span>
    }

    protected Color getHighlightColor() {
<span class="nc" id="L102">        return highlightColor;</span>
    }

    protected Color getFocusColor() {
<span class="nc" id="L106">        return focusColor;</span>
    }

    /**
     * Returns true if the user is dragging the slider.
     *
     * @return true if the user is dragging the slider
     * @since 1.5
     */
    protected boolean isDragging() {
<span class="nc" id="L116">        return isDragging;</span>
    }

    /////////////////////////////////////////////////////////////////////////////
    // ComponentUI Interface Implementation methods
    /////////////////////////////////////////////////////////////////////////////
    public static ComponentUI createUI(JComponent b)    {
<span class="nc" id="L123">        return new BasicSliderUI((JSlider)b);</span>
    }

<span class="nc" id="L126">    public BasicSliderUI(JSlider b)   {</span>
<span class="nc" id="L127">    }</span>

    public void installUI(JComponent c)   {
<span class="nc" id="L130">        slider = (JSlider) c;</span>

<span class="nc" id="L132">        checkedLabelBaselines = false;</span>

<span class="nc" id="L134">        slider.setEnabled(slider.isEnabled());</span>
<span class="nc" id="L135">        LookAndFeel.installProperty(slider, &quot;opaque&quot;, Boolean.TRUE);</span>

<span class="nc" id="L137">        isDragging = false;</span>
<span class="nc" id="L138">        trackListener = createTrackListener( slider );</span>
<span class="nc" id="L139">        changeListener = createChangeListener( slider );</span>
<span class="nc" id="L140">        componentListener = createComponentListener( slider );</span>
<span class="nc" id="L141">        focusListener = createFocusListener( slider );</span>
<span class="nc" id="L142">        scrollListener = createScrollListener( slider );</span>
<span class="nc" id="L143">        propertyChangeListener = createPropertyChangeListener( slider );</span>

<span class="nc" id="L145">        installDefaults( slider );</span>
<span class="nc" id="L146">        installListeners( slider );</span>
<span class="nc" id="L147">        installKeyboardActions( slider );</span>

<span class="nc" id="L149">        scrollTimer = new Timer( 100, scrollListener );</span>
<span class="nc" id="L150">        scrollTimer.setInitialDelay( 300 );</span>

<span class="nc" id="L152">        insetCache = slider.getInsets();</span>
<span class="nc" id="L153">        leftToRightCache = BasicGraphicsUtils.isLeftToRight(slider);</span>
<span class="nc" id="L154">        focusRect = new Rectangle();</span>
<span class="nc" id="L155">        contentRect = new Rectangle();</span>
<span class="nc" id="L156">        labelRect = new Rectangle();</span>
<span class="nc" id="L157">        tickRect = new Rectangle();</span>
<span class="nc" id="L158">        trackRect = new Rectangle();</span>
<span class="nc" id="L159">        thumbRect = new Rectangle();</span>
<span class="nc" id="L160">        lastValue = slider.getValue();</span>

<span class="nc" id="L162">        calculateGeometry(); // This figures out where the labels, ticks, track, and thumb are.</span>
<span class="nc" id="L163">    }</span>

    public void uninstallUI(JComponent c) {
<span class="nc bnc" id="L166" title="All 2 branches missed.">        if ( c != slider )</span>
<span class="nc" id="L167">            throw new IllegalComponentStateException(</span>
                                                    this + &quot; was asked to deinstall() &quot;
                                                    + c + &quot; when it only knows about &quot;
                                                    + slider + &quot;.&quot;);

<span class="nc" id="L172">        scrollTimer.stop();</span>
<span class="nc" id="L173">        scrollTimer = null;</span>

<span class="nc" id="L175">        uninstallDefaults(slider);</span>
<span class="nc" id="L176">        uninstallListeners( slider );</span>
<span class="nc" id="L177">        uninstallKeyboardActions(slider);</span>

<span class="nc" id="L179">        insetCache = null;</span>
<span class="nc" id="L180">        leftToRightCache = true;</span>
<span class="nc" id="L181">        focusRect = null;</span>
<span class="nc" id="L182">        contentRect = null;</span>
<span class="nc" id="L183">        labelRect = null;</span>
<span class="nc" id="L184">        tickRect = null;</span>
<span class="nc" id="L185">        trackRect = null;</span>
<span class="nc" id="L186">        thumbRect = null;</span>
<span class="nc" id="L187">        trackListener = null;</span>
<span class="nc" id="L188">        changeListener = null;</span>
<span class="nc" id="L189">        componentListener = null;</span>
<span class="nc" id="L190">        focusListener = null;</span>
<span class="nc" id="L191">        scrollListener = null;</span>
<span class="nc" id="L192">        propertyChangeListener = null;</span>
<span class="nc" id="L193">        slider = null;</span>
<span class="nc" id="L194">    }</span>

    protected void installDefaults( JSlider slider ) {
<span class="nc" id="L197">        LookAndFeel.installBorder(slider, &quot;Slider.border&quot;);</span>
<span class="nc" id="L198">        LookAndFeel.installColorsAndFont(slider, &quot;Slider.background&quot;,</span>
                                         &quot;Slider.foreground&quot;, &quot;Slider.font&quot;);
<span class="nc" id="L200">        highlightColor = UIManager.getColor(&quot;Slider.highlight&quot;);</span>

<span class="nc" id="L202">        shadowColor = UIManager.getColor(&quot;Slider.shadow&quot;);</span>
<span class="nc" id="L203">        focusColor = UIManager.getColor(&quot;Slider.focus&quot;);</span>

<span class="nc" id="L205">        focusInsets = (Insets)UIManager.get( &quot;Slider.focusInsets&quot; );</span>
        // use default if missing so that BasicSliderUI can be used in other
        // LAFs like Nimbus
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (focusInsets == null) focusInsets = new InsetsUIResource(2,2,2,2);</span>
<span class="nc" id="L209">    }</span>

    protected void uninstallDefaults(JSlider slider) {
<span class="nc" id="L212">        LookAndFeel.uninstallBorder(slider);</span>

<span class="nc" id="L214">        focusInsets = null;</span>
<span class="nc" id="L215">    }</span>

    protected TrackListener createTrackListener(JSlider slider) {
<span class="nc" id="L218">        return new TrackListener();</span>
    }

    protected ChangeListener createChangeListener(JSlider slider) {
<span class="nc" id="L222">        return getHandler();</span>
    }

    protected ComponentListener createComponentListener(JSlider slider) {
<span class="nc" id="L226">        return getHandler();</span>
    }

    protected FocusListener createFocusListener(JSlider slider) {
<span class="nc" id="L230">        return getHandler();</span>
    }

    protected ScrollListener createScrollListener( JSlider slider ) {
<span class="nc" id="L234">        return new ScrollListener();</span>
    }

    protected PropertyChangeListener createPropertyChangeListener(
            JSlider slider) {
<span class="nc" id="L239">        return getHandler();</span>
    }

    private Handler getHandler() {
<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (handler == null) {</span>
<span class="nc" id="L244">            handler = new Handler();</span>
        }
<span class="nc" id="L246">        return handler;</span>
    }

    protected void installListeners( JSlider slider ) {
<span class="nc" id="L250">        slider.addMouseListener(trackListener);</span>
<span class="nc" id="L251">        slider.addMouseMotionListener(trackListener);</span>
<span class="nc" id="L252">        slider.addFocusListener(focusListener);</span>
<span class="nc" id="L253">        slider.addComponentListener(componentListener);</span>
<span class="nc" id="L254">        slider.addPropertyChangeListener( propertyChangeListener );</span>
<span class="nc" id="L255">        slider.getModel().addChangeListener(changeListener);</span>
<span class="nc" id="L256">    }</span>

    protected void uninstallListeners( JSlider slider ) {
<span class="nc" id="L259">        slider.removeMouseListener(trackListener);</span>
<span class="nc" id="L260">        slider.removeMouseMotionListener(trackListener);</span>
<span class="nc" id="L261">        slider.removeFocusListener(focusListener);</span>
<span class="nc" id="L262">        slider.removeComponentListener(componentListener);</span>
<span class="nc" id="L263">        slider.removePropertyChangeListener( propertyChangeListener );</span>
<span class="nc" id="L264">        slider.getModel().removeChangeListener(changeListener);</span>
<span class="nc" id="L265">        handler = null;</span>
<span class="nc" id="L266">    }</span>

    protected void installKeyboardActions( JSlider slider ) {
<span class="nc" id="L269">        InputMap km = getInputMap(JComponent.WHEN_FOCUSED, slider);</span>
<span class="nc" id="L270">        SwingUtilities.replaceUIInputMap(slider, JComponent.WHEN_FOCUSED, km);</span>
<span class="nc" id="L271">        LazyActionMap.installLazyActionMap(slider, BasicSliderUI.class,</span>
                &quot;Slider.actionMap&quot;);
<span class="nc" id="L273">    }</span>

    InputMap getInputMap(int condition, JSlider slider) {
<span class="nc bnc" id="L276" title="All 2 branches missed.">        if (condition == JComponent.WHEN_FOCUSED) {</span>
<span class="nc" id="L277">            InputMap keyMap = (InputMap)DefaultLookup.get(slider, this,</span>
                  &quot;Slider.focusInputMap&quot;);
            InputMap rtlKeyMap;

<span class="nc bnc" id="L281" title="All 2 branches missed.">            if (slider.getComponentOrientation().isLeftToRight() ||</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">                ((rtlKeyMap = (InputMap)DefaultLookup.get(slider, this,</span>
                          &quot;Slider.focusInputMap.RightToLeft&quot;)) == null)) {
<span class="nc" id="L284">                return keyMap;</span>
            } else {
<span class="nc" id="L286">                rtlKeyMap.setParent(keyMap);</span>
<span class="nc" id="L287">                return rtlKeyMap;</span>
            }
        }
<span class="nc" id="L290">        return null;</span>
    }

    /**
     * Populates ComboBox's actions.
     */
    static void loadActionMap(LazyActionMap map) {
<span class="nc" id="L297">        map.put(new Actions(Actions.POSITIVE_UNIT_INCREMENT));</span>
<span class="nc" id="L298">        map.put(new Actions(Actions.POSITIVE_BLOCK_INCREMENT));</span>
<span class="nc" id="L299">        map.put(new Actions(Actions.NEGATIVE_UNIT_INCREMENT));</span>
<span class="nc" id="L300">        map.put(new Actions(Actions.NEGATIVE_BLOCK_INCREMENT));</span>
<span class="nc" id="L301">        map.put(new Actions(Actions.MIN_SCROLL_INCREMENT));</span>
<span class="nc" id="L302">        map.put(new Actions(Actions.MAX_SCROLL_INCREMENT));</span>
<span class="nc" id="L303">    }</span>

    protected void uninstallKeyboardActions( JSlider slider ) {
<span class="nc" id="L306">        SwingUtilities.replaceUIActionMap(slider, null);</span>
<span class="nc" id="L307">        SwingUtilities.replaceUIInputMap(slider, JComponent.WHEN_FOCUSED,</span>
                                         null);
<span class="nc" id="L309">    }</span>


    /**
     * Returns the baseline.
     *
     * @throws NullPointerException {@inheritDoc}
     * @throws IllegalArgumentException {@inheritDoc}
     * @see javax.swing.JComponent#getBaseline(int, int)
     * @since 1.6
     */
    public int getBaseline(JComponent c, int width, int height) {
<span class="nc" id="L321">        super.getBaseline(c, width, height);</span>
<span class="nc bnc" id="L322" title="All 4 branches missed.">        if (slider.getPaintLabels() &amp;&amp; labelsHaveSameBaselines()) {</span>
<span class="nc" id="L323">            FontMetrics metrics = slider.getFontMetrics(slider.getFont());</span>
<span class="nc" id="L324">            Insets insets = slider.getInsets();</span>
<span class="nc" id="L325">            Dimension thumbSize = getThumbSize();</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">            if (slider.getOrientation() == JSlider.HORIZONTAL) {</span>
<span class="nc" id="L327">                int tickLength = getTickLength();</span>
<span class="nc" id="L328">                int contentHeight = height - insets.top - insets.bottom -</span>
                    focusInsets.top - focusInsets.bottom;
<span class="nc" id="L330">                int thumbHeight = thumbSize.height;</span>
<span class="nc" id="L331">                int centerSpacing = thumbHeight;</span>
<span class="nc bnc" id="L332" title="All 2 branches missed.">                if (slider.getPaintTicks()) {</span>
<span class="nc" id="L333">                    centerSpacing += tickLength;</span>
                }
                // Assume uniform labels.
<span class="nc" id="L336">                centerSpacing += getHeightOfTallestLabel();</span>
<span class="nc" id="L337">                int trackY = insets.top + focusInsets.top +</span>
                    (contentHeight - centerSpacing - 1) / 2;
<span class="nc" id="L339">                int trackHeight = thumbHeight;</span>
<span class="nc" id="L340">                int tickY = trackY + trackHeight;</span>
<span class="nc" id="L341">                int tickHeight = tickLength;</span>
<span class="nc bnc" id="L342" title="All 2 branches missed.">                if (!slider.getPaintTicks()) {</span>
<span class="nc" id="L343">                    tickHeight = 0;</span>
                }
<span class="nc" id="L345">                int labelY = tickY + tickHeight;</span>
<span class="nc" id="L346">                return labelY + metrics.getAscent();</span>
            }
            else { // vertical
<span class="nc" id="L349">                boolean inverted = slider.getInverted();</span>
<span class="nc bnc" id="L350" title="All 2 branches missed.">                Integer value = inverted ? getLowestValue() :</span>
<span class="nc" id="L351">                                           getHighestValue();</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">                if (value != null) {</span>
<span class="nc" id="L353">                    int thumbHeight = thumbSize.height;</span>
<span class="nc" id="L354">                    int trackBuffer = Math.max(metrics.getHeight() / 2,</span>
                                               thumbHeight / 2);
<span class="nc" id="L356">                    int contentY = focusInsets.top + insets.top;</span>
<span class="nc" id="L357">                    int trackY = contentY + trackBuffer;</span>
<span class="nc" id="L358">                    int trackHeight = height - focusInsets.top -</span>
                        focusInsets.bottom - insets.top - insets.bottom -
                        trackBuffer - trackBuffer;
<span class="nc" id="L361">                    int yPosition = yPositionForValue(value, trackY,</span>
                                                      trackHeight);
<span class="nc" id="L363">                    return yPosition - metrics.getHeight() / 2 +</span>
<span class="nc" id="L364">                        metrics.getAscent();</span>
                }
            }
        }
<span class="nc" id="L368">        return 0;</span>
    }

    /**
     * Returns an enum indicating how the baseline of the component
     * changes as the size changes.
     *
     * @throws NullPointerException {@inheritDoc}
     * @see javax.swing.JComponent#getBaseline(int, int)
     * @since 1.6
     */
    public Component.BaselineResizeBehavior getBaselineResizeBehavior(
            JComponent c) {
<span class="nc" id="L381">        super.getBaselineResizeBehavior(c);</span>
        // NOTE: BasicSpinner really provides for CENTER_OFFSET, but
        // the default min/pref size is smaller than it should be
        // so that getBaseline() doesn't implement the contract
        // for CENTER_OFFSET as defined in Component.
<span class="nc" id="L386">        return Component.BaselineResizeBehavior.OTHER;</span>
    }

    /**
     * Returns true if all the labels from the label table have the same
     * baseline.
     *
     * @return true if all the labels from the label table have the
     *         same baseline
     * @since 1.6
     */
    protected boolean labelsHaveSameBaselines() {
<span class="nc bnc" id="L398" title="All 2 branches missed.">        if (!checkedLabelBaselines) {</span>
<span class="nc" id="L399">            checkedLabelBaselines = true;</span>
<span class="nc" id="L400">            Dictionary dictionary = slider.getLabelTable();</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">            if (dictionary != null) {</span>
<span class="nc" id="L402">                sameLabelBaselines = true;</span>
<span class="nc" id="L403">                Enumeration elements = dictionary.elements();</span>
<span class="nc" id="L404">                int baseline = -1;</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">                while (elements.hasMoreElements()) {</span>
<span class="nc" id="L406">                    JComponent label = (JComponent) elements.nextElement();</span>
<span class="nc" id="L407">                    Dimension pref = label.getPreferredSize();</span>
<span class="nc" id="L408">                    int labelBaseline = label.getBaseline(pref.width,</span>
                                                          pref.height);
<span class="nc bnc" id="L410" title="All 2 branches missed.">                    if (labelBaseline &gt;= 0) {</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">                        if (baseline == -1) {</span>
<span class="nc" id="L412">                            baseline = labelBaseline;</span>
                        }
<span class="nc bnc" id="L414" title="All 2 branches missed.">                        else if (baseline != labelBaseline) {</span>
<span class="nc" id="L415">                            sameLabelBaselines = false;</span>
<span class="nc" id="L416">                            break;</span>
                        }
                    }
                    else {
<span class="nc" id="L420">                        sameLabelBaselines = false;</span>
<span class="nc" id="L421">                        break;</span>
                    }
<span class="nc" id="L423">                }</span>
<span class="nc" id="L424">            }</span>
            else {
<span class="nc" id="L426">                sameLabelBaselines = false;</span>
            }
        }
<span class="nc" id="L429">        return sameLabelBaselines;</span>
    }

    public Dimension getPreferredHorizontalSize() {
<span class="nc" id="L433">        Dimension horizDim = (Dimension)DefaultLookup.get(slider,</span>
                this, &quot;Slider.horizontalSize&quot;);
<span class="nc bnc" id="L435" title="All 2 branches missed.">        if (horizDim == null) {</span>
<span class="nc" id="L436">            horizDim = new Dimension(200, 21);</span>
        }
<span class="nc" id="L438">        return horizDim;</span>
    }

    public Dimension getPreferredVerticalSize() {
<span class="nc" id="L442">        Dimension vertDim = (Dimension)DefaultLookup.get(slider,</span>
                this, &quot;Slider.verticalSize&quot;);
<span class="nc bnc" id="L444" title="All 2 branches missed.">        if (vertDim == null) {</span>
<span class="nc" id="L445">            vertDim = new Dimension(21, 200);</span>
        }
<span class="nc" id="L447">        return vertDim;</span>
    }

    public Dimension getMinimumHorizontalSize() {
<span class="nc" id="L451">        Dimension minHorizDim = (Dimension)DefaultLookup.get(slider,</span>
                this, &quot;Slider.minimumHorizontalSize&quot;);
<span class="nc bnc" id="L453" title="All 2 branches missed.">        if (minHorizDim == null) {</span>
<span class="nc" id="L454">            minHorizDim = new Dimension(36, 21);</span>
        }
<span class="nc" id="L456">        return minHorizDim;</span>
    }

    public Dimension getMinimumVerticalSize() {
<span class="nc" id="L460">        Dimension minVertDim = (Dimension)DefaultLookup.get(slider,</span>
                this, &quot;Slider.minimumVerticalSize&quot;);
<span class="nc bnc" id="L462" title="All 2 branches missed.">        if (minVertDim == null) {</span>
<span class="nc" id="L463">            minVertDim = new Dimension(21, 36);</span>
        }
<span class="nc" id="L465">        return minVertDim;</span>
    }

    public Dimension getPreferredSize(JComponent c)    {
<span class="nc" id="L469">        recalculateIfInsetsChanged();</span>
        Dimension d;
<span class="nc bnc" id="L471" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.VERTICAL ) {</span>
<span class="nc" id="L472">            d = new Dimension(getPreferredVerticalSize());</span>
<span class="nc" id="L473">            d.width = insetCache.left + insetCache.right;</span>
<span class="nc" id="L474">            d.width += focusInsets.left + focusInsets.right;</span>
<span class="nc" id="L475">            d.width += trackRect.width + tickRect.width + labelRect.width;</span>
        }
        else {
<span class="nc" id="L478">            d = new Dimension(getPreferredHorizontalSize());</span>
<span class="nc" id="L479">            d.height = insetCache.top + insetCache.bottom;</span>
<span class="nc" id="L480">            d.height += focusInsets.top + focusInsets.bottom;</span>
<span class="nc" id="L481">            d.height += trackRect.height + tickRect.height + labelRect.height;</span>
        }

<span class="nc" id="L484">        return d;</span>
    }

    public Dimension getMinimumSize(JComponent c)  {
<span class="nc" id="L488">        recalculateIfInsetsChanged();</span>
        Dimension d;

<span class="nc bnc" id="L491" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.VERTICAL ) {</span>
<span class="nc" id="L492">            d = new Dimension(getMinimumVerticalSize());</span>
<span class="nc" id="L493">            d.width = insetCache.left + insetCache.right;</span>
<span class="nc" id="L494">            d.width += focusInsets.left + focusInsets.right;</span>
<span class="nc" id="L495">            d.width += trackRect.width + tickRect.width + labelRect.width;</span>
        }
        else {
<span class="nc" id="L498">            d = new Dimension(getMinimumHorizontalSize());</span>
<span class="nc" id="L499">            d.height = insetCache.top + insetCache.bottom;</span>
<span class="nc" id="L500">            d.height += focusInsets.top + focusInsets.bottom;</span>
<span class="nc" id="L501">            d.height += trackRect.height + tickRect.height + labelRect.height;</span>
        }

<span class="nc" id="L504">        return d;</span>
    }

    public Dimension getMaximumSize(JComponent c) {
<span class="nc" id="L508">        Dimension d = getPreferredSize(c);</span>
<span class="nc bnc" id="L509" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.VERTICAL ) {</span>
<span class="nc" id="L510">            d.height = Short.MAX_VALUE;</span>
        }
        else {
<span class="nc" id="L513">            d.width = Short.MAX_VALUE;</span>
        }

<span class="nc" id="L516">        return d;</span>
    }

    protected void calculateGeometry() {
<span class="nc" id="L520">        calculateFocusRect();</span>
<span class="nc" id="L521">        calculateContentRect();</span>
<span class="nc" id="L522">        calculateThumbSize();</span>
<span class="nc" id="L523">        calculateTrackBuffer();</span>
<span class="nc" id="L524">        calculateTrackRect();</span>
<span class="nc" id="L525">        calculateTickRect();</span>
<span class="nc" id="L526">        calculateLabelRect();</span>
<span class="nc" id="L527">        calculateThumbLocation();</span>
<span class="nc" id="L528">    }</span>

    protected void calculateFocusRect() {
<span class="nc" id="L531">        focusRect.x = insetCache.left;</span>
<span class="nc" id="L532">        focusRect.y = insetCache.top;</span>
<span class="nc" id="L533">        focusRect.width = slider.getWidth() - (insetCache.left + insetCache.right);</span>
<span class="nc" id="L534">        focusRect.height = slider.getHeight() - (insetCache.top + insetCache.bottom);</span>
<span class="nc" id="L535">    }</span>

    protected void calculateThumbSize() {
<span class="nc" id="L538">        Dimension size = getThumbSize();</span>
<span class="nc" id="L539">        thumbRect.setSize( size.width, size.height );</span>
<span class="nc" id="L540">    }</span>

    protected void calculateContentRect() {
<span class="nc" id="L543">        contentRect.x = focusRect.x + focusInsets.left;</span>
<span class="nc" id="L544">        contentRect.y = focusRect.y + focusInsets.top;</span>
<span class="nc" id="L545">        contentRect.width = focusRect.width - (focusInsets.left + focusInsets.right);</span>
<span class="nc" id="L546">        contentRect.height = focusRect.height - (focusInsets.top + focusInsets.bottom);</span>
<span class="nc" id="L547">    }</span>

    private int getTickSpacing() {
<span class="nc" id="L550">        int majorTickSpacing = slider.getMajorTickSpacing();</span>
<span class="nc" id="L551">        int minorTickSpacing = slider.getMinorTickSpacing();</span>

        int result;

<span class="nc bnc" id="L555" title="All 2 branches missed.">        if (minorTickSpacing &gt; 0) {</span>
<span class="nc" id="L556">            result = minorTickSpacing;</span>
<span class="nc bnc" id="L557" title="All 2 branches missed.">        } else if (majorTickSpacing &gt; 0) {</span>
<span class="nc" id="L558">            result = majorTickSpacing;</span>
        } else {
<span class="nc" id="L560">            result = 0;</span>
        }

<span class="nc" id="L563">        return result;</span>
    }

    protected void calculateThumbLocation() {
<span class="nc bnc" id="L567" title="All 2 branches missed.">        if ( slider.getSnapToTicks() ) {</span>
<span class="nc" id="L568">            int sliderValue = slider.getValue();</span>
<span class="nc" id="L569">            int snappedValue = sliderValue;</span>
<span class="nc" id="L570">            int tickSpacing = getTickSpacing();</span>

<span class="nc bnc" id="L572" title="All 2 branches missed.">            if ( tickSpacing != 0 ) {</span>
                // If it's not on a tick, change the value
<span class="nc bnc" id="L574" title="All 2 branches missed.">                if ( (sliderValue - slider.getMinimum()) % tickSpacing != 0 ) {</span>
<span class="nc" id="L575">                    float temp = (float)(sliderValue - slider.getMinimum()) / (float)tickSpacing;</span>
<span class="nc" id="L576">                    int whichTick = Math.round( temp );</span>

                    // This is the fix for the bug #6401380
<span class="nc bnc" id="L579" title="All 4 branches missed.">                    if (temp - (int)temp == .5 &amp;&amp; sliderValue &lt; lastValue) {</span>
<span class="nc" id="L580">                      whichTick --;</span>
                    }
<span class="nc" id="L582">                    snappedValue = slider.getMinimum() + (whichTick * tickSpacing);</span>
                }

<span class="nc bnc" id="L585" title="All 2 branches missed.">                if( snappedValue != sliderValue ) {</span>
<span class="nc" id="L586">                    slider.setValue( snappedValue );</span>
                }
            }
        }

<span class="nc bnc" id="L591" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L592">            int valuePosition = xPositionForValue(slider.getValue());</span>

<span class="nc" id="L594">            thumbRect.x = valuePosition - (thumbRect.width / 2);</span>
<span class="nc" id="L595">            thumbRect.y = trackRect.y;</span>
<span class="nc" id="L596">        }</span>
        else {
<span class="nc" id="L598">            int valuePosition = yPositionForValue(slider.getValue());</span>

<span class="nc" id="L600">            thumbRect.x = trackRect.x;</span>
<span class="nc" id="L601">            thumbRect.y = valuePosition - (thumbRect.height / 2);</span>
        }
<span class="nc" id="L603">    }</span>

    protected void calculateTrackBuffer() {
<span class="nc bnc" id="L606" title="All 4 branches missed.">        if ( slider.getPaintLabels() &amp;&amp; slider.getLabelTable()  != null ) {</span>
<span class="nc" id="L607">            Component highLabel = getHighestValueLabel();</span>
<span class="nc" id="L608">            Component lowLabel = getLowestValueLabel();</span>

<span class="nc bnc" id="L610" title="All 2 branches missed.">            if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L611">                trackBuffer = Math.max( highLabel.getBounds().width, lowLabel.getBounds().width ) / 2;</span>
<span class="nc" id="L612">                trackBuffer = Math.max( trackBuffer, thumbRect.width / 2 );</span>
            }
            else {
<span class="nc" id="L615">                trackBuffer = Math.max( highLabel.getBounds().height, lowLabel.getBounds().height ) / 2;</span>
<span class="nc" id="L616">                trackBuffer = Math.max( trackBuffer, thumbRect.height / 2 );</span>
            }
<span class="nc" id="L618">        }</span>
        else {
<span class="nc bnc" id="L620" title="All 2 branches missed.">            if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L621">                trackBuffer = thumbRect.width / 2;</span>
            }
            else {
<span class="nc" id="L624">                trackBuffer = thumbRect.height / 2;</span>
            }
        }
<span class="nc" id="L627">    }</span>


    protected void calculateTrackRect() {
        int centerSpacing; // used to center sliders added using BorderLayout.CENTER (bug 4275631)
<span class="nc bnc" id="L632" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L633">            centerSpacing = thumbRect.height;</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">            if ( slider.getPaintTicks() ) centerSpacing += getTickLength();</span>
<span class="nc bnc" id="L635" title="All 2 branches missed.">            if ( slider.getPaintLabels() ) centerSpacing += getHeightOfTallestLabel();</span>
<span class="nc" id="L636">            trackRect.x = contentRect.x + trackBuffer;</span>
<span class="nc" id="L637">            trackRect.y = contentRect.y + (contentRect.height - centerSpacing - 1)/2;</span>
<span class="nc" id="L638">            trackRect.width = contentRect.width - (trackBuffer * 2);</span>
<span class="nc" id="L639">            trackRect.height = thumbRect.height;</span>
        }
        else {
<span class="nc" id="L642">            centerSpacing = thumbRect.width;</span>
<span class="nc bnc" id="L643" title="All 2 branches missed.">            if (BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc bnc" id="L644" title="All 2 branches missed.">                if ( slider.getPaintTicks() ) centerSpacing += getTickLength();</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">                if ( slider.getPaintLabels() ) centerSpacing += getWidthOfWidestLabel();</span>
            } else {
<span class="nc bnc" id="L647" title="All 2 branches missed.">                if ( slider.getPaintTicks() ) centerSpacing -= getTickLength();</span>
<span class="nc bnc" id="L648" title="All 2 branches missed.">                if ( slider.getPaintLabels() ) centerSpacing -= getWidthOfWidestLabel();</span>
            }
<span class="nc" id="L650">            trackRect.x = contentRect.x + (contentRect.width - centerSpacing - 1)/2;</span>
<span class="nc" id="L651">            trackRect.y = contentRect.y + trackBuffer;</span>
<span class="nc" id="L652">            trackRect.width = thumbRect.width;</span>
<span class="nc" id="L653">            trackRect.height = contentRect.height - (trackBuffer * 2);</span>
        }

<span class="nc" id="L656">    }</span>

    /**
     * Gets the height of the tick area for horizontal sliders and the width of the
     * tick area for vertical sliders.  BasicSliderUI uses the returned value to
     * determine the tick area rectangle.  If you want to give your ticks some room,
     * make this larger than you need and paint your ticks away from the sides in paintTicks().
     */
    protected int getTickLength() {
<span class="nc" id="L665">        return 8;</span>
    }

    protected void calculateTickRect() {
<span class="nc bnc" id="L669" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L670">            tickRect.x = trackRect.x;</span>
<span class="nc" id="L671">            tickRect.y = trackRect.y + trackRect.height;</span>
<span class="nc" id="L672">            tickRect.width = trackRect.width;</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">            tickRect.height = (slider.getPaintTicks()) ? getTickLength() : 0;</span>
        }
        else {
<span class="nc bnc" id="L676" title="All 2 branches missed.">            tickRect.width = (slider.getPaintTicks()) ? getTickLength() : 0;</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">            if(BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L678">                tickRect.x = trackRect.x + trackRect.width;</span>
            }
            else {
<span class="nc" id="L681">                tickRect.x = trackRect.x - tickRect.width;</span>
            }
<span class="nc" id="L683">            tickRect.y = trackRect.y;</span>
<span class="nc" id="L684">            tickRect.height = trackRect.height;</span>
        }
<span class="nc" id="L686">    }</span>

    protected void calculateLabelRect() {
<span class="nc bnc" id="L689" title="All 2 branches missed.">        if ( slider.getPaintLabels() ) {</span>
<span class="nc bnc" id="L690" title="All 2 branches missed.">            if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L691">                labelRect.x = tickRect.x - trackBuffer;</span>
<span class="nc" id="L692">                labelRect.y = tickRect.y + tickRect.height;</span>
<span class="nc" id="L693">                labelRect.width = tickRect.width + (trackBuffer * 2);</span>
<span class="nc" id="L694">                labelRect.height = getHeightOfTallestLabel();</span>
            }
            else {
<span class="nc bnc" id="L697" title="All 2 branches missed.">                if(BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L698">                    labelRect.x = tickRect.x + tickRect.width;</span>
<span class="nc" id="L699">                    labelRect.width = getWidthOfWidestLabel();</span>
                }
                else {
<span class="nc" id="L702">                    labelRect.width = getWidthOfWidestLabel();</span>
<span class="nc" id="L703">                    labelRect.x = tickRect.x - labelRect.width;</span>
                }
<span class="nc" id="L705">                labelRect.y = tickRect.y - trackBuffer;</span>
<span class="nc" id="L706">                labelRect.height = tickRect.height + (trackBuffer * 2);</span>
            }
        }
        else {
<span class="nc bnc" id="L710" title="All 2 branches missed.">            if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L711">                labelRect.x = tickRect.x;</span>
<span class="nc" id="L712">                labelRect.y = tickRect.y + tickRect.height;</span>
<span class="nc" id="L713">                labelRect.width = tickRect.width;</span>
<span class="nc" id="L714">                labelRect.height = 0;</span>
            }
            else {
<span class="nc bnc" id="L717" title="All 2 branches missed.">                if(BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L718">                    labelRect.x = tickRect.x + tickRect.width;</span>
                }
                else {
<span class="nc" id="L721">                    labelRect.x = tickRect.x;</span>
                }
<span class="nc" id="L723">                labelRect.y = tickRect.y;</span>
<span class="nc" id="L724">                labelRect.width = 0;</span>
<span class="nc" id="L725">                labelRect.height = tickRect.height;</span>
            }
        }
<span class="nc" id="L728">    }</span>

    protected Dimension getThumbSize() {
<span class="nc" id="L731">        Dimension size = new Dimension();</span>

<span class="nc bnc" id="L733" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.VERTICAL ) {</span>
<span class="nc" id="L734">            size.width = 20;</span>
<span class="nc" id="L735">            size.height = 11;</span>
        }
        else {
<span class="nc" id="L738">            size.width = 11;</span>
<span class="nc" id="L739">            size.height = 20;</span>
        }

<span class="nc" id="L742">        return size;</span>
    }

<span class="nc" id="L745">    public class PropertyChangeHandler implements PropertyChangeListener {</span>
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        public void propertyChange( PropertyChangeEvent e ) {
<span class="nc" id="L751">            getHandler().propertyChange(e);</span>
<span class="nc" id="L752">        }</span>
    }

    protected int getWidthOfWidestLabel() {
<span class="nc" id="L756">        Dictionary dictionary = slider.getLabelTable();</span>
<span class="nc" id="L757">        int widest = 0;</span>
<span class="nc bnc" id="L758" title="All 2 branches missed.">        if ( dictionary != null ) {</span>
<span class="nc" id="L759">            Enumeration keys = dictionary.keys();</span>
<span class="nc bnc" id="L760" title="All 2 branches missed.">            while ( keys.hasMoreElements() ) {</span>
<span class="nc" id="L761">                JComponent label = (JComponent) dictionary.get(keys.nextElement());</span>
<span class="nc" id="L762">                widest = Math.max( label.getPreferredSize().width, widest );</span>
<span class="nc" id="L763">            }</span>
        }
<span class="nc" id="L765">        return widest;</span>
    }

    protected int getHeightOfTallestLabel() {
<span class="nc" id="L769">        Dictionary dictionary = slider.getLabelTable();</span>
<span class="nc" id="L770">        int tallest = 0;</span>
<span class="nc bnc" id="L771" title="All 2 branches missed.">        if ( dictionary != null ) {</span>
<span class="nc" id="L772">            Enumeration keys = dictionary.keys();</span>
<span class="nc bnc" id="L773" title="All 2 branches missed.">            while ( keys.hasMoreElements() ) {</span>
<span class="nc" id="L774">                JComponent label = (JComponent) dictionary.get(keys.nextElement());</span>
<span class="nc" id="L775">                tallest = Math.max( label.getPreferredSize().height, tallest );</span>
<span class="nc" id="L776">            }</span>
        }
<span class="nc" id="L778">        return tallest;</span>
    }

    protected int getWidthOfHighValueLabel() {
<span class="nc" id="L782">        Component label = getHighestValueLabel();</span>
<span class="nc" id="L783">        int width = 0;</span>

<span class="nc bnc" id="L785" title="All 2 branches missed.">        if ( label != null ) {</span>
<span class="nc" id="L786">            width = label.getPreferredSize().width;</span>
        }

<span class="nc" id="L789">        return width;</span>
    }

    protected int getWidthOfLowValueLabel() {
<span class="nc" id="L793">        Component label = getLowestValueLabel();</span>
<span class="nc" id="L794">        int width = 0;</span>

<span class="nc bnc" id="L796" title="All 2 branches missed.">        if ( label != null ) {</span>
<span class="nc" id="L797">            width = label.getPreferredSize().width;</span>
        }

<span class="nc" id="L800">        return width;</span>
    }

    protected int getHeightOfHighValueLabel() {
<span class="nc" id="L804">        Component label = getHighestValueLabel();</span>
<span class="nc" id="L805">        int height = 0;</span>

<span class="nc bnc" id="L807" title="All 2 branches missed.">        if ( label != null ) {</span>
<span class="nc" id="L808">            height = label.getPreferredSize().height;</span>
        }

<span class="nc" id="L811">        return height;</span>
    }

    protected int getHeightOfLowValueLabel() {
<span class="nc" id="L815">        Component label = getLowestValueLabel();</span>
<span class="nc" id="L816">        int height = 0;</span>

<span class="nc bnc" id="L818" title="All 2 branches missed.">        if ( label != null ) {</span>
<span class="nc" id="L819">            height = label.getPreferredSize().height;</span>
        }

<span class="nc" id="L822">        return height;</span>
    }

    protected boolean drawInverted() {
<span class="nc bnc" id="L826" title="All 2 branches missed.">        if (slider.getOrientation()==JSlider.HORIZONTAL) {</span>
<span class="nc bnc" id="L827" title="All 2 branches missed.">            if(BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L828">                return slider.getInverted();</span>
            } else {
<span class="nc bnc" id="L830" title="All 2 branches missed.">                return !slider.getInverted();</span>
            }
        } else {
<span class="nc" id="L833">            return slider.getInverted();</span>
        }
    }

    /**
     * Returns the biggest value that has an entry in the label table.
     *
     * @return biggest value that has an entry in the label table, or
     *         null.
     * @since 1.6
     */
    protected Integer getHighestValue() {
<span class="nc" id="L845">        Dictionary dictionary = slider.getLabelTable();</span>

<span class="nc bnc" id="L847" title="All 2 branches missed.">        if (dictionary == null) {</span>
<span class="nc" id="L848">            return null;</span>
        }

<span class="nc" id="L851">        Enumeration keys = dictionary.keys();</span>

<span class="nc" id="L853">        Integer max = null;</span>

<span class="nc bnc" id="L855" title="All 2 branches missed.">        while (keys.hasMoreElements()) {</span>
<span class="nc" id="L856">            Integer i = (Integer) keys.nextElement();</span>

<span class="nc bnc" id="L858" title="All 4 branches missed.">            if (max == null || i &gt; max) {</span>
<span class="nc" id="L859">                max = i;</span>
            }
<span class="nc" id="L861">        }</span>

<span class="nc" id="L863">        return max;</span>
    }

    /**
     * Returns the smallest value that has an entry in the label table.
     *
     * @return smallest value that has an entry in the label table, or
     *         null.
     * @since 1.6
     */
    protected Integer getLowestValue() {
<span class="nc" id="L874">        Dictionary dictionary = slider.getLabelTable();</span>

<span class="nc bnc" id="L876" title="All 2 branches missed.">        if (dictionary == null) {</span>
<span class="nc" id="L877">            return null;</span>
        }

<span class="nc" id="L880">        Enumeration keys = dictionary.keys();</span>

<span class="nc" id="L882">        Integer min = null;</span>

<span class="nc bnc" id="L884" title="All 2 branches missed.">        while (keys.hasMoreElements()) {</span>
<span class="nc" id="L885">            Integer i = (Integer) keys.nextElement();</span>

<span class="nc bnc" id="L887" title="All 4 branches missed.">            if (min == null || i &lt; min) {</span>
<span class="nc" id="L888">                min = i;</span>
            }
<span class="nc" id="L890">        }</span>

<span class="nc" id="L892">        return min;</span>
    }


    /**
     * Returns the label that corresponds to the highest slider value in the label table.
     * @see JSlider#setLabelTable
     */
    protected Component getLowestValueLabel() {
<span class="nc" id="L901">        Integer min = getLowestValue();</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">        if (min != null) {</span>
<span class="nc" id="L903">            return (Component)slider.getLabelTable().get(min);</span>
        }
<span class="nc" id="L905">        return null;</span>
    }

    /**
     * Returns the label that corresponds to the lowest slider value in the label table.
     * @see JSlider#setLabelTable
     */
    protected Component getHighestValueLabel() {
<span class="nc" id="L913">        Integer max = getHighestValue();</span>
<span class="nc bnc" id="L914" title="All 2 branches missed.">        if (max != null) {</span>
<span class="nc" id="L915">            return (Component)slider.getLabelTable().get(max);</span>
        }
<span class="nc" id="L917">        return null;</span>
    }

    public void paint( Graphics g, JComponent c )   {
<span class="nc" id="L921">        recalculateIfInsetsChanged();</span>
<span class="nc" id="L922">        recalculateIfOrientationChanged();</span>
<span class="nc" id="L923">        Rectangle clip = g.getClipBounds();</span>

<span class="nc bnc" id="L925" title="All 4 branches missed.">        if ( !clip.intersects(trackRect) &amp;&amp; slider.getPaintTrack())</span>
<span class="nc" id="L926">            calculateGeometry();</span>

<span class="nc bnc" id="L928" title="All 4 branches missed.">        if ( slider.getPaintTrack() &amp;&amp; clip.intersects( trackRect ) ) {</span>
<span class="nc" id="L929">            paintTrack( g );</span>
        }
<span class="nc bnc" id="L931" title="All 4 branches missed.">        if ( slider.getPaintTicks() &amp;&amp; clip.intersects( tickRect ) ) {</span>
<span class="nc" id="L932">            paintTicks( g );</span>
        }
<span class="nc bnc" id="L934" title="All 4 branches missed.">        if ( slider.getPaintLabels() &amp;&amp; clip.intersects( labelRect ) ) {</span>
<span class="nc" id="L935">            paintLabels( g );</span>
        }
<span class="nc bnc" id="L937" title="All 4 branches missed.">        if ( slider.hasFocus() &amp;&amp; clip.intersects( focusRect ) ) {</span>
<span class="nc" id="L938">            paintFocus( g );</span>
        }
<span class="nc bnc" id="L940" title="All 2 branches missed.">        if ( clip.intersects( thumbRect ) ) {</span>
<span class="nc" id="L941">            paintThumb( g );</span>
        }
<span class="nc" id="L943">    }</span>

    protected void recalculateIfInsetsChanged() {
<span class="nc" id="L946">        Insets newInsets = slider.getInsets();</span>
<span class="nc bnc" id="L947" title="All 2 branches missed.">        if ( !newInsets.equals( insetCache ) ) {</span>
<span class="nc" id="L948">            insetCache = newInsets;</span>
<span class="nc" id="L949">            calculateGeometry();</span>
        }
<span class="nc" id="L951">    }</span>

    protected void recalculateIfOrientationChanged() {
<span class="nc" id="L954">        boolean ltr = BasicGraphicsUtils.isLeftToRight(slider);</span>
<span class="nc bnc" id="L955" title="All 2 branches missed.">        if ( ltr!=leftToRightCache ) {</span>
<span class="nc" id="L956">            leftToRightCache = ltr;</span>
<span class="nc" id="L957">            calculateGeometry();</span>
        }
<span class="nc" id="L959">    }</span>

    public void paintFocus(Graphics g)  {
<span class="nc" id="L962">        g.setColor( getFocusColor() );</span>

<span class="nc" id="L964">        BasicGraphicsUtils.drawDashedRect( g, focusRect.x, focusRect.y,</span>
                                           focusRect.width, focusRect.height );
<span class="nc" id="L966">    }</span>

    public void paintTrack(Graphics g)  {

<span class="nc" id="L970">        Rectangle trackBounds = trackRect;</span>

<span class="nc bnc" id="L972" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L973">            int cy = (trackBounds.height / 2) - 2;</span>
<span class="nc" id="L974">            int cw = trackBounds.width;</span>

<span class="nc" id="L976">            g.translate(trackBounds.x, trackBounds.y + cy);</span>

<span class="nc" id="L978">            g.setColor(getShadowColor());</span>
<span class="nc" id="L979">            g.drawLine(0, 0, cw - 1, 0);</span>
<span class="nc" id="L980">            g.drawLine(0, 1, 0, 2);</span>
<span class="nc" id="L981">            g.setColor(getHighlightColor());</span>
<span class="nc" id="L982">            g.drawLine(0, 3, cw, 3);</span>
<span class="nc" id="L983">            g.drawLine(cw, 0, cw, 3);</span>
<span class="nc" id="L984">            g.setColor(Color.black);</span>
<span class="nc" id="L985">            g.drawLine(1, 1, cw-2, 1);</span>

<span class="nc" id="L987">            g.translate(-trackBounds.x, -(trackBounds.y + cy));</span>
<span class="nc" id="L988">        }</span>
        else {
<span class="nc" id="L990">            int cx = (trackBounds.width / 2) - 2;</span>
<span class="nc" id="L991">            int ch = trackBounds.height;</span>

<span class="nc" id="L993">            g.translate(trackBounds.x + cx, trackBounds.y);</span>

<span class="nc" id="L995">            g.setColor(getShadowColor());</span>
<span class="nc" id="L996">            g.drawLine(0, 0, 0, ch - 1);</span>
<span class="nc" id="L997">            g.drawLine(1, 0, 2, 0);</span>
<span class="nc" id="L998">            g.setColor(getHighlightColor());</span>
<span class="nc" id="L999">            g.drawLine(3, 0, 3, ch);</span>
<span class="nc" id="L1000">            g.drawLine(0, ch, 3, ch);</span>
<span class="nc" id="L1001">            g.setColor(Color.black);</span>
<span class="nc" id="L1002">            g.drawLine(1, 1, 1, ch-2);</span>

<span class="nc" id="L1004">            g.translate(-(trackBounds.x + cx), -trackBounds.y);</span>
        }
<span class="nc" id="L1006">    }</span>

    public void paintTicks(Graphics g)  {
<span class="nc" id="L1009">        Rectangle tickBounds = tickRect;</span>

<span class="nc" id="L1011">        g.setColor(DefaultLookup.getColor(slider, this, &quot;Slider.tickColor&quot;, Color.black));</span>

<span class="nc bnc" id="L1013" title="All 2 branches missed.">        if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L1014">            g.translate(0, tickBounds.y);</span>

<span class="nc bnc" id="L1016" title="All 2 branches missed.">            if (slider.getMinorTickSpacing() &gt; 0) {</span>
<span class="nc" id="L1017">                int value = slider.getMinimum();</span>

<span class="nc bnc" id="L1019" title="All 2 branches missed.">                while ( value &lt;= slider.getMaximum() ) {</span>
<span class="nc" id="L1020">                    int xPos = xPositionForValue(value);</span>
<span class="nc" id="L1021">                    paintMinorTickForHorizSlider( g, tickBounds, xPos );</span>

                    // Overflow checking
<span class="nc bnc" id="L1024" title="All 2 branches missed.">                    if (Integer.MAX_VALUE - slider.getMinorTickSpacing() &lt; value) {</span>
<span class="nc" id="L1025">                        break;</span>
                    }

<span class="nc" id="L1028">                    value += slider.getMinorTickSpacing();</span>
<span class="nc" id="L1029">                }</span>
            }

<span class="nc bnc" id="L1032" title="All 2 branches missed.">            if (slider.getMajorTickSpacing() &gt; 0) {</span>
<span class="nc" id="L1033">                int value = slider.getMinimum();</span>

<span class="nc bnc" id="L1035" title="All 2 branches missed.">                while ( value &lt;= slider.getMaximum() ) {</span>
<span class="nc" id="L1036">                    int xPos = xPositionForValue(value);</span>
<span class="nc" id="L1037">                    paintMajorTickForHorizSlider( g, tickBounds, xPos );</span>

                    // Overflow checking
<span class="nc bnc" id="L1040" title="All 2 branches missed.">                    if (Integer.MAX_VALUE - slider.getMajorTickSpacing() &lt; value) {</span>
<span class="nc" id="L1041">                        break;</span>
                    }

<span class="nc" id="L1044">                    value += slider.getMajorTickSpacing();</span>
<span class="nc" id="L1045">                }</span>
            }

<span class="nc" id="L1048">            g.translate( 0, -tickBounds.y);</span>
        } else {
<span class="nc" id="L1050">            g.translate(tickBounds.x, 0);</span>

<span class="nc bnc" id="L1052" title="All 2 branches missed.">            if (slider.getMinorTickSpacing() &gt; 0) {</span>
<span class="nc" id="L1053">                int offset = 0;</span>
<span class="nc bnc" id="L1054" title="All 2 branches missed.">                if(!BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1055">                    offset = tickBounds.width - tickBounds.width / 2;</span>
<span class="nc" id="L1056">                    g.translate(offset, 0);</span>
                }

<span class="nc" id="L1059">                int value = slider.getMinimum();</span>

<span class="nc bnc" id="L1061" title="All 2 branches missed.">                while (value &lt;= slider.getMaximum()) {</span>
<span class="nc" id="L1062">                    int yPos = yPositionForValue(value);</span>
<span class="nc" id="L1063">                    paintMinorTickForVertSlider( g, tickBounds, yPos );</span>

                    // Overflow checking
<span class="nc bnc" id="L1066" title="All 2 branches missed.">                    if (Integer.MAX_VALUE - slider.getMinorTickSpacing() &lt; value) {</span>
<span class="nc" id="L1067">                        break;</span>
                    }

<span class="nc" id="L1070">                    value += slider.getMinorTickSpacing();</span>
<span class="nc" id="L1071">                }</span>

<span class="nc bnc" id="L1073" title="All 2 branches missed.">                if(!BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1074">                    g.translate(-offset, 0);</span>
                }
            }

<span class="nc bnc" id="L1078" title="All 2 branches missed.">            if (slider.getMajorTickSpacing() &gt; 0) {</span>
<span class="nc bnc" id="L1079" title="All 2 branches missed.">                if(!BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1080">                    g.translate(2, 0);</span>
                }

<span class="nc" id="L1083">                int value = slider.getMinimum();</span>

<span class="nc bnc" id="L1085" title="All 2 branches missed.">                while (value &lt;= slider.getMaximum()) {</span>
<span class="nc" id="L1086">                    int yPos = yPositionForValue(value);</span>
<span class="nc" id="L1087">                    paintMajorTickForVertSlider( g, tickBounds, yPos );</span>

                    // Overflow checking
<span class="nc bnc" id="L1090" title="All 2 branches missed.">                    if (Integer.MAX_VALUE - slider.getMajorTickSpacing() &lt; value) {</span>
<span class="nc" id="L1091">                        break;</span>
                    }

<span class="nc" id="L1094">                    value += slider.getMajorTickSpacing();</span>
<span class="nc" id="L1095">                }</span>

<span class="nc bnc" id="L1097" title="All 2 branches missed.">                if(!BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1098">                    g.translate(-2, 0);</span>
                }
            }
<span class="nc" id="L1101">            g.translate(-tickBounds.x, 0);</span>
        }
<span class="nc" id="L1103">    }</span>

    protected void paintMinorTickForHorizSlider( Graphics g, Rectangle tickBounds, int x ) {
<span class="nc" id="L1106">        g.drawLine( x, 0, x, tickBounds.height / 2 - 1 );</span>
<span class="nc" id="L1107">    }</span>

    protected void paintMajorTickForHorizSlider( Graphics g, Rectangle tickBounds, int x ) {
<span class="nc" id="L1110">        g.drawLine( x, 0, x, tickBounds.height - 2 );</span>
<span class="nc" id="L1111">    }</span>

    protected void paintMinorTickForVertSlider( Graphics g, Rectangle tickBounds, int y ) {
<span class="nc" id="L1114">        g.drawLine( 0, y, tickBounds.width / 2 - 1, y );</span>
<span class="nc" id="L1115">    }</span>

    protected void paintMajorTickForVertSlider( Graphics g, Rectangle tickBounds, int y ) {
<span class="nc" id="L1118">        g.drawLine( 0, y,  tickBounds.width - 2, y );</span>
<span class="nc" id="L1119">    }</span>

    public void paintLabels( Graphics g ) {
<span class="nc" id="L1122">        Rectangle labelBounds = labelRect;</span>

<span class="nc" id="L1124">        Dictionary dictionary = slider.getLabelTable();</span>
<span class="nc bnc" id="L1125" title="All 2 branches missed.">        if ( dictionary != null ) {</span>
<span class="nc" id="L1126">            Enumeration keys = dictionary.keys();</span>
<span class="nc" id="L1127">            int minValue = slider.getMinimum();</span>
<span class="nc" id="L1128">            int maxValue = slider.getMaximum();</span>
<span class="nc" id="L1129">            boolean enabled = slider.isEnabled();</span>
<span class="nc bnc" id="L1130" title="All 2 branches missed.">            while ( keys.hasMoreElements() ) {</span>
<span class="nc" id="L1131">                Integer key = (Integer)keys.nextElement();</span>
<span class="nc" id="L1132">                int value = key.intValue();</span>
<span class="nc bnc" id="L1133" title="All 4 branches missed.">                if (value &gt;= minValue &amp;&amp; value &lt;= maxValue) {</span>
<span class="nc" id="L1134">                    JComponent label = (JComponent) dictionary.get(key);</span>
<span class="nc" id="L1135">                    label.setEnabled(enabled);</span>

<span class="nc bnc" id="L1137" title="All 2 branches missed.">                    if (label instanceof JLabel) {</span>
<span class="nc bnc" id="L1138" title="All 2 branches missed.">                        Icon icon = label.isEnabled() ? ((JLabel) label).getIcon() : ((JLabel) label).getDisabledIcon();</span>

<span class="nc bnc" id="L1140" title="All 2 branches missed.">                        if (icon instanceof ImageIcon) {</span>
                            // Register Slider as an image observer. It allows to catch notifications about
                            // image changes (e.g. gif animation)
<span class="nc" id="L1143">                            Toolkit.getDefaultToolkit().checkImage(((ImageIcon) icon).getImage(), -1, -1, slider);</span>
                        }
                    }

<span class="nc bnc" id="L1147" title="All 2 branches missed.">                    if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L1148">                        g.translate( 0, labelBounds.y );</span>
<span class="nc" id="L1149">                        paintHorizontalLabel( g, value, label );</span>
<span class="nc" id="L1150">                        g.translate( 0, -labelBounds.y );</span>
                    }
                    else {
<span class="nc" id="L1153">                        int offset = 0;</span>
<span class="nc bnc" id="L1154" title="All 2 branches missed.">                        if (!BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1155">                            offset = labelBounds.width -</span>
<span class="nc" id="L1156">                                label.getPreferredSize().width;</span>
                        }
<span class="nc" id="L1158">                        g.translate( labelBounds.x + offset, 0 );</span>
<span class="nc" id="L1159">                        paintVerticalLabel( g, value, label );</span>
<span class="nc" id="L1160">                        g.translate( -labelBounds.x - offset, 0 );</span>
                    }
                }
<span class="nc" id="L1163">            }</span>
        }

<span class="nc" id="L1166">    }</span>

    /**
     * Called for every label in the label table.  Used to draw the labels for horizontal sliders.
     * The graphics have been translated to labelRect.y already.
     * @see JSlider#setLabelTable
     */
    protected void paintHorizontalLabel( Graphics g, int value, Component label ) {
<span class="nc" id="L1174">        int labelCenter = xPositionForValue( value );</span>
<span class="nc" id="L1175">        int labelLeft = labelCenter - (label.getPreferredSize().width / 2);</span>
<span class="nc" id="L1176">        g.translate( labelLeft, 0 );</span>
<span class="nc" id="L1177">        label.paint( g );</span>
<span class="nc" id="L1178">        g.translate( -labelLeft, 0 );</span>
<span class="nc" id="L1179">    }</span>

    /**
     * Called for every label in the label table.  Used to draw the labels for vertical sliders.
     * The graphics have been translated to labelRect.x already.
     * @see JSlider#setLabelTable
     */
    protected void paintVerticalLabel( Graphics g, int value, Component label ) {
<span class="nc" id="L1187">        int labelCenter = yPositionForValue( value );</span>
<span class="nc" id="L1188">        int labelTop = labelCenter - (label.getPreferredSize().height / 2);</span>
<span class="nc" id="L1189">        g.translate( 0, labelTop );</span>
<span class="nc" id="L1190">        label.paint( g );</span>
<span class="nc" id="L1191">        g.translate( 0, -labelTop );</span>
<span class="nc" id="L1192">    }</span>

    public void paintThumb(Graphics g)  {
<span class="nc" id="L1195">        Rectangle knobBounds = thumbRect;</span>
<span class="nc" id="L1196">        int w = knobBounds.width;</span>
<span class="nc" id="L1197">        int h = knobBounds.height;</span>

<span class="nc" id="L1199">        g.translate(knobBounds.x, knobBounds.y);</span>

<span class="nc bnc" id="L1201" title="All 2 branches missed.">        if ( slider.isEnabled() ) {</span>
<span class="nc" id="L1202">            g.setColor(slider.getBackground());</span>
        }
        else {
<span class="nc" id="L1205">            g.setColor(slider.getBackground().darker());</span>
        }

<span class="nc" id="L1208">        Boolean paintThumbArrowShape =</span>
<span class="nc" id="L1209">            (Boolean)slider.getClientProperty(&quot;Slider.paintThumbArrowShape&quot;);</span>

<span class="nc bnc" id="L1211" title="All 6 branches missed.">        if ((!slider.getPaintTicks() &amp;&amp; paintThumbArrowShape == null) ||</span>
            paintThumbArrowShape == Boolean.FALSE) {

            // &quot;plain&quot; version
<span class="nc" id="L1215">            g.fillRect(0, 0, w, h);</span>

<span class="nc" id="L1217">            g.setColor(Color.black);</span>
<span class="nc" id="L1218">            g.drawLine(0, h-1, w-1, h-1);</span>
<span class="nc" id="L1219">            g.drawLine(w-1, 0, w-1, h-1);</span>

<span class="nc" id="L1221">            g.setColor(highlightColor);</span>
<span class="nc" id="L1222">            g.drawLine(0, 0, 0, h-2);</span>
<span class="nc" id="L1223">            g.drawLine(1, 0, w-2, 0);</span>

<span class="nc" id="L1225">            g.setColor(shadowColor);</span>
<span class="nc" id="L1226">            g.drawLine(1, h-2, w-2, h-2);</span>
<span class="nc" id="L1227">            g.drawLine(w-2, 1, w-2, h-3);</span>
        }
<span class="nc bnc" id="L1229" title="All 2 branches missed.">        else if ( slider.getOrientation() == JSlider.HORIZONTAL ) {</span>
<span class="nc" id="L1230">            int cw = w / 2;</span>
<span class="nc" id="L1231">            g.fillRect(1, 1, w-3, h-1-cw);</span>
<span class="nc" id="L1232">            Polygon p = new Polygon();</span>
<span class="nc" id="L1233">            p.addPoint(1, h-cw);</span>
<span class="nc" id="L1234">            p.addPoint(cw-1, h-1);</span>
<span class="nc" id="L1235">            p.addPoint(w-2, h-1-cw);</span>
<span class="nc" id="L1236">            g.fillPolygon(p);</span>

<span class="nc" id="L1238">            g.setColor(highlightColor);</span>
<span class="nc" id="L1239">            g.drawLine(0, 0, w-2, 0);</span>
<span class="nc" id="L1240">            g.drawLine(0, 1, 0, h-1-cw);</span>
<span class="nc" id="L1241">            g.drawLine(0, h-cw, cw-1, h-1);</span>

<span class="nc" id="L1243">            g.setColor(Color.black);</span>
<span class="nc" id="L1244">            g.drawLine(w-1, 0, w-1, h-2-cw);</span>
<span class="nc" id="L1245">            g.drawLine(w-1, h-1-cw, w-1-cw, h-1);</span>

<span class="nc" id="L1247">            g.setColor(shadowColor);</span>
<span class="nc" id="L1248">            g.drawLine(w-2, 1, w-2, h-2-cw);</span>
<span class="nc" id="L1249">            g.drawLine(w-2, h-1-cw, w-1-cw, h-2);</span>
<span class="nc" id="L1250">        }</span>
        else {  // vertical
<span class="nc" id="L1252">            int cw = h / 2;</span>
<span class="nc bnc" id="L1253" title="All 2 branches missed.">            if(BasicGraphicsUtils.isLeftToRight(slider)) {</span>
<span class="nc" id="L1254">                  g.fillRect(1, 1, w-1-cw, h-3);</span>
<span class="nc" id="L1255">                  Polygon p = new Polygon();</span>
<span class="nc" id="L1256">                  p.addPoint(w-cw-1, 0);</span>
<span class="nc" id="L1257">                  p.addPoint(w-1, cw);</span>
<span class="nc" id="L1258">                  p.addPoint(w-1-cw, h-2);</span>
<span class="nc" id="L1259">                  g.fillPolygon(p);</span>

<span class="nc" id="L1261">                  g.setColor(highlightColor);</span>
<span class="nc" id="L1262">                  g.drawLine(0, 0, 0, h - 2);                  // left</span>
<span class="nc" id="L1263">                  g.drawLine(1, 0, w-1-cw, 0);                 // top</span>
<span class="nc" id="L1264">                  g.drawLine(w-cw-1, 0, w-1, cw);              // top slant</span>

<span class="nc" id="L1266">                  g.setColor(Color.black);</span>
<span class="nc" id="L1267">                  g.drawLine(0, h-1, w-2-cw, h-1);             // bottom</span>
<span class="nc" id="L1268">                  g.drawLine(w-1-cw, h-1, w-1, h-1-cw);        // bottom slant</span>

<span class="nc" id="L1270">                  g.setColor(shadowColor);</span>
<span class="nc" id="L1271">                  g.drawLine(1, h-2, w-2-cw,  h-2 );         // bottom</span>
<span class="nc" id="L1272">                  g.drawLine(w-1-cw, h-2, w-2, h-cw-1 );     // bottom slant</span>
<span class="nc" id="L1273">            }</span>
            else {
<span class="nc" id="L1275">                  g.fillRect(5, 1, w-1-cw, h-3);</span>
<span class="nc" id="L1276">                  Polygon p = new Polygon();</span>
<span class="nc" id="L1277">                  p.addPoint(cw, 0);</span>
<span class="nc" id="L1278">                  p.addPoint(0, cw);</span>
<span class="nc" id="L1279">                  p.addPoint(cw, h-2);</span>
<span class="nc" id="L1280">                  g.fillPolygon(p);</span>

<span class="nc" id="L1282">                  g.setColor(highlightColor);</span>
<span class="nc" id="L1283">                  g.drawLine(cw-1, 0, w-2, 0);             // top</span>
<span class="nc" id="L1284">                  g.drawLine(0, cw, cw, 0);                // top slant</span>

<span class="nc" id="L1286">                  g.setColor(Color.black);</span>
<span class="nc" id="L1287">                  g.drawLine(0, h-1-cw, cw, h-1 );         // bottom slant</span>
<span class="nc" id="L1288">                  g.drawLine(cw, h-1, w-1, h-1);           // bottom</span>

<span class="nc" id="L1290">                  g.setColor(shadowColor);</span>
<span class="nc" id="L1291">                  g.drawLine(cw, h-2, w-2,  h-2 );         // bottom</span>
<span class="nc" id="L1292">                  g.drawLine(w-1, 1, w-1,  h-2 );          // right</span>
            }
        }

<span class="nc" id="L1296">        g.translate(-knobBounds.x, -knobBounds.y);</span>
<span class="nc" id="L1297">    }</span>

    // Used exclusively by setThumbLocation()
<span class="nc" id="L1300">    private static Rectangle unionRect = new Rectangle();</span>

    public void setThumbLocation(int x, int y)  {
<span class="nc" id="L1303">        unionRect.setBounds( thumbRect );</span>

<span class="nc" id="L1305">        thumbRect.setLocation( x, y );</span>

<span class="nc" id="L1307">        SwingUtilities.computeUnion( thumbRect.x, thumbRect.y, thumbRect.width, thumbRect.height, unionRect );</span>
<span class="nc" id="L1308">        slider.repaint( unionRect.x, unionRect.y, unionRect.width, unionRect.height );</span>
<span class="nc" id="L1309">    }</span>

    public void scrollByBlock(int direction)    {
<span class="nc" id="L1312">        synchronized(slider)    {</span>
<span class="nc" id="L1313">            int blockIncrement =</span>
<span class="nc" id="L1314">                (slider.getMaximum() - slider.getMinimum()) / 10;</span>
<span class="nc bnc" id="L1315" title="All 2 branches missed.">            if (blockIncrement == 0) {</span>
<span class="nc" id="L1316">                blockIncrement = 1;</span>
            }

<span class="nc bnc" id="L1319" title="All 2 branches missed.">            if (slider.getSnapToTicks()) {</span>
<span class="nc" id="L1320">                int tickSpacing = getTickSpacing();</span>

<span class="nc bnc" id="L1322" title="All 2 branches missed.">                if (blockIncrement &lt; tickSpacing) {</span>
<span class="nc" id="L1323">                    blockIncrement = tickSpacing;</span>
                }
            }

<span class="nc bnc" id="L1327" title="All 2 branches missed.">            int delta = blockIncrement * ((direction &gt; 0) ? POSITIVE_SCROLL : NEGATIVE_SCROLL);</span>
<span class="nc" id="L1328">            slider.setValue(slider.getValue() + delta);</span>
<span class="nc" id="L1329">        }</span>
<span class="nc" id="L1330">    }</span>

    public void scrollByUnit(int direction) {
<span class="nc" id="L1333">        synchronized(slider)    {</span>
<span class="nc bnc" id="L1334" title="All 2 branches missed.">            int delta = ((direction &gt; 0) ? POSITIVE_SCROLL : NEGATIVE_SCROLL);</span>

<span class="nc bnc" id="L1336" title="All 2 branches missed.">            if (slider.getSnapToTicks()) {</span>
<span class="nc" id="L1337">                delta *= getTickSpacing();</span>
            }

<span class="nc" id="L1340">            slider.setValue(slider.getValue() + delta);</span>
<span class="nc" id="L1341">        }</span>
<span class="nc" id="L1342">    }</span>

    /**
     * This function is called when a mousePressed was detected in the track, not
     * in the thumb.  The default behavior is to scroll by block.  You can
     *  override this method to stop it from scrolling or to add additional behavior.
     */
    protected void scrollDueToClickInTrack( int dir ) {
<span class="nc" id="L1350">        scrollByBlock( dir );</span>
<span class="nc" id="L1351">    }</span>

    protected int xPositionForValue( int value )    {
<span class="nc" id="L1354">        int min = slider.getMinimum();</span>
<span class="nc" id="L1355">        int max = slider.getMaximum();</span>
<span class="nc" id="L1356">        int trackLength = trackRect.width;</span>
<span class="nc" id="L1357">        double valueRange = (double)max - (double)min;</span>
<span class="nc" id="L1358">        double pixelsPerValue = (double)trackLength / valueRange;</span>
<span class="nc" id="L1359">        int trackLeft = trackRect.x;</span>
<span class="nc" id="L1360">        int trackRight = trackRect.x + (trackRect.width - 1);</span>
        int xPosition;

<span class="nc bnc" id="L1363" title="All 2 branches missed.">        if ( !drawInverted() ) {</span>
<span class="nc" id="L1364">            xPosition = trackLeft;</span>
<span class="nc" id="L1365">            xPosition += Math.round( pixelsPerValue * ((double)value - min) );</span>
        }
        else {
<span class="nc" id="L1368">            xPosition = trackRight;</span>
<span class="nc" id="L1369">            xPosition -= Math.round( pixelsPerValue * ((double)value - min) );</span>
        }

<span class="nc" id="L1372">        xPosition = Math.max( trackLeft, xPosition );</span>
<span class="nc" id="L1373">        xPosition = Math.min( trackRight, xPosition );</span>

<span class="nc" id="L1375">        return xPosition;</span>
    }

    protected int yPositionForValue( int value )  {
<span class="nc" id="L1379">        return yPositionForValue(value, trackRect.y, trackRect.height);</span>
    }

    /**
     * Returns the y location for the specified value.  No checking is
     * done on the arguments.  In particular if &lt;code&gt;trackHeight&lt;/code&gt; is
     * negative undefined results may occur.
     *
     * @param value the slider value to get the location for
     * @param trackY y-origin of the track
     * @param trackHeight the height of the track
     * @since 1.6
     */
    protected int yPositionForValue(int value, int trackY, int trackHeight) {
<span class="nc" id="L1393">        int min = slider.getMinimum();</span>
<span class="nc" id="L1394">        int max = slider.getMaximum();</span>
<span class="nc" id="L1395">        double valueRange = (double)max - (double)min;</span>
<span class="nc" id="L1396">        double pixelsPerValue = (double)trackHeight / valueRange;</span>
<span class="nc" id="L1397">        int trackBottom = trackY + (trackHeight - 1);</span>
        int yPosition;

<span class="nc bnc" id="L1400" title="All 2 branches missed.">        if ( !drawInverted() ) {</span>
<span class="nc" id="L1401">            yPosition = trackY;</span>
<span class="nc" id="L1402">            yPosition += Math.round( pixelsPerValue * ((double)max - value ) );</span>
        }
        else {
<span class="nc" id="L1405">            yPosition = trackY;</span>
<span class="nc" id="L1406">            yPosition += Math.round( pixelsPerValue * ((double)value - min) );</span>
        }

<span class="nc" id="L1409">        yPosition = Math.max( trackY, yPosition );</span>
<span class="nc" id="L1410">        yPosition = Math.min( trackBottom, yPosition );</span>

<span class="nc" id="L1412">        return yPosition;</span>
    }

    /**
     * Returns the value at the y position. If {@code yPos} is beyond the
     * track at the the bottom or the top, this method sets the value to either
     * the minimum or maximum value of the slider, depending on if the slider
     * is inverted or not.
     */
    public int valueForYPosition( int yPos ) {
        int value;
<span class="nc" id="L1423">        final int minValue = slider.getMinimum();</span>
<span class="nc" id="L1424">        final int maxValue = slider.getMaximum();</span>
<span class="nc" id="L1425">        final int trackLength = trackRect.height;</span>
<span class="nc" id="L1426">        final int trackTop = trackRect.y;</span>
<span class="nc" id="L1427">        final int trackBottom = trackRect.y + (trackRect.height - 1);</span>

<span class="nc bnc" id="L1429" title="All 2 branches missed.">        if ( yPos &lt;= trackTop ) {</span>
<span class="nc bnc" id="L1430" title="All 2 branches missed.">            value = drawInverted() ? minValue : maxValue;</span>
        }
<span class="nc bnc" id="L1432" title="All 2 branches missed.">        else if ( yPos &gt;= trackBottom ) {</span>
<span class="nc bnc" id="L1433" title="All 2 branches missed.">            value = drawInverted() ? maxValue : minValue;</span>
        }
        else {
<span class="nc" id="L1436">            int distanceFromTrackTop = yPos - trackTop;</span>
<span class="nc" id="L1437">            double valueRange = (double)maxValue - (double)minValue;</span>
<span class="nc" id="L1438">            double valuePerPixel = valueRange / (double)trackLength;</span>
<span class="nc" id="L1439">            int valueFromTrackTop = (int)Math.round( distanceFromTrackTop * valuePerPixel );</span>

<span class="nc bnc" id="L1441" title="All 2 branches missed.">            value = drawInverted() ? minValue + valueFromTrackTop : maxValue - valueFromTrackTop;</span>
        }

<span class="nc" id="L1444">        return value;</span>
    }

    /**
     * Returns the value at the x position.  If {@code xPos} is beyond the
     * track at the left or the right, this method sets the value to either the
     * minimum or maximum value of the slider, depending on if the slider is
     * inverted or not.
     */
    public int valueForXPosition( int xPos ) {
        int value;
<span class="nc" id="L1455">        final int minValue = slider.getMinimum();</span>
<span class="nc" id="L1456">        final int maxValue = slider.getMaximum();</span>
<span class="nc" id="L1457">        final int trackLength = trackRect.width;</span>
<span class="nc" id="L1458">        final int trackLeft = trackRect.x;</span>
<span class="nc" id="L1459">        final int trackRight = trackRect.x + (trackRect.width - 1);</span>

<span class="nc bnc" id="L1461" title="All 2 branches missed.">        if ( xPos &lt;= trackLeft ) {</span>
<span class="nc bnc" id="L1462" title="All 2 branches missed.">            value = drawInverted() ? maxValue : minValue;</span>
        }
<span class="nc bnc" id="L1464" title="All 2 branches missed.">        else if ( xPos &gt;= trackRight ) {</span>
<span class="nc bnc" id="L1465" title="All 2 branches missed.">            value = drawInverted() ? minValue : maxValue;</span>
        }
        else {
<span class="nc" id="L1468">            int distanceFromTrackLeft = xPos - trackLeft;</span>
<span class="nc" id="L1469">            double valueRange = (double)maxValue - (double)minValue;</span>
<span class="nc" id="L1470">            double valuePerPixel = valueRange / (double)trackLength;</span>
<span class="nc" id="L1471">            int valueFromTrackLeft = (int)Math.round( distanceFromTrackLeft * valuePerPixel );</span>

<span class="nc bnc" id="L1473" title="All 2 branches missed.">            value = drawInverted() ? maxValue - valueFromTrackLeft :</span>
              minValue + valueFromTrackLeft;
        }

<span class="nc" id="L1477">        return value;</span>
    }


<span class="nc" id="L1481">    private class Handler implements ChangeListener,</span>
            ComponentListener, FocusListener, PropertyChangeListener {
        // Change Handler
        public void stateChanged(ChangeEvent e) {
<span class="nc bnc" id="L1485" title="All 2 branches missed.">            if (!isDragging) {</span>
<span class="nc" id="L1486">                calculateThumbLocation();</span>
<span class="nc" id="L1487">                slider.repaint();</span>
            }
<span class="nc" id="L1489">            lastValue = slider.getValue();</span>
<span class="nc" id="L1490">        }</span>

        // Component Handler
<span class="nc" id="L1493">        public void componentHidden(ComponentEvent e) { }</span>
<span class="nc" id="L1494">        public void componentMoved(ComponentEvent e) { }</span>
        public void componentResized(ComponentEvent e) {
<span class="nc" id="L1496">            calculateGeometry();</span>
<span class="nc" id="L1497">            slider.repaint();</span>
<span class="nc" id="L1498">        }</span>
<span class="nc" id="L1499">        public void componentShown(ComponentEvent e) { }</span>

        // Focus Handler
<span class="nc" id="L1502">        public void focusGained(FocusEvent e) { slider.repaint(); }</span>
<span class="nc" id="L1503">        public void focusLost(FocusEvent e) { slider.repaint(); }</span>

        // Property Change Handler
        public void propertyChange(PropertyChangeEvent e) {
<span class="nc" id="L1507">            String propertyName = e.getPropertyName();</span>
<span class="nc bnc" id="L1508" title="All 20 branches missed.">            if (propertyName == &quot;orientation&quot; ||</span>
                    propertyName == &quot;inverted&quot; ||
                    propertyName == &quot;labelTable&quot; ||
                    propertyName == &quot;majorTickSpacing&quot; ||
                    propertyName == &quot;minorTickSpacing&quot; ||
                    propertyName == &quot;paintTicks&quot; ||
                    propertyName == &quot;paintTrack&quot; ||
                    propertyName == &quot;font&quot; ||
                    propertyName == &quot;paintLabels&quot; ||
                    propertyName == &quot;Slider.paintThumbArrowShape&quot;) {
<span class="nc" id="L1518">                checkedLabelBaselines = false;</span>
<span class="nc" id="L1519">                calculateGeometry();</span>
<span class="nc" id="L1520">                slider.repaint();</span>
<span class="nc bnc" id="L1521" title="All 2 branches missed.">            } else if (propertyName == &quot;componentOrientation&quot;) {</span>
<span class="nc" id="L1522">                calculateGeometry();</span>
<span class="nc" id="L1523">                slider.repaint();</span>
<span class="nc" id="L1524">                InputMap km = getInputMap(JComponent.WHEN_FOCUSED, slider);</span>
<span class="nc" id="L1525">                SwingUtilities.replaceUIInputMap(slider,</span>
                    JComponent.WHEN_FOCUSED, km);
<span class="nc bnc" id="L1527" title="All 2 branches missed.">            } else if (propertyName == &quot;model&quot;) {</span>
<span class="nc" id="L1528">                ((BoundedRangeModel)e.getOldValue()).removeChangeListener(</span>
                    changeListener);
<span class="nc" id="L1530">                ((BoundedRangeModel)e.getNewValue()).addChangeListener(</span>
                    changeListener);
<span class="nc" id="L1532">                calculateThumbLocation();</span>
<span class="nc" id="L1533">                slider.repaint();</span>
            }
<span class="nc" id="L1535">        }</span>
    }

    /////////////////////////////////////////////////////////////////////////
    /// Model Listener Class
    /////////////////////////////////////////////////////////////////////////
    /**
     * Data model listener.
     *
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
<span class="nc" id="L1547">    public class ChangeHandler implements ChangeListener {</span>
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        public void stateChanged(ChangeEvent e) {
<span class="nc" id="L1553">            getHandler().stateChanged(e);</span>
<span class="nc" id="L1554">        }</span>
    }

    /////////////////////////////////////////////////////////////////////////
    /// Track Listener Class
    /////////////////////////////////////////////////////////////////////////
    /**
     * Track mouse movements.
     *
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
<span class="nc" id="L1566">    public class TrackListener extends MouseInputAdapter {</span>
        protected transient int offset;
        protected transient int currentMouseX, currentMouseY;

        public void mouseReleased(MouseEvent e) {
<span class="nc bnc" id="L1571" title="All 2 branches missed.">            if (!slider.isEnabled()) {</span>
<span class="nc" id="L1572">                return;</span>
            }

<span class="nc" id="L1575">            offset = 0;</span>
<span class="nc" id="L1576">            scrollTimer.stop();</span>

<span class="nc" id="L1578">            isDragging = false;</span>
<span class="nc" id="L1579">            slider.setValueIsAdjusting(false);</span>
<span class="nc" id="L1580">            slider.repaint();</span>
<span class="nc" id="L1581">        }</span>

        /**
        * If the mouse is pressed above the &quot;thumb&quot; component
        * then reduce the scrollbars value by one page (&quot;page up&quot;),
        * otherwise increase it by one page.  If there is no
        * thumb then page up if the mouse is in the upper half
        * of the track.
        */
        public void mousePressed(MouseEvent e) {
<span class="nc bnc" id="L1591" title="All 2 branches missed.">            if (!slider.isEnabled()) {</span>
<span class="nc" id="L1592">                return;</span>
            }

            // We should recalculate geometry just before
            // calculation of the thumb movement direction.
            // It is important for the case, when JSlider
            // is a cell editor in JTable. See 6348946.
<span class="nc" id="L1599">            calculateGeometry();</span>

<span class="nc" id="L1601">            currentMouseX = e.getX();</span>
<span class="nc" id="L1602">            currentMouseY = e.getY();</span>

<span class="nc bnc" id="L1604" title="All 2 branches missed.">            if (slider.isRequestFocusEnabled()) {</span>
<span class="nc" id="L1605">                slider.requestFocus();</span>
            }

            // Clicked in the Thumb area?
<span class="nc bnc" id="L1609" title="All 2 branches missed.">            if (thumbRect.contains(currentMouseX, currentMouseY)) {</span>
<span class="nc bnc" id="L1610" title="All 2 branches missed.">                if (UIManager.getBoolean(&quot;Slider.onlyLeftMouseButtonDrag&quot;)</span>
<span class="nc bnc" id="L1611" title="All 2 branches missed.">                        &amp;&amp; !SwingUtilities.isLeftMouseButton(e)) {</span>
<span class="nc" id="L1612">                    return;</span>
                }

<span class="nc bnc" id="L1615" title="All 3 branches missed.">                switch (slider.getOrientation()) {</span>
                case JSlider.VERTICAL:
<span class="nc" id="L1617">                    offset = currentMouseY - thumbRect.y;</span>
<span class="nc" id="L1618">                    break;</span>
                case JSlider.HORIZONTAL:
<span class="nc" id="L1620">                    offset = currentMouseX - thumbRect.x;</span>
                    break;
                }
<span class="nc" id="L1623">                isDragging = true;</span>
<span class="nc" id="L1624">                return;</span>
            }

<span class="nc bnc" id="L1627" title="All 2 branches missed.">            if (!SwingUtilities.isLeftMouseButton(e)) {</span>
<span class="nc" id="L1628">                return;</span>
            }

<span class="nc" id="L1631">            isDragging = false;</span>
<span class="nc" id="L1632">            slider.setValueIsAdjusting(true);</span>

<span class="nc" id="L1634">            Dimension sbSize = slider.getSize();</span>
<span class="nc" id="L1635">            int direction = POSITIVE_SCROLL;</span>

<span class="nc bnc" id="L1637" title="All 3 branches missed.">            switch (slider.getOrientation()) {</span>
            case JSlider.VERTICAL:
<span class="nc bnc" id="L1639" title="All 2 branches missed.">                if ( thumbRect.isEmpty() ) {</span>
<span class="nc" id="L1640">                    int scrollbarCenter = sbSize.height / 2;</span>
<span class="nc bnc" id="L1641" title="All 2 branches missed.">                    if ( !drawInverted() ) {</span>
<span class="nc bnc" id="L1642" title="All 2 branches missed.">                        direction = (currentMouseY &lt; scrollbarCenter) ?</span>
                            POSITIVE_SCROLL : NEGATIVE_SCROLL;
                    }
                    else {
<span class="nc bnc" id="L1646" title="All 2 branches missed.">                        direction = (currentMouseY &lt; scrollbarCenter) ?</span>
                            NEGATIVE_SCROLL : POSITIVE_SCROLL;
                    }
<span class="nc" id="L1649">                }</span>
                else {
<span class="nc" id="L1651">                    int thumbY = thumbRect.y;</span>
<span class="nc bnc" id="L1652" title="All 2 branches missed.">                    if ( !drawInverted() ) {</span>
<span class="nc bnc" id="L1653" title="All 2 branches missed.">                        direction = (currentMouseY &lt; thumbY) ?</span>
                            POSITIVE_SCROLL : NEGATIVE_SCROLL;
                    }
                    else {
<span class="nc bnc" id="L1657" title="All 2 branches missed.">                        direction = (currentMouseY &lt; thumbY) ?</span>
                            NEGATIVE_SCROLL : POSITIVE_SCROLL;
                    }
                }
<span class="nc" id="L1661">                break;</span>
            case JSlider.HORIZONTAL:
<span class="nc bnc" id="L1663" title="All 2 branches missed.">                if ( thumbRect.isEmpty() ) {</span>
<span class="nc" id="L1664">                    int scrollbarCenter = sbSize.width / 2;</span>
<span class="nc bnc" id="L1665" title="All 2 branches missed.">                    if ( !drawInverted() ) {</span>
<span class="nc bnc" id="L1666" title="All 2 branches missed.">                        direction = (currentMouseX &lt; scrollbarCenter) ?</span>
                            NEGATIVE_SCROLL : POSITIVE_SCROLL;
                    }
                    else {
<span class="nc bnc" id="L1670" title="All 2 branches missed.">                        direction = (currentMouseX &lt; scrollbarCenter) ?</span>
                            POSITIVE_SCROLL : NEGATIVE_SCROLL;
                    }
<span class="nc" id="L1673">                }</span>
                else {
<span class="nc" id="L1675">                    int thumbX = thumbRect.x;</span>
<span class="nc bnc" id="L1676" title="All 2 branches missed.">                    if ( !drawInverted() ) {</span>
<span class="nc bnc" id="L1677" title="All 2 branches missed.">                        direction = (currentMouseX &lt; thumbX) ?</span>
                            NEGATIVE_SCROLL : POSITIVE_SCROLL;
                    }
                    else {
<span class="nc bnc" id="L1681" title="All 2 branches missed.">                        direction = (currentMouseX &lt; thumbX) ?</span>
                            POSITIVE_SCROLL : NEGATIVE_SCROLL;
                    }
                }
                break;
            }

<span class="nc bnc" id="L1688" title="All 2 branches missed.">            if (shouldScroll(direction)) {</span>
<span class="nc" id="L1689">                scrollDueToClickInTrack(direction);</span>
            }
<span class="nc bnc" id="L1691" title="All 2 branches missed.">            if (shouldScroll(direction)) {</span>
<span class="nc" id="L1692">                scrollTimer.stop();</span>
<span class="nc" id="L1693">                scrollListener.setDirection(direction);</span>
<span class="nc" id="L1694">                scrollTimer.start();</span>
            }
<span class="nc" id="L1696">        }</span>

        public boolean shouldScroll(int direction) {
<span class="nc" id="L1699">            Rectangle r = thumbRect;</span>
<span class="nc bnc" id="L1700" title="All 2 branches missed.">            if (slider.getOrientation() == JSlider.VERTICAL) {</span>
<span class="nc bnc" id="L1701" title="All 6 branches missed.">                if (drawInverted() ? direction &lt; 0 : direction &gt; 0) {</span>
<span class="nc bnc" id="L1702" title="All 2 branches missed.">                    if (r.y  &lt;= currentMouseY) {</span>
<span class="nc" id="L1703">                        return false;</span>
                    }
                }
<span class="nc bnc" id="L1706" title="All 2 branches missed.">                else if (r.y + r.height &gt;= currentMouseY) {</span>
<span class="nc" id="L1707">                    return false;</span>
                }
            }
            else {
<span class="nc bnc" id="L1711" title="All 6 branches missed.">                if (drawInverted() ? direction &lt; 0 : direction &gt; 0) {</span>
<span class="nc bnc" id="L1712" title="All 2 branches missed.">                    if (r.x + r.width  &gt;= currentMouseX) {</span>
<span class="nc" id="L1713">                        return false;</span>
                    }
                }
<span class="nc bnc" id="L1716" title="All 2 branches missed.">                else if (r.x &lt;= currentMouseX) {</span>
<span class="nc" id="L1717">                    return false;</span>
                }
            }

<span class="nc bnc" id="L1721" title="All 2 branches missed.">            if (direction &gt; 0 &amp;&amp; slider.getValue() + slider.getExtent() &gt;=</span>
<span class="nc bnc" id="L1722" title="All 2 branches missed.">                    slider.getMaximum()) {</span>
<span class="nc" id="L1723">                return false;</span>
            }
<span class="nc bnc" id="L1725" title="All 2 branches missed.">            else if (direction &lt; 0 &amp;&amp; slider.getValue() &lt;=</span>
<span class="nc bnc" id="L1726" title="All 2 branches missed.">                    slider.getMinimum()) {</span>
<span class="nc" id="L1727">                return false;</span>
            }

<span class="nc" id="L1730">            return true;</span>
        }

        /**
        * Set the models value to the position of the top/left
        * of the thumb relative to the origin of the track.
        */
        public void mouseDragged(MouseEvent e) {
            int thumbMiddle;

<span class="nc bnc" id="L1740" title="All 2 branches missed.">            if (!slider.isEnabled()) {</span>
<span class="nc" id="L1741">                return;</span>
            }

<span class="nc" id="L1744">            currentMouseX = e.getX();</span>
<span class="nc" id="L1745">            currentMouseY = e.getY();</span>

<span class="nc bnc" id="L1747" title="All 2 branches missed.">            if (!isDragging) {</span>
<span class="nc" id="L1748">                return;</span>
            }

<span class="nc" id="L1751">            slider.setValueIsAdjusting(true);</span>

<span class="nc bnc" id="L1753" title="All 3 branches missed.">            switch (slider.getOrientation()) {</span>
            case JSlider.VERTICAL:
<span class="nc" id="L1755">                int halfThumbHeight = thumbRect.height / 2;</span>
<span class="nc" id="L1756">                int thumbTop = e.getY() - offset;</span>
<span class="nc" id="L1757">                int trackTop = trackRect.y;</span>
<span class="nc" id="L1758">                int trackBottom = trackRect.y + (trackRect.height - 1);</span>
<span class="nc" id="L1759">                int vMax = yPositionForValue(slider.getMaximum() -</span>
<span class="nc" id="L1760">                                            slider.getExtent());</span>

<span class="nc bnc" id="L1762" title="All 2 branches missed.">                if (drawInverted()) {</span>
<span class="nc" id="L1763">                    trackBottom = vMax;</span>
                }
                else {
<span class="nc" id="L1766">                    trackTop = vMax;</span>
                }
<span class="nc" id="L1768">                thumbTop = Math.max(thumbTop, trackTop - halfThumbHeight);</span>
<span class="nc" id="L1769">                thumbTop = Math.min(thumbTop, trackBottom - halfThumbHeight);</span>

<span class="nc" id="L1771">                setThumbLocation(thumbRect.x, thumbTop);</span>

<span class="nc" id="L1773">                thumbMiddle = thumbTop + halfThumbHeight;</span>
<span class="nc" id="L1774">                slider.setValue( valueForYPosition( thumbMiddle ) );</span>
<span class="nc" id="L1775">                break;</span>
            case JSlider.HORIZONTAL:
<span class="nc" id="L1777">                int halfThumbWidth = thumbRect.width / 2;</span>
<span class="nc" id="L1778">                int thumbLeft = e.getX() - offset;</span>
<span class="nc" id="L1779">                int trackLeft = trackRect.x;</span>
<span class="nc" id="L1780">                int trackRight = trackRect.x + (trackRect.width - 1);</span>
<span class="nc" id="L1781">                int hMax = xPositionForValue(slider.getMaximum() -</span>
<span class="nc" id="L1782">                                            slider.getExtent());</span>

<span class="nc bnc" id="L1784" title="All 2 branches missed.">                if (drawInverted()) {</span>
<span class="nc" id="L1785">                    trackLeft = hMax;</span>
                }
                else {
<span class="nc" id="L1788">                    trackRight = hMax;</span>
                }
<span class="nc" id="L1790">                thumbLeft = Math.max(thumbLeft, trackLeft - halfThumbWidth);</span>
<span class="nc" id="L1791">                thumbLeft = Math.min(thumbLeft, trackRight - halfThumbWidth);</span>

<span class="nc" id="L1793">                setThumbLocation(thumbLeft, thumbRect.y);</span>

<span class="nc" id="L1795">                thumbMiddle = thumbLeft + halfThumbWidth;</span>
<span class="nc" id="L1796">                slider.setValue(valueForXPosition(thumbMiddle));</span>
                break;
            }
<span class="nc" id="L1799">        }</span>

<span class="nc" id="L1801">        public void mouseMoved(MouseEvent e) { }</span>
    }

    /**
     * Scroll-event listener.
     *
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
    public class ScrollListener implements ActionListener {
        // changed this class to public to avoid bogus IllegalAccessException
        // bug in InternetExplorer browser.  It was protected.  Work around
        // for 4109432
<span class="nc" id="L1814">        int direction = POSITIVE_SCROLL;</span>
        boolean useBlockIncrement;

<span class="nc" id="L1817">        public ScrollListener() {</span>
<span class="nc" id="L1818">            direction = POSITIVE_SCROLL;</span>
<span class="nc" id="L1819">            useBlockIncrement = true;</span>
<span class="nc" id="L1820">        }</span>

<span class="nc" id="L1822">        public ScrollListener(int dir, boolean block)   {</span>
<span class="nc" id="L1823">            direction = dir;</span>
<span class="nc" id="L1824">            useBlockIncrement = block;</span>
<span class="nc" id="L1825">        }</span>

        public void setDirection(int direction) {
<span class="nc" id="L1828">            this.direction = direction;</span>
<span class="nc" id="L1829">        }</span>

        public void setScrollByBlock(boolean block) {
<span class="nc" id="L1832">            this.useBlockIncrement = block;</span>
<span class="nc" id="L1833">        }</span>

        public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L1836" title="All 2 branches missed.">            if (useBlockIncrement) {</span>
<span class="nc" id="L1837">                scrollByBlock(direction);</span>
            }
            else {
<span class="nc" id="L1840">                scrollByUnit(direction);</span>
            }
<span class="nc bnc" id="L1842" title="All 2 branches missed.">            if (!trackListener.shouldScroll(direction)) {</span>
<span class="nc" id="L1843">                ((Timer)e.getSource()).stop();</span>
            }
<span class="nc" id="L1845">        }</span>
    }

    /**
     * Listener for resizing events.
     * &lt;p&gt;
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
<span class="nc" id="L1854">    public class ComponentHandler extends ComponentAdapter {</span>
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        public void componentResized(ComponentEvent e)  {
<span class="nc" id="L1860">            getHandler().componentResized(e);</span>
<span class="nc" id="L1861">        }</span>
    }

    /**
     * Focus-change listener.
     * &lt;p&gt;
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
<span class="nc" id="L1870">    public class FocusHandler implements FocusListener {</span>
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Handler. If you need to add
        // new functionality add it to the Handler, but make sure this
        // class calls into the Handler.
        public void focusGained(FocusEvent e) {
<span class="nc" id="L1876">            getHandler().focusGained(e);</span>
<span class="nc" id="L1877">        }</span>

        public void focusLost(FocusEvent e) {
<span class="nc" id="L1880">            getHandler().focusLost(e);</span>
<span class="nc" id="L1881">        }</span>
    }

    /**
     * As of Java 2 platform v1.3 this undocumented class is no longer used.
     * The recommended approach to creating bindings is to use a
     * combination of an &lt;code&gt;ActionMap&lt;/code&gt;, to contain the action,
     * and an &lt;code&gt;InputMap&lt;/code&gt; to contain the mapping from KeyStroke
     * to action description. The InputMap is is usually described in the
     * LookAndFeel tables.
     * &lt;p&gt;
     * Please refer to the key bindings specification for further details.
     * &lt;p&gt;
     * This class should be treated as a &amp;quot;protected&amp;quot; inner class.
     * Instantiate it only within subclasses of &lt;code&gt;Foo&lt;/code&gt;.
     */
    public class ActionScroller extends AbstractAction {
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Actions. If you need to add
        // new functionality add it to the Actions, but make sure this
        // class calls into the Actions.
        int dir;
        boolean block;
        JSlider slider;

<span class="nc" id="L1906">        public ActionScroller( JSlider slider, int dir, boolean block) {</span>
<span class="nc" id="L1907">            this.dir = dir;</span>
<span class="nc" id="L1908">            this.block = block;</span>
<span class="nc" id="L1909">            this.slider = slider;</span>
<span class="nc" id="L1910">        }</span>

        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L1913">            SHARED_ACTION.scroll(slider, BasicSliderUI.this, dir, block);</span>
<span class="nc" id="L1914">        }</span>

        public boolean isEnabled() {
<span class="nc" id="L1917">            boolean b = true;</span>
<span class="nc bnc" id="L1918" title="All 2 branches missed.">            if (slider != null) {</span>
<span class="nc" id="L1919">                b = slider.isEnabled();</span>
            }
<span class="nc" id="L1921">            return b;</span>
        }

    }


    /**
     * A static version of the above.
     */
    static class SharedActionScroller extends AbstractAction {
        // NOTE: This class exists only for backward compatibility. All
        // its functionality has been moved into Actions. If you need to add
        // new functionality add it to the Actions, but make sure this
        // class calls into the Actions.
        int dir;
        boolean block;

<span class="nc" id="L1938">        public SharedActionScroller(int dir, boolean block) {</span>
<span class="nc" id="L1939">            this.dir = dir;</span>
<span class="nc" id="L1940">            this.block = block;</span>
<span class="nc" id="L1941">        }</span>

        public void actionPerformed(ActionEvent evt) {
<span class="nc" id="L1944">            JSlider slider = (JSlider)evt.getSource();</span>
<span class="nc" id="L1945">            BasicSliderUI ui = (BasicSliderUI)BasicLookAndFeel.getUIOfType(</span>
<span class="nc" id="L1946">                    slider.getUI(), BasicSliderUI.class);</span>
<span class="nc bnc" id="L1947" title="All 2 branches missed.">            if (ui == null) {</span>
<span class="nc" id="L1948">                return;</span>
            }
<span class="nc" id="L1950">            SHARED_ACTION.scroll(slider, ui, dir, block);</span>
<span class="nc" id="L1951">        }</span>
    }

    private static class Actions extends UIAction {
        public static final String POSITIVE_UNIT_INCREMENT =
            &quot;positiveUnitIncrement&quot;;
        public static final String POSITIVE_BLOCK_INCREMENT =
            &quot;positiveBlockIncrement&quot;;
        public static final String NEGATIVE_UNIT_INCREMENT =
            &quot;negativeUnitIncrement&quot;;
        public static final String NEGATIVE_BLOCK_INCREMENT =
            &quot;negativeBlockIncrement&quot;;
        public static final String MIN_SCROLL_INCREMENT = &quot;minScroll&quot;;
        public static final String MAX_SCROLL_INCREMENT = &quot;maxScroll&quot;;


        Actions() {
<span class="nc" id="L1968">            super(null);</span>
<span class="nc" id="L1969">        }</span>

        public Actions(String name) {
<span class="nc" id="L1972">            super(name);</span>
<span class="nc" id="L1973">        }</span>

        public void actionPerformed(ActionEvent evt) {
<span class="nc" id="L1976">            JSlider slider = (JSlider)evt.getSource();</span>
<span class="nc" id="L1977">            BasicSliderUI ui = (BasicSliderUI)BasicLookAndFeel.getUIOfType(</span>
<span class="nc" id="L1978">                     slider.getUI(), BasicSliderUI.class);</span>
<span class="nc" id="L1979">            String name = getName();</span>

<span class="nc bnc" id="L1981" title="All 2 branches missed.">            if (ui == null) {</span>
<span class="nc" id="L1982">                return;</span>
            }
<span class="nc bnc" id="L1984" title="All 2 branches missed.">            if (POSITIVE_UNIT_INCREMENT == name) {</span>
<span class="nc" id="L1985">                scroll(slider, ui, POSITIVE_SCROLL, false);</span>
<span class="nc bnc" id="L1986" title="All 2 branches missed.">            } else if (NEGATIVE_UNIT_INCREMENT == name) {</span>
<span class="nc" id="L1987">                scroll(slider, ui, NEGATIVE_SCROLL, false);</span>
<span class="nc bnc" id="L1988" title="All 2 branches missed.">            } else if (POSITIVE_BLOCK_INCREMENT == name) {</span>
<span class="nc" id="L1989">                scroll(slider, ui, POSITIVE_SCROLL, true);</span>
<span class="nc bnc" id="L1990" title="All 2 branches missed.">            } else if (NEGATIVE_BLOCK_INCREMENT == name) {</span>
<span class="nc" id="L1991">                scroll(slider, ui, NEGATIVE_SCROLL, true);</span>
<span class="nc bnc" id="L1992" title="All 2 branches missed.">            } else if (MIN_SCROLL_INCREMENT == name) {</span>
<span class="nc" id="L1993">                scroll(slider, ui, MIN_SCROLL, false);</span>
<span class="nc bnc" id="L1994" title="All 2 branches missed.">            } else if (MAX_SCROLL_INCREMENT == name) {</span>
<span class="nc" id="L1995">                scroll(slider, ui, MAX_SCROLL, false);</span>
            }
<span class="nc" id="L1997">        }</span>

        private void scroll(JSlider slider, BasicSliderUI ui, int direction,
                boolean isBlock) {
<span class="nc" id="L2001">            boolean invert = slider.getInverted();</span>

<span class="nc bnc" id="L2003" title="All 4 branches missed.">            if (direction == NEGATIVE_SCROLL || direction == POSITIVE_SCROLL) {</span>
<span class="nc bnc" id="L2004" title="All 2 branches missed.">                if (invert) {</span>
<span class="nc bnc" id="L2005" title="All 2 branches missed.">                    direction = (direction == POSITIVE_SCROLL) ?</span>
                        NEGATIVE_SCROLL : POSITIVE_SCROLL;
                }

<span class="nc bnc" id="L2009" title="All 2 branches missed.">                if (isBlock) {</span>
<span class="nc" id="L2010">                    ui.scrollByBlock(direction);</span>
                } else {
<span class="nc" id="L2012">                    ui.scrollByUnit(direction);</span>
                }
            } else {  // MIN or MAX
<span class="nc bnc" id="L2015" title="All 2 branches missed.">                if (invert) {</span>
<span class="nc bnc" id="L2016" title="All 2 branches missed.">                    direction = (direction == MIN_SCROLL) ?</span>
                        MAX_SCROLL : MIN_SCROLL;
                }

<span class="nc bnc" id="L2020" title="All 2 branches missed.">                slider.setValue((direction == MIN_SCROLL) ?</span>
<span class="nc" id="L2021">                    slider.getMinimum() : slider.getMaximum());</span>
            }
<span class="nc" id="L2023">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>