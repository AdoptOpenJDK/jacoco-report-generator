<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>BasicRadioButtonUI.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.basic</a> &gt; <span class="el_source">BasicRadioButtonUI.java</span></div><h1>BasicRadioButtonUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.basic;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.plaf.*;
import javax.swing.text.View;
import sun.swing.SwingUtilities2;
import sun.awt.AppContext;


/**
 * RadioButtonUI implementation for BasicRadioButtonUI
 *
 * @author Jeff Dinkins
 */
<span class="nc" id="L43">public class BasicRadioButtonUI extends BasicToggleButtonUI</span>
{
<span class="nc" id="L45">    private static final Object BASIC_RADIO_BUTTON_UI_KEY = new Object();</span>

    protected Icon icon;

<span class="nc" id="L49">    private boolean defaults_initialized = false;</span>

    private final static String propertyPrefix = &quot;RadioButton&quot; + &quot;.&quot;;

    // ********************************
    //        Create PLAF
    // ********************************
    public static ComponentUI createUI(JComponent b) {
<span class="nc" id="L57">        AppContext appContext = AppContext.getAppContext();</span>
<span class="nc" id="L58">        BasicRadioButtonUI radioButtonUI =</span>
<span class="nc" id="L59">                (BasicRadioButtonUI) appContext.get(BASIC_RADIO_BUTTON_UI_KEY);</span>
<span class="nc bnc" id="L60" title="All 2 branches missed.">        if (radioButtonUI == null) {</span>
<span class="nc" id="L61">            radioButtonUI = new BasicRadioButtonUI();</span>
<span class="nc" id="L62">            appContext.put(BASIC_RADIO_BUTTON_UI_KEY, radioButtonUI);</span>
        }
<span class="nc" id="L64">        return radioButtonUI;</span>
    }

    protected String getPropertyPrefix() {
<span class="nc" id="L68">        return propertyPrefix;</span>
    }

    // ********************************
    //        Install PLAF
    // ********************************
    protected void installDefaults(AbstractButton b){
<span class="nc" id="L75">        super.installDefaults(b);</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">        if(!defaults_initialized) {</span>
<span class="nc" id="L77">            icon = UIManager.getIcon(getPropertyPrefix() + &quot;icon&quot;);</span>
<span class="nc" id="L78">            defaults_initialized = true;</span>
        }
<span class="nc" id="L80">    }</span>

    // ********************************
    //        Uninstall PLAF
    // ********************************
    protected void uninstallDefaults(AbstractButton b){
<span class="nc" id="L86">        super.uninstallDefaults(b);</span>
<span class="nc" id="L87">        defaults_initialized = false;</span>
<span class="nc" id="L88">    }</span>

    public Icon getDefaultIcon() {
<span class="nc" id="L91">        return icon;</span>
    }


    /* These Dimensions/Rectangles are allocated once for all
     * RadioButtonUI.paint() calls.  Re-using rectangles
     * rather than allocating them in each paint call substantially
     * reduced the time it took paint to run.  Obviously, this
     * method can't be re-entered.
     */
<span class="nc" id="L101">    private static Dimension size = new Dimension();</span>
<span class="nc" id="L102">    private static Rectangle viewRect = new Rectangle();</span>
<span class="nc" id="L103">    private static Rectangle iconRect = new Rectangle();</span>
<span class="nc" id="L104">    private static Rectangle textRect = new Rectangle();</span>

    /**
     * paint the radio button
     */
    public synchronized void paint(Graphics g, JComponent c) {
<span class="nc" id="L110">        AbstractButton b = (AbstractButton) c;</span>
<span class="nc" id="L111">        ButtonModel model = b.getModel();</span>

<span class="nc" id="L113">        Font f = c.getFont();</span>
<span class="nc" id="L114">        g.setFont(f);</span>
<span class="nc" id="L115">        FontMetrics fm = SwingUtilities2.getFontMetrics(c, g, f);</span>

<span class="nc" id="L117">        Insets i = c.getInsets();</span>
<span class="nc" id="L118">        size = b.getSize(size);</span>
<span class="nc" id="L119">        viewRect.x = i.left;</span>
<span class="nc" id="L120">        viewRect.y = i.top;</span>
<span class="nc" id="L121">        viewRect.width = size.width - (i.right + viewRect.x);</span>
<span class="nc" id="L122">        viewRect.height = size.height - (i.bottom + viewRect.y);</span>
<span class="nc" id="L123">        iconRect.x = iconRect.y = iconRect.width = iconRect.height = 0;</span>
<span class="nc" id="L124">        textRect.x = textRect.y = textRect.width = textRect.height = 0;</span>

<span class="nc" id="L126">        Icon altIcon = b.getIcon();</span>
<span class="nc" id="L127">        Icon selectedIcon = null;</span>
<span class="nc" id="L128">        Icon disabledIcon = null;</span>

<span class="nc" id="L130">        String text = SwingUtilities.layoutCompoundLabel(</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">            c, fm, b.getText(), altIcon != null ? altIcon : getDefaultIcon(),</span>
<span class="nc" id="L132">            b.getVerticalAlignment(), b.getHorizontalAlignment(),</span>
<span class="nc" id="L133">            b.getVerticalTextPosition(), b.getHorizontalTextPosition(),</span>
            viewRect, iconRect, textRect,
<span class="nc bnc" id="L135" title="All 2 branches missed.">            b.getText() == null ? 0 : b.getIconTextGap());</span>

        // fill background
<span class="nc bnc" id="L138" title="All 2 branches missed.">        if(c.isOpaque()) {</span>
<span class="nc" id="L139">            g.setColor(b.getBackground());</span>
<span class="nc" id="L140">            g.fillRect(0,0, size.width, size.height);</span>
        }


        // Paint the radio button
<span class="nc bnc" id="L145" title="All 2 branches missed.">        if(altIcon != null) {</span>

<span class="nc bnc" id="L147" title="All 2 branches missed.">            if(!model.isEnabled()) {</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">                if(model.isSelected()) {</span>
<span class="nc" id="L149">                   altIcon = b.getDisabledSelectedIcon();</span>
                } else {
<span class="nc" id="L151">                   altIcon = b.getDisabledIcon();</span>
                }
<span class="nc bnc" id="L153" title="All 4 branches missed.">            } else if(model.isPressed() &amp;&amp; model.isArmed()) {</span>
<span class="nc" id="L154">                altIcon = b.getPressedIcon();</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">                if(altIcon == null) {</span>
                    // Use selected icon
<span class="nc" id="L157">                    altIcon = b.getSelectedIcon();</span>
                }
<span class="nc bnc" id="L159" title="All 2 branches missed.">            } else if(model.isSelected()) {</span>
<span class="nc bnc" id="L160" title="All 4 branches missed.">                if(b.isRolloverEnabled() &amp;&amp; model.isRollover()) {</span>
<span class="nc" id="L161">                        altIcon = b.getRolloverSelectedIcon();</span>
<span class="nc bnc" id="L162" title="All 2 branches missed.">                        if (altIcon == null) {</span>
<span class="nc" id="L163">                                altIcon = b.getSelectedIcon();</span>
                        }
                } else {
<span class="nc" id="L166">                        altIcon = b.getSelectedIcon();</span>
                }
<span class="nc bnc" id="L168" title="All 4 branches missed.">            } else if(b.isRolloverEnabled() &amp;&amp; model.isRollover()) {</span>
<span class="nc" id="L169">                altIcon = b.getRolloverIcon();</span>
            }

<span class="nc bnc" id="L172" title="All 2 branches missed.">            if(altIcon == null) {</span>
<span class="nc" id="L173">                altIcon = b.getIcon();</span>
            }

<span class="nc" id="L176">            altIcon.paintIcon(c, g, iconRect.x, iconRect.y);</span>

        } else {
<span class="nc" id="L179">            getDefaultIcon().paintIcon(c, g, iconRect.x, iconRect.y);</span>
        }


        // Draw the Text
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if(text != null) {</span>
<span class="nc" id="L185">            View v = (View) c.getClientProperty(BasicHTML.propertyKey);</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">            if (v != null) {</span>
<span class="nc" id="L187">                v.paint(g, textRect);</span>
            } else {
<span class="nc" id="L189">                paintText(g, b, textRect, text);</span>
            }
<span class="nc bnc" id="L191" title="All 8 branches missed.">            if(b.hasFocus() &amp;&amp; b.isFocusPainted() &amp;&amp;</span>
               textRect.width &gt; 0 &amp;&amp; textRect.height &gt; 0 ) {
<span class="nc" id="L193">                paintFocus(g, textRect, size);</span>
            }
        }
<span class="nc" id="L196">    }</span>

    protected void paintFocus(Graphics g, Rectangle textRect, Dimension size){
<span class="nc" id="L199">    }</span>


    /* These Insets/Rectangles are allocated once for all
     * RadioButtonUI.getPreferredSize() calls.  Re-using rectangles
     * rather than allocating them in each call substantially
     * reduced the time it took getPreferredSize() to run.  Obviously,
     * this method can't be re-entered.
     */
<span class="nc" id="L208">    private static Rectangle prefViewRect = new Rectangle();</span>
<span class="nc" id="L209">    private static Rectangle prefIconRect = new Rectangle();</span>
<span class="nc" id="L210">    private static Rectangle prefTextRect = new Rectangle();</span>
<span class="nc" id="L211">    private static Insets prefInsets = new Insets(0, 0, 0, 0);</span>

    /**
     * The preferred size of the radio button
     */
    public Dimension getPreferredSize(JComponent c) {
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if(c.getComponentCount() &gt; 0) {</span>
<span class="nc" id="L218">            return null;</span>
        }

<span class="nc" id="L221">        AbstractButton b = (AbstractButton) c;</span>

<span class="nc" id="L223">        String text = b.getText();</span>

<span class="nc" id="L225">        Icon buttonIcon = b.getIcon();</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if(buttonIcon == null) {</span>
<span class="nc" id="L227">            buttonIcon = getDefaultIcon();</span>
        }

<span class="nc" id="L230">        Font font = b.getFont();</span>
<span class="nc" id="L231">        FontMetrics fm = b.getFontMetrics(font);</span>

<span class="nc" id="L233">        prefViewRect.x = prefViewRect.y = 0;</span>
<span class="nc" id="L234">        prefViewRect.width = Short.MAX_VALUE;</span>
<span class="nc" id="L235">        prefViewRect.height = Short.MAX_VALUE;</span>
<span class="nc" id="L236">        prefIconRect.x = prefIconRect.y = prefIconRect.width = prefIconRect.height = 0;</span>
<span class="nc" id="L237">        prefTextRect.x = prefTextRect.y = prefTextRect.width = prefTextRect.height = 0;</span>

<span class="nc" id="L239">        SwingUtilities.layoutCompoundLabel(</span>
            c, fm, text, buttonIcon,
<span class="nc" id="L241">            b.getVerticalAlignment(), b.getHorizontalAlignment(),</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">            b.getVerticalTextPosition(), b.getHorizontalTextPosition(),</span>
            prefViewRect, prefIconRect, prefTextRect,
<span class="nc" id="L244">            text == null ? 0 : b.getIconTextGap());</span>

        // find the union of the icon and text rects (from Rectangle.java)
<span class="nc" id="L247">        int x1 = Math.min(prefIconRect.x, prefTextRect.x);</span>
<span class="nc" id="L248">        int x2 = Math.max(prefIconRect.x + prefIconRect.width,</span>
                          prefTextRect.x + prefTextRect.width);
<span class="nc" id="L250">        int y1 = Math.min(prefIconRect.y, prefTextRect.y);</span>
<span class="nc" id="L251">        int y2 = Math.max(prefIconRect.y + prefIconRect.height,</span>
                          prefTextRect.y + prefTextRect.height);
<span class="nc" id="L253">        int width = x2 - x1;</span>
<span class="nc" id="L254">        int height = y2 - y1;</span>

<span class="nc" id="L256">        prefInsets = b.getInsets(prefInsets);</span>
<span class="nc" id="L257">        width += prefInsets.left + prefInsets.right;</span>
<span class="nc" id="L258">        height += prefInsets.top + prefInsets.bottom;</span>
<span class="nc" id="L259">        return new Dimension(width, height);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>