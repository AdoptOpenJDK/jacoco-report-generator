<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>HexDumpEncoder.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">sun.misc</a> &gt; <span class="el_source">HexDumpEncoder.java</span></div><h1>HexDumpEncoder.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1995, 1997, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */


package sun.misc;
import java.io.PrintStream;
import java.io.OutputStream;
import java.io.IOException;

/**
 * This class encodes a buffer into the classic: &quot;Hexadecimal Dump&quot; format of
 * the past. It is useful for analyzing the contents of binary buffers.
 * The format produced is as follows:
 * &lt;pre&gt;
 * xxxx: 00 11 22 33 44 55 66 77   88 99 aa bb cc dd ee ff ................
 * &lt;/pre&gt;
 * Where xxxx is the offset into the buffer in 16 byte chunks, followed
 * by ascii coded hexadecimal bytes followed by the ASCII representation of
 * the bytes or '.' if they are not valid bytes.
 *
 * @author      Chuck McManis
 */

<span class="fc" id="L46">public class HexDumpEncoder extends CharacterEncoder {</span>

    private int offset;
    private int thisLineLength;
    private int currentByte;
<span class="fc" id="L51">    private byte thisLine[] = new byte[16];</span>

    static void hexDigit(PrintStream p, byte x) {
        char c;

<span class="fc" id="L56">        c = (char) ((x &gt;&gt; 4) &amp; 0xf);</span>
<span class="fc bfc" id="L57" title="All 2 branches covered.">        if (c &gt; 9)</span>
<span class="fc" id="L58">            c = (char) ((c-10) + 'A');</span>
        else
<span class="fc" id="L60">            c = (char)(c + '0');</span>
<span class="fc" id="L61">        p.write(c);</span>
<span class="fc" id="L62">        c = (char) (x &amp; 0xf);</span>
<span class="fc bfc" id="L63" title="All 2 branches covered.">        if (c &gt; 9)</span>
<span class="fc" id="L64">            c = (char)((c-10) + 'A');</span>
        else
<span class="fc" id="L66">            c = (char)(c + '0');</span>
<span class="fc" id="L67">        p.write(c);</span>
<span class="fc" id="L68">    }</span>

    protected int bytesPerAtom() {
<span class="fc" id="L71">        return (1);</span>
    }

    protected int bytesPerLine() {
<span class="fc" id="L75">        return (16);</span>
    }

    protected void encodeBufferPrefix(OutputStream o) throws IOException {
<span class="fc" id="L79">        offset = 0;</span>
<span class="fc" id="L80">        super.encodeBufferPrefix(o);</span>
<span class="fc" id="L81">    }</span>

    protected void encodeLinePrefix(OutputStream o, int len) throws IOException {
<span class="fc" id="L84">        hexDigit(pStream, (byte)((offset &gt;&gt;&gt; 8) &amp; 0xff));</span>
<span class="fc" id="L85">        hexDigit(pStream, (byte)(offset &amp; 0xff));</span>
<span class="fc" id="L86">        pStream.print(&quot;: &quot;);</span>
<span class="fc" id="L87">        currentByte = 0;</span>
<span class="fc" id="L88">        thisLineLength = len;</span>
<span class="fc" id="L89">    }</span>

    protected void encodeAtom(OutputStream o, byte buf[], int off, int len) throws IOException {
<span class="fc" id="L92">        thisLine[currentByte] = buf[off];</span>
<span class="fc" id="L93">        hexDigit(pStream, buf[off]);</span>
<span class="fc" id="L94">        pStream.print(&quot; &quot;);</span>
<span class="fc" id="L95">        currentByte++;</span>
<span class="fc bfc" id="L96" title="All 2 branches covered.">        if (currentByte == 8)</span>
<span class="fc" id="L97">            pStream.print(&quot;  &quot;);</span>
<span class="fc" id="L98">    }</span>

    protected void encodeLineSuffix(OutputStream o) throws IOException {
<span class="fc bfc" id="L101" title="All 2 branches covered.">        if (thisLineLength &lt; 16) {</span>
<span class="fc bfc" id="L102" title="All 2 branches covered.">            for (int i = thisLineLength; i &lt; 16; i++) {</span>
<span class="fc" id="L103">                pStream.print(&quot;   &quot;);</span>
<span class="fc bfc" id="L104" title="All 2 branches covered.">                if (i == 7)</span>
<span class="fc" id="L105">                    pStream.print(&quot;  &quot;);</span>
            }
        }
<span class="fc" id="L108">        pStream.print(&quot; &quot;);</span>
<span class="fc bfc" id="L109" title="All 2 branches covered.">        for (int i = 0; i &lt; thisLineLength; i++) {</span>
<span class="fc bfc" id="L110" title="All 4 branches covered.">            if ((thisLine[i] &lt; ' ') || (thisLine[i] &gt; 'z')) {</span>
<span class="fc" id="L111">                pStream.print(&quot;.&quot;);</span>
            } else {
<span class="fc" id="L113">                pStream.write(thisLine[i]);</span>
            }
        }
<span class="fc" id="L116">        pStream.println();</span>
<span class="fc" id="L117">        offset += thisLineLength;</span>
<span class="fc" id="L118">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>