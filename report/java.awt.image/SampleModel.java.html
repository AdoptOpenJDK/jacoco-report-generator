<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>SampleModel.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.awt.image</a> &gt; <span class="el_source">SampleModel.java</span></div><h1>SampleModel.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

/* ****************************************************************
 ******************************************************************
 ******************************************************************
 *** COPYRIGHT (c) Eastman Kodak Company, 1997
 *** As  an unpublished  work pursuant to Title 17 of the United
 *** States Code.  All rights reserved.
 ******************************************************************
 ******************************************************************
 ******************************************************************/

package java.awt.image;

/**
 *  This abstract class defines an interface for extracting samples of pixels
 *  in an image.  All image data is expressed as a collection of pixels.
 *  Each pixel consists of a number of samples. A sample is a datum
 *  for one band of an image and a band consists of all samples of a
 *  particular type in an image.  For example, a pixel might contain
 *  three samples representing its red, green and blue components.
 *  There are three bands in the image containing this pixel.  One band
 *  consists of all the red samples from all pixels in the
 *  image.  The second band consists of all the green samples and
 *  the remaining band consists of all of the blue samples.  The pixel
 *  can be stored in various formats.  For example, all samples from
 *  a particular band can be stored contiguously or all samples from a
 *  single pixel can be stored contiguously.
 *  &lt;p&gt;
 *  Subclasses of SampleModel specify the types of samples they can
 *  represent (e.g. unsigned 8-bit byte, signed 16-bit short, etc.)
 *  and may specify how the samples are organized in memory.
 *  In the Java 2D(tm) API, built-in image processing operators may
 *  not operate on all possible sample types, but generally will work
 *  for unsigned integral samples of 16 bits or less.  Some operators
 *  support a wider variety of sample types.
 *  &lt;p&gt;
 *  A collection of pixels is represented as a Raster, which consists of
 *  a DataBuffer and a SampleModel.  The SampleModel allows access to
 *  samples in the DataBuffer and may provide low-level information that
 *  a programmer can use to directly manipulate samples and pixels in the
 *  DataBuffer.
 *  &lt;p&gt;
 *  This class is generally a fall back method for dealing with
 *  images.  More efficient code will cast the SampleModel to the
 *  appropriate subclass and extract the information needed to directly
 *  manipulate pixels in the DataBuffer.
 *
 *  @see java.awt.image.DataBuffer
 *  @see java.awt.image.Raster
 *  @see java.awt.image.ComponentSampleModel
 *  @see java.awt.image.PixelInterleavedSampleModel
 *  @see java.awt.image.BandedSampleModel
 *  @see java.awt.image.MultiPixelPackedSampleModel
 *  @see java.awt.image.SinglePixelPackedSampleModel
 */

public abstract class SampleModel
{

    /** Width in pixels of the region of image data that this SampleModel
     *  describes.
     */
    protected int width;

    /** Height in pixels of the region of image data that this SampleModel
     *  describes.
     */
    protected int height;

    /** Number of bands of the image data that this SampleModel describes. */
    protected int numBands;

    /** Data type of the DataBuffer storing the pixel data.
     *  @see java.awt.image.DataBuffer
     */
    protected int dataType;

    static private native void initIDs();
    static {
<span class="nc" id="L104">        ColorModel.loadLibraries();</span>
<span class="nc" id="L105">        initIDs();</span>
<span class="nc" id="L106">    }</span>

    /**
     * Constructs a SampleModel with the specified parameters.
     * @param dataType  The data type of the DataBuffer storing the pixel data.
     * @param w         The width (in pixels) of the region of image data.
     * @param h         The height (in pixels) of the region of image data.
     * @param numBands  The number of bands of the image data.
     * @throws IllegalArgumentException if &lt;code&gt;w&lt;/code&gt; or &lt;code&gt;h&lt;/code&gt;
     *         is not greater than 0
     * @throws IllegalArgumentException if the product of &lt;code&gt;w&lt;/code&gt;
     *         and &lt;code&gt;h&lt;/code&gt; is greater than
     *         &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt;
     * @throws IllegalArgumentException if &lt;code&gt;dataType&lt;/code&gt; is not
     *         one of the supported data types
     */
    public SampleModel(int dataType, int w, int h, int numBands)
<span class="nc" id="L123">    {</span>
<span class="nc" id="L124">        long size = (long)w * h;</span>
<span class="nc bnc" id="L125" title="All 4 branches missed.">        if (w &lt;= 0 || h &lt;= 0) {</span>
<span class="nc" id="L126">            throw new IllegalArgumentException(&quot;Width (&quot;+w+&quot;) and height (&quot;+</span>
                                               h+&quot;) must be &gt; 0&quot;);
        }
<span class="nc bnc" id="L129" title="All 2 branches missed.">        if (size &gt;= Integer.MAX_VALUE) {</span>
<span class="nc" id="L130">            throw new IllegalArgumentException(&quot;Dimensions (width=&quot;+w+</span>
                                               &quot; height=&quot;+h+&quot;) are too large&quot;);
        }

<span class="nc bnc" id="L134" title="All 6 branches missed.">        if (dataType &lt; DataBuffer.TYPE_BYTE ||</span>
            (dataType &gt; DataBuffer.TYPE_DOUBLE &amp;&amp;
             dataType != DataBuffer.TYPE_UNDEFINED))
        {
<span class="nc" id="L138">            throw new IllegalArgumentException(&quot;Unsupported dataType: &quot;+</span>
                                               dataType);
        }

<span class="nc bnc" id="L142" title="All 2 branches missed.">        if (numBands &lt;= 0) {</span>
<span class="nc" id="L143">            throw new IllegalArgumentException(&quot;Number of bands must be &gt; 0&quot;);</span>
        }

<span class="nc" id="L146">        this.dataType = dataType;</span>
<span class="nc" id="L147">        this.width = w;</span>
<span class="nc" id="L148">        this.height = h;</span>
<span class="nc" id="L149">        this.numBands = numBands;</span>
<span class="nc" id="L150">    }</span>

    /** Returns the width in pixels.
     *  @return the width in pixels of the region of image data
     *          that this &lt;code&gt;SampleModel&lt;/code&gt; describes.
     */
    final public int getWidth() {
<span class="nc" id="L157">         return width;</span>
    }

    /** Returns the height in pixels.
     *  @return the height in pixels of the region of image data
     *          that this &lt;code&gt;SampleModel&lt;/code&gt; describes.
     */
    final public int getHeight() {
<span class="nc" id="L165">         return height;</span>
    }

    /** Returns the total number of bands of image data.
     *  @return the number of bands of image data that this
     *          &lt;code&gt;SampleModel&lt;/code&gt; describes.
     */
    final public int getNumBands() {
<span class="nc" id="L173">         return numBands;</span>
    }

    /** Returns the number of data elements needed to transfer a pixel
     *  via the getDataElements and setDataElements methods.  When pixels
     *  are transferred via these methods, they may be transferred in a
     *  packed or unpacked format, depending on the implementation of the
     *  SampleModel.  Using these methods, pixels are transferred as an
     *  array of getNumDataElements() elements of a primitive type given
     *  by getTransferType().  The TransferType may or may not be the same
     *  as the storage DataType.
     *  @return the number of data elements.
     *  @see #getDataElements(int, int, Object, DataBuffer)
     *  @see #getDataElements(int, int, int, int, Object, DataBuffer)
     *  @see #setDataElements(int, int, Object, DataBuffer)
     *  @see #setDataElements(int, int, int, int, Object, DataBuffer)
     *  @see #getTransferType
     */
    public abstract int getNumDataElements();

    /** Returns the data type of the DataBuffer storing the pixel data.
     *  @return the data type.
     */
    final public int getDataType() {
<span class="nc" id="L197">        return dataType;</span>
    }

    /** Returns the TransferType used to transfer pixels via the
     *  getDataElements and setDataElements methods.  When pixels
     *  are transferred via these methods, they may be transferred in a
     *  packed or unpacked format, depending on the implementation of the
     *  SampleModel.  Using these methods, pixels are transferred as an
     *  array of getNumDataElements() elements of a primitive type given
     *  by getTransferType().  The TransferType may or may not be the same
     *  as the storage DataType.  The TransferType will be one of the types
     *  defined in DataBuffer.
     *  @return the transfer type.
     *  @see #getDataElements(int, int, Object, DataBuffer)
     *  @see #getDataElements(int, int, int, int, Object, DataBuffer)
     *  @see #setDataElements(int, int, Object, DataBuffer)
     *  @see #setDataElements(int, int, int, int, Object, DataBuffer)
     *  @see #getNumDataElements
     *  @see java.awt.image.DataBuffer
     */
    public int getTransferType() {
<span class="nc" id="L218">        return dataType;</span>
    }

    /**
     * Returns the samples for a specified pixel in an int array,
     * one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location
     * @param y         The Y coordinate of the pixel location
     * @param iArray    If non-null, returns the samples in this array
     * @param data      The DataBuffer containing the image data
     * @return the samples for the specified pixel.
     * @see #setPixel(int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if iArray is too small to hold the output.
     */
    public int[] getPixel(int x, int y, int iArray[], DataBuffer data) {

        int pixels[];

<span class="nc bnc" id="L241" title="All 2 branches missed.">        if (iArray != null)</span>
<span class="nc" id="L242">            pixels = iArray;</span>
        else
<span class="nc" id="L244">            pixels = new int[numBands];</span>

<span class="nc bnc" id="L246" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++) {</span>
<span class="nc" id="L247">            pixels[i] = getSample(x, y, i, data);</span>
        }

<span class="nc" id="L250">        return pixels;</span>
    }

    /**
     * Returns data for a single pixel in a primitive array of type
     * TransferType.  For image data supported by the Java 2D API, this
     * will be one of DataBuffer.TYPE_BYTE, DataBuffer.TYPE_USHORT,
     * DataBuffer.TYPE_INT, DataBuffer.TYPE_SHORT, DataBuffer.TYPE_FLOAT,
     * or DataBuffer.TYPE_DOUBLE.  Data may be returned in a packed format,
     * thus increasing efficiency for data transfers. Generally, obj
     * should be passed in as null, so that the Object will be created
     * automatically and will be of the right primitive data type.
     * &lt;p&gt;
     * The following code illustrates transferring data for one pixel from
     * DataBuffer &lt;code&gt;db1&lt;/code&gt;, whose storage layout is described by
     * SampleModel &lt;code&gt;sm1&lt;/code&gt;, to DataBuffer &lt;code&gt;db2&lt;/code&gt;, whose
     * storage layout is described by SampleModel &lt;code&gt;sm2&lt;/code&gt;.
     * The transfer will generally be more efficient than using
     * getPixel/setPixel.
     * &lt;pre&gt;
     *       SampleModel sm1, sm2;
     *       DataBuffer db1, db2;
     *       sm2.setDataElements(x, y, sm1.getDataElements(x, y, null, db1), db2);
     * &lt;/pre&gt;
     * Using getDataElements/setDataElements to transfer between two
     * DataBuffer/SampleModel pairs is legitimate if the SampleModels have
     * the same number of bands, corresponding bands have the same number of
     * bits per sample, and the TransferTypes are the same.
     * &lt;p&gt;
     * If obj is non-null, it should be a primitive array of type TransferType.
     * Otherwise, a ClassCastException is thrown.  An
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds, or if obj is non-null and is not large enough to hold
     * the pixel data.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param obj       If non-null, a primitive array in which to return
     *                  the pixel data.
     * @param data      The DataBuffer containing the image data.
     * @return the data elements for the specified pixel.
     * @see #getNumDataElements
     * @see #getTransferType
     * @see java.awt.image.DataBuffer
     * @see #setDataElements(int, int, Object, DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if obj is too small to hold the output.
     */
    public abstract Object getDataElements(int x, int y,
                                           Object obj, DataBuffer data);

    /**
     * Returns the pixel data for the specified rectangle of pixels in a
     * primitive array of type TransferType.
     * For image data supported by the Java 2D API, this
     * will be one of DataBuffer.TYPE_BYTE, DataBuffer.TYPE_USHORT,
     * DataBuffer.TYPE_INT, DataBuffer.TYPE_SHORT, DataBuffer.TYPE_FLOAT,
     * or DataBuffer.TYPE_DOUBLE.  Data may be returned in a packed format,
     * thus increasing efficiency for data transfers. Generally, obj
     * should be passed in as null, so that the Object will be created
     * automatically and will be of the right primitive data type.
     * &lt;p&gt;
     * The following code illustrates transferring data for a rectangular
     * region of pixels from
     * DataBuffer &lt;code&gt;db1&lt;/code&gt;, whose storage layout is described by
     * SampleModel &lt;code&gt;sm1&lt;/code&gt;, to DataBuffer &lt;code&gt;db2&lt;/code&gt;, whose
     * storage layout is described by SampleModel &lt;code&gt;sm2&lt;/code&gt;.
     * The transfer will generally be more efficient than using
     * getPixels/setPixels.
     * &lt;pre&gt;
     *       SampleModel sm1, sm2;
     *       DataBuffer db1, db2;
     *       sm2.setDataElements(x, y, w, h, sm1.getDataElements(x, y, w,
     *                           h, null, db1), db2);
     * &lt;/pre&gt;
     * Using getDataElements/setDataElements to transfer between two
     * DataBuffer/SampleModel pairs is legitimate if the SampleModels have
     * the same number of bands, corresponding bands have the same number of
     * bits per sample, and the TransferTypes are the same.
     * &lt;p&gt;
     * If obj is non-null, it should be a primitive array of type TransferType.
     * Otherwise, a ClassCastException is thrown.  An
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds, or if obj is non-null and is not large enough to hold
     * the pixel data.
     * @param x         The minimum X coordinate of the pixel rectangle.
     * @param y         The minimum Y coordinate of the pixel rectangle.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param obj       If non-null, a primitive array in which to return
     *                  the pixel data.
     * @param data      The DataBuffer containing the image data.
     * @return the data elements for the specified region of pixels.
     * @see #getNumDataElements
     * @see #getTransferType
     * @see #setDataElements(int, int, int, int, Object, DataBuffer)
     * @see java.awt.image.DataBuffer
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if obj is too small to hold the output.
     */
    public Object getDataElements(int x, int y, int w, int h,
                                  Object obj, DataBuffer data) {

<span class="nc" id="L356">        int type = getTransferType();</span>
<span class="nc" id="L357">        int numDataElems = getNumDataElements();</span>
<span class="nc" id="L358">        int cnt = 0;</span>
<span class="nc" id="L359">        Object o = null;</span>

<span class="nc" id="L361">        int x1 = x + w;</span>
<span class="nc" id="L362">        int y1 = y + h;</span>

<span class="nc bnc" id="L364" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L367">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L370" title="All 6 branches missed.">        switch(type) {</span>

        case DataBuffer.TYPE_BYTE:

            byte[] btemp;
            byte[] bdata;

<span class="nc bnc" id="L377" title="All 2 branches missed.">            if (obj == null)</span>
<span class="nc" id="L378">                bdata = new byte[numDataElems*w*h];</span>
            else
<span class="nc" id="L380">                bdata = (byte[])obj;</span>

<span class="nc bnc" id="L382" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L384">                    o = getDataElements(j, i, o, data);</span>
<span class="nc" id="L385">                    btemp = (byte[])o;</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L387">                        bdata[cnt++] = btemp[k];</span>
                    }
                }
            }
<span class="nc" id="L391">            obj = (Object)bdata;</span>
<span class="nc" id="L392">            break;</span>

        case DataBuffer.TYPE_USHORT:
        case DataBuffer.TYPE_SHORT:

            short[] sdata;
            short[] stemp;

<span class="nc bnc" id="L400" title="All 2 branches missed.">            if (obj == null)</span>
<span class="nc" id="L401">                sdata = new short[numDataElems*w*h];</span>
            else
<span class="nc" id="L403">                sdata = (short[])obj;</span>

<span class="nc bnc" id="L405" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L407">                    o = getDataElements(j, i, o, data);</span>
<span class="nc" id="L408">                    stemp = (short[])o;</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L410">                        sdata[cnt++] = stemp[k];</span>
                    }
                }
            }

<span class="nc" id="L415">            obj = (Object)sdata;</span>
<span class="nc" id="L416">            break;</span>

        case DataBuffer.TYPE_INT:

            int[] idata;
            int[] itemp;

<span class="nc bnc" id="L423" title="All 2 branches missed.">            if (obj == null)</span>
<span class="nc" id="L424">                idata = new int[numDataElems*w*h];</span>
            else
<span class="nc" id="L426">                idata = (int[])obj;</span>

<span class="nc bnc" id="L428" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L430">                    o = getDataElements(j, i, o, data);</span>
<span class="nc" id="L431">                    itemp = (int[])o;</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L433">                        idata[cnt++] = itemp[k];</span>
                    }
                }
            }

<span class="nc" id="L438">            obj = (Object)idata;</span>
<span class="nc" id="L439">            break;</span>

        case DataBuffer.TYPE_FLOAT:

            float[] fdata;
            float[] ftemp;

<span class="nc bnc" id="L446" title="All 2 branches missed.">            if (obj == null)</span>
<span class="nc" id="L447">                fdata = new float[numDataElems*w*h];</span>
            else
<span class="nc" id="L449">                fdata = (float[])obj;</span>

<span class="nc bnc" id="L451" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L453">                    o = getDataElements(j, i, o, data);</span>
<span class="nc" id="L454">                    ftemp = (float[])o;</span>
<span class="nc bnc" id="L455" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L456">                        fdata[cnt++] = ftemp[k];</span>
                    }
                }
            }

<span class="nc" id="L461">            obj = (Object)fdata;</span>
<span class="nc" id="L462">            break;</span>

        case DataBuffer.TYPE_DOUBLE:

            double[] ddata;
            double[] dtemp;

<span class="nc bnc" id="L469" title="All 2 branches missed.">            if (obj == null)</span>
<span class="nc" id="L470">                ddata = new double[numDataElems*w*h];</span>
            else
<span class="nc" id="L472">                ddata = (double[])obj;</span>

<span class="nc bnc" id="L474" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L476">                    o = getDataElements(j, i, o, data);</span>
<span class="nc" id="L477">                    dtemp = (double[])o;</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L479">                        ddata[cnt++] = dtemp[k];</span>
                    }
                }
            }

<span class="nc" id="L484">            obj = (Object)ddata;</span>
            break;
        }

<span class="nc" id="L488">        return obj;</span>
    }

    /**
     * Sets the data for a single pixel in the specified DataBuffer from a
     * primitive array of type TransferType.  For image data supported by
     * the Java 2D API, this will be one of DataBuffer.TYPE_BYTE,
     * DataBuffer.TYPE_USHORT, DataBuffer.TYPE_INT, DataBuffer.TYPE_SHORT,
     * DataBuffer.TYPE_FLOAT, or DataBuffer.TYPE_DOUBLE.  Data in the array
     * may be in a packed format, thus increasing efficiency for data
     * transfers.
     * &lt;p&gt;
     * The following code illustrates transferring data for one pixel from
     * DataBuffer &lt;code&gt;db1&lt;/code&gt;, whose storage layout is described by
     * SampleModel &lt;code&gt;sm1&lt;/code&gt;, to DataBuffer &lt;code&gt;db2&lt;/code&gt;, whose
     * storage layout is described by SampleModel &lt;code&gt;sm2&lt;/code&gt;.
     * The transfer will generally be more efficient than using
     * getPixel/setPixel.
     * &lt;pre&gt;
     *       SampleModel sm1, sm2;
     *       DataBuffer db1, db2;
     *       sm2.setDataElements(x, y, sm1.getDataElements(x, y, null, db1),
     *                           db2);
     * &lt;/pre&gt;
     * Using getDataElements/setDataElements to transfer between two
     * DataBuffer/SampleModel pairs is legitimate if the SampleModels have
     * the same number of bands, corresponding bands have the same number of
     * bits per sample, and the TransferTypes are the same.
     * &lt;p&gt;
     * obj must be a primitive array of type TransferType.  Otherwise,
     * a ClassCastException is thrown.  An
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds, or if obj is not large enough to hold the pixel data.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param obj       A primitive array containing pixel data.
     * @param data      The DataBuffer containing the image data.
     * @see #getNumDataElements
     * @see #getTransferType
     * @see #getDataElements(int, int, Object, DataBuffer)
     * @see java.awt.image.DataBuffer
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if obj is too small to hold the input.
     */
    public abstract void setDataElements(int x, int y,
                                         Object obj, DataBuffer data);

    /**
     * Sets the data for a rectangle of pixels in the specified DataBuffer
     * from a primitive array of type TransferType.  For image data supported
     * by the Java 2D API, this will be one of DataBuffer.TYPE_BYTE,
     * DataBuffer.TYPE_USHORT, DataBuffer.TYPE_INT, DataBuffer.TYPE_SHORT,
     * DataBuffer.TYPE_FLOAT, or DataBuffer.TYPE_DOUBLE.  Data in the array
     * may be in a packed format, thus increasing efficiency for data
     * transfers.
     * &lt;p&gt;
     * The following code illustrates transferring data for a rectangular
     * region of pixels from
     * DataBuffer &lt;code&gt;db1&lt;/code&gt;, whose storage layout is described by
     * SampleModel &lt;code&gt;sm1&lt;/code&gt;, to DataBuffer &lt;code&gt;db2&lt;/code&gt;, whose
     * storage layout is described by SampleModel &lt;code&gt;sm2&lt;/code&gt;.
     * The transfer will generally be more efficient than using
     * getPixels/setPixels.
     * &lt;pre&gt;
     *       SampleModel sm1, sm2;
     *       DataBuffer db1, db2;
     *       sm2.setDataElements(x, y, w, h, sm1.getDataElements(x, y, w, h,
     *                           null, db1), db2);
     * &lt;/pre&gt;
     * Using getDataElements/setDataElements to transfer between two
     * DataBuffer/SampleModel pairs is legitimate if the SampleModels have
     * the same number of bands, corresponding bands have the same number of
     * bits per sample, and the TransferTypes are the same.
     * &lt;p&gt;
     * obj must be a primitive array of type TransferType.  Otherwise,
     * a ClassCastException is thrown.  An
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds, or if obj is not large enough to hold the pixel data.
     * @param x         The minimum X coordinate of the pixel rectangle.
     * @param y         The minimum Y coordinate of the pixel rectangle.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param obj       A primitive array containing pixel data.
     * @param data      The DataBuffer containing the image data.
     * @see #getNumDataElements
     * @see #getTransferType
     * @see #getDataElements(int, int, int, int, Object, DataBuffer)
     * @see java.awt.image.DataBuffer
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if obj is too small to hold the input.
     */
    public void setDataElements(int x, int y, int w, int h,
                                Object obj, DataBuffer data) {

<span class="nc" id="L586">        int cnt = 0;</span>
<span class="nc" id="L587">        Object o = null;</span>
<span class="nc" id="L588">        int type = getTransferType();</span>
<span class="nc" id="L589">        int numDataElems = getNumDataElements();</span>

<span class="nc" id="L591">        int x1 = x + w;</span>
<span class="nc" id="L592">        int y1 = y + h;</span>

<span class="nc bnc" id="L594" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L597">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L600" title="All 6 branches missed.">        switch(type) {</span>

        case DataBuffer.TYPE_BYTE:

<span class="nc" id="L604">            byte[] barray = (byte[])obj;</span>
<span class="nc" id="L605">            byte[] btemp = new byte[numDataElems];</span>

<span class="nc bnc" id="L607" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L610">                        btemp[k] = barray[cnt++];</span>
                    }

<span class="nc" id="L613">                    setDataElements(j, i, btemp, data);</span>
                }
            }
<span class="nc" id="L616">            break;</span>

        case DataBuffer.TYPE_USHORT:
        case DataBuffer.TYPE_SHORT:

<span class="nc" id="L621">            short[] sarray = (short[])obj;</span>
<span class="nc" id="L622">            short[] stemp = new short[numDataElems];</span>

<span class="nc bnc" id="L624" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L625" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L626" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L627">                        stemp[k] = sarray[cnt++];</span>
                    }

<span class="nc" id="L630">                    setDataElements(j, i, stemp, data);</span>
                }
            }
<span class="nc" id="L633">            break;</span>

        case DataBuffer.TYPE_INT:

<span class="nc" id="L637">            int[] iArray = (int[])obj;</span>
<span class="nc" id="L638">            int[] itemp = new int[numDataElems];</span>

<span class="nc bnc" id="L640" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L641" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L642" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L643">                        itemp[k] = iArray[cnt++];</span>
                    }

<span class="nc" id="L646">                    setDataElements(j, i, itemp, data);</span>
                }
            }
<span class="nc" id="L649">            break;</span>

        case DataBuffer.TYPE_FLOAT:

<span class="nc" id="L653">            float[] fArray = (float[])obj;</span>
<span class="nc" id="L654">            float[] ftemp = new float[numDataElems];</span>

<span class="nc bnc" id="L656" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L657" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L659">                        ftemp[k] = fArray[cnt++];</span>
                    }

<span class="nc" id="L662">                    setDataElements(j, i, ftemp, data);</span>
                }
            }
<span class="nc" id="L665">            break;</span>

        case DataBuffer.TYPE_DOUBLE:

<span class="nc" id="L669">            double[] dArray = (double[])obj;</span>
<span class="nc" id="L670">            double[] dtemp = new double[numDataElems];</span>

<span class="nc bnc" id="L672" title="All 2 branches missed.">            for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">                for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">                    for (int k=0; k&lt;numDataElems; k++) {</span>
<span class="nc" id="L675">                        dtemp[k] = dArray[cnt++];</span>
                    }

<span class="nc" id="L678">                    setDataElements(j, i, dtemp, data);</span>
                }
            }
            break;
        }

<span class="nc" id="L684">    }</span>

    /**
     * Returns the samples for the specified pixel in an array of float.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param fArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified pixel.
     * @see #setPixel(int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if fArray is too small to hold the output.
     */
    public float[] getPixel(int x, int y, float fArray[],
                            DataBuffer data) {

        float pixels[];

<span class="nc bnc" id="L706" title="All 2 branches missed.">        if (fArray != null)</span>
<span class="nc" id="L707">            pixels = fArray;</span>
        else
<span class="nc" id="L709">            pixels = new float[numBands];</span>

<span class="nc bnc" id="L711" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++)</span>
<span class="nc" id="L712">            pixels[i] = getSampleFloat(x, y, i, data);</span>

<span class="nc" id="L714">        return pixels;</span>
    }

    /**
     * Returns the samples for the specified pixel in an array of double.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param dArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified pixel.
     * @see #setPixel(int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if dArray is too small to hold the output.
     */
    public double[] getPixel(int x, int y, double dArray[],
                             DataBuffer data) {

        double pixels[];

<span class="nc bnc" id="L737" title="All 2 branches missed.">        if(dArray != null)</span>
<span class="nc" id="L738">            pixels = dArray;</span>
        else
<span class="nc" id="L740">            pixels = new double[numBands];</span>

<span class="nc bnc" id="L742" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++)</span>
<span class="nc" id="L743">            pixels[i] = getSampleDouble(x, y, i, data);</span>

<span class="nc" id="L745">        return pixels;</span>
    }

    /**
     * Returns all samples for a rectangle of pixels in an
     * int array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param iArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified region of pixels.
     * @see #setPixels(int, int, int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if iArray is too small to hold the output.
     */
    public int[] getPixels(int x, int y, int w, int h,
                           int iArray[], DataBuffer data) {

        int pixels[];
<span class="nc" id="L770">        int Offset=0;</span>
<span class="nc" id="L771">        int x1 = x + w;</span>
<span class="nc" id="L772">        int y1 = y + h;</span>

<span class="nc bnc" id="L774" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L777">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L780" title="All 2 branches missed.">        if (iArray != null)</span>
<span class="nc" id="L781">            pixels = iArray;</span>
        else
<span class="nc" id="L783">            pixels = new int[numBands * w * h];</span>

<span class="nc bnc" id="L785" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L786" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">                for(int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L788">                    pixels[Offset++] = getSample(j, i, k, data);</span>
                }
            }
        }

<span class="nc" id="L793">        return pixels;</span>
    }

    /**
     * Returns all samples for a rectangle of pixels in a float
     * array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param fArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified region of pixels.
     * @see #setPixels(int, int, int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if fArray is too small to hold the output.
     */
    public float[] getPixels(int x, int y, int w, int h,
                             float fArray[], DataBuffer data) {

        float pixels[];
<span class="nc" id="L818">        int Offset = 0;</span>
<span class="nc" id="L819">        int x1 = x + w;</span>
<span class="nc" id="L820">        int y1 = y + h;</span>

<span class="nc bnc" id="L822" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L825">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L828" title="All 2 branches missed.">        if (fArray != null)</span>
<span class="nc" id="L829">            pixels = fArray;</span>
        else
<span class="nc" id="L831">            pixels = new float[numBands * w * h];</span>

<span class="nc bnc" id="L833" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L834" title="All 2 branches missed.">            for(int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L835" title="All 2 branches missed.">                for(int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L836">                    pixels[Offset++] = getSampleFloat(j, i, k, data);</span>
                }
            }
        }

<span class="nc" id="L841">        return pixels;</span>
    }

    /**
     * Returns all samples for a rectangle of pixels in a double
     * array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param dArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified region of pixels.
     * @see #setPixels(int, int, int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if dArray is too small to hold the output.
     */
    public double[] getPixels(int x, int y, int w, int h,
                              double dArray[], DataBuffer data) {
        double pixels[];
<span class="nc" id="L865">        int    Offset = 0;</span>
<span class="nc" id="L866">        int x1 = x + w;</span>
<span class="nc" id="L867">        int y1 = y + h;</span>

<span class="nc bnc" id="L869" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L872">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L875" title="All 2 branches missed.">        if (dArray != null)</span>
<span class="nc" id="L876">            pixels = dArray;</span>
        else
<span class="nc" id="L878">            pixels = new double[numBands * w * h];</span>

        // Fix 4217412
<span class="nc bnc" id="L881" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L882" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">                for (int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L884">                    pixels[Offset++] = getSampleDouble(j, i, k, data);</span>
                }
            }
        }

<span class="nc" id="L889">        return pixels;</span>
    }


    /**
     * Returns the sample in a specified band for the pixel located
     * at (x,y) as an int.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to return.
     * @param data      The DataBuffer containing the image data.
     * @return the sample in a specified band for the specified pixel.
     * @see #setSample(int, int, int, int, DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public abstract int getSample(int x, int y, int b, DataBuffer data);


    /**
     * Returns the sample in a specified band
     * for the pixel located at (x,y) as a float.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to return.
     * @param data      The DataBuffer containing the image data.
     * @return the sample in a specified band for the specified pixel.
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public float getSampleFloat(int x, int y, int b, DataBuffer data) {

        float sample;
<span class="nc" id="L930">        sample = (float) getSample(x, y, b, data);</span>
<span class="nc" id="L931">        return sample;</span>
    }

    /**
     * Returns the sample in a specified band
     * for a pixel located at (x,y) as a double.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to return.
     * @param data      The DataBuffer containing the image data.
     * @return the sample in a specified band for the specified pixel.
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public double getSampleDouble(int x, int y, int b, DataBuffer data) {

        double sample;

<span class="nc" id="L953">        sample = (double) getSample(x, y, b, data);</span>
<span class="nc" id="L954">        return sample;</span>
    }

    /**
     * Returns the samples for a specified band for the specified rectangle
     * of pixels in an int array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to return.
     * @param iArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified band for the specified region
     *         of pixels.
     * @see #setSamples(int, int, int, int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if iArray is too small to
     * hold the output.
     */
    public int[] getSamples(int x, int y, int w, int h, int b,
                            int iArray[], DataBuffer data) {
        int pixels[];
<span class="nc" id="L981">        int Offset=0;</span>
<span class="nc" id="L982">        int x1 = x + w;</span>
<span class="nc" id="L983">        int y1 = y + h;</span>

<span class="nc bnc" id="L985" title="All 12 branches missed.">        if (x &lt; 0 || x1 &lt; x || x1 &gt; width ||</span>
            y &lt; 0 || y1 &lt; y || y1 &gt; height)
        {
<span class="nc" id="L988">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L991" title="All 2 branches missed.">        if (iArray != null)</span>
<span class="nc" id="L992">            pixels = iArray;</span>
        else
<span class="nc" id="L994">            pixels = new int[w * h];</span>

<span class="nc bnc" id="L996" title="All 2 branches missed.">        for(int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L997" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L998">                pixels[Offset++] = getSample(j, i, b, data);</span>
            }
        }

<span class="nc" id="L1002">        return pixels;</span>
    }

    /**
     * Returns the samples for a specified band for the specified rectangle
     * of pixels in a float array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to return.
     * @param fArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified band for the specified region
     *         of pixels.
     * @see #setSamples(int, int, int, int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if fArray is too small to
     * hold the output.
     */
    public float[] getSamples(int x, int y, int w, int h,
                              int b, float fArray[],
                              DataBuffer data) {
        float pixels[];
<span class="nc" id="L1030">        int   Offset=0;</span>
<span class="nc" id="L1031">        int x1 = x + w;</span>
<span class="nc" id="L1032">        int y1 = y + h;</span>

<span class="nc bnc" id="L1034" title="All 12 branches missed.">        if (x &lt; 0 || x1 &lt; x || x1 &gt; width ||</span>
            y &lt; 0 || y1 &lt; y || y1 &gt; height)
        {
<span class="nc" id="L1037">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates&quot;);</span>
        }

<span class="nc bnc" id="L1040" title="All 2 branches missed.">        if (fArray != null)</span>
<span class="nc" id="L1041">            pixels = fArray;</span>
        else
<span class="nc" id="L1043">            pixels = new float[w * h];</span>

<span class="nc bnc" id="L1045" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1046" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L1047">                pixels[Offset++] = getSampleFloat(j, i, b, data);</span>
            }
        }

<span class="nc" id="L1051">        return pixels;</span>
    }

    /**
     * Returns the samples for a specified band for a specified rectangle
     * of pixels in a double array, one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to return.
     * @param dArray    If non-null, returns the samples in this array.
     * @param data      The DataBuffer containing the image data.
     * @return the samples for the specified band for the specified region
     *         of pixels.
     * @see #setSamples(int, int, int, int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if dArray is too small to
     * hold the output.
     */
    public double[] getSamples(int x, int y, int w, int h,
                               int b, double dArray[],
                               DataBuffer data) {
        double pixels[];
<span class="nc" id="L1079">        int    Offset=0;</span>
<span class="nc" id="L1080">        int x1 = x + w;</span>
<span class="nc" id="L1081">        int y1 = y + h;</span>

<span class="nc bnc" id="L1083" title="All 12 branches missed.">        if (x &lt; 0 || x1 &lt; x || x1 &gt; width ||</span>
            y &lt; 0 || y1 &lt; y || y1 &gt; height)
        {
<span class="nc" id="L1086">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates&quot;);</span>
        }

<span class="nc bnc" id="L1089" title="All 2 branches missed.">        if (dArray != null)</span>
<span class="nc" id="L1090">            pixels = dArray;</span>
        else
<span class="nc" id="L1092">            pixels = new double[w * h];</span>

<span class="nc bnc" id="L1094" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1095" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L1096">                pixels[Offset++] = getSampleDouble(j, i, b, data);</span>
            }
        }

<span class="nc" id="L1100">        return pixels;</span>
    }

    /**
     * Sets a pixel in  the DataBuffer using an int array of samples for input.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param iArray    The input samples in an int array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixel(int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if iArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if iArray is too small to hold the input.
     */
    public void setPixel(int x, int y, int iArray[], DataBuffer data) {

<span class="nc bnc" id="L1119" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++)</span>
<span class="nc" id="L1120">            setSample(x, y, i, iArray[i], data);</span>
<span class="nc" id="L1121">    }</span>

    /**
     * Sets a pixel in the DataBuffer using a float array of samples for input.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param fArray    The input samples in a float array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixel(int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if fArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if fArray is too small to hold the input.
     */
    public void setPixel(int x, int y, float fArray[], DataBuffer data) {

<span class="nc bnc" id="L1139" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++)</span>
<span class="nc" id="L1140">            setSample(x, y, i, fArray[i], data);</span>
<span class="nc" id="L1141">    }</span>

    /**
     * Sets a pixel in the DataBuffer using a double array of samples
     * for input.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param dArray    The input samples in a double array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixel(int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if dArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if fArray is too small to hold the input.
     */
    public void setPixel(int x, int y, double dArray[], DataBuffer data) {

<span class="nc bnc" id="L1158" title="All 2 branches missed.">        for (int i=0; i&lt;numBands; i++)</span>
<span class="nc" id="L1159">            setSample(x, y, i, dArray[i], data);</span>
<span class="nc" id="L1160">    }</span>

    /**
     * Sets all samples for a rectangle of pixels from an int array containing
     * one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param iArray    The input samples in an int array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixels(int, int, int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if iArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if iArray is too small to hold the input.
     */
    public void setPixels(int x, int y, int w, int h,
                          int iArray[], DataBuffer data) {
<span class="nc" id="L1181">        int Offset=0;</span>
<span class="nc" id="L1182">        int x1 = x + w;</span>
<span class="nc" id="L1183">        int y1 = y + h;</span>

<span class="nc bnc" id="L1185" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1188">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1191" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1192" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L1193" title="All 2 branches missed.">                for (int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L1194">                    setSample(j, i, k, iArray[Offset++], data);</span>
                }
            }
        }
<span class="nc" id="L1198">    }</span>

    /**
     * Sets all samples for a rectangle of pixels from a float array containing
     * one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param fArray    The input samples in a float array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixels(int, int, int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if fArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if fArray is too small to hold the input.
     */
    public void setPixels(int x, int y, int w, int h,
                          float fArray[], DataBuffer data) {
<span class="nc" id="L1219">        int Offset=0;</span>
<span class="nc" id="L1220">        int x1 = x + w;</span>
<span class="nc" id="L1221">        int y1 = y + h;</span>

<span class="nc bnc" id="L1223" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1226">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1229" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1230" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">                for(int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L1232">                    setSample(j, i, k, fArray[Offset++], data);</span>
                }
            }
        }
<span class="nc" id="L1236">    }</span>

    /**
     * Sets all samples for a rectangle of pixels from a double array
     * containing one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param dArray    The input samples in a double array.
     * @param data      The DataBuffer containing the image data.
     * @see #getPixels(int, int, int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if dArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates are
     * not in bounds, or if dArray is too small to hold the input.
     */
    public void setPixels(int x, int y, int w, int h,
                          double dArray[], DataBuffer data) {
<span class="nc" id="L1257">        int Offset=0;</span>
<span class="nc" id="L1258">        int x1 = x + w;</span>
<span class="nc" id="L1259">        int y1 = y + h;</span>

<span class="nc bnc" id="L1261" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1264">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1267" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1268" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc bnc" id="L1269" title="All 2 branches missed.">                for (int k=0; k&lt;numBands; k++) {</span>
<span class="nc" id="L1270">                    setSample(j, i, k, dArray[Offset++], data);</span>
                }
            }
        }
<span class="nc" id="L1274">    }</span>

    /**
     * Sets a sample in the specified band for the pixel located at (x,y)
     * in the DataBuffer using an int for input.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to set.
     * @param s         The input sample as an int.
     * @param data      The DataBuffer containing the image data.
     * @see #getSample(int, int, int,  DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public abstract void setSample(int x, int y, int b,
                                   int s,
                                   DataBuffer data);

    /**
     * Sets a sample in the specified band for the pixel located at (x,y)
     * in the DataBuffer using a float for input.
     * The default implementation of this method casts the input
     * float sample to an int and then calls the
     * &lt;code&gt;setSample(int, int, int, DataBuffer)&lt;/code&gt; method using
     * that int value.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to set.
     * @param s         The input sample as a float.
     * @param data      The DataBuffer containing the image data.
     * @see #getSample(int, int, int, DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public void setSample(int x, int y, int b,
                          float s ,
                          DataBuffer data) {
<span class="nc" id="L1319">        int sample = (int)s;</span>

<span class="nc" id="L1321">        setSample(x, y, b, sample, data);</span>
<span class="nc" id="L1322">    }</span>

    /**
     * Sets a sample in the specified band for the pixel located at (x,y)
     * in the DataBuffer using a double for input.
     * The default implementation of this method casts the input
     * double sample to an int and then calls the
     * &lt;code&gt;setSample(int, int, int, DataBuffer)&lt;/code&gt; method using
     * that int value.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the pixel location.
     * @param y         The Y coordinate of the pixel location.
     * @param b         The band to set.
     * @param s         The input sample as a double.
     * @param data      The DataBuffer containing the image data.
     * @see #getSample(int, int, int, DataBuffer)
     *
     * @throws NullPointerException if data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds.
     */
    public void setSample(int x, int y, int b,
                          double s,
                          DataBuffer data) {
<span class="nc" id="L1347">        int sample = (int)s;</span>

<span class="nc" id="L1349">        setSample(x, y, b, sample, data);</span>
<span class="nc" id="L1350">    }</span>

    /**
     * Sets the samples in the specified band for the specified rectangle
     * of pixels from an int array containing one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to set.
     * @param iArray    The input samples in an int array.
     * @param data      The DataBuffer containing the image data.
     * @see #getSamples(int, int, int, int, int, int[], DataBuffer)
     *
     * @throws NullPointerException if iArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if iArray is too small to
     * hold the input.
     */
    public void setSamples(int x, int y, int w, int h, int b,
                           int iArray[], DataBuffer data) {

<span class="nc" id="L1374">        int Offset=0;</span>
<span class="nc" id="L1375">        int x1 = x + w;</span>
<span class="nc" id="L1376">        int y1 = y + h;</span>
<span class="nc bnc" id="L1377" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1380">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1383" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1384" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L1385">                setSample(j, i, b, iArray[Offset++], data);</span>
            }
        }
<span class="nc" id="L1388">    }</span>

    /**
     * Sets the samples in the specified band for the specified rectangle
     * of pixels from a float array containing one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to set.
     * @param fArray    The input samples in a float array.
     * @param data      The DataBuffer containing the image data.
     * @see #getSamples(int, int, int, int, int, float[], DataBuffer)
     *
     * @throws NullPointerException if fArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if fArray is too small to
     * hold the input.
     */
    public void setSamples(int x, int y, int w, int h, int b,
                           float fArray[], DataBuffer data) {
<span class="nc" id="L1411">        int Offset=0;</span>
<span class="nc" id="L1412">        int x1 = x + w;</span>
<span class="nc" id="L1413">        int y1 = y + h;</span>

<span class="nc bnc" id="L1415" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1418">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1421" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1422" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L1423">                setSample(j, i, b, fArray[Offset++], data);</span>
            }
        }
<span class="nc" id="L1426">    }</span>

    /**
     * Sets the samples in the specified band for the specified rectangle
     * of pixels from a double array containing one sample per array element.
     * ArrayIndexOutOfBoundsException may be thrown if the coordinates are
     * not in bounds.
     * @param x         The X coordinate of the upper left pixel location.
     * @param y         The Y coordinate of the upper left pixel location.
     * @param w         The width of the pixel rectangle.
     * @param h         The height of the pixel rectangle.
     * @param b         The band to set.
     * @param dArray    The input samples in a double array.
     * @param data      The DataBuffer containing the image data.
     * @see #getSamples(int, int, int, int, int, double[], DataBuffer)
     *
     * @throws NullPointerException if dArray or data is null.
     * @throws ArrayIndexOutOfBoundsException if the coordinates or
     * the band index are not in bounds, or if dArray is too small to
     * hold the input.
     */
    public void setSamples(int x, int y, int w, int h, int b,
                           double dArray[], DataBuffer data) {
<span class="nc" id="L1449">        int Offset=0;</span>
<span class="nc" id="L1450">        int x1 = x + w;</span>
<span class="nc" id="L1451">        int y1 = y + h;</span>


<span class="nc bnc" id="L1454" title="All 20 branches missed.">        if (x &lt; 0 || x &gt;= width || w &gt; width || x1 &lt; 0 || x1 &gt; width ||</span>
            y &lt; 0 || y &gt;= height || h &gt; height || y1 &lt; 0 || y1 &gt; height)
        {
<span class="nc" id="L1457">            throw new ArrayIndexOutOfBoundsException(&quot;Invalid coordinates.&quot;);</span>
        }

<span class="nc bnc" id="L1460" title="All 2 branches missed.">        for (int i=y; i&lt;y1; i++) {</span>
<span class="nc bnc" id="L1461" title="All 2 branches missed.">            for (int j=x; j&lt;x1; j++) {</span>
<span class="nc" id="L1462">                setSample(j, i, b, dArray[Offset++], data);</span>
            }
        }
<span class="nc" id="L1465">    }</span>

    /**
     *  Creates a SampleModel which describes data in this SampleModel's
     *  format, but with a different width and height.
     *  @param w the width of the image data
     *  @param h the height of the image data
     *  @return a &lt;code&gt;SampleModel&lt;/code&gt; describing the same image
     *          data as this &lt;code&gt;SampleModel&lt;/code&gt;, but with a
     *          different size.
     */
    public abstract SampleModel createCompatibleSampleModel(int w, int h);

    /**
     * Creates a new SampleModel
     * with a subset of the bands of this
     * SampleModel.
     * @param bands the subset of bands of this &lt;code&gt;SampleModel&lt;/code&gt;
     * @return a &lt;code&gt;SampleModel&lt;/code&gt; with a subset of bands of this
     *         &lt;code&gt;SampleModel&lt;/code&gt;.
     */
    public abstract SampleModel createSubsetSampleModel(int bands[]);

    /**
     * Creates a DataBuffer that corresponds to this SampleModel.
     * The DataBuffer's width and height will match this SampleModel's.
     * @return a &lt;code&gt;DataBuffer&lt;/code&gt; corresponding to this
     *         &lt;code&gt;SampleModel&lt;/code&gt;.
     */
    public abstract DataBuffer createDataBuffer();

    /** Returns the size in bits of samples for all bands.
     *  @return the size of samples for all bands.
     */
    public abstract int[] getSampleSize();

    /** Returns the size in bits of samples for the specified band.
     *  @param band the specified band
     *  @return the size of the samples of the specified band.
     */
    public abstract int getSampleSize(int band);

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>