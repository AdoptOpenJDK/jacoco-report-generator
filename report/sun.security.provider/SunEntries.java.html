<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SunEntries.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">sun.security.provider</a> &gt; <span class="el_source">SunEntries.java</span></div><h1>SunEntries.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1996, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package sun.security.provider;

import java.io.*;
import java.net.*;
import java.util.Map;
import java.security.*;

/**
 * Defines the entries of the SUN provider.
 *
 * Algorithms supported, and their names:
 *
 * - SHA is the message digest scheme described in FIPS 180-1.
 *   Aliases for SHA are SHA-1 and SHA1.
 *
 * - SHA1withDSA is the signature scheme described in FIPS 186.
 *   (SHA used in DSA is SHA-1: FIPS 186 with Change No 1.)
 *   Aliases for SHA1withDSA are DSA, DSS, SHA/DSA, SHA-1/DSA, SHA1/DSA,
 *   SHAwithDSA, DSAWithSHA1, and the object
 *   identifier strings &quot;OID.1.3.14.3.2.13&quot;, &quot;OID.1.3.14.3.2.27&quot; and
 *   &quot;OID.1.2.840.10040.4.3&quot;.
 *
 * - SHA-2 is a set of message digest schemes described in FIPS 180-2.
 *   SHA-2 family of hash functions includes SHA-224, SHA-256, SHA-384,
 *   and SHA-512.
 *
 * - SHA-224withDSA/SHA-256withDSA are the signature schemes
 *   described in FIPS 186-3. The associated object identifiers are
 *   &quot;OID.2.16.840.1.101.3.4.3.1&quot;, and &quot;OID.2.16.840.1.101.3.4.3.2&quot;.

 * - DSA is the key generation scheme as described in FIPS 186.
 *   Aliases for DSA include the OID strings &quot;OID.1.3.14.3.2.12&quot;
 *   and &quot;OID.1.2.840.10040.4.1&quot;.
 *
 * - MD5 is the message digest scheme described in RFC 1321.
 *   There are no aliases for MD5.
 *
 * - X.509 is the certificate factory type for X.509 certificates
 *   and CRLs. Aliases for X.509 are X509.
 *
 * - PKIX is the certification path validation algorithm described
 *   in RFC 3280. The ValidationAlgorithm attribute notes the
 *   specification that this provider implements.
 *
 * - LDAP is the CertStore type for LDAP repositories. The
 *   LDAPSchema attribute notes the specification defining the
 *   schema that this provider uses to find certificates and CRLs.
 *
 * - JavaPolicy is the default file-based Policy type.
 *
 * - JavaLoginConfig is the default file-based LoginModule Configuration type.
 */

final class SunEntries {

<span class="nc" id="L81">    private SunEntries() {</span>
        // empty
<span class="nc" id="L83">    }</span>

    static void putEntries(Map&lt;Object, Object&gt; map) {

        /*
         * SecureRandom
         *
         * Register these first to speed up &quot;new SecureRandom()&quot;,
         * which iterates through the list of algorithms
         */
        // register the native PRNG, if available
        // if user selected /dev/urandom, we put it before SHA1PRNG,
        // otherwise after it
<span class="fc" id="L96">        boolean nativeAvailable = NativePRNG.isAvailable();</span>
<span class="fc bfc" id="L97" title="All 2 branches covered.">        boolean useNativePRNG = seedSource.equals(URL_DEV_URANDOM) ||</span>
<span class="fc bfc" id="L98" title="All 2 branches covered.">            seedSource.equals(URL_DEV_RANDOM);</span>

<span class="pc bpc" id="L100" title="1 of 4 branches missed.">        if (nativeAvailable &amp;&amp; useNativePRNG) {</span>
<span class="fc" id="L101">            map.put(&quot;SecureRandom.NativePRNG&quot;,</span>
                &quot;sun.security.provider.NativePRNG&quot;);
        }
<span class="fc" id="L104">        map.put(&quot;SecureRandom.SHA1PRNG&quot;,</span>
             &quot;sun.security.provider.SecureRandom&quot;);
<span class="pc bpc" id="L106" title="1 of 4 branches missed.">        if (nativeAvailable &amp;&amp; !useNativePRNG) {</span>
<span class="fc" id="L107">            map.put(&quot;SecureRandom.NativePRNG&quot;,</span>
                &quot;sun.security.provider.NativePRNG&quot;);
        }

<span class="pc bpc" id="L111" title="1 of 2 branches missed.">        if (NativePRNG.Blocking.isAvailable()) {</span>
<span class="fc" id="L112">            map.put(&quot;SecureRandom.NativePRNGBlocking&quot;,</span>
                &quot;sun.security.provider.NativePRNG$Blocking&quot;);
        }

<span class="pc bpc" id="L116" title="1 of 2 branches missed.">        if (NativePRNG.NonBlocking.isAvailable()) {</span>
<span class="fc" id="L117">            map.put(&quot;SecureRandom.NativePRNGNonBlocking&quot;,</span>
                &quot;sun.security.provider.NativePRNG$NonBlocking&quot;);
        }

        /*
         * Signature engines
         */
<span class="fc" id="L124">        map.put(&quot;Signature.SHA1withDSA&quot;,</span>
                &quot;sun.security.provider.DSA$SHA1withDSA&quot;);
<span class="fc" id="L126">        map.put(&quot;Signature.NONEwithDSA&quot;, &quot;sun.security.provider.DSA$RawDSA&quot;);</span>
<span class="fc" id="L127">        map.put(&quot;Alg.Alias.Signature.RawDSA&quot;, &quot;NONEwithDSA&quot;);</span>
<span class="fc" id="L128">        map.put(&quot;Signature.SHA224withDSA&quot;,</span>
                &quot;sun.security.provider.DSA$SHA224withDSA&quot;);
<span class="fc" id="L130">        map.put(&quot;Signature.SHA256withDSA&quot;,</span>
                &quot;sun.security.provider.DSA$SHA256withDSA&quot;);

<span class="fc" id="L133">        String dsaKeyClasses = &quot;java.security.interfaces.DSAPublicKey&quot; +</span>
                &quot;|java.security.interfaces.DSAPrivateKey&quot;;
<span class="fc" id="L135">        map.put(&quot;Signature.SHA1withDSA SupportedKeyClasses&quot;, dsaKeyClasses);</span>
<span class="fc" id="L136">        map.put(&quot;Signature.NONEwithDSA SupportedKeyClasses&quot;, dsaKeyClasses);</span>
<span class="fc" id="L137">        map.put(&quot;Signature.SHA224withDSA SupportedKeyClasses&quot;, dsaKeyClasses);</span>
<span class="fc" id="L138">        map.put(&quot;Signature.SHA256withDSA SupportedKeyClasses&quot;, dsaKeyClasses);</span>

<span class="fc" id="L140">        map.put(&quot;Alg.Alias.Signature.DSA&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L141">        map.put(&quot;Alg.Alias.Signature.DSS&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L142">        map.put(&quot;Alg.Alias.Signature.SHA/DSA&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L143">        map.put(&quot;Alg.Alias.Signature.SHA-1/DSA&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L144">        map.put(&quot;Alg.Alias.Signature.SHA1/DSA&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L145">        map.put(&quot;Alg.Alias.Signature.SHAwithDSA&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L146">        map.put(&quot;Alg.Alias.Signature.DSAWithSHA1&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L147">        map.put(&quot;Alg.Alias.Signature.OID.1.2.840.10040.4.3&quot;,</span>
                &quot;SHA1withDSA&quot;);
<span class="fc" id="L149">        map.put(&quot;Alg.Alias.Signature.1.2.840.10040.4.3&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L150">        map.put(&quot;Alg.Alias.Signature.1.3.14.3.2.13&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L151">        map.put(&quot;Alg.Alias.Signature.1.3.14.3.2.27&quot;, &quot;SHA1withDSA&quot;);</span>
<span class="fc" id="L152">        map.put(&quot;Alg.Alias.Signature.OID.2.16.840.1.101.3.4.3.1&quot;,</span>
                &quot;SHA224withDSA&quot;);
<span class="fc" id="L154">        map.put(&quot;Alg.Alias.Signature.2.16.840.1.101.3.4.3.1&quot;, &quot;SHA224withDSA&quot;);</span>
<span class="fc" id="L155">        map.put(&quot;Alg.Alias.Signature.OID.2.16.840.1.101.3.4.3.2&quot;,</span>
                &quot;SHA256withDSA&quot;);
<span class="fc" id="L157">        map.put(&quot;Alg.Alias.Signature.2.16.840.1.101.3.4.3.2&quot;, &quot;SHA256withDSA&quot;);</span>

        /*
         *  Key Pair Generator engines
         */
<span class="fc" id="L162">        map.put(&quot;KeyPairGenerator.DSA&quot;,</span>
            &quot;sun.security.provider.DSAKeyPairGenerator&quot;);
<span class="fc" id="L164">        map.put(&quot;Alg.Alias.KeyPairGenerator.OID.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L165">        map.put(&quot;Alg.Alias.KeyPairGenerator.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L166">        map.put(&quot;Alg.Alias.KeyPairGenerator.1.3.14.3.2.12&quot;, &quot;DSA&quot;);</span>

        /*
         * Digest engines
         */
<span class="fc" id="L171">        map.put(&quot;MessageDigest.MD2&quot;, &quot;sun.security.provider.MD2&quot;);</span>
<span class="fc" id="L172">        map.put(&quot;MessageDigest.MD5&quot;, &quot;sun.security.provider.MD5&quot;);</span>
<span class="fc" id="L173">        map.put(&quot;MessageDigest.SHA&quot;, &quot;sun.security.provider.SHA&quot;);</span>

<span class="fc" id="L175">        map.put(&quot;Alg.Alias.MessageDigest.SHA-1&quot;, &quot;SHA&quot;);</span>
<span class="fc" id="L176">        map.put(&quot;Alg.Alias.MessageDigest.SHA1&quot;, &quot;SHA&quot;);</span>
<span class="fc" id="L177">        map.put(&quot;Alg.Alias.MessageDigest.1.3.14.3.2.26&quot;, &quot;SHA&quot;);</span>
<span class="fc" id="L178">        map.put(&quot;Alg.Alias.MessageDigest.OID.1.3.14.3.2.26&quot;, &quot;SHA&quot;);</span>

<span class="fc" id="L180">        map.put(&quot;MessageDigest.SHA-224&quot;, &quot;sun.security.provider.SHA2$SHA224&quot;);</span>
<span class="fc" id="L181">        map.put(&quot;Alg.Alias.MessageDigest.2.16.840.1.101.3.4.2.4&quot;, &quot;SHA-224&quot;);</span>
<span class="fc" id="L182">        map.put(&quot;Alg.Alias.MessageDigest.OID.2.16.840.1.101.3.4.2.4&quot;,</span>
                &quot;SHA-224&quot;);

<span class="fc" id="L185">        map.put(&quot;MessageDigest.SHA-256&quot;, &quot;sun.security.provider.SHA2$SHA256&quot;);</span>
<span class="fc" id="L186">        map.put(&quot;Alg.Alias.MessageDigest.2.16.840.1.101.3.4.2.1&quot;, &quot;SHA-256&quot;);</span>
<span class="fc" id="L187">        map.put(&quot;Alg.Alias.MessageDigest.OID.2.16.840.1.101.3.4.2.1&quot;,</span>
                &quot;SHA-256&quot;);
<span class="fc" id="L189">        map.put(&quot;MessageDigest.SHA-384&quot;, &quot;sun.security.provider.SHA5$SHA384&quot;);</span>
<span class="fc" id="L190">        map.put(&quot;Alg.Alias.MessageDigest.2.16.840.1.101.3.4.2.2&quot;, &quot;SHA-384&quot;);</span>
<span class="fc" id="L191">        map.put(&quot;Alg.Alias.MessageDigest.OID.2.16.840.1.101.3.4.2.2&quot;,</span>
                &quot;SHA-384&quot;);
<span class="fc" id="L193">        map.put(&quot;MessageDigest.SHA-512&quot;, &quot;sun.security.provider.SHA5$SHA512&quot;);</span>
<span class="fc" id="L194">        map.put(&quot;Alg.Alias.MessageDigest.2.16.840.1.101.3.4.2.3&quot;, &quot;SHA-512&quot;);</span>
<span class="fc" id="L195">        map.put(&quot;Alg.Alias.MessageDigest.OID.2.16.840.1.101.3.4.2.3&quot;,</span>
                &quot;SHA-512&quot;);

        /*
         * Algorithm Parameter Generator engines
         */
<span class="fc" id="L201">        map.put(&quot;AlgorithmParameterGenerator.DSA&quot;,</span>
            &quot;sun.security.provider.DSAParameterGenerator&quot;);

        /*
         * Algorithm Parameter engines
         */
<span class="fc" id="L207">        map.put(&quot;AlgorithmParameters.DSA&quot;,</span>
            &quot;sun.security.provider.DSAParameters&quot;);
<span class="fc" id="L209">        map.put(&quot;Alg.Alias.AlgorithmParameters.OID.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L210">        map.put(&quot;Alg.Alias.AlgorithmParameters.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L211">        map.put(&quot;Alg.Alias.AlgorithmParameters.1.3.14.3.2.12&quot;, &quot;DSA&quot;);</span>

        /*
         * Key factories
         */
<span class="fc" id="L216">        map.put(&quot;KeyFactory.DSA&quot;, &quot;sun.security.provider.DSAKeyFactory&quot;);</span>
<span class="fc" id="L217">        map.put(&quot;Alg.Alias.KeyFactory.OID.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L218">        map.put(&quot;Alg.Alias.KeyFactory.1.2.840.10040.4.1&quot;, &quot;DSA&quot;);</span>
<span class="fc" id="L219">        map.put(&quot;Alg.Alias.KeyFactory.1.3.14.3.2.12&quot;, &quot;DSA&quot;);</span>

        /*
         * Certificates
         */
<span class="fc" id="L224">        map.put(&quot;CertificateFactory.X.509&quot;,</span>
            &quot;sun.security.provider.X509Factory&quot;);
<span class="fc" id="L226">        map.put(&quot;Alg.Alias.CertificateFactory.X509&quot;, &quot;X.509&quot;);</span>

        /*
         * KeyStore
         */
<span class="fc" id="L231">        map.put(&quot;KeyStore.JKS&quot;, &quot;sun.security.provider.JavaKeyStore$JKS&quot;);</span>
<span class="fc" id="L232">        map.put(&quot;KeyStore.CaseExactJKS&quot;,</span>
                        &quot;sun.security.provider.JavaKeyStore$CaseExactJKS&quot;);
<span class="fc" id="L234">        map.put(&quot;KeyStore.DKS&quot;, &quot;sun.security.provider.DomainKeyStore$DKS&quot;);</span>

        /*
         * Policy
         */
<span class="fc" id="L239">        map.put(&quot;Policy.JavaPolicy&quot;, &quot;sun.security.provider.PolicySpiFile&quot;);</span>

        /*
         * Configuration
         */
<span class="fc" id="L244">        map.put(&quot;Configuration.JavaLoginConfig&quot;,</span>
                        &quot;sun.security.provider.ConfigFile$Spi&quot;);

        /*
         * CertPathBuilder
         */
<span class="fc" id="L250">        map.put(&quot;CertPathBuilder.PKIX&quot;,</span>
            &quot;sun.security.provider.certpath.SunCertPathBuilder&quot;);
<span class="fc" id="L252">        map.put(&quot;CertPathBuilder.PKIX ValidationAlgorithm&quot;,</span>
            &quot;RFC3280&quot;);

        /*
         * CertPathValidator
         */
<span class="fc" id="L258">        map.put(&quot;CertPathValidator.PKIX&quot;,</span>
            &quot;sun.security.provider.certpath.PKIXCertPathValidator&quot;);
<span class="fc" id="L260">        map.put(&quot;CertPathValidator.PKIX ValidationAlgorithm&quot;,</span>
            &quot;RFC3280&quot;);

        /*
         * CertStores
         */
<span class="fc" id="L266">        map.put(&quot;CertStore.LDAP&quot;,</span>
            &quot;sun.security.provider.certpath.ldap.LDAPCertStore&quot;);
<span class="fc" id="L268">        map.put(&quot;CertStore.LDAP LDAPSchema&quot;, &quot;RFC2587&quot;);</span>
<span class="fc" id="L269">        map.put(&quot;CertStore.Collection&quot;,</span>
            &quot;sun.security.provider.certpath.CollectionCertStore&quot;);
<span class="fc" id="L271">        map.put(&quot;CertStore.com.sun.security.IndexedCollection&quot;,</span>
            &quot;sun.security.provider.certpath.IndexedCollectionCertStore&quot;);

        /*
         * KeySize
         */
<span class="fc" id="L277">        map.put(&quot;Signature.NONEwithDSA KeySize&quot;, &quot;1024&quot;);</span>
<span class="fc" id="L278">        map.put(&quot;Signature.SHA1withDSA KeySize&quot;, &quot;1024&quot;);</span>
<span class="fc" id="L279">        map.put(&quot;Signature.SHA224withDSA KeySize&quot;, &quot;2048&quot;);</span>
<span class="fc" id="L280">        map.put(&quot;Signature.SHA256withDSA KeySize&quot;, &quot;2048&quot;);</span>

<span class="fc" id="L282">        map.put(&quot;KeyPairGenerator.DSA KeySize&quot;, &quot;2048&quot;);</span>
<span class="fc" id="L283">        map.put(&quot;AlgorithmParameterGenerator.DSA KeySize&quot;, &quot;2048&quot;);</span>

        /*
         * Implementation type: software or hardware
         */
<span class="fc" id="L288">        map.put(&quot;Signature.SHA1withDSA ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L289">        map.put(&quot;KeyPairGenerator.DSA ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L290">        map.put(&quot;MessageDigest.MD5 ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L291">        map.put(&quot;MessageDigest.SHA ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L292">        map.put(&quot;AlgorithmParameterGenerator.DSA ImplementedIn&quot;,</span>
            &quot;Software&quot;);
<span class="fc" id="L294">        map.put(&quot;AlgorithmParameters.DSA ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L295">        map.put(&quot;KeyFactory.DSA ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L296">        map.put(&quot;SecureRandom.SHA1PRNG ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L297">        map.put(&quot;CertificateFactory.X.509 ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L298">        map.put(&quot;KeyStore.JKS ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L299">        map.put(&quot;CertPathValidator.PKIX ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L300">        map.put(&quot;CertPathBuilder.PKIX ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L301">        map.put(&quot;CertStore.LDAP ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L302">        map.put(&quot;CertStore.Collection ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="fc" id="L303">        map.put(&quot;CertStore.com.sun.security.IndexedCollection ImplementedIn&quot;,</span>
            &quot;Software&quot;);

<span class="fc" id="L306">    }</span>

    // name of the *System* property, takes precedence over PROP_RNDSOURCE
    private final static String PROP_EGD = &quot;java.security.egd&quot;;
    // name of the *Security* property
    private final static String PROP_RNDSOURCE = &quot;securerandom.source&quot;;

    final static String URL_DEV_RANDOM = &quot;file:/dev/random&quot;;
    final static String URL_DEV_URANDOM = &quot;file:/dev/urandom&quot;;

    private static final String seedSource;

    static {
<span class="fc" id="L319">        seedSource = AccessController.doPrivileged(</span>
<span class="fc" id="L320">                new PrivilegedAction&lt;String&gt;() {</span>

            @Override
            public String run() {
<span class="fc" id="L324">                String egdSource = System.getProperty(PROP_EGD, &quot;&quot;);</span>
<span class="fc bfc" id="L325" title="All 2 branches covered.">                if (egdSource.length() != 0) {</span>
<span class="fc" id="L326">                    return egdSource;</span>
                }
<span class="fc" id="L328">                egdSource = Security.getProperty(PROP_RNDSOURCE);</span>
<span class="pc bpc" id="L329" title="1 of 2 branches missed.">                if (egdSource == null) {</span>
<span class="nc" id="L330">                    return &quot;&quot;;</span>
                }
<span class="fc" id="L332">                return egdSource;</span>
            }
        });
<span class="fc" id="L335">    }</span>

    static String getSeedSource() {
<span class="fc" id="L338">        return seedSource;</span>
    }

    /*
     * Use a URI to access this File. Previous code used a URL
     * which is less strict on syntax. If we encounter a
     * URISyntaxException we make best efforts for backwards
     * compatibility. e.g. space character in deviceName string.
     *
     * Method called within PrivilegedExceptionAction block.
     *
     * Moved from SeedGenerator to avoid initialization problems with
     * signed providers.
     */
    static File getDeviceFile(URL device) throws IOException {
        try {
<span class="fc" id="L354">            URI deviceURI = device.toURI();</span>
<span class="fc bfc" id="L355" title="All 2 branches covered.">            if(deviceURI.isOpaque()) {</span>
                // File constructor does not accept opaque URI
<span class="fc" id="L357">                URI localDir = new File(</span>
<span class="fc" id="L358">                    System.getProperty(&quot;user.dir&quot;)).toURI();</span>
<span class="fc" id="L359">                String uriPath = localDir.toString() +</span>
<span class="fc" id="L360">                                     deviceURI.toString().substring(5);</span>
<span class="fc" id="L361">                return new File(URI.create(uriPath));</span>
            } else {
<span class="fc" id="L363">                return new File(deviceURI);</span>
            }
<span class="nc" id="L365">        } catch (URISyntaxException use) {</span>
            /*
             * Make best effort to access this File.
             * We can try using the URL path.
             */
<span class="nc" id="L370">            return new File(device.getPath());</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>