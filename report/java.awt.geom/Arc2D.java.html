<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Arc2D.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">java.awt.geom</a> &gt; <span class="el_source">Arc2D.java</span></div><h1>Arc2D.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2006, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package java.awt.geom;

import java.io.Serializable;

/**
 * &lt;CODE&gt;Arc2D&lt;/CODE&gt; is the abstract superclass for all objects that
 * store a 2D arc defined by a framing rectangle,
 * start angle, angular extent (length of the arc), and a closure type
 * (&lt;CODE&gt;OPEN&lt;/CODE&gt;, &lt;CODE&gt;CHORD&lt;/CODE&gt;, or &lt;CODE&gt;PIE&lt;/CODE&gt;).
 * &lt;p&gt;
 * &lt;a name=&quot;inscribes&quot;&gt;
 * The arc is a partial section of a full ellipse which
 * inscribes the framing rectangle of its parent {@link RectangularShape}.
 * &lt;/a&gt;
 * &lt;a name=&quot;angles&quot;&gt;
 * The angles are specified relative to the non-square
 * framing rectangle such that 45 degrees always falls on the line from
 * the center of the ellipse to the upper right corner of the framing
 * rectangle.
 * As a result, if the framing rectangle is noticeably longer along one
 * axis than the other, the angles to the start and end of the arc segment
 * will be skewed farther along the longer axis of the frame.
 * &lt;/a&gt;
 * &lt;p&gt;
 * The actual storage representation of the coordinates is left to
 * the subclass.
 *
 * @author      Jim Graham
 * @since 1.2
 */
public abstract class Arc2D extends RectangularShape {

    /**
     * The closure type for an open arc with no path segments
     * connecting the two ends of the arc segment.
     * @since 1.2
     */
    public final static int OPEN = 0;

    /**
     * The closure type for an arc closed by drawing a straight
     * line segment from the start of the arc segment to the end of the
     * arc segment.
     * @since 1.2
     */
    public final static int CHORD = 1;

    /**
     * The closure type for an arc closed by drawing straight line
     * segments from the start of the arc segment to the center
     * of the full ellipse and from that point to the end of the arc segment.
     * @since 1.2
     */
    public final static int PIE = 2;

    /**
     * This class defines an arc specified in {@code float} precision.
     * @since 1.2
     */
    public static class Float extends Arc2D implements Serializable {
        /**
         * The X coordinate of the upper-left corner of the framing
         * rectangle of the arc.
         * @since 1.2
         * @serial
         */
        public float x;

        /**
         * The Y coordinate of the upper-left corner of the framing
         * rectangle of the arc.
         * @since 1.2
         * @serial
         */
        public float y;

        /**
         * The overall width of the full ellipse of which this arc is
         * a partial section (not considering the
         * angular extents).
         * @since 1.2
         * @serial
         */
        public float width;

        /**
         * The overall height of the full ellipse of which this arc is
         * a partial section (not considering the
         * angular extents).
         * @since 1.2
         * @serial
         */
        public float height;

        /**
         * The starting angle of the arc in degrees.
         * @since 1.2
         * @serial
         */
        public float start;

        /**
         * The angular extent of the arc in degrees.
         * @since 1.2
         * @serial
         */
        public float extent;

        /**
         * Constructs a new OPEN arc, initialized to location (0, 0),
         * size (0, 0), angular extents (start = 0, extent = 0).
         * @since 1.2
         */
        public Float() {
<span class="nc" id="L140">            super(OPEN);</span>
<span class="nc" id="L141">        }</span>

        /**
         * Constructs a new arc, initialized to location (0, 0),
         * size (0, 0), angular extents (start = 0, extent = 0), and
         * the specified closure type.
         *
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Float(int type) {
<span class="nc" id="L153">            super(type);</span>
<span class="nc" id="L154">        }</span>

        /**
         * Constructs a new arc, initialized to the specified location,
         * size, angular extents, and closure type.
         *
         * @param x The X coordinate of the upper-left corner of
         *          the arc's framing rectangle.
         * @param y The Y coordinate of the upper-left corner of
         *          the arc's framing rectangle.
         * @param w The overall width of the full ellipse of which
         *          this arc is a partial section.
         * @param h The overall height of the full ellipse of which this
         *          arc is a partial section.
         * @param start The starting angle of the arc in degrees.
         * @param extent The angular extent of the arc in degrees.
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Float(float x, float y, float w, float h,
                     float start, float extent, int type) {
<span class="nc" id="L176">            super(type);</span>
<span class="nc" id="L177">            this.x = x;</span>
<span class="nc" id="L178">            this.y = y;</span>
<span class="nc" id="L179">            this.width = w;</span>
<span class="nc" id="L180">            this.height = h;</span>
<span class="nc" id="L181">            this.start = start;</span>
<span class="nc" id="L182">            this.extent = extent;</span>
<span class="nc" id="L183">        }</span>

        /**
         * Constructs a new arc, initialized to the specified location,
         * size, angular extents, and closure type.
         *
         * @param ellipseBounds The framing rectangle that defines the
         * outer boundary of the full ellipse of which this arc is a
         * partial section.
         * @param start The starting angle of the arc in degrees.
         * @param extent The angular extent of the arc in degrees.
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Float(Rectangle2D ellipseBounds,
                     float start, float extent, int type) {
<span class="nc" id="L200">            super(type);</span>
<span class="nc" id="L201">            this.x = (float) ellipseBounds.getX();</span>
<span class="nc" id="L202">            this.y = (float) ellipseBounds.getY();</span>
<span class="nc" id="L203">            this.width = (float) ellipseBounds.getWidth();</span>
<span class="nc" id="L204">            this.height = (float) ellipseBounds.getHeight();</span>
<span class="nc" id="L205">            this.start = start;</span>
<span class="nc" id="L206">            this.extent = extent;</span>
<span class="nc" id="L207">        }</span>

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getX() {
<span class="nc" id="L218">            return (double) x;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getY() {
<span class="nc" id="L230">            return (double) y;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getWidth() {
<span class="nc" id="L242">            return (double) width;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getHeight() {
<span class="nc" id="L254">            return (double) height;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public double getAngleStart() {
<span class="nc" id="L262">            return (double) start;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public double getAngleExtent() {
<span class="nc" id="L270">            return (double) extent;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public boolean isEmpty() {
<span class="nc bnc" id="L278" title="All 4 branches missed.">            return (width &lt;= 0.0 || height &lt;= 0.0);</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setArc(double x, double y, double w, double h,
                           double angSt, double angExt, int closure) {
<span class="nc" id="L287">            this.setArcType(closure);</span>
<span class="nc" id="L288">            this.x = (float) x;</span>
<span class="nc" id="L289">            this.y = (float) y;</span>
<span class="nc" id="L290">            this.width = (float) w;</span>
<span class="nc" id="L291">            this.height = (float) h;</span>
<span class="nc" id="L292">            this.start = (float) angSt;</span>
<span class="nc" id="L293">            this.extent = (float) angExt;</span>
<span class="nc" id="L294">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setAngleStart(double angSt) {
<span class="nc" id="L301">            this.start = (float) angSt;</span>
<span class="nc" id="L302">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setAngleExtent(double angExt) {
<span class="nc" id="L309">            this.extent = (float) angExt;</span>
<span class="nc" id="L310">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        protected Rectangle2D makeBounds(double x, double y,
                                         double w, double h) {
<span class="nc" id="L318">            return new Rectangle2D.Float((float) x, (float) y,</span>
                                         (float) w, (float) h);
        }

        /*
         * JDK 1.6 serialVersionUID
         */
        private static final long serialVersionUID = 9130893014586380278L;

        /**
         * Writes the default serializable fields to the
         * &lt;code&gt;ObjectOutputStream&lt;/code&gt; followed by a byte
         * indicating the arc type of this &lt;code&gt;Arc2D&lt;/code&gt;
         * instance.
         *
         * @serialData
         * &lt;ol&gt;
         * &lt;li&gt;The default serializable fields.
         * &lt;li&gt;
         * followed by a &lt;code&gt;byte&lt;/code&gt; indicating the arc type
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * &lt;/ol&gt;
         */
        private void writeObject(java.io.ObjectOutputStream s)
            throws java.io.IOException
        {
<span class="nc" id="L344">            s.defaultWriteObject();</span>

<span class="nc" id="L346">            s.writeByte(getArcType());</span>
<span class="nc" id="L347">        }</span>

        /**
         * Reads the default serializable fields from the
         * &lt;code&gt;ObjectInputStream&lt;/code&gt; followed by a byte
         * indicating the arc type of this &lt;code&gt;Arc2D&lt;/code&gt;
         * instance.
         *
         * @serialData
         * &lt;ol&gt;
         * &lt;li&gt;The default serializable fields.
         * &lt;li&gt;
         * followed by a &lt;code&gt;byte&lt;/code&gt; indicating the arc type
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * &lt;/ol&gt;
         */
        private void readObject(java.io.ObjectInputStream s)
            throws java.lang.ClassNotFoundException, java.io.IOException
        {
<span class="nc" id="L366">            s.defaultReadObject();</span>

            try {
<span class="nc" id="L369">                setArcType(s.readByte());</span>
<span class="nc" id="L370">            } catch (IllegalArgumentException iae) {</span>
<span class="nc" id="L371">                throw new java.io.InvalidObjectException(iae.getMessage());</span>
<span class="nc" id="L372">            }</span>
<span class="nc" id="L373">        }</span>
    }

    /**
     * This class defines an arc specified in {@code double} precision.
     * @since 1.2
     */
    public static class Double extends Arc2D implements Serializable {
        /**
         * The X coordinate of the upper-left corner of the framing
         * rectangle of the arc.
         * @since 1.2
         * @serial
         */
        public double x;

        /**
         * The Y coordinate of the upper-left corner of the framing
         * rectangle of the arc.
         * @since 1.2
         * @serial
         */
        public double y;

        /**
         * The overall width of the full ellipse of which this arc is
         * a partial section (not considering the angular extents).
         * @since 1.2
         * @serial
         */
        public double width;

        /**
         * The overall height of the full ellipse of which this arc is
         * a partial section (not considering the angular extents).
         * @since 1.2
         * @serial
         */
        public double height;

        /**
         * The starting angle of the arc in degrees.
         * @since 1.2
         * @serial
         */
        public double start;

        /**
         * The angular extent of the arc in degrees.
         * @since 1.2
         * @serial
         */
        public double extent;

        /**
         * Constructs a new OPEN arc, initialized to location (0, 0),
         * size (0, 0), angular extents (start = 0, extent = 0).
         * @since 1.2
         */
        public Double() {
<span class="nc" id="L433">            super(OPEN);</span>
<span class="nc" id="L434">        }</span>

        /**
         * Constructs a new arc, initialized to location (0, 0),
         * size (0, 0), angular extents (start = 0, extent = 0), and
         * the specified closure type.
         *
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Double(int type) {
<span class="nc" id="L446">            super(type);</span>
<span class="nc" id="L447">        }</span>

        /**
         * Constructs a new arc, initialized to the specified location,
         * size, angular extents, and closure type.
         *
         * @param x The X coordinate of the upper-left corner
         *          of the arc's framing rectangle.
         * @param y The Y coordinate of the upper-left corner
         *          of the arc's framing rectangle.
         * @param w The overall width of the full ellipse of which this
         *          arc is a partial section.
         * @param h The overall height of the full ellipse of which this
         *          arc is a partial section.
         * @param start The starting angle of the arc in degrees.
         * @param extent The angular extent of the arc in degrees.
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Double(double x, double y, double w, double h,
                      double start, double extent, int type) {
<span class="nc" id="L469">            super(type);</span>
<span class="nc" id="L470">            this.x = x;</span>
<span class="nc" id="L471">            this.y = y;</span>
<span class="nc" id="L472">            this.width = w;</span>
<span class="nc" id="L473">            this.height = h;</span>
<span class="nc" id="L474">            this.start = start;</span>
<span class="nc" id="L475">            this.extent = extent;</span>
<span class="nc" id="L476">        }</span>

        /**
         * Constructs a new arc, initialized to the specified location,
         * size, angular extents, and closure type.
         *
         * @param ellipseBounds The framing rectangle that defines the
         * outer boundary of the full ellipse of which this arc is a
         * partial section.
         * @param start The starting angle of the arc in degrees.
         * @param extent The angular extent of the arc in degrees.
         * @param type The closure type for the arc:
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * @since 1.2
         */
        public Double(Rectangle2D ellipseBounds,
                      double start, double extent, int type) {
<span class="nc" id="L493">            super(type);</span>
<span class="nc" id="L494">            this.x = ellipseBounds.getX();</span>
<span class="nc" id="L495">            this.y = ellipseBounds.getY();</span>
<span class="nc" id="L496">            this.width = ellipseBounds.getWidth();</span>
<span class="nc" id="L497">            this.height = ellipseBounds.getHeight();</span>
<span class="nc" id="L498">            this.start = start;</span>
<span class="nc" id="L499">            this.extent = extent;</span>
<span class="nc" id="L500">        }</span>

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getX() {
<span class="nc" id="L511">            return x;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getY() {
<span class="nc" id="L523">            return y;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getWidth() {
<span class="nc" id="L535">            return width;</span>
        }

        /**
         * {@inheritDoc}
         * Note that the arc
         * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
         * the framing rectangle of this {@code RectangularShape}.
         *
         * @since 1.2
         */
        public double getHeight() {
<span class="nc" id="L547">            return height;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public double getAngleStart() {
<span class="nc" id="L555">            return start;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public double getAngleExtent() {
<span class="nc" id="L563">            return extent;</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public boolean isEmpty() {
<span class="nc bnc" id="L571" title="All 4 branches missed.">            return (width &lt;= 0.0 || height &lt;= 0.0);</span>
        }

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setArc(double x, double y, double w, double h,
                           double angSt, double angExt, int closure) {
<span class="nc" id="L580">            this.setArcType(closure);</span>
<span class="nc" id="L581">            this.x = x;</span>
<span class="nc" id="L582">            this.y = y;</span>
<span class="nc" id="L583">            this.width = w;</span>
<span class="nc" id="L584">            this.height = h;</span>
<span class="nc" id="L585">            this.start = angSt;</span>
<span class="nc" id="L586">            this.extent = angExt;</span>
<span class="nc" id="L587">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setAngleStart(double angSt) {
<span class="nc" id="L594">            this.start = angSt;</span>
<span class="nc" id="L595">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        public void setAngleExtent(double angExt) {
<span class="nc" id="L602">            this.extent = angExt;</span>
<span class="nc" id="L603">        }</span>

        /**
         * {@inheritDoc}
         * @since 1.2
         */
        protected Rectangle2D makeBounds(double x, double y,
                                         double w, double h) {
<span class="nc" id="L611">            return new Rectangle2D.Double(x, y, w, h);</span>
        }

        /*
         * JDK 1.6 serialVersionUID
         */
        private static final long serialVersionUID = 728264085846882001L;

        /**
         * Writes the default serializable fields to the
         * &lt;code&gt;ObjectOutputStream&lt;/code&gt; followed by a byte
         * indicating the arc type of this &lt;code&gt;Arc2D&lt;/code&gt;
         * instance.
         *
         * @serialData
         * &lt;ol&gt;
         * &lt;li&gt;The default serializable fields.
         * &lt;li&gt;
         * followed by a &lt;code&gt;byte&lt;/code&gt; indicating the arc type
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * &lt;/ol&gt;
         */
        private void writeObject(java.io.ObjectOutputStream s)
            throws java.io.IOException
        {
<span class="nc" id="L636">            s.defaultWriteObject();</span>

<span class="nc" id="L638">            s.writeByte(getArcType());</span>
<span class="nc" id="L639">        }</span>

        /**
         * Reads the default serializable fields from the
         * &lt;code&gt;ObjectInputStream&lt;/code&gt; followed by a byte
         * indicating the arc type of this &lt;code&gt;Arc2D&lt;/code&gt;
         * instance.
         *
         * @serialData
         * &lt;ol&gt;
         * &lt;li&gt;The default serializable fields.
         * &lt;li&gt;
         * followed by a &lt;code&gt;byte&lt;/code&gt; indicating the arc type
         * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
         * &lt;/ol&gt;
         */
        private void readObject(java.io.ObjectInputStream s)
            throws java.lang.ClassNotFoundException, java.io.IOException
        {
<span class="nc" id="L658">            s.defaultReadObject();</span>

            try {
<span class="nc" id="L661">                setArcType(s.readByte());</span>
<span class="nc" id="L662">            } catch (IllegalArgumentException iae) {</span>
<span class="nc" id="L663">                throw new java.io.InvalidObjectException(iae.getMessage());</span>
<span class="nc" id="L664">            }</span>
<span class="nc" id="L665">        }</span>
    }

    private int type;

    /**
     * This is an abstract class that cannot be instantiated directly.
     * Type-specific implementation subclasses are available for
     * instantiation and provide a number of formats for storing
     * the information necessary to satisfy the various accessor
     * methods below.
     * &lt;p&gt;
     * This constructor creates an object with a default closure
     * type of {@link #OPEN}.  It is provided only to enable
     * serialization of subclasses.
     *
     * @see java.awt.geom.Arc2D.Float
     * @see java.awt.geom.Arc2D.Double
     */
    protected Arc2D() {
<span class="nc" id="L685">        this(OPEN);</span>
<span class="nc" id="L686">    }</span>

    /**
     * This is an abstract class that cannot be instantiated directly.
     * Type-specific implementation subclasses are available for
     * instantiation and provide a number of formats for storing
     * the information necessary to satisfy the various accessor
     * methods below.
     *
     * @param type The closure type of this arc:
     * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
     * @see java.awt.geom.Arc2D.Float
     * @see java.awt.geom.Arc2D.Double
     * @since 1.2
     */
<span class="nc" id="L701">    protected Arc2D(int type) {</span>
<span class="nc" id="L702">        setArcType(type);</span>
<span class="nc" id="L703">    }</span>

    /**
     * Returns the starting angle of the arc.
     *
     * @return A double value that represents the starting angle
     * of the arc in degrees.
     * @see #setAngleStart
     * @since 1.2
     */
    public abstract double getAngleStart();

    /**
     * Returns the angular extent of the arc.
     *
     * @return A double value that represents the angular extent
     * of the arc in degrees.
     * @see #setAngleExtent
     * @since 1.2
     */
    public abstract double getAngleExtent();

    /**
     * Returns the arc closure type of the arc: {@link #OPEN},
     * {@link #CHORD}, or {@link #PIE}.
     * @return One of the integer constant closure types defined
     * in this class.
     * @see #setArcType
     * @since 1.2
     */
    public int getArcType() {
<span class="nc" id="L734">        return type;</span>
    }

    /**
     * Returns the starting point of the arc.  This point is the
     * intersection of the ray from the center defined by the
     * starting angle and the elliptical boundary of the arc.
     *
     * @return A &lt;CODE&gt;Point2D&lt;/CODE&gt; object representing the
     * x,y coordinates of the starting point of the arc.
     * @since 1.2
     */
    public Point2D getStartPoint() {
<span class="nc" id="L747">        double angle = Math.toRadians(-getAngleStart());</span>
<span class="nc" id="L748">        double x = getX() + (Math.cos(angle) * 0.5 + 0.5) * getWidth();</span>
<span class="nc" id="L749">        double y = getY() + (Math.sin(angle) * 0.5 + 0.5) * getHeight();</span>
<span class="nc" id="L750">        return new Point2D.Double(x, y);</span>
    }

    /**
     * Returns the ending point of the arc.  This point is the
     * intersection of the ray from the center defined by the
     * starting angle plus the angular extent of the arc and the
     * elliptical boundary of the arc.
     *
     * @return A &lt;CODE&gt;Point2D&lt;/CODE&gt; object representing the
     * x,y coordinates  of the ending point of the arc.
     * @since 1.2
     */
    public Point2D getEndPoint() {
<span class="nc" id="L764">        double angle = Math.toRadians(-getAngleStart() - getAngleExtent());</span>
<span class="nc" id="L765">        double x = getX() + (Math.cos(angle) * 0.5 + 0.5) * getWidth();</span>
<span class="nc" id="L766">        double y = getY() + (Math.sin(angle) * 0.5 + 0.5) * getHeight();</span>
<span class="nc" id="L767">        return new Point2D.Double(x, y);</span>
    }

    /**
     * Sets the location, size, angular extents, and closure type of
     * this arc to the specified double values.
     *
     * @param x The X coordinate of the upper-left corner of the arc.
     * @param y The Y coordinate of the upper-left corner of the arc.
     * @param w The overall width of the full ellipse of which
     *          this arc is a partial section.
     * @param h The overall height of the full ellipse of which
     *          this arc is a partial section.
     * @param angSt The starting angle of the arc in degrees.
     * @param angExt The angular extent of the arc in degrees.
     * @param closure The closure type for the arc:
     * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
     * @since 1.2
     */
    public abstract void setArc(double x, double y, double w, double h,
                                double angSt, double angExt, int closure);

    /**
     * Sets the location, size, angular extents, and closure type of
     * this arc to the specified values.
     *
     * @param loc The &lt;CODE&gt;Point2D&lt;/CODE&gt; representing the coordinates of
     * the upper-left corner of the arc.
     * @param size The &lt;CODE&gt;Dimension2D&lt;/CODE&gt; representing the width
     * and height of the full ellipse of which this arc is
     * a partial section.
     * @param angSt The starting angle of the arc in degrees.
     * @param angExt The angular extent of the arc in degrees.
     * @param closure The closure type for the arc:
     * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
     * @since 1.2
     */
    public void setArc(Point2D loc, Dimension2D size,
                       double angSt, double angExt, int closure) {
<span class="nc" id="L806">        setArc(loc.getX(), loc.getY(), size.getWidth(), size.getHeight(),</span>
               angSt, angExt, closure);
<span class="nc" id="L808">    }</span>

    /**
     * Sets the location, size, angular extents, and closure type of
     * this arc to the specified values.
     *
     * @param rect The framing rectangle that defines the
     * outer boundary of the full ellipse of which this arc is a
     * partial section.
     * @param angSt The starting angle of the arc in degrees.
     * @param angExt The angular extent of the arc in degrees.
     * @param closure The closure type for the arc:
     * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
     * @since 1.2
     */
    public void setArc(Rectangle2D rect, double angSt, double angExt,
                       int closure) {
<span class="nc" id="L825">        setArc(rect.getX(), rect.getY(), rect.getWidth(), rect.getHeight(),</span>
               angSt, angExt, closure);
<span class="nc" id="L827">    }</span>

    /**
     * Sets this arc to be the same as the specified arc.
     *
     * @param a The &lt;CODE&gt;Arc2D&lt;/CODE&gt; to use to set the arc's values.
     * @since 1.2
     */
    public void setArc(Arc2D a) {
<span class="nc" id="L836">        setArc(a.getX(), a.getY(), a.getWidth(), a.getHeight(),</span>
<span class="nc" id="L837">               a.getAngleStart(), a.getAngleExtent(), a.type);</span>
<span class="nc" id="L838">    }</span>

    /**
     * Sets the position, bounds, angular extents, and closure type of
     * this arc to the specified values. The arc is defined by a center
     * point and a radius rather than a framing rectangle for the full ellipse.
     *
     * @param x The X coordinate of the center of the arc.
     * @param y The Y coordinate of the center of the arc.
     * @param radius The radius of the arc.
     * @param angSt The starting angle of the arc in degrees.
     * @param angExt The angular extent of the arc in degrees.
     * @param closure The closure type for the arc:
     * {@link #OPEN}, {@link #CHORD}, or {@link #PIE}.
     * @since 1.2
     */
    public void setArcByCenter(double x, double y, double radius,
                               double angSt, double angExt, int closure) {
<span class="nc" id="L856">        setArc(x - radius, y - radius, radius * 2.0, radius * 2.0,</span>
               angSt, angExt, closure);
<span class="nc" id="L858">    }</span>

    /**
     * Sets the position, bounds, and angular extents of this arc to the
     * specified value. The starting angle of the arc is tangent to the
     * line specified by points (p1, p2), the ending angle is tangent to
     * the line specified by points (p2, p3), and the arc has the
     * specified radius.
     *
     * @param p1 The first point that defines the arc. The starting
     * angle of the arc is tangent to the line specified by points (p1, p2).
     * @param p2 The second point that defines the arc. The starting
     * angle of the arc is tangent to the line specified by points (p1, p2).
     * The ending angle of the arc is tangent to the line specified by
     * points (p2, p3).
     * @param p3 The third point that defines the arc. The ending angle
     * of the arc is tangent to the line specified by points (p2, p3).
     * @param radius The radius of the arc.
     * @since 1.2
     */
    public void setArcByTangent(Point2D p1, Point2D p2, Point2D p3,
                                double radius) {
<span class="nc" id="L880">        double ang1 = Math.atan2(p1.getY() - p2.getY(),</span>
<span class="nc" id="L881">                                 p1.getX() - p2.getX());</span>
<span class="nc" id="L882">        double ang2 = Math.atan2(p3.getY() - p2.getY(),</span>
<span class="nc" id="L883">                                 p3.getX() - p2.getX());</span>
<span class="nc" id="L884">        double diff = ang2 - ang1;</span>
<span class="nc bnc" id="L885" title="All 2 branches missed.">        if (diff &gt; Math.PI) {</span>
<span class="nc" id="L886">            ang2 -= Math.PI * 2.0;</span>
<span class="nc bnc" id="L887" title="All 2 branches missed.">        } else if (diff &lt; -Math.PI) {</span>
<span class="nc" id="L888">            ang2 += Math.PI * 2.0;</span>
        }
<span class="nc" id="L890">        double bisect = (ang1 + ang2) / 2.0;</span>
<span class="nc" id="L891">        double theta = Math.abs(ang2 - bisect);</span>
<span class="nc" id="L892">        double dist = radius / Math.sin(theta);</span>
<span class="nc" id="L893">        double x = p2.getX() + dist * Math.cos(bisect);</span>
<span class="nc" id="L894">        double y = p2.getY() + dist * Math.sin(bisect);</span>
        // REMIND: This needs some work...
<span class="nc bnc" id="L896" title="All 2 branches missed.">        if (ang1 &lt; ang2) {</span>
<span class="nc" id="L897">            ang1 -= Math.PI / 2.0;</span>
<span class="nc" id="L898">            ang2 += Math.PI / 2.0;</span>
        } else {
<span class="nc" id="L900">            ang1 += Math.PI / 2.0;</span>
<span class="nc" id="L901">            ang2 -= Math.PI / 2.0;</span>
        }
<span class="nc" id="L903">        ang1 = Math.toDegrees(-ang1);</span>
<span class="nc" id="L904">        ang2 = Math.toDegrees(-ang2);</span>
<span class="nc" id="L905">        diff = ang2 - ang1;</span>
<span class="nc bnc" id="L906" title="All 2 branches missed.">        if (diff &lt; 0) {</span>
<span class="nc" id="L907">            diff += 360;</span>
        } else {
<span class="nc" id="L909">            diff -= 360;</span>
        }
<span class="nc" id="L911">        setArcByCenter(x, y, radius, ang1, diff, type);</span>
<span class="nc" id="L912">    }</span>

    /**
     * Sets the starting angle of this arc to the specified double
     * value.
     *
     * @param angSt The starting angle of the arc in degrees.
     * @see #getAngleStart
     * @since 1.2
     */
    public abstract void setAngleStart(double angSt);

    /**
     * Sets the angular extent of this arc to the specified double
     * value.
     *
     * @param angExt The angular extent of the arc in degrees.
     * @see #getAngleExtent
     * @since 1.2
     */
    public abstract void setAngleExtent(double angExt);

    /**
     * Sets the starting angle of this arc to the angle that the
     * specified point defines relative to the center of this arc.
     * The angular extent of the arc will remain the same.
     *
     * @param p The &lt;CODE&gt;Point2D&lt;/CODE&gt; that defines the starting angle.
     * @see #getAngleStart
     * @since 1.2
     */
    public void setAngleStart(Point2D p) {
        // Bias the dx and dy by the height and width of the oval.
<span class="nc" id="L945">        double dx = getHeight() * (p.getX() - getCenterX());</span>
<span class="nc" id="L946">        double dy = getWidth() * (p.getY() - getCenterY());</span>
<span class="nc" id="L947">        setAngleStart(-Math.toDegrees(Math.atan2(dy, dx)));</span>
<span class="nc" id="L948">    }</span>

    /**
     * Sets the starting angle and angular extent of this arc using two
     * sets of coordinates. The first set of coordinates is used to
     * determine the angle of the starting point relative to the arc's
     * center. The second set of coordinates is used to determine the
     * angle of the end point relative to the arc's center.
     * The arc will always be non-empty and extend counterclockwise
     * from the first point around to the second point.
     *
     * @param x1 The X coordinate of the arc's starting point.
     * @param y1 The Y coordinate of the arc's starting point.
     * @param x2 The X coordinate of the arc's ending point.
     * @param y2 The Y coordinate of the arc's ending point.
     * @since 1.2
     */
    public void setAngles(double x1, double y1, double x2, double y2) {
<span class="nc" id="L966">        double x = getCenterX();</span>
<span class="nc" id="L967">        double y = getCenterY();</span>
<span class="nc" id="L968">        double w = getWidth();</span>
<span class="nc" id="L969">        double h = getHeight();</span>
        // Note: reversing the Y equations negates the angle to adjust
        // for the upside down coordinate system.
        // Also we should bias atans by the height and width of the oval.
<span class="nc" id="L973">        double ang1 = Math.atan2(w * (y - y1), h * (x1 - x));</span>
<span class="nc" id="L974">        double ang2 = Math.atan2(w * (y - y2), h * (x2 - x));</span>
<span class="nc" id="L975">        ang2 -= ang1;</span>
<span class="nc bnc" id="L976" title="All 2 branches missed.">        if (ang2 &lt;= 0.0) {</span>
<span class="nc" id="L977">            ang2 += Math.PI * 2.0;</span>
        }
<span class="nc" id="L979">        setAngleStart(Math.toDegrees(ang1));</span>
<span class="nc" id="L980">        setAngleExtent(Math.toDegrees(ang2));</span>
<span class="nc" id="L981">    }</span>

    /**
     * Sets the starting angle and angular extent of this arc using
     * two points. The first point is used to determine the angle of
     * the starting point relative to the arc's center.
     * The second point is used to determine the angle of the end point
     * relative to the arc's center.
     * The arc will always be non-empty and extend counterclockwise
     * from the first point around to the second point.
     *
     * @param p1 The &lt;CODE&gt;Point2D&lt;/CODE&gt; that defines the arc's
     * starting point.
     * @param p2 The &lt;CODE&gt;Point2D&lt;/CODE&gt; that defines the arc's
     * ending point.
     * @since 1.2
     */
    public void setAngles(Point2D p1, Point2D p2) {
<span class="nc" id="L999">        setAngles(p1.getX(), p1.getY(), p2.getX(), p2.getY());</span>
<span class="nc" id="L1000">    }</span>

    /**
     * Sets the closure type of this arc to the specified value:
     * &lt;CODE&gt;OPEN&lt;/CODE&gt;, &lt;CODE&gt;CHORD&lt;/CODE&gt;, or &lt;CODE&gt;PIE&lt;/CODE&gt;.
     *
     * @param type The integer constant that represents the closure
     * type of this arc: {@link #OPEN}, {@link #CHORD}, or
     * {@link #PIE}.
     *
     * @throws IllegalArgumentException if &lt;code&gt;type&lt;/code&gt; is not
     * 0, 1, or 2.+
     * @see #getArcType
     * @since 1.2
     */
    public void setArcType(int type) {
<span class="nc bnc" id="L1016" title="All 4 branches missed.">        if (type &lt; OPEN || type &gt; PIE) {</span>
<span class="nc" id="L1017">            throw new IllegalArgumentException(&quot;invalid type for Arc: &quot;+type);</span>
        }
<span class="nc" id="L1019">        this.type = type;</span>
<span class="nc" id="L1020">    }</span>

    /**
     * {@inheritDoc}
     * Note that the arc
     * &lt;a href=&quot;Arc2D.html#inscribes&quot;&gt;partially inscribes&lt;/a&gt;
     * the framing rectangle of this {@code RectangularShape}.
     *
     * @since 1.2
     */
    public void setFrame(double x, double y, double w, double h) {
<span class="nc" id="L1031">        setArc(x, y, w, h, getAngleStart(), getAngleExtent(), type);</span>
<span class="nc" id="L1032">    }</span>

    /**
     * Returns the high-precision framing rectangle of the arc.  The framing
     * rectangle contains only the part of this &lt;code&gt;Arc2D&lt;/code&gt; that is
     * in between the starting and ending angles and contains the pie
     * wedge, if this &lt;code&gt;Arc2D&lt;/code&gt; has a &lt;code&gt;PIE&lt;/code&gt; closure type.
     * &lt;p&gt;
     * This method differs from the
     * {@link RectangularShape#getBounds() getBounds} in that the
     * &lt;code&gt;getBounds&lt;/code&gt; method only returns the bounds of the
     * enclosing ellipse of this &lt;code&gt;Arc2D&lt;/code&gt; without considering
     * the starting and ending angles of this &lt;code&gt;Arc2D&lt;/code&gt;.
     *
     * @return the &lt;CODE&gt;Rectangle2D&lt;/CODE&gt; that represents the arc's
     * framing rectangle.
     * @since 1.2
     */
    public Rectangle2D getBounds2D() {
<span class="nc bnc" id="L1051" title="All 2 branches missed.">        if (isEmpty()) {</span>
<span class="nc" id="L1052">            return makeBounds(getX(), getY(), getWidth(), getHeight());</span>
        }
        double x1, y1, x2, y2;
<span class="nc bnc" id="L1055" title="All 2 branches missed.">        if (getArcType() == PIE) {</span>
<span class="nc" id="L1056">            x1 = y1 = x2 = y2 = 0.0;</span>
        } else {
<span class="nc" id="L1058">            x1 = y1 = 1.0;</span>
<span class="nc" id="L1059">            x2 = y2 = -1.0;</span>
        }
<span class="nc" id="L1061">        double angle = 0.0;</span>
<span class="nc bnc" id="L1062" title="All 2 branches missed.">        for (int i = 0; i &lt; 6; i++) {</span>
<span class="nc bnc" id="L1063" title="All 2 branches missed.">            if (i &lt; 4) {</span>
                // 0-3 are the four quadrants
<span class="nc" id="L1065">                angle += 90.0;</span>
<span class="nc bnc" id="L1066" title="All 2 branches missed.">                if (!containsAngle(angle)) {</span>
<span class="nc" id="L1067">                    continue;</span>
                }
<span class="nc bnc" id="L1069" title="All 2 branches missed.">            } else if (i == 4) {</span>
                // 4 is start angle
<span class="nc" id="L1071">                angle = getAngleStart();</span>
            } else {
                // 5 is end angle
<span class="nc" id="L1074">                angle += getAngleExtent();</span>
            }
<span class="nc" id="L1076">            double rads = Math.toRadians(-angle);</span>
<span class="nc" id="L1077">            double xe = Math.cos(rads);</span>
<span class="nc" id="L1078">            double ye = Math.sin(rads);</span>
<span class="nc" id="L1079">            x1 = Math.min(x1, xe);</span>
<span class="nc" id="L1080">            y1 = Math.min(y1, ye);</span>
<span class="nc" id="L1081">            x2 = Math.max(x2, xe);</span>
<span class="nc" id="L1082">            y2 = Math.max(y2, ye);</span>
        }
<span class="nc" id="L1084">        double w = getWidth();</span>
<span class="nc" id="L1085">        double h = getHeight();</span>
<span class="nc" id="L1086">        x2 = (x2 - x1) * 0.5 * w;</span>
<span class="nc" id="L1087">        y2 = (y2 - y1) * 0.5 * h;</span>
<span class="nc" id="L1088">        x1 = getX() + (x1 * 0.5 + 0.5) * w;</span>
<span class="nc" id="L1089">        y1 = getY() + (y1 * 0.5 + 0.5) * h;</span>
<span class="nc" id="L1090">        return makeBounds(x1, y1, x2, y2);</span>
    }

    /**
     * Constructs a &lt;code&gt;Rectangle2D&lt;/code&gt; of the appropriate precision
     * to hold the parameters calculated to be the framing rectangle
     * of this arc.
     *
     * @param x The X coordinate of the upper-left corner of the
     * framing rectangle.
     * @param y The Y coordinate of the upper-left corner of the
     * framing rectangle.
     * @param w The width of the framing rectangle.
     * @param h The height of the framing rectangle.
     * @return a &lt;code&gt;Rectangle2D&lt;/code&gt; that is the framing rectangle
     *     of this arc.
     * @since 1.2
     */
    protected abstract Rectangle2D makeBounds(double x, double y,
                                              double w, double h);

    /*
     * Normalizes the specified angle into the range -180 to 180.
     */
    static double normalizeDegrees(double angle) {
<span class="nc bnc" id="L1115" title="All 2 branches missed.">        if (angle &gt; 180.0) {</span>
<span class="nc bnc" id="L1116" title="All 2 branches missed.">            if (angle &lt;= (180.0 + 360.0)) {</span>
<span class="nc" id="L1117">                angle = angle - 360.0;</span>
            } else {
<span class="nc" id="L1119">                angle = Math.IEEEremainder(angle, 360.0);</span>
                // IEEEremainder can return -180 here for some input values...
<span class="nc bnc" id="L1121" title="All 2 branches missed.">                if (angle == -180.0) {</span>
<span class="nc" id="L1122">                    angle = 180.0;</span>
                }
            }
<span class="nc bnc" id="L1125" title="All 2 branches missed.">        } else if (angle &lt;= -180.0) {</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">            if (angle &gt; (-180.0 - 360.0)) {</span>
<span class="nc" id="L1127">                angle = angle + 360.0;</span>
            } else {
<span class="nc" id="L1129">                angle = Math.IEEEremainder(angle, 360.0);</span>
                // IEEEremainder can return -180 here for some input values...
<span class="nc bnc" id="L1131" title="All 2 branches missed.">                if (angle == -180.0) {</span>
<span class="nc" id="L1132">                    angle = 180.0;</span>
                }
            }
        }
<span class="nc" id="L1136">        return angle;</span>
    }

    /**
     * Determines whether or not the specified angle is within the
     * angular extents of the arc.
     *
     * @param angle The angle to test.
     *
     * @return &lt;CODE&gt;true&lt;/CODE&gt; if the arc contains the angle,
     * &lt;CODE&gt;false&lt;/CODE&gt; if the arc doesn't contain the angle.
     * @since 1.2
     */
    public boolean containsAngle(double angle) {
<span class="nc" id="L1150">        double angExt = getAngleExtent();</span>
<span class="nc bnc" id="L1151" title="All 2 branches missed.">        boolean backwards = (angExt &lt; 0.0);</span>
<span class="nc bnc" id="L1152" title="All 2 branches missed.">        if (backwards) {</span>
<span class="nc" id="L1153">            angExt = -angExt;</span>
        }
<span class="nc bnc" id="L1155" title="All 2 branches missed.">        if (angExt &gt;= 360.0) {</span>
<span class="nc" id="L1156">            return true;</span>
        }
<span class="nc" id="L1158">        angle = normalizeDegrees(angle) - normalizeDegrees(getAngleStart());</span>
<span class="nc bnc" id="L1159" title="All 2 branches missed.">        if (backwards) {</span>
<span class="nc" id="L1160">            angle = -angle;</span>
        }
<span class="nc bnc" id="L1162" title="All 2 branches missed.">        if (angle &lt; 0.0) {</span>
<span class="nc" id="L1163">            angle += 360.0;</span>
        }


<span class="nc bnc" id="L1167" title="All 4 branches missed.">        return (angle &gt;= 0.0) &amp;&amp; (angle &lt; angExt);</span>
    }

    /**
     * Determines whether or not the specified point is inside the boundary
     * of the arc.
     *
     * @param x The X coordinate of the point to test.
     * @param y The Y coordinate of the point to test.
     *
     * @return &lt;CODE&gt;true&lt;/CODE&gt; if the point lies within the bound of
     * the arc, &lt;CODE&gt;false&lt;/CODE&gt; if the point lies outside of the
     * arc's bounds.
     * @since 1.2
     */
    public boolean contains(double x, double y) {
        // Normalize the coordinates compared to the ellipse
        // having a center at 0,0 and a radius of 0.5.
<span class="nc" id="L1185">        double ellw = getWidth();</span>
<span class="nc bnc" id="L1186" title="All 2 branches missed.">        if (ellw &lt;= 0.0) {</span>
<span class="nc" id="L1187">            return false;</span>
        }
<span class="nc" id="L1189">        double normx = (x - getX()) / ellw - 0.5;</span>
<span class="nc" id="L1190">        double ellh = getHeight();</span>
<span class="nc bnc" id="L1191" title="All 2 branches missed.">        if (ellh &lt;= 0.0) {</span>
<span class="nc" id="L1192">            return false;</span>
        }
<span class="nc" id="L1194">        double normy = (y - getY()) / ellh - 0.5;</span>
<span class="nc" id="L1195">        double distSq = (normx * normx + normy * normy);</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">        if (distSq &gt;= 0.25) {</span>
<span class="nc" id="L1197">            return false;</span>
        }
<span class="nc" id="L1199">        double angExt = Math.abs(getAngleExtent());</span>
<span class="nc bnc" id="L1200" title="All 2 branches missed.">        if (angExt &gt;= 360.0) {</span>
<span class="nc" id="L1201">            return true;</span>
        }
<span class="nc" id="L1203">        boolean inarc = containsAngle(-Math.toDegrees(Math.atan2(normy,</span>
                                                                 normx)));
<span class="nc bnc" id="L1205" title="All 2 branches missed.">        if (type == PIE) {</span>
<span class="nc" id="L1206">            return inarc;</span>
        }
        // CHORD and OPEN behave the same way
<span class="nc bnc" id="L1209" title="All 2 branches missed.">        if (inarc) {</span>
<span class="nc bnc" id="L1210" title="All 2 branches missed.">            if (angExt &gt;= 180.0) {</span>
<span class="nc" id="L1211">                return true;</span>
            }
            // point must be outside the &quot;pie triangle&quot;
        } else {
<span class="nc bnc" id="L1215" title="All 2 branches missed.">            if (angExt &lt;= 180.0) {</span>
<span class="nc" id="L1216">                return false;</span>
            }
            // point must be inside the &quot;pie triangle&quot;
        }
        // The point is inside the pie triangle iff it is on the same
        // side of the line connecting the ends of the arc as the center.
<span class="nc" id="L1222">        double angle = Math.toRadians(-getAngleStart());</span>
<span class="nc" id="L1223">        double x1 = Math.cos(angle);</span>
<span class="nc" id="L1224">        double y1 = Math.sin(angle);</span>
<span class="nc" id="L1225">        angle += Math.toRadians(-getAngleExtent());</span>
<span class="nc" id="L1226">        double x2 = Math.cos(angle);</span>
<span class="nc" id="L1227">        double y2 = Math.sin(angle);</span>
<span class="nc" id="L1228">        boolean inside = (Line2D.relativeCCW(x1, y1, x2, y2, 2*normx, 2*normy) *</span>
<span class="nc bnc" id="L1229" title="All 2 branches missed.">                          Line2D.relativeCCW(x1, y1, x2, y2, 0, 0) &gt;= 0);</span>
<span class="nc bnc" id="L1230" title="All 4 branches missed.">        return inarc ? !inside : inside;</span>
    }

    /**
     * Determines whether or not the interior of the arc intersects
     * the interior of the specified rectangle.
     *
     * @param x The X coordinate of the rectangle's upper-left corner.
     * @param y The Y coordinate of the rectangle's upper-left corner.
     * @param w The width of the rectangle.
     * @param h The height of the rectangle.
     *
     * @return &lt;CODE&gt;true&lt;/CODE&gt; if the arc intersects the rectangle,
     * &lt;CODE&gt;false&lt;/CODE&gt; if the arc doesn't intersect the rectangle.
     * @since 1.2
     */
    public boolean intersects(double x, double y, double w, double h) {

<span class="nc" id="L1248">        double aw = getWidth();</span>
<span class="nc" id="L1249">        double ah = getHeight();</span>

<span class="nc bnc" id="L1251" title="All 8 branches missed.">        if ( w &lt;= 0 || h &lt;= 0 || aw &lt;= 0 || ah &lt;= 0 ) {</span>
<span class="nc" id="L1252">            return false;</span>
        }
<span class="nc" id="L1254">        double ext = getAngleExtent();</span>
<span class="nc bnc" id="L1255" title="All 2 branches missed.">        if (ext == 0) {</span>
<span class="nc" id="L1256">            return false;</span>
        }

<span class="nc" id="L1259">        double ax  = getX();</span>
<span class="nc" id="L1260">        double ay  = getY();</span>
<span class="nc" id="L1261">        double axw = ax + aw;</span>
<span class="nc" id="L1262">        double ayh = ay + ah;</span>
<span class="nc" id="L1263">        double xw  = x + w;</span>
<span class="nc" id="L1264">        double yh  = y + h;</span>

        // check bbox
<span class="nc bnc" id="L1267" title="All 8 branches missed.">        if (x &gt;= axw || y &gt;= ayh || xw &lt;= ax || yh &lt;= ay) {</span>
<span class="nc" id="L1268">            return false;</span>
        }

        // extract necessary data
<span class="nc" id="L1272">        double axc = getCenterX();</span>
<span class="nc" id="L1273">        double ayc = getCenterY();</span>
<span class="nc" id="L1274">        Point2D sp = getStartPoint();</span>
<span class="nc" id="L1275">        Point2D ep = getEndPoint();</span>
<span class="nc" id="L1276">        double sx = sp.getX();</span>
<span class="nc" id="L1277">        double sy = sp.getY();</span>
<span class="nc" id="L1278">        double ex = ep.getX();</span>
<span class="nc" id="L1279">        double ey = ep.getY();</span>

        /*
         * Try to catch rectangles that intersect arc in areas
         * outside of rectagle with left top corner coordinates
         * (min(center x, start point x, end point x),
         *  min(center y, start point y, end point y))
         * and rigth bottom corner coordinates
         * (max(center x, start point x, end point x),
         *  max(center y, start point y, end point y)).
         * So we'll check axis segments outside of rectangle above.
         */
<span class="nc bnc" id="L1291" title="All 4 branches missed.">        if (ayc &gt;= y &amp;&amp; ayc &lt;= yh) { // 0 and 180</span>
<span class="nc bnc" id="L1292" title="All 8 branches missed.">            if ((sx &lt; xw &amp;&amp; ex &lt; xw &amp;&amp; axc &lt; xw &amp;&amp;</span>
<span class="nc bnc" id="L1293" title="All 10 branches missed.">                 axw &gt; x &amp;&amp; containsAngle(0)) ||</span>
                (sx &gt; x &amp;&amp; ex &gt; x &amp;&amp; axc &gt; x &amp;&amp;
<span class="nc bnc" id="L1295" title="All 2 branches missed.">                 ax &lt; xw &amp;&amp; containsAngle(180))) {</span>
<span class="nc" id="L1296">                return true;</span>
            }
        }
<span class="nc bnc" id="L1299" title="All 4 branches missed.">        if (axc &gt;= x &amp;&amp; axc &lt;= xw) { // 90 and 270</span>
<span class="nc bnc" id="L1300" title="All 8 branches missed.">            if ((sy &gt; y &amp;&amp; ey &gt; y &amp;&amp; ayc &gt; y &amp;&amp;</span>
<span class="nc bnc" id="L1301" title="All 10 branches missed.">                 ay &lt; yh &amp;&amp; containsAngle(90)) ||</span>
                (sy &lt; yh &amp;&amp; ey &lt; yh &amp;&amp; ayc &lt; yh &amp;&amp;
<span class="nc bnc" id="L1303" title="All 2 branches missed.">                 ayh &gt; y &amp;&amp; containsAngle(270))) {</span>
<span class="nc" id="L1304">                return true;</span>
            }
        }

        /*
         * For PIE we should check intersection with pie slices;
         * also we should do the same for arcs with extent is greater
         * than 180, because we should cover case of rectangle, which
         * situated between center of arc and chord, but does not
         * intersect the chord.
         */
<span class="nc" id="L1315">        Rectangle2D rect = new Rectangle2D.Double(x, y, w, h);</span>
<span class="nc bnc" id="L1316" title="All 4 branches missed.">        if (type == PIE || Math.abs(ext) &gt; 180) {</span>
            // for PIE: try to find intersections with pie slices
<span class="nc bnc" id="L1318" title="All 2 branches missed.">            if (rect.intersectsLine(axc, ayc, sx, sy) ||</span>
<span class="nc bnc" id="L1319" title="All 2 branches missed.">                rect.intersectsLine(axc, ayc, ex, ey)) {</span>
<span class="nc" id="L1320">                return true;</span>
            }
        } else {
            // for CHORD and OPEN: try to find intersections with chord
<span class="nc bnc" id="L1324" title="All 2 branches missed.">            if (rect.intersectsLine(sx, sy, ex, ey)) {</span>
<span class="nc" id="L1325">                return true;</span>
            }
        }

        // finally check the rectangle corners inside the arc
<span class="nc bnc" id="L1330" title="All 4 branches missed.">        if (contains(x, y) || contains(x + w, y) ||</span>
<span class="nc bnc" id="L1331" title="All 4 branches missed.">            contains(x, y + h) || contains(x + w, y + h)) {</span>
<span class="nc" id="L1332">            return true;</span>
        }

<span class="nc" id="L1335">        return false;</span>
    }

    /**
     * Determines whether or not the interior of the arc entirely contains
     * the specified rectangle.
     *
     * @param x The X coordinate of the rectangle's upper-left corner.
     * @param y The Y coordinate of the rectangle's upper-left corner.
     * @param w The width of the rectangle.
     * @param h The height of the rectangle.
     *
     * @return &lt;CODE&gt;true&lt;/CODE&gt; if the arc contains the rectangle,
     * &lt;CODE&gt;false&lt;/CODE&gt; if the arc doesn't contain the rectangle.
     * @since 1.2
     */
    public boolean contains(double x, double y, double w, double h) {
<span class="nc" id="L1352">        return contains(x, y, w, h, null);</span>
    }

    /**
     * Determines whether or not the interior of the arc entirely contains
     * the specified rectangle.
     *
     * @param r The &lt;CODE&gt;Rectangle2D&lt;/CODE&gt; to test.
     *
     * @return &lt;CODE&gt;true&lt;/CODE&gt; if the arc contains the rectangle,
     * &lt;CODE&gt;false&lt;/CODE&gt; if the arc doesn't contain the rectangle.
     * @since 1.2
     */
    public boolean contains(Rectangle2D r) {
<span class="nc" id="L1366">        return contains(r.getX(), r.getY(), r.getWidth(), r.getHeight(), r);</span>
    }

    private boolean contains(double x, double y, double w, double h,
                             Rectangle2D origrect) {
<span class="nc bnc" id="L1371" title="All 2 branches missed.">        if (!(contains(x, y) &amp;&amp;</span>
<span class="nc bnc" id="L1372" title="All 2 branches missed.">              contains(x + w, y) &amp;&amp;</span>
<span class="nc bnc" id="L1373" title="All 2 branches missed.">              contains(x, y + h) &amp;&amp;</span>
<span class="nc bnc" id="L1374" title="All 2 branches missed.">              contains(x + w, y + h))) {</span>
<span class="nc" id="L1375">            return false;</span>
        }
        // If the shape is convex then we have done all the testing
        // we need.  Only PIE arcs can be concave and then only if
        // the angular extents are greater than 180 degrees.
<span class="nc bnc" id="L1380" title="All 4 branches missed.">        if (type != PIE || Math.abs(getAngleExtent()) &lt;= 180.0) {</span>
<span class="nc" id="L1381">            return true;</span>
        }
        // For a PIE shape we have an additional test for the case where
        // the angular extents are greater than 180 degrees and all four
        // rectangular corners are inside the shape but one of the
        // rectangle edges spans across the &quot;missing wedge&quot; of the arc.
        // We can test for this case by checking if the rectangle intersects
        // either of the pie angle segments.
<span class="nc bnc" id="L1389" title="All 2 branches missed.">        if (origrect == null) {</span>
<span class="nc" id="L1390">            origrect = new Rectangle2D.Double(x, y, w, h);</span>
        }
<span class="nc" id="L1392">        double halfW = getWidth() / 2.0;</span>
<span class="nc" id="L1393">        double halfH = getHeight() / 2.0;</span>
<span class="nc" id="L1394">        double xc = getX() + halfW;</span>
<span class="nc" id="L1395">        double yc = getY() + halfH;</span>
<span class="nc" id="L1396">        double angle = Math.toRadians(-getAngleStart());</span>
<span class="nc" id="L1397">        double xe = xc + halfW * Math.cos(angle);</span>
<span class="nc" id="L1398">        double ye = yc + halfH * Math.sin(angle);</span>
<span class="nc bnc" id="L1399" title="All 2 branches missed.">        if (origrect.intersectsLine(xc, yc, xe, ye)) {</span>
<span class="nc" id="L1400">            return false;</span>
        }
<span class="nc" id="L1402">        angle += Math.toRadians(-getAngleExtent());</span>
<span class="nc" id="L1403">        xe = xc + halfW * Math.cos(angle);</span>
<span class="nc" id="L1404">        ye = yc + halfH * Math.sin(angle);</span>
<span class="nc bnc" id="L1405" title="All 2 branches missed.">        return !origrect.intersectsLine(xc, yc, xe, ye);</span>
    }

    /**
     * Returns an iteration object that defines the boundary of the
     * arc.
     * This iterator is multithread safe.
     * &lt;code&gt;Arc2D&lt;/code&gt; guarantees that
     * modifications to the geometry of the arc
     * do not affect any iterations of that geometry that
     * are already in process.
     *
     * @param at an optional &lt;CODE&gt;AffineTransform&lt;/CODE&gt; to be applied
     * to the coordinates as they are returned in the iteration, or null
     * if the untransformed coordinates are desired.
     *
     * @return A &lt;CODE&gt;PathIterator&lt;/CODE&gt; that defines the arc's boundary.
     * @since 1.2
     */
    public PathIterator getPathIterator(AffineTransform at) {
<span class="nc" id="L1425">        return new ArcIterator(this, at);</span>
    }

    /**
     * Returns the hashcode for this &lt;code&gt;Arc2D&lt;/code&gt;.
     * @return the hashcode for this &lt;code&gt;Arc2D&lt;/code&gt;.
     * @since 1.6
     */
    public int hashCode() {
<span class="nc" id="L1434">        long bits = java.lang.Double.doubleToLongBits(getX());</span>
<span class="nc" id="L1435">        bits += java.lang.Double.doubleToLongBits(getY()) * 37;</span>
<span class="nc" id="L1436">        bits += java.lang.Double.doubleToLongBits(getWidth()) * 43;</span>
<span class="nc" id="L1437">        bits += java.lang.Double.doubleToLongBits(getHeight()) * 47;</span>
<span class="nc" id="L1438">        bits += java.lang.Double.doubleToLongBits(getAngleStart()) * 53;</span>
<span class="nc" id="L1439">        bits += java.lang.Double.doubleToLongBits(getAngleExtent()) * 59;</span>
<span class="nc" id="L1440">        bits += getArcType() * 61;</span>
<span class="nc" id="L1441">        return (((int) bits) ^ ((int) (bits &gt;&gt; 32)));</span>
    }

    /**
     * Determines whether or not the specified &lt;code&gt;Object&lt;/code&gt; is
     * equal to this &lt;code&gt;Arc2D&lt;/code&gt;.  The specified
     * &lt;code&gt;Object&lt;/code&gt; is equal to this &lt;code&gt;Arc2D&lt;/code&gt;
     * if it is an instance of &lt;code&gt;Arc2D&lt;/code&gt; and if its
     * location, size, arc extents and type are the same as this
     * &lt;code&gt;Arc2D&lt;/code&gt;.
     * @param obj  an &lt;code&gt;Object&lt;/code&gt; to be compared with this
     *             &lt;code&gt;Arc2D&lt;/code&gt;.
     * @return  &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;obj&lt;/code&gt; is an instance
     *          of &lt;code&gt;Arc2D&lt;/code&gt; and has the same values;
     *          &lt;code&gt;false&lt;/code&gt; otherwise.
     * @since 1.6
     */
    public boolean equals(Object obj) {
<span class="nc bnc" id="L1459" title="All 2 branches missed.">        if (obj == this) {</span>
<span class="nc" id="L1460">            return true;</span>
        }
<span class="nc bnc" id="L1462" title="All 2 branches missed.">        if (obj instanceof Arc2D) {</span>
<span class="nc" id="L1463">            Arc2D a2d = (Arc2D) obj;</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">            return ((getX() == a2d.getX()) &amp;&amp;</span>
<span class="nc bnc" id="L1465" title="All 2 branches missed.">                    (getY() == a2d.getY()) &amp;&amp;</span>
<span class="nc bnc" id="L1466" title="All 2 branches missed.">                    (getWidth() == a2d.getWidth()) &amp;&amp;</span>
<span class="nc bnc" id="L1467" title="All 2 branches missed.">                    (getHeight() == a2d.getHeight()) &amp;&amp;</span>
<span class="nc bnc" id="L1468" title="All 2 branches missed.">                    (getAngleStart() == a2d.getAngleStart()) &amp;&amp;</span>
<span class="nc bnc" id="L1469" title="All 2 branches missed.">                    (getAngleExtent() == a2d.getAngleExtent()) &amp;&amp;</span>
<span class="nc bnc" id="L1470" title="All 2 branches missed.">                    (getArcType() == a2d.getArcType()));</span>
        }
<span class="nc" id="L1472">        return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>