<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>RoleUnresolvedList.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.management.relation</a> &gt; <span class="el_source">RoleUnresolvedList.java</span></div><h1>RoleUnresolvedList.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2000, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.management.relation;

import com.sun.jmx.mbeanserver.Util;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

/**
 * A RoleUnresolvedList represents a list of RoleUnresolved objects,
 * representing roles not retrieved from a relation due to a problem
 * encountered when trying to access (read or write) the roles.
 *
 * @since 1.5
 */
/* We cannot extend ArrayList&lt;RoleUnresolved&gt; because our legacy
   add(RoleUnresolved) method would then override add(E) in ArrayList&lt;E&gt;,
   and our return value is void whereas ArrayList.add(E)'s is boolean.
   Likewise for set(int,RoleUnresolved).  Grrr.  We cannot use covariance
   to override the most important methods and have them return
   RoleUnresolved, either, because that would break subclasses that
   override those methods in turn (using the original return type
   of Object).  Finally, we cannot implement Iterable&lt;RoleUnresolved&gt;
   so you could write
       for (RoleUnresolved r : roleUnresolvedList)
   because ArrayList&lt;&gt; implements Iterable&lt;&gt; and the same class cannot
   implement two versions of a generic interface.  Instead we provide
   the asList() method so you can write
       for (RoleUnresolved r : roleUnresolvedList.asList())
*/
public class RoleUnresolvedList extends ArrayList&lt;Object&gt; {

    private transient boolean typeSafe;
    private transient boolean tainted;

    /* Serial version */
    private static final long serialVersionUID = 4054902803091433324L;

    //
    // Constructors
    //

    /**
     * Constructs an empty RoleUnresolvedList.
     */
    public RoleUnresolvedList() {
<span class="nc" id="L71">        super();</span>
<span class="nc" id="L72">    }</span>

    /**
     * Constructs an empty RoleUnresolvedList with the initial capacity
     * specified.
     *
     * @param initialCapacity  initial capacity
     */
    public RoleUnresolvedList(int initialCapacity) {
<span class="nc" id="L81">        super(initialCapacity);</span>
<span class="nc" id="L82">    }</span>

    /**
     * Constructs a {@code RoleUnresolvedList} containing the elements of the
     * {@code List} specified, in the order in which they are returned by
     * the {@code List}'s iterator. The {@code RoleUnresolvedList} instance has
     * an initial capacity of 110% of the size of the {@code List}
     * specified.
     *
     * @param list the {@code List} that defines the initial contents of
     * the new {@code RoleUnresolvedList}.
     *
     * @exception IllegalArgumentException if the {@code list} parameter
     * is {@code null} or if the {@code list} parameter contains any
     * non-RoleUnresolved objects.
     *
     * @see ArrayList#ArrayList(java.util.Collection)
     */
    public RoleUnresolvedList(List&lt;RoleUnresolved&gt; list)
<span class="nc" id="L101">        throws IllegalArgumentException {</span>
        // Check for null parameter
        //
<span class="nc bnc" id="L104" title="All 2 branches missed.">        if (list == null)</span>
<span class="nc" id="L105">            throw new IllegalArgumentException(&quot;Null parameter&quot;);</span>

        // Check for non-RoleUnresolved objects
        //
<span class="nc" id="L109">        checkTypeSafe(list);</span>

        // Build the List&lt;RoleUnresolved&gt;
        //
<span class="nc" id="L113">        super.addAll(list);</span>
<span class="nc" id="L114">    }</span>

    /**
     * Return a view of this list as a {@code List&lt;RoleUnresolved&gt;}.
     * Changes to the returned value are reflected by changes
     * to the original {@code RoleUnresolvedList} and vice versa.
     *
     * @return a {@code List&lt;RoleUnresolved&gt;} whose contents
     * reflect the contents of this {@code RoleUnresolvedList}.
     *
     * &lt;p&gt;If this method has ever been called on a given
     * {@code RoleUnresolvedList} instance, a subsequent attempt to add
     * an object to that instance which is not a {@code RoleUnresolved}
     * will fail with an {@code IllegalArgumentException}. For compatibility
     * reasons, a {@code RoleUnresolvedList} on which this method has never
     * been called does allow objects other than {@code RoleUnresolved}s to
     * be added.&lt;/p&gt;
     *
     * @throws IllegalArgumentException if this {@code RoleUnresolvedList}
     * contains an element that is not a {@code RoleUnresolved}.
     *
     * @since 1.6
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public List&lt;RoleUnresolved&gt; asList() {
<span class="nc bnc" id="L139" title="All 2 branches missed.">        if (!typeSafe) {</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">            if (tainted)</span>
<span class="nc" id="L141">                checkTypeSafe(this);</span>
<span class="nc" id="L142">            typeSafe = true;</span>
        }
<span class="nc" id="L144">        return Util.cast(this);</span>
    }

    //
    // Accessors
    //

    /**
     * Adds the RoleUnresolved specified as the last element of the list.
     *
     * @param role - the unresolved role to be added.
     *
     * @exception IllegalArgumentException  if the unresolved role is null.
     */
    public void add(RoleUnresolved role)
        throws IllegalArgumentException {

<span class="nc bnc" id="L161" title="All 2 branches missed.">        if (role == null) {</span>
<span class="nc" id="L162">            String excMsg = &quot;Invalid parameter&quot;;</span>
<span class="nc" id="L163">            throw new IllegalArgumentException(excMsg);</span>
        }
<span class="nc" id="L165">        super.add(role);</span>
<span class="nc" id="L166">    }</span>

    /**
     * Inserts the unresolved role specified as an element at the position
     * specified.
     * Elements with an index greater than or equal to the current position are
     * shifted up.
     *
     * @param index - The position in the list where the new
     * RoleUnresolved object is to be inserted.
     * @param role - The RoleUnresolved object to be inserted.
     *
     * @exception IllegalArgumentException  if the unresolved role is null.
     * @exception IndexOutOfBoundsException if index is out of range
     * (&lt;code&gt;index &amp;lt; 0 || index &amp;gt; size()&lt;/code&gt;).
     */
    public void add(int index,
                    RoleUnresolved role)
        throws IllegalArgumentException,
               IndexOutOfBoundsException {

<span class="nc bnc" id="L187" title="All 2 branches missed.">        if (role == null) {</span>
<span class="nc" id="L188">            String excMsg = &quot;Invalid parameter&quot;;</span>
<span class="nc" id="L189">            throw new IllegalArgumentException(excMsg);</span>
        }

<span class="nc" id="L192">        super.add(index, role);</span>
<span class="nc" id="L193">    }</span>

    /**
     * Sets the element at the position specified to be the unresolved role
     * specified.
     * The previous element at that position is discarded.
     *
     * @param index - The position specified.
     * @param role - The value to which the unresolved role element
     * should be set.
     *
     * @exception IllegalArgumentException   if the unresolved role is null.
     * @exception IndexOutOfBoundsException if index is out of range
     * (&lt;code&gt;index &amp;lt; 0 || index &amp;gt;= size()&lt;/code&gt;).
     */
     public void set(int index,
                     RoleUnresolved role)
         throws IllegalArgumentException,
                IndexOutOfBoundsException {

<span class="nc bnc" id="L213" title="All 2 branches missed.">        if (role == null) {</span>
<span class="nc" id="L214">            String excMsg = &quot;Invalid parameter&quot;;</span>
<span class="nc" id="L215">            throw new IllegalArgumentException(excMsg);</span>
        }

<span class="nc" id="L218">        super.set(index, role);</span>
<span class="nc" id="L219">     }</span>

    /**
     * Appends all the elements in the RoleUnresolvedList specified to the end
     * of the list, in the order in which they are returned by the Iterator of
     * the RoleUnresolvedList specified.
     *
     * @param roleList - Elements to be inserted into the list
     * (can be null).
     *
     * @return true if this list changed as a result of the call.
     *
     * @exception IndexOutOfBoundsException  if accessing with an index
     * outside of the list.
     */
    public boolean addAll(RoleUnresolvedList roleList)
        throws IndexOutOfBoundsException {

<span class="nc bnc" id="L237" title="All 2 branches missed.">        if (roleList == null) {</span>
<span class="nc" id="L238">            return true;</span>
        }

<span class="nc" id="L241">        return (super.addAll(roleList));</span>
    }

    /**
     * Inserts all of the elements in the RoleUnresolvedList specified into
     * this list, starting at the specified position, in the order in which
     * they are returned by the Iterator of the RoleUnresolvedList specified.
     *
     * @param index - Position at which to insert the first element from the
     * RoleUnresolvedList specified.
     * @param roleList - Elements to be inserted into the list.
     *
     * @return true if this list changed as a result of the call.
     *
     * @exception IllegalArgumentException  if the role is null.
     * @exception IndexOutOfBoundsException if index is out of range
     * (&lt;code&gt;index &amp;lt; 0 || index &amp;gt; size()&lt;/code&gt;).
     */
    public boolean addAll(int index,
                          RoleUnresolvedList roleList)
        throws IllegalArgumentException,
               IndexOutOfBoundsException {

<span class="nc bnc" id="L264" title="All 2 branches missed.">        if (roleList == null) {</span>
<span class="nc" id="L265">            String excMsg = &quot;Invalid parameter&quot;;</span>
<span class="nc" id="L266">            throw new IllegalArgumentException(excMsg);</span>
        }

<span class="nc" id="L269">        return (super.addAll(index, roleList));</span>
    }

    /*
     * Override all of the methods from ArrayList&lt;Object&gt; that might add
     * a non-RoleUnresolved to the List, and disallow that if asList has
     * ever been called on this instance.
     */

    @Override
    public boolean add(Object o) {
<span class="nc bnc" id="L280" title="All 2 branches missed.">        if (!tainted)</span>
<span class="nc" id="L281">            tainted = isTainted(o);</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">        if (typeSafe)</span>
<span class="nc" id="L283">            checkTypeSafe(o);</span>
<span class="nc" id="L284">        return super.add(o);</span>
    }

    @Override
    public void add(int index, Object element) {
<span class="nc bnc" id="L289" title="All 2 branches missed.">        if (!tainted)</span>
<span class="nc" id="L290">            tainted = isTainted(element);</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">        if (typeSafe)</span>
<span class="nc" id="L292">            checkTypeSafe(element);</span>
<span class="nc" id="L293">        super.add(index, element);</span>
<span class="nc" id="L294">    }</span>

    @Override
    public boolean addAll(Collection&lt;?&gt; c) {
<span class="nc bnc" id="L298" title="All 2 branches missed.">        if (!tainted)</span>
<span class="nc" id="L299">            tainted = isTainted(c);</span>
<span class="nc bnc" id="L300" title="All 2 branches missed.">        if (typeSafe)</span>
<span class="nc" id="L301">            checkTypeSafe(c);</span>
<span class="nc" id="L302">        return super.addAll(c);</span>
    }

    @Override
    public boolean addAll(int index, Collection&lt;?&gt; c) {
<span class="nc bnc" id="L307" title="All 2 branches missed.">        if (!tainted)</span>
<span class="nc" id="L308">            tainted = isTainted(c);</span>
<span class="nc bnc" id="L309" title="All 2 branches missed.">        if (typeSafe)</span>
<span class="nc" id="L310">            checkTypeSafe(c);</span>
<span class="nc" id="L311">        return super.addAll(index, c);</span>
    }

    @Override
    public Object set(int index, Object element) {
<span class="nc bnc" id="L316" title="All 2 branches missed.">        if (!tainted)</span>
<span class="nc" id="L317">            tainted = isTainted(element);</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (typeSafe)</span>
<span class="nc" id="L319">            checkTypeSafe(element);</span>
<span class="nc" id="L320">        return super.set(index, element);</span>
    }

    /**
     * IllegalArgumentException if o is a non-RoleUnresolved object.
     */
    private static void checkTypeSafe(Object o) {
        try {
<span class="nc" id="L328">            o = (RoleUnresolved) o;</span>
<span class="nc" id="L329">        } catch (ClassCastException e) {</span>
<span class="nc" id="L330">            throw new IllegalArgumentException(e);</span>
<span class="nc" id="L331">        }</span>
<span class="nc" id="L332">    }</span>

    /**
     * IllegalArgumentException if c contains any non-RoleUnresolved objects.
     */
    private static void checkTypeSafe(Collection&lt;?&gt; c) {
        try {
            RoleUnresolved r;
<span class="nc bnc" id="L340" title="All 2 branches missed.">            for (Object o : c)</span>
<span class="nc" id="L341">                r = (RoleUnresolved) o;</span>
<span class="nc" id="L342">        } catch (ClassCastException e) {</span>
<span class="nc" id="L343">            throw new IllegalArgumentException(e);</span>
<span class="nc" id="L344">        }</span>
<span class="nc" id="L345">    }</span>

    /**
     * Returns true if o is a non-RoleUnresolved object.
     */
    private static boolean isTainted(Object o) {
        try {
<span class="nc" id="L352">            checkTypeSafe(o);</span>
<span class="nc" id="L353">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L354">            return true;</span>
<span class="nc" id="L355">        }</span>
<span class="nc" id="L356">        return false;</span>
    }

    /**
     * Returns true if c contains any non-RoleUnresolved objects.
     */
    private static boolean isTainted(Collection&lt;?&gt; c) {
        try {
<span class="nc" id="L364">            checkTypeSafe(c);</span>
<span class="nc" id="L365">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L366">            return true;</span>
<span class="nc" id="L367">        }</span>
<span class="nc" id="L368">        return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>