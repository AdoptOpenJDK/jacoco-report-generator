<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>DragGestureEvent.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">java.awt.dnd</a> &gt; <span class="el_source">DragGestureEvent.java</span></div><h1>DragGestureEvent.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1998, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */


package java.awt.dnd;

import java.awt.Component;
import java.awt.Cursor;

import java.awt.Image;
import java.awt.Point;

import java.awt.event.InputEvent;

import java.awt.datatransfer.Transferable;

import java.util.EventObject;

import java.util.Collections;
import java.util.List;
import java.util.Iterator;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;


/**
 * A &lt;code&gt;DragGestureEvent&lt;/code&gt; is passed
 * to &lt;code&gt;DragGestureListener&lt;/code&gt;'s
 * dragGestureRecognized() method
 * when a particular &lt;code&gt;DragGestureRecognizer&lt;/code&gt; detects that a
 * platform dependent drag initiating gesture has occurred
 * on the &lt;code&gt;Component&lt;/code&gt; that it is tracking.
 *
 * The {@code action} field of any {@code DragGestureEvent} instance should take one of the following
 * values:
 * &lt;ul&gt;
 * &lt;li&gt; {@code DnDConstants.ACTION_COPY}
 * &lt;li&gt; {@code DnDConstants.ACTION_MOVE}
 * &lt;li&gt; {@code DnDConstants.ACTION_LINK}
 * &lt;/ul&gt;
 * Assigning the value different from listed above will cause an unspecified behavior.
 *
 * @see java.awt.dnd.DragGestureRecognizer
 * @see java.awt.dnd.DragGestureListener
 * @see java.awt.dnd.DragSource
 * @see java.awt.dnd.DnDConstants
 */

public class DragGestureEvent extends EventObject {

    private static final long serialVersionUID = 9080172649166731306L;

    /**
     * Constructs a &lt;code&gt;DragGestureEvent&lt;/code&gt; object given by the
     * &lt;code&gt;DragGestureRecognizer&lt;/code&gt; instance firing this event,
     * an {@code act} parameter representing
     * the user's preferred action, an {@code ori} parameter
     * indicating the origin of the drag, and a {@code List} of
     * events that comprise the gesture({@code evs} parameter).
     * &lt;P&gt;
     * @param dgr The &lt;code&gt;DragGestureRecognizer&lt;/code&gt; firing this event
     * @param act The user's preferred action.
     *            For information on allowable values, see
     *            the class description for {@link DragGestureEvent}
     * @param ori The origin of the drag
     * @param evs The &lt;code&gt;List&lt;/code&gt; of events that comprise the gesture
     * &lt;P&gt;
     * @throws IllegalArgumentException if any parameter equals {@code null}
     * @throws IllegalArgumentException if the act parameter does not comply with
     *                                  the values given in the class
     *                                  description for {@link DragGestureEvent}
     * @see java.awt.dnd.DnDConstants
     */

    public DragGestureEvent(DragGestureRecognizer dgr, int act, Point ori,
                            List&lt;? extends InputEvent&gt; evs)
    {
<span class="nc" id="L102">        super(dgr);</span>

<span class="nc bnc" id="L104" title="All 2 branches missed.">        if ((component = dgr.getComponent()) == null)</span>
<span class="nc" id="L105">            throw new IllegalArgumentException(&quot;null component&quot;);</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">        if ((dragSource = dgr.getDragSource()) == null)</span>
<span class="nc" id="L107">            throw new IllegalArgumentException(&quot;null DragSource&quot;);</span>

<span class="nc bnc" id="L109" title="All 4 branches missed.">        if (evs == null || evs.isEmpty())</span>
<span class="nc" id="L110">            throw new IllegalArgumentException(&quot;null or empty list of events&quot;);</span>

<span class="nc bnc" id="L112" title="All 6 branches missed.">        if (act != DnDConstants.ACTION_COPY &amp;&amp;</span>
            act != DnDConstants.ACTION_MOVE &amp;&amp;
            act != DnDConstants.ACTION_LINK)
<span class="nc" id="L115">            throw new IllegalArgumentException(&quot;bad action&quot;);</span>

<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (ori == null) throw new IllegalArgumentException(&quot;null origin&quot;);</span>

<span class="nc" id="L119">        events     = evs;</span>
<span class="nc" id="L120">        action     = act;</span>
<span class="nc" id="L121">        origin     = ori;</span>
<span class="nc" id="L122">    }</span>

    /**
     * Returns the source as a &lt;code&gt;DragGestureRecognizer&lt;/code&gt;.
     * &lt;P&gt;
     * @return the source as a &lt;code&gt;DragGestureRecognizer&lt;/code&gt;
     */

    public DragGestureRecognizer getSourceAsDragGestureRecognizer() {
<span class="nc" id="L131">        return (DragGestureRecognizer)getSource();</span>
    }

    /**
     * Returns the &lt;code&gt;Component&lt;/code&gt; associated
     * with this &lt;code&gt;DragGestureEvent&lt;/code&gt;.
     * &lt;P&gt;
     * @return the Component
     */

<span class="nc" id="L141">    public Component getComponent() { return component; }</span>

    /**
     * Returns the &lt;code&gt;DragSource&lt;/code&gt;.
     * &lt;P&gt;
     * @return the &lt;code&gt;DragSource&lt;/code&gt;
     */

<span class="nc" id="L149">    public DragSource getDragSource() { return dragSource; }</span>

    /**
     * Returns a &lt;code&gt;Point&lt;/code&gt; in the coordinates
     * of the &lt;code&gt;Component&lt;/code&gt; over which the drag originated.
     * &lt;P&gt;
     * @return the Point where the drag originated in Component coords.
     */

    public Point getDragOrigin() {
<span class="nc" id="L159">        return origin;</span>
    }

    /**
     * Returns an &lt;code&gt;Iterator&lt;/code&gt; for the events
     * comprising the gesture.
     * &lt;P&gt;
     * @return an Iterator for the events comprising the gesture
     */
    @SuppressWarnings(&quot;unchecked&quot;)
<span class="nc" id="L169">    public Iterator&lt;InputEvent&gt; iterator() { return events.iterator(); }</span>

    /**
     * Returns an &lt;code&gt;Object&lt;/code&gt; array of the
     * events comprising the drag gesture.
     * &lt;P&gt;
     * @return an array of the events comprising the gesture
     */

<span class="nc" id="L178">    public Object[] toArray() { return events.toArray(); }</span>

    /**
     * Returns an array of the events comprising the drag gesture.
     * &lt;P&gt;
     * @param array the array of &lt;code&gt;EventObject&lt;/code&gt; sub(types)
     * &lt;P&gt;
     * @return an array of the events comprising the gesture
     */
    @SuppressWarnings(&quot;unchecked&quot;)
<span class="nc" id="L188">    public Object[] toArray(Object[] array) { return events.toArray(array); }</span>

    /**
     * Returns an &lt;code&gt;int&lt;/code&gt; representing the
     * action selected by the user.
     * &lt;P&gt;
     * @return the action selected by the user
     */

<span class="nc" id="L197">    public int getDragAction() { return action; }</span>

    /**
     * Returns the initial event that triggered the gesture.
     * &lt;P&gt;
     * @return the first &quot;triggering&quot; event in the sequence of the gesture
     */

    public InputEvent getTriggerEvent() {
<span class="nc" id="L206">        return getSourceAsDragGestureRecognizer().getTriggerEvent();</span>
    }

    /**
     * Starts the drag operation given the &lt;code&gt;Cursor&lt;/code&gt; for this drag
     * operation and the &lt;code&gt;Transferable&lt;/code&gt; representing the source data
     * for this drag operation.
     * &lt;br&gt;
     * If a &lt;code&gt;null&lt;/code&gt; &lt;code&gt;Cursor&lt;/code&gt; is specified no exception will
     * be thrown and default drag cursors will be used instead.
     * &lt;br&gt;
     * If a &lt;code&gt;null&lt;/code&gt; &lt;code&gt;Transferable&lt;/code&gt; is specified
     * &lt;code&gt;NullPointerException&lt;/code&gt; will be thrown.
     * @param dragCursor     The initial {@code Cursor} for this drag operation
     *                       or {@code null} for the default cursor handling;
     *                       see
     *                       &lt;a href=&quot;DragSourceContext.html#defaultCursor&quot;&gt;DragSourceContext&lt;/a&gt;
     *                       for more details on the cursor handling mechanism
     *                       during drag and drop
     * @param transferable The &lt;code&gt;Transferable&lt;/code&gt; representing the source
     *                     data for this drag operation.
     *
     * @throws InvalidDnDOperationException if the Drag and Drop
     *         system is unable to initiate a drag operation, or if the user
     *         attempts to start a drag while an existing drag operation is
     *         still executing.
     * @throws NullPointerException if the {@code Transferable} is {@code null}
     * @since 1.4
     */
    public void startDrag(Cursor dragCursor, Transferable transferable)
      throws InvalidDnDOperationException {
<span class="nc" id="L237">        dragSource.startDrag(this, dragCursor, transferable, null);</span>
<span class="nc" id="L238">    }</span>

    /**
     * Starts the drag given the initial &lt;code&gt;Cursor&lt;/code&gt; to display,
     * the &lt;code&gt;Transferable&lt;/code&gt; object,
     * and the &lt;code&gt;DragSourceListener&lt;/code&gt; to use.
     * &lt;P&gt;
     * @param dragCursor     The initial {@code Cursor} for this drag operation
     *                       or {@code null} for the default cursor handling;
     *                       see
     *                       &lt;a href=&quot;DragSourceContext.html#defaultCursor&quot;&gt;DragSourceContext&lt;/a&gt;
     *                       for more details on the cursor handling mechanism
     *                       during drag and drop
     * @param transferable The source's Transferable
     * @param dsl          The source's DragSourceListener
     * &lt;P&gt;
     * @throws InvalidDnDOperationException if
     * the Drag and Drop system is unable to
     * initiate a drag operation, or if the user
     * attempts to start a drag while an existing
     * drag operation is still executing.
     */

    public void startDrag(Cursor dragCursor, Transferable transferable, DragSourceListener dsl) throws InvalidDnDOperationException {
<span class="nc" id="L262">        dragSource.startDrag(this, dragCursor, transferable, dsl);</span>
<span class="nc" id="L263">    }</span>

    /**
     * Start the drag given the initial &lt;code&gt;Cursor&lt;/code&gt; to display,
     * a drag &lt;code&gt;Image&lt;/code&gt;, the offset of
     * the &lt;code&gt;Image&lt;/code&gt;,
     * the &lt;code&gt;Transferable&lt;/code&gt; object, and
     * the &lt;code&gt;DragSourceListener&lt;/code&gt; to use.
     * &lt;P&gt;
     * @param dragCursor     The initial {@code Cursor} for this drag operation
     *                       or {@code null} for the default cursor handling;
     *                       see
     *                       &lt;a href=&quot;DragSourceContext.html#defaultCursor&quot;&gt;DragSourceContext&lt;/a&gt;
     *                       for more details on the cursor handling mechanism
     *                       during drag and drop
     * @param dragImage    The source's dragImage
     * @param imageOffset  The dragImage's offset
     * @param transferable The source's Transferable
     * @param dsl          The source's DragSourceListener
     * &lt;P&gt;
     * @throws InvalidDnDOperationException if
     * the Drag and Drop system is unable to
     * initiate a drag operation, or if the user
     * attempts to start a drag while an existing
     * drag operation is still executing.
     */

    public void startDrag(Cursor dragCursor, Image dragImage, Point imageOffset, Transferable transferable, DragSourceListener dsl) throws InvalidDnDOperationException {
<span class="nc" id="L291">        dragSource.startDrag(this,  dragCursor, dragImage, imageOffset, transferable, dsl);</span>
<span class="nc" id="L292">    }</span>

    /**
     * Serializes this &lt;code&gt;DragGestureEvent&lt;/code&gt;. Performs default
     * serialization and then writes out this object's &lt;code&gt;List&lt;/code&gt; of
     * gesture events if and only if the &lt;code&gt;List&lt;/code&gt; can be serialized.
     * If not, &lt;code&gt;null&lt;/code&gt; is written instead. In this case, a
     * &lt;code&gt;DragGestureEvent&lt;/code&gt; created from the resulting deserialized
     * stream will contain an empty &lt;code&gt;List&lt;/code&gt; of gesture events.
     *
     * @serialData The default serializable fields, in alphabetical order,
     *             followed by either a &lt;code&gt;List&lt;/code&gt; instance, or
     *             &lt;code&gt;null&lt;/code&gt;.
     * @since 1.4
     */
    private void writeObject(ObjectOutputStream s) throws IOException {
<span class="nc" id="L308">        s.defaultWriteObject();</span>

<span class="nc bnc" id="L310" title="All 2 branches missed.">        s.writeObject(SerializationTester.test(events) ? events : null);</span>
<span class="nc" id="L311">    }</span>

    /**
     * Deserializes this &lt;code&gt;DragGestureEvent&lt;/code&gt;. This method first
     * performs default deserialization for all non-&lt;code&gt;transient&lt;/code&gt;
     * fields. An attempt is then made to deserialize this object's
     * &lt;code&gt;List&lt;/code&gt; of gesture events as well. This is first attempted
     * by deserializing the field &lt;code&gt;events&lt;/code&gt;, because, in releases
     * prior to 1.4, a non-&lt;code&gt;transient&lt;/code&gt; field of this name stored the
     * &lt;code&gt;List&lt;/code&gt; of gesture events. If this fails, the next object in
     * the stream is used instead. If the resulting &lt;code&gt;List&lt;/code&gt; is
     * &lt;code&gt;null&lt;/code&gt;, this object's &lt;code&gt;List&lt;/code&gt; of gesture events
     * is set to an empty &lt;code&gt;List&lt;/code&gt;.
     *
     * @since 1.4
     */
    private void readObject(ObjectInputStream s)
        throws ClassNotFoundException, IOException
    {
<span class="nc" id="L330">        ObjectInputStream.GetField f = s.readFields();</span>

<span class="nc" id="L332">        dragSource = (DragSource)f.get(&quot;dragSource&quot;, null);</span>
<span class="nc" id="L333">        component = (Component)f.get(&quot;component&quot;, null);</span>
<span class="nc" id="L334">        origin = (Point)f.get(&quot;origin&quot;, null);</span>
<span class="nc" id="L335">        action = f.get(&quot;action&quot;, 0);</span>
        // Pre-1.4 support. 'events' was previously non-transient
        try {
<span class="nc" id="L338">            events = (List)f.get(&quot;events&quot;, null);</span>
<span class="nc" id="L339">        } catch (IllegalArgumentException e) {</span>
            // 1.4-compatible byte stream. 'events' was written explicitly
<span class="nc" id="L341">            events = (List)s.readObject();</span>
<span class="nc" id="L342">        }</span>

        // Implementation assumes 'events' is never null.
<span class="nc bnc" id="L345" title="All 2 branches missed.">        if (events == null) {</span>
<span class="nc" id="L346">            events = Collections.EMPTY_LIST;</span>
        }
<span class="nc" id="L348">    }</span>

    /*
     * fields
     */
    @SuppressWarnings(&quot;rawtypes&quot;)
    private transient List events;

    /**
     * The DragSource associated with this DragGestureEvent.
     *
     * @serial
     */
    private DragSource dragSource;

    /**
     * The Component associated with this DragGestureEvent.
     *
     * @serial
     */
    private Component  component;

    /**
     * The origin of the drag.
     *
     * @serial
     */
    private Point      origin;

    /**
     * The user's preferred action.
     *
     * @serial
     */
    private int        action;
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>