<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>DefaultPreviewPanel.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing.colorchooser</a> &gt; <span class="el_source">DefaultPreviewPanel.java</span></div><h1>DefaultPreviewPanel.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1998, 2005, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.colorchooser;

import javax.swing.*;
import javax.swing.border.*;
import javax.swing.event.*;
import javax.swing.text.*;
import java.awt.*;
import java.awt.image.*;
import java.awt.event.*;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.Serializable;
import sun.swing.SwingUtilities2;


/**
 * The standard preview panel for the color chooser.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * Serialized objects of this class will not be compatible with
 * future Swing releases. The current serialization support is
 * appropriate for short term storage or RMI between applications running
 * the same version of Swing.  As of 1.4, support for long term storage
 * of all JavaBeans&amp;trade;
 * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
 * Please see {@link java.beans.XMLEncoder}.
 *
 * @author Steve Wilson
 * @see JColorChooser
 */
<span class="nc" id="L56">class DefaultPreviewPanel extends JPanel {</span>

<span class="nc" id="L58">    private int squareSize = 25;</span>
<span class="nc" id="L59">    private int squareGap = 5;</span>
<span class="nc" id="L60">    private int innerGap = 5;</span>


<span class="nc" id="L63">    private int textGap = 5;</span>
<span class="nc" id="L64">    private Font font = new Font(Font.DIALOG, Font.PLAIN, 12);</span>
    private String sampleText;

<span class="nc" id="L67">    private int swatchWidth = 50;</span>

<span class="nc" id="L69">    private Color oldColor = null;</span>

    private JColorChooser getColorChooser() {
<span class="nc" id="L72">        return (JColorChooser)SwingUtilities.getAncestorOfClass(</span>
                                   JColorChooser.class, this);
    }

    public Dimension getPreferredSize() {
<span class="nc" id="L77">        JComponent host = getColorChooser();</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">        if (host == null) {</span>
<span class="nc" id="L79">            host = this;</span>
        }
<span class="nc" id="L81">        FontMetrics fm = host.getFontMetrics(getFont());</span>

<span class="nc" id="L83">        int ascent = fm.getAscent();</span>
<span class="nc" id="L84">        int height = fm.getHeight();</span>
<span class="nc" id="L85">        int width = SwingUtilities2.stringWidth(host, fm, getSampleText());</span>

<span class="nc" id="L87">        int y = height*3 + textGap*3;</span>
<span class="nc" id="L88">        int x = squareSize * 3 + squareGap*2 + swatchWidth + width + textGap*3;</span>
<span class="nc" id="L89">        return new Dimension( x,y );</span>
    }

    public void paintComponent(Graphics g) {
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if (oldColor == null)</span>
<span class="nc" id="L94">            oldColor = getForeground();</span>

<span class="nc" id="L96">        g.setColor(getBackground());</span>
<span class="nc" id="L97">        g.fillRect(0,0,getWidth(),getHeight());</span>

<span class="nc bnc" id="L99" title="All 2 branches missed.">        if (this.getComponentOrientation().isLeftToRight()) {</span>
<span class="nc" id="L100">            int squareWidth = paintSquares(g, 0);</span>
<span class="nc" id="L101">            int textWidth = paintText(g, squareWidth);</span>
<span class="nc" id="L102">            paintSwatch(g, squareWidth + textWidth);</span>
<span class="nc" id="L103">        } else {</span>
<span class="nc" id="L104">            int swatchWidth = paintSwatch(g, 0);</span>
<span class="nc" id="L105">            int textWidth = paintText(g, swatchWidth);</span>
<span class="nc" id="L106">            paintSquares(g , swatchWidth + textWidth);</span>

        }
<span class="nc" id="L109">    }</span>

    private int paintSwatch(Graphics g, int offsetX) {
<span class="nc" id="L112">        int swatchX = offsetX;</span>
<span class="nc" id="L113">        g.setColor(oldColor);</span>
<span class="nc" id="L114">        g.fillRect(swatchX, 0, swatchWidth, (squareSize) + (squareGap/2));</span>
<span class="nc" id="L115">        g.setColor(getForeground());</span>
<span class="nc" id="L116">        g.fillRect(swatchX, (squareSize) + (squareGap/2), swatchWidth, (squareSize) + (squareGap/2) );</span>
<span class="nc" id="L117">        return (swatchX+swatchWidth);</span>
    }

    private int paintText(Graphics g, int offsetX) {
<span class="nc" id="L121">        g.setFont(getFont());</span>
<span class="nc" id="L122">        JComponent host = getColorChooser();</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">        if (host == null) {</span>
<span class="nc" id="L124">            host = this;</span>
        }
<span class="nc" id="L126">        FontMetrics fm = SwingUtilities2.getFontMetrics(host, g);</span>

<span class="nc" id="L128">        int ascent = fm.getAscent();</span>
<span class="nc" id="L129">        int height = fm.getHeight();</span>
<span class="nc" id="L130">        int width = SwingUtilities2.stringWidth(host, fm, getSampleText());</span>

<span class="nc" id="L132">        int textXOffset = offsetX + textGap;</span>

<span class="nc" id="L134">        Color color = getForeground();</span>

<span class="nc" id="L136">        g.setColor(color);</span>

<span class="nc" id="L138">        SwingUtilities2.drawString(host, g, getSampleText(),textXOffset+(textGap/2),</span>
                                   ascent+2);

<span class="nc" id="L141">        g.fillRect(textXOffset,</span>
                   ( height) + textGap,
                   width + (textGap),
                   height +2);

<span class="nc" id="L146">        g.setColor(Color.black);</span>
<span class="nc" id="L147">        SwingUtilities2.drawString(host, g, getSampleText(),</span>
                     textXOffset+(textGap/2),
                     height+ascent+textGap+2);


<span class="nc" id="L152">        g.setColor(Color.white);</span>

<span class="nc" id="L154">        g.fillRect(textXOffset,</span>
                   ( height + textGap) * 2,
                   width + (textGap),
                   height +2);

<span class="nc" id="L159">        g.setColor(color);</span>
<span class="nc" id="L160">        SwingUtilities2.drawString(host, g, getSampleText(),</span>
                     textXOffset+(textGap/2),
                     ((height+textGap) * 2)+ascent+2);

<span class="nc" id="L164">        return width + textGap*3;</span>

    }

    private int paintSquares(Graphics g, int offsetX) {

<span class="nc" id="L170">        int squareXOffset = offsetX;</span>
<span class="nc" id="L171">        Color color = getForeground();</span>

<span class="nc" id="L173">        g.setColor(Color.white);</span>
<span class="nc" id="L174">        g.fillRect(squareXOffset,0,squareSize,squareSize);</span>
<span class="nc" id="L175">        g.setColor(color);</span>
<span class="nc" id="L176">        g.fillRect(squareXOffset+innerGap,</span>
                   innerGap,
                   squareSize - (innerGap*2),
                   squareSize - (innerGap*2));
<span class="nc" id="L180">        g.setColor(Color.white);</span>
<span class="nc" id="L181">        g.fillRect(squareXOffset+innerGap*2,</span>
                   innerGap*2,
                   squareSize - (innerGap*4),
                   squareSize - (innerGap*4));

<span class="nc" id="L186">        g.setColor(color);</span>
<span class="nc" id="L187">        g.fillRect(squareXOffset,squareSize+squareGap,squareSize,squareSize);</span>

<span class="nc" id="L189">        g.translate(squareSize+squareGap, 0);</span>
<span class="nc" id="L190">        g.setColor(Color.black);</span>
<span class="nc" id="L191">        g.fillRect(squareXOffset,0,squareSize,squareSize);</span>
<span class="nc" id="L192">        g.setColor(color);</span>
<span class="nc" id="L193">        g.fillRect(squareXOffset+innerGap,</span>
                   innerGap,
                   squareSize - (innerGap*2),
                   squareSize - (innerGap*2));
<span class="nc" id="L197">        g.setColor(Color.white);</span>
<span class="nc" id="L198">        g.fillRect(squareXOffset+innerGap*2,</span>
                   innerGap*2,
                   squareSize - (innerGap*4),
                   squareSize - (innerGap*4));
<span class="nc" id="L202">        g.translate(-(squareSize+squareGap), 0);</span>

<span class="nc" id="L204">        g.translate(squareSize+squareGap, squareSize+squareGap);</span>
<span class="nc" id="L205">        g.setColor(Color.white);</span>
<span class="nc" id="L206">        g.fillRect(squareXOffset,0,squareSize,squareSize);</span>
<span class="nc" id="L207">        g.setColor(color);</span>
<span class="nc" id="L208">        g.fillRect(squareXOffset+innerGap,</span>
                   innerGap,
                   squareSize - (innerGap*2),
                   squareSize - (innerGap*2));
<span class="nc" id="L212">        g.translate(-(squareSize+squareGap), -(squareSize+squareGap));</span>



<span class="nc" id="L216">        g.translate((squareSize+squareGap)*2, 0);</span>
<span class="nc" id="L217">        g.setColor(Color.white);</span>
<span class="nc" id="L218">        g.fillRect(squareXOffset,0,squareSize,squareSize);</span>
<span class="nc" id="L219">        g.setColor(color);</span>
<span class="nc" id="L220">        g.fillRect(squareXOffset+innerGap,</span>
                   innerGap,
                   squareSize - (innerGap*2),
                   squareSize - (innerGap*2));
<span class="nc" id="L224">        g.setColor(Color.black);</span>
<span class="nc" id="L225">        g.fillRect(squareXOffset+innerGap*2,</span>
                   innerGap*2,
                   squareSize - (innerGap*4),
                   squareSize - (innerGap*4));
<span class="nc" id="L229">        g.translate(-((squareSize+squareGap)*2), 0);</span>

<span class="nc" id="L231">        g.translate((squareSize+squareGap)*2, (squareSize+squareGap));</span>
<span class="nc" id="L232">        g.setColor(Color.black);</span>
<span class="nc" id="L233">        g.fillRect(squareXOffset,0,squareSize,squareSize);</span>
<span class="nc" id="L234">        g.setColor(color);</span>
<span class="nc" id="L235">        g.fillRect(squareXOffset+innerGap,</span>
                   innerGap,
                   squareSize - (innerGap*2),
                   squareSize - (innerGap*2));
<span class="nc" id="L239">        g.translate(-((squareSize+squareGap)*2), -(squareSize+squareGap));</span>

<span class="nc" id="L241">        return (squareSize*3+squareGap*2);</span>

    }

    private String getSampleText() {
<span class="nc bnc" id="L246" title="All 2 branches missed.">        if (this.sampleText == null) {</span>
<span class="nc" id="L247">            this.sampleText = UIManager.getString(&quot;ColorChooser.sampleText&quot;, getLocale());</span>
        }
<span class="nc" id="L249">        return this.sampleText;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>