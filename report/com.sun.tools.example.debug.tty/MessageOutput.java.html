<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>MessageOutput.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">com.sun.tools.example.debug.tty</a> &gt; <span class="el_source">MessageOutput.java</span></div><h1>MessageOutput.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2001, 2011, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

/*
 * This source code is provided to illustrate the usage of a given feature
 * or technique and has been deliberately simplified. Additional steps
 * required for a production-quality application, such as security checks,
 * input validation and proper error handling, might not be present in
 * this sample code.
 */

package com.sun.tools.example.debug.tty;

import java.util.*;
import java.text.MessageFormat;
/**
 * Internationalization (i18n) convenience methods for jdb.
 *
 * All program output should flow through these methods, and this is
 * the only class that should be printing directly or otherwise
 * accessing System.[out,err].
 *
 * @bug 4348376
 * @author Tim Bell
 */
<span class="nc" id="L48">public class MessageOutput {</span>
    /**
     * The resource bundle containing localizable message content.
     * This is loaded by TTY.main() at start-up
     */
    static ResourceBundle textResources;

    /** Our message formatter.  Allocated once, used many times */
    private static MessageFormat messageFormat;

    /**
     * Fatal shutdown notification.  This is sent to System.err
     * instead of System.out
     */
    static void fatalError(String messageKey) {
<span class="nc" id="L63">        System.err.println();</span>
<span class="nc" id="L64">        System.err.println(format(&quot;Fatal error&quot;));</span>
<span class="nc" id="L65">        System.err.println(format(messageKey));</span>
<span class="nc" id="L66">        Env.shutdown();</span>
<span class="nc" id="L67">    }</span>

    /**
     * &quot;Format&quot; a string by doing a simple key lookup.
     */
    static String format(String key) {
<span class="nc" id="L73">        return (textResources.getString(key));</span>
    }

    /**
     * Fetch and format a message with one string argument.
     * This is the most common usage.
     */
    static String format(String key, String argument) {
<span class="nc" id="L81">        return format(key, new Object [] {argument});</span>
    }

    /**
     * Fetch a string by key lookup and format in the arguments.
     */
    static synchronized String format(String key, Object [] arguments) {
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (messageFormat == null) {</span>
<span class="nc" id="L89">            messageFormat = new MessageFormat (textResources.getString(key));</span>
        } else {
<span class="nc" id="L91">            messageFormat.applyPattern (textResources.getString(key));</span>
        }
<span class="nc" id="L93">        return (messageFormat.format (arguments));</span>
    }

    /**
     * Print directly to System.out.
     * Every rule has a few exceptions.
     * The exceptions to &quot;must use the MessageOutput formatters&quot; are:
     *     VMConnection.dumpStream()
     *     TTY.monitorCommand()
     *     TTY.TTY() (for the '!!' command only)
     *     Commands.java (multiple locations)
     * These are the only sites that should be calling this
     * method.
     */
    static void printDirectln(String line) {
<span class="nc" id="L108">        System.out.println(line);</span>
<span class="nc" id="L109">    }</span>
    static void printDirect(String line) {
<span class="nc" id="L111">        System.out.print(line);</span>
<span class="nc" id="L112">    }</span>
    static void printDirect(char c) {
<span class="nc" id="L114">        System.out.print(c);</span>
<span class="nc" id="L115">    }</span>

    /**
     * Print a newline.
     * Use this instead of '\n'
     */
    static void println() {
<span class="nc" id="L122">        System.out.println();</span>
<span class="nc" id="L123">    }</span>

    /**
     * Format and print a simple string.
     */
    static void print(String key) {
<span class="nc" id="L129">        System.out.print(format(key));</span>
<span class="nc" id="L130">    }</span>
    /**
     * Format and print a simple string.
     */
    static void println(String key) {
<span class="nc" id="L135">        System.out.println(format(key));</span>
<span class="nc" id="L136">    }</span>


    /**
     * Fetch, format and print a message with one string argument.
     * This is the most common usage.
     */
    static void print(String key, String argument) {
<span class="nc" id="L144">        System.out.print(format(key, argument));</span>
<span class="nc" id="L145">    }</span>
    static void println(String key, String argument) {
<span class="nc" id="L147">        System.out.println(format(key, argument));</span>
<span class="nc" id="L148">    }</span>

    /**
     * Fetch, format and print a message with an arbitrary
     * number of message arguments.
     */
    static void println(String key, Object [] arguments) {
<span class="nc" id="L155">        System.out.println(format(key, arguments));</span>
<span class="nc" id="L156">    }</span>

    /**
     * Print a newline, followed by the string.
     */
    static void lnprint(String key) {
<span class="nc" id="L162">        System.out.println();</span>
<span class="nc" id="L163">        System.out.print(textResources.getString(key));</span>
<span class="nc" id="L164">    }</span>

    static void lnprint(String key, String argument) {
<span class="nc" id="L167">        System.out.println();</span>
<span class="nc" id="L168">        System.out.print(format(key, argument));</span>
<span class="nc" id="L169">    }</span>

    static void lnprint(String key, Object [] arguments) {
<span class="nc" id="L172">        System.out.println();</span>
<span class="nc" id="L173">        System.out.print(format(key, arguments));</span>
<span class="nc" id="L174">    }</span>

    /**
     * Print an exception message with a stack trace.
     */
    static void printException(String key, Exception e) {
<span class="nc bnc" id="L180" title="All 2 branches missed.">        if (key != null) {</span>
            try {
<span class="nc" id="L182">                println(key);</span>
<span class="nc" id="L183">            } catch (MissingResourceException mex) {</span>
<span class="nc" id="L184">                printDirectln(key);</span>
<span class="nc" id="L185">            }</span>
        }
<span class="nc" id="L187">        System.out.flush();</span>
<span class="nc" id="L188">        e.printStackTrace();</span>
<span class="nc" id="L189">    }</span>

    static void printPrompt() {
<span class="nc" id="L192">        ThreadInfo threadInfo = ThreadInfo.getCurrentThreadInfo();</span>
<span class="nc bnc" id="L193" title="All 2 branches missed.">        if (threadInfo == null) {</span>
<span class="nc" id="L194">            System.out.print</span>
<span class="nc" id="L195">                (MessageOutput.format(&quot;jdb prompt with no current thread&quot;));</span>
        } else {
<span class="nc" id="L197">            System.out.print</span>
<span class="nc" id="L198">                (MessageOutput.format(&quot;jdb prompt thread name and current stack frame&quot;,</span>
                                      new Object [] {
<span class="nc" id="L200">                                          threadInfo.getThread().name(),</span>
<span class="nc" id="L201">                                          new Integer (threadInfo.getCurrentFrameIndex() + 1)}));</span>
        }
<span class="nc" id="L203">        System.out.flush();</span>
<span class="nc" id="L204">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>