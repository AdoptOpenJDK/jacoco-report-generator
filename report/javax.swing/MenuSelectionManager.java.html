<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>MenuSelectionManager.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing</a> &gt; <span class="el_source">MenuSelectionManager.java</span></div><h1>MenuSelectionManager.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package javax.swing;

import java.awt.*;
import java.util.*;
import java.awt.event.*;
import javax.swing.event.*;

import sun.awt.AppContext;

/**
 * A MenuSelectionManager owns the selection in menu hierarchy.
 *
 * @author Arnaud Weber
 */
<span class="nc" id="L39">public class MenuSelectionManager {</span>
<span class="nc" id="L40">    private Vector&lt;MenuElement&gt; selection = new Vector&lt;MenuElement&gt;();</span>

    /* diagnostic aids -- should be false for production builds. */
    private static final boolean TRACE =   false; // trace creates and disposes
    private static final boolean VERBOSE = false; // show reuse hits/misses
    private static final boolean DEBUG =   false;  // show bad params, misc.

<span class="nc" id="L47">    private static final StringBuilder MENU_SELECTION_MANAGER_KEY =</span>
                       new StringBuilder(&quot;javax.swing.MenuSelectionManager&quot;);

    /**
     * Returns the default menu selection manager.
     *
     * @return a MenuSelectionManager object
     */
    public static MenuSelectionManager defaultManager() {
<span class="nc" id="L56">        synchronized (MENU_SELECTION_MANAGER_KEY) {</span>
<span class="nc" id="L57">            AppContext context = AppContext.getAppContext();</span>
<span class="nc" id="L58">            MenuSelectionManager msm = (MenuSelectionManager)context.get(</span>
                                                 MENU_SELECTION_MANAGER_KEY);
<span class="nc bnc" id="L60" title="All 2 branches missed.">            if (msm == null) {</span>
<span class="nc" id="L61">                msm = new MenuSelectionManager();</span>
<span class="nc" id="L62">                context.put(MENU_SELECTION_MANAGER_KEY, msm);</span>
            }

<span class="nc" id="L65">            return msm;</span>
<span class="nc" id="L66">        }</span>
    }

    /**
     * Only one ChangeEvent is needed per button model instance since the
     * event's only state is the source property.  The source of events
     * generated is always &quot;this&quot;.
     */
<span class="nc" id="L74">    protected transient ChangeEvent changeEvent = null;</span>
<span class="nc" id="L75">    protected EventListenerList listenerList = new EventListenerList();</span>

    /**
     * Changes the selection in the menu hierarchy.  The elements
     * in the array are sorted in order from the root menu
     * element to the currently selected menu element.
     * &lt;p&gt;
     * Note that this method is public but is used by the look and
     * feel engine and should not be called by client applications.
     *
     * @param path  an array of &lt;code&gt;MenuElement&lt;/code&gt; objects specifying
     *        the selected path
     */
    public void setSelectedPath(MenuElement[] path) {
        int i,c;
<span class="nc" id="L90">        int currentSelectionCount = selection.size();</span>
<span class="nc" id="L91">        int firstDifference = 0;</span>

<span class="nc bnc" id="L93" title="All 2 branches missed.">        if(path == null) {</span>
<span class="nc" id="L94">            path = new MenuElement[0];</span>
        }

        if (DEBUG) {
            System.out.print(&quot;Previous:  &quot;); printMenuElementArray(getSelectedPath());
            System.out.print(&quot;New:  &quot;); printMenuElementArray(path);
        }

<span class="nc bnc" id="L102" title="All 2 branches missed.">        for(i=0,c=path.length;i&lt;c;i++) {</span>
<span class="nc bnc" id="L103" title="All 4 branches missed.">            if (i &lt; currentSelectionCount &amp;&amp; selection.elementAt(i) == path[i])</span>
<span class="nc" id="L104">                firstDifference++;</span>
            else
                break;
        }

<span class="nc bnc" id="L109" title="All 2 branches missed.">        for(i=currentSelectionCount - 1 ; i &gt;= firstDifference ; i--) {</span>
<span class="nc" id="L110">            MenuElement me = selection.elementAt(i);</span>
<span class="nc" id="L111">            selection.removeElementAt(i);</span>
<span class="nc" id="L112">            me.menuSelectionChanged(false);</span>
        }

<span class="nc bnc" id="L115" title="All 2 branches missed.">        for(i = firstDifference, c = path.length ; i &lt; c ; i++) {</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            if (path[i] != null) {</span>
<span class="nc" id="L117">                selection.addElement(path[i]);</span>
<span class="nc" id="L118">                path[i].menuSelectionChanged(true);</span>
            }
        }

<span class="nc" id="L122">        fireStateChanged();</span>
<span class="nc" id="L123">    }</span>

    /**
     * Returns the path to the currently selected menu item
     *
     * @return an array of MenuElement objects representing the selected path
     */
    public MenuElement[] getSelectedPath() {
<span class="nc" id="L131">        MenuElement res[] = new MenuElement[selection.size()];</span>
        int i,c;
<span class="nc bnc" id="L133" title="All 2 branches missed.">        for(i=0,c=selection.size();i&lt;c;i++)</span>
<span class="nc" id="L134">            res[i] = selection.elementAt(i);</span>
<span class="nc" id="L135">        return res;</span>
    }

    /**
     * Tell the menu selection to close and unselect all the menu components. Call this method
     * when a choice has been made
     */
    public void clearSelectedPath() {
<span class="nc bnc" id="L143" title="All 2 branches missed.">        if (selection.size() &gt; 0) {</span>
<span class="nc" id="L144">            setSelectedPath(null);</span>
        }
<span class="nc" id="L146">    }</span>

    /**
     * Adds a ChangeListener to the button.
     *
     * @param l the listener to add
     */
    public void addChangeListener(ChangeListener l) {
<span class="nc" id="L154">        listenerList.add(ChangeListener.class, l);</span>
<span class="nc" id="L155">    }</span>

    /**
     * Removes a ChangeListener from the button.
     *
     * @param l the listener to remove
     */
    public void removeChangeListener(ChangeListener l) {
<span class="nc" id="L163">        listenerList.remove(ChangeListener.class, l);</span>
<span class="nc" id="L164">    }</span>

    /**
     * Returns an array of all the &lt;code&gt;ChangeListener&lt;/code&gt;s added
     * to this MenuSelectionManager with addChangeListener().
     *
     * @return all of the &lt;code&gt;ChangeListener&lt;/code&gt;s added or an empty
     *         array if no listeners have been added
     * @since 1.4
     */
    public ChangeListener[] getChangeListeners() {
<span class="nc" id="L175">        return listenerList.getListeners(ChangeListener.class);</span>
    }

    /**
     * Notifies all listeners that have registered interest for
     * notification on this event type.  The event instance
     * is created lazily.
     *
     * @see EventListenerList
     */
    protected void fireStateChanged() {
        // Guaranteed to return a non-null array
<span class="nc" id="L187">        Object[] listeners = listenerList.getListenerList();</span>
        // Process the listeners last to first, notifying
        // those that are interested in this event
<span class="nc bnc" id="L190" title="All 2 branches missed.">        for (int i = listeners.length-2; i&gt;=0; i-=2) {</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">            if (listeners[i]==ChangeListener.class) {</span>
                // Lazily create the event:
<span class="nc bnc" id="L193" title="All 2 branches missed.">                if (changeEvent == null)</span>
<span class="nc" id="L194">                    changeEvent = new ChangeEvent(this);</span>
<span class="nc" id="L195">                ((ChangeListener)listeners[i+1]).stateChanged(changeEvent);</span>
            }
        }
<span class="nc" id="L198">    }</span>

    /**
     * When a MenuElement receives an event from a MouseListener, it should never process the event
     * directly. Instead all MenuElements should call this method with the event.
     *
     * @param event  a MouseEvent object
     */
    public void processMouseEvent(MouseEvent event) {
        int screenX,screenY;
        Point p;
        int i,c,j,d;
        Component mc;
        Rectangle r2;
        int cWidth,cHeight;
        MenuElement menuElement;
        MenuElement subElements[];
        MenuElement path[];
        Vector&lt;MenuElement&gt; tmp;
        int selectionSize;
<span class="nc" id="L218">        p = event.getPoint();</span>

<span class="nc" id="L220">        Component source = event.getComponent();</span>

<span class="nc bnc" id="L222" title="All 4 branches missed.">        if ((source != null) &amp;&amp; !source.isShowing()) {</span>
            // This can happen if a mouseReleased removes the
            // containing component -- bug 4146684
<span class="nc" id="L225">            return;</span>
        }

<span class="nc" id="L228">        int type = event.getID();</span>
<span class="nc" id="L229">        int modifiers = event.getModifiers();</span>
        // 4188027: drag enter/exit added in JDK 1.1.7A, JDK1.2
<span class="nc bnc" id="L231" title="All 6 branches missed.">        if ((type==MouseEvent.MOUSE_ENTERED||</span>
             type==MouseEvent.MOUSE_EXITED)
            &amp;&amp; ((modifiers &amp; (InputEvent.BUTTON1_MASK |
                              InputEvent.BUTTON2_MASK | InputEvent.BUTTON3_MASK)) !=0 )) {
<span class="nc" id="L235">            return;</span>
        }

<span class="nc bnc" id="L238" title="All 2 branches missed.">        if (source != null) {</span>
<span class="nc" id="L239">            SwingUtilities.convertPointToScreen(p, source);</span>
        }

<span class="nc" id="L242">        screenX = p.x;</span>
<span class="nc" id="L243">        screenY = p.y;</span>

<span class="nc" id="L245">        tmp = (Vector&lt;MenuElement&gt;)selection.clone();</span>
<span class="nc" id="L246">        selectionSize = tmp.size();</span>
<span class="nc" id="L247">        boolean success = false;</span>
<span class="nc bnc" id="L248" title="All 4 branches missed.">        for (i=selectionSize - 1;i &gt;= 0 &amp;&amp; success == false; i--) {</span>
<span class="nc" id="L249">            menuElement = (MenuElement) tmp.elementAt(i);</span>
<span class="nc" id="L250">            subElements = menuElement.getSubElements();</span>

<span class="nc" id="L252">            path = null;</span>
<span class="nc bnc" id="L253" title="All 4 branches missed.">            for (j = 0, d = subElements.length;j &lt; d &amp;&amp; success == false; j++) {</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">                if (subElements[j] == null)</span>
<span class="nc" id="L255">                    continue;</span>
<span class="nc" id="L256">                mc = subElements[j].getComponent();</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">                if(!mc.isShowing())</span>
<span class="nc" id="L258">                    continue;</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">                if(mc instanceof JComponent) {</span>
<span class="nc" id="L260">                    cWidth  = mc.getWidth();</span>
<span class="nc" id="L261">                    cHeight = mc.getHeight();</span>
                } else {
<span class="nc" id="L263">                    r2 = mc.getBounds();</span>
<span class="nc" id="L264">                    cWidth  = r2.width;</span>
<span class="nc" id="L265">                    cHeight = r2.height;</span>
                }
<span class="nc" id="L267">                p.x = screenX;</span>
<span class="nc" id="L268">                p.y = screenY;</span>
<span class="nc" id="L269">                SwingUtilities.convertPointFromScreen(p,mc);</span>

                /** Send the event to visible menu element if menu element currently in
                 *  the selected path or contains the event location
                 */
<span class="nc bnc" id="L274" title="All 8 branches missed.">                if(</span>
                   (p.x &gt;= 0 &amp;&amp; p.x &lt; cWidth &amp;&amp; p.y &gt;= 0 &amp;&amp; p.y &lt; cHeight)) {
                    int k;
<span class="nc bnc" id="L277" title="All 2 branches missed.">                    if(path == null) {</span>
<span class="nc" id="L278">                        path = new MenuElement[i+2];</span>
<span class="nc bnc" id="L279" title="All 2 branches missed.">                        for(k=0;k&lt;=i;k++)</span>
<span class="nc" id="L280">                            path[k] = (MenuElement)tmp.elementAt(k);</span>
                    }
<span class="nc" id="L282">                    path[i+1] = subElements[j];</span>
<span class="nc" id="L283">                    MenuElement currentSelection[] = getSelectedPath();</span>

                    // Enter/exit detection -- needs tuning...
<span class="nc bnc" id="L286" title="All 6 branches missed.">                    if (currentSelection[currentSelection.length-1] !=</span>
                        path[i+1] &amp;&amp;
                        (currentSelection.length &lt; 2 ||
                         currentSelection[currentSelection.length-2] !=
                         path[i+1])) {
<span class="nc" id="L291">                        Component oldMC = currentSelection[currentSelection.length-1].getComponent();</span>

<span class="nc" id="L293">                        MouseEvent exitEvent = new MouseEvent(oldMC, MouseEvent.MOUSE_EXITED,</span>
<span class="nc" id="L294">                                                              event.getWhen(),</span>
<span class="nc" id="L295">                                                              event.getModifiers(), p.x, p.y,</span>
<span class="nc" id="L296">                                                              event.getXOnScreen(),</span>
<span class="nc" id="L297">                                                              event.getYOnScreen(),</span>
<span class="nc" id="L298">                                                              event.getClickCount(),</span>
<span class="nc" id="L299">                                                              event.isPopupTrigger(),</span>
                                                              MouseEvent.NOBUTTON);
<span class="nc" id="L301">                        currentSelection[currentSelection.length-1].</span>
<span class="nc" id="L302">                            processMouseEvent(exitEvent, path, this);</span>

<span class="nc" id="L304">                        MouseEvent enterEvent = new MouseEvent(mc,</span>
                                                               MouseEvent.MOUSE_ENTERED,
<span class="nc" id="L306">                                                               event.getWhen(),</span>
<span class="nc" id="L307">                                                               event.getModifiers(), p.x, p.y,</span>
<span class="nc" id="L308">                                                               event.getXOnScreen(),</span>
<span class="nc" id="L309">                                                               event.getYOnScreen(),</span>
<span class="nc" id="L310">                                                               event.getClickCount(),</span>
<span class="nc" id="L311">                                                               event.isPopupTrigger(),</span>
                                                               MouseEvent.NOBUTTON);
<span class="nc" id="L313">                        subElements[j].processMouseEvent(enterEvent, path, this);</span>
                    }
<span class="nc" id="L315">                    MouseEvent mouseEvent = new MouseEvent(mc, event.getID(),event. getWhen(),</span>
<span class="nc" id="L316">                                                           event.getModifiers(), p.x, p.y,</span>
<span class="nc" id="L317">                                                           event.getXOnScreen(),</span>
<span class="nc" id="L318">                                                           event.getYOnScreen(),</span>
<span class="nc" id="L319">                                                           event.getClickCount(),</span>
<span class="nc" id="L320">                                                           event.isPopupTrigger(),</span>
                                                           MouseEvent.NOBUTTON);
<span class="nc" id="L322">                    subElements[j].processMouseEvent(mouseEvent, path, this);</span>
<span class="nc" id="L323">                    success = true;</span>
<span class="nc" id="L324">                    event.consume();</span>
                }
            }
        }
<span class="nc" id="L328">    }</span>

    private void printMenuElementArray(MenuElement path[]) {
<span class="nc" id="L331">        printMenuElementArray(path, false);</span>
<span class="nc" id="L332">    }</span>

    private void printMenuElementArray(MenuElement path[], boolean dumpStack) {
<span class="nc" id="L335">        System.out.println(&quot;Path is(&quot;);</span>
        int i, j;
<span class="nc bnc" id="L337" title="All 2 branches missed.">        for(i=0,j=path.length; i&lt;j ;i++){</span>
<span class="nc bnc" id="L338" title="All 2 branches missed.">            for (int k=0; k&lt;=i; k++)</span>
<span class="nc" id="L339">                System.out.print(&quot;  &quot;);</span>
<span class="nc" id="L340">            MenuElement me = path[i];</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">            if(me instanceof JMenuItem) {</span>
<span class="nc" id="L342">                System.out.println(((JMenuItem)me).getText() + &quot;, &quot;);</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">            } else if (me instanceof JMenuBar) {</span>
<span class="nc" id="L344">                System.out.println(&quot;JMenuBar, &quot;);</span>
<span class="nc bnc" id="L345" title="All 2 branches missed.">            } else if(me instanceof JPopupMenu) {</span>
<span class="nc" id="L346">                System.out.println(&quot;JPopupMenu, &quot;);</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">            } else if (me == null) {</span>
<span class="nc" id="L348">                System.out.println(&quot;NULL , &quot;);</span>
            } else {
<span class="nc" id="L350">                System.out.println(&quot;&quot; + me + &quot;, &quot;);</span>
            }
        }
<span class="nc" id="L353">        System.out.println(&quot;)&quot;);</span>

<span class="nc bnc" id="L355" title="All 2 branches missed.">        if (dumpStack == true)</span>
<span class="nc" id="L356">            Thread.dumpStack();</span>
<span class="nc" id="L357">    }</span>

    /**
     * Returns the component in the currently selected path
     * which contains sourcePoint.
     *
     * @param source The component in whose coordinate space sourcePoint
     *        is given
     * @param sourcePoint The point which is being tested
     * @return The component in the currently selected path which
     *         contains sourcePoint (relative to the source component's
     *         coordinate space.  If sourcePoint is not inside a component
     *         on the currently selected path, null is returned.
     */
    public Component componentForPoint(Component source, Point sourcePoint) {
        int screenX,screenY;
<span class="nc" id="L373">        Point p = sourcePoint;</span>
        int i,c,j,d;
        Component mc;
        Rectangle r2;
        int cWidth,cHeight;
        MenuElement menuElement;
        MenuElement subElements[];
        Vector&lt;MenuElement&gt; tmp;
        int selectionSize;

<span class="nc" id="L383">        SwingUtilities.convertPointToScreen(p,source);</span>

<span class="nc" id="L385">        screenX = p.x;</span>
<span class="nc" id="L386">        screenY = p.y;</span>

<span class="nc" id="L388">        tmp = (Vector&lt;MenuElement&gt;)selection.clone();</span>
<span class="nc" id="L389">        selectionSize = tmp.size();</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">        for(i=selectionSize - 1 ; i &gt;= 0 ; i--) {</span>
<span class="nc" id="L391">            menuElement = (MenuElement) tmp.elementAt(i);</span>
<span class="nc" id="L392">            subElements = menuElement.getSubElements();</span>

<span class="nc bnc" id="L394" title="All 2 branches missed.">            for(j = 0, d = subElements.length ; j &lt; d ; j++) {</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">                if (subElements[j] == null)</span>
<span class="nc" id="L396">                    continue;</span>
<span class="nc" id="L397">                mc = subElements[j].getComponent();</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">                if(!mc.isShowing())</span>
<span class="nc" id="L399">                    continue;</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">                if(mc instanceof JComponent) {</span>
<span class="nc" id="L401">                    cWidth  = mc.getWidth();</span>
<span class="nc" id="L402">                    cHeight = mc.getHeight();</span>
                } else {
<span class="nc" id="L404">                    r2 = mc.getBounds();</span>
<span class="nc" id="L405">                    cWidth  = r2.width;</span>
<span class="nc" id="L406">                    cHeight = r2.height;</span>
                }
<span class="nc" id="L408">                p.x = screenX;</span>
<span class="nc" id="L409">                p.y = screenY;</span>
<span class="nc" id="L410">                SwingUtilities.convertPointFromScreen(p,mc);</span>

                /** Return the deepest component on the selection
                 *  path in whose bounds the event's point occurs
                 */
<span class="nc bnc" id="L415" title="All 8 branches missed.">                if (p.x &gt;= 0 &amp;&amp; p.x &lt; cWidth &amp;&amp; p.y &gt;= 0 &amp;&amp; p.y &lt; cHeight) {</span>
<span class="nc" id="L416">                    return mc;</span>
                }
            }
        }
<span class="nc" id="L420">        return null;</span>
    }

    /**
     * When a MenuElement receives an event from a KeyListener, it should never process the event
     * directly. Instead all MenuElements should call this method with the event.
     *
     * @param e  a KeyEvent object
     */
    public void processKeyEvent(KeyEvent e) {
<span class="nc" id="L430">        MenuElement[] sel2 = new MenuElement[0];</span>
<span class="nc" id="L431">        sel2 = selection.toArray(sel2);</span>
<span class="nc" id="L432">        int selSize = sel2.length;</span>
        MenuElement[] path;

<span class="nc bnc" id="L435" title="All 2 branches missed.">        if (selSize &lt; 1) {</span>
<span class="nc" id="L436">            return;</span>
        }

<span class="nc bnc" id="L439" title="All 2 branches missed.">        for (int i=selSize-1; i&gt;=0; i--) {</span>
<span class="nc" id="L440">            MenuElement elem = sel2[i];</span>
<span class="nc" id="L441">            MenuElement[] subs = elem.getSubElements();</span>
<span class="nc" id="L442">            path = null;</span>

<span class="nc bnc" id="L444" title="All 2 branches missed.">            for (int j=0; j&lt;subs.length; j++) {</span>
<span class="nc bnc" id="L445" title="All 4 branches missed.">                if (subs[j] == null || !subs[j].getComponent().isShowing()</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">                    || !subs[j].getComponent().isEnabled()) {</span>
<span class="nc" id="L447">                    continue;</span>
                }

<span class="nc bnc" id="L450" title="All 2 branches missed.">                if(path == null) {</span>
<span class="nc" id="L451">                    path = new MenuElement[i+2];</span>
<span class="nc" id="L452">                    System.arraycopy(sel2, 0, path, 0, i+1);</span>
                    }
<span class="nc" id="L454">                path[i+1] = subs[j];</span>
<span class="nc" id="L455">                subs[j].processKeyEvent(e, path, this);</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">                if (e.isConsumed()) {</span>
<span class="nc" id="L457">                    return;</span>
            }
        }
    }

        // finally dispatch event to the first component in path
<span class="nc" id="L463">        path = new MenuElement[1];</span>
<span class="nc" id="L464">        path[0] = sel2[0];</span>
<span class="nc" id="L465">        path[0].processKeyEvent(e, path, this);</span>
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (e.isConsumed()) {</span>
<span class="nc" id="L467">            return;</span>
        }
<span class="nc" id="L469">    }</span>

    /**
     * Return true if c is part of the currently used menu
     */
    public boolean isComponentPartOfCurrentMenu(Component c) {
<span class="nc bnc" id="L475" title="All 2 branches missed.">        if(selection.size() &gt; 0) {</span>
<span class="nc" id="L476">            MenuElement me = selection.elementAt(0);</span>
<span class="nc" id="L477">            return isComponentPartOfCurrentMenu(me,c);</span>
        } else
<span class="nc" id="L479">            return false;</span>
    }

    private boolean isComponentPartOfCurrentMenu(MenuElement root,Component c) {
        MenuElement children[];
        int i,d;

<span class="nc bnc" id="L486" title="All 2 branches missed.">        if (root == null)</span>
<span class="nc" id="L487">            return false;</span>

<span class="nc bnc" id="L489" title="All 2 branches missed.">        if(root.getComponent() == c)</span>
<span class="nc" id="L490">            return true;</span>
        else {
<span class="nc" id="L492">            children = root.getSubElements();</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">            for(i=0,d=children.length;i&lt;d;i++) {</span>
<span class="nc bnc" id="L494" title="All 2 branches missed.">                if(isComponentPartOfCurrentMenu(children[i],c))</span>
<span class="nc" id="L495">                    return true;</span>
            }
        }
<span class="nc" id="L498">        return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>