<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>AbstractButton.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing</a> &gt; <span class="el_source">AbstractButton.java</span></div><h1>AbstractButton.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2011, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package javax.swing;

import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import java.text.*;
import java.awt.geom.*;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.beans.Transient;
import java.util.Enumeration;
import java.util.Vector;
import java.io.Serializable;
import javax.swing.event.*;
import javax.swing.border.*;
import javax.swing.plaf.*;
import javax.accessibility.*;
import javax.swing.text.*;
import javax.swing.text.html.*;
import javax.swing.plaf.basic.*;
import java.util.*;

/**
 * Defines common behaviors for buttons and menu items.
 * &lt;p&gt;
 * Buttons can be configured, and to some degree controlled, by
 * &lt;code&gt;&lt;a href=&quot;Action.html&quot;&gt;Action&lt;/a&gt;&lt;/code&gt;s.  Using an
 * &lt;code&gt;Action&lt;/code&gt; with a button has many benefits beyond directly
 * configuring a button.  Refer to &lt;a href=&quot;Action.html#buttonActions&quot;&gt;
 * Swing Components Supporting &lt;code&gt;Action&lt;/code&gt;&lt;/a&gt; for more
 * details, and you can find more information in &lt;a
 * href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html&quot;&gt;How
 * to Use Actions&lt;/a&gt;, a section in &lt;em&gt;The Java Tutorial&lt;/em&gt;.
 * &lt;p&gt;
 * For further information see
 * &lt;a
 href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/components/button.html&quot;&gt;How to Use Buttons, Check Boxes, and Radio Buttons&lt;/a&gt;,
 * a section in &lt;em&gt;The Java Tutorial&lt;/em&gt;.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * Serialized objects of this class will not be compatible with
 * future Swing releases. The current serialization support is
 * appropriate for short term storage or RMI between applications running
 * the same version of Swing.  As of 1.4, support for long term storage
 * of all JavaBeans&amp;trade;
 * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
 * Please see {@link java.beans.XMLEncoder}.
 *
 * @author Jeff Dinkins
 */
<span class="nc" id="L75">public abstract class AbstractButton extends JComponent implements ItemSelectable, SwingConstants {</span>

    // *********************************
    // ******* Button properties *******
    // *********************************

    /** Identifies a change in the button model. */
    public static final String MODEL_CHANGED_PROPERTY = &quot;model&quot;;
    /** Identifies a change in the button's text. */
    public static final String TEXT_CHANGED_PROPERTY = &quot;text&quot;;
    /** Identifies a change to the button's mnemonic. */
    public static final String MNEMONIC_CHANGED_PROPERTY = &quot;mnemonic&quot;;

    // Text positioning and alignment
    /** Identifies a change in the button's margins. */
    public static final String MARGIN_CHANGED_PROPERTY = &quot;margin&quot;;
    /** Identifies a change in the button's vertical alignment. */
    public static final String VERTICAL_ALIGNMENT_CHANGED_PROPERTY = &quot;verticalAlignment&quot;;
    /** Identifies a change in the button's horizontal alignment. */
    public static final String HORIZONTAL_ALIGNMENT_CHANGED_PROPERTY = &quot;horizontalAlignment&quot;;

    /** Identifies a change in the button's vertical text position. */
    public static final String VERTICAL_TEXT_POSITION_CHANGED_PROPERTY = &quot;verticalTextPosition&quot;;
    /** Identifies a change in the button's horizontal text position. */
    public static final String HORIZONTAL_TEXT_POSITION_CHANGED_PROPERTY = &quot;horizontalTextPosition&quot;;

    // Paint options
    /**
     * Identifies a change to having the border drawn,
     * or having it not drawn.
     */
    public static final String BORDER_PAINTED_CHANGED_PROPERTY = &quot;borderPainted&quot;;
    /**
     * Identifies a change to having the border highlighted when focused,
     * or not.
     */
    public static final String FOCUS_PAINTED_CHANGED_PROPERTY = &quot;focusPainted&quot;;
    /**
     * Identifies a change from rollover enabled to disabled or back
     * to enabled.
     */
    public static final String ROLLOVER_ENABLED_CHANGED_PROPERTY = &quot;rolloverEnabled&quot;;
    /**
     * Identifies a change to having the button paint the content area.
     */
    public static final String CONTENT_AREA_FILLED_CHANGED_PROPERTY = &quot;contentAreaFilled&quot;;

    // Icons
    /** Identifies a change to the icon that represents the button. */
    public static final String ICON_CHANGED_PROPERTY = &quot;icon&quot;;

    /**
     * Identifies a change to the icon used when the button has been
     * pressed.
     */
    public static final String PRESSED_ICON_CHANGED_PROPERTY = &quot;pressedIcon&quot;;
    /**
     * Identifies a change to the icon used when the button has
     * been selected.
     */
    public static final String SELECTED_ICON_CHANGED_PROPERTY = &quot;selectedIcon&quot;;

    /**
     * Identifies a change to the icon used when the cursor is over
     * the button.
     */
    public static final String ROLLOVER_ICON_CHANGED_PROPERTY = &quot;rolloverIcon&quot;;
    /**
     * Identifies a change to the icon used when the cursor is
     * over the button and it has been selected.
     */
    public static final String ROLLOVER_SELECTED_ICON_CHANGED_PROPERTY = &quot;rolloverSelectedIcon&quot;;

    /**
     * Identifies a change to the icon used when the button has
     * been disabled.
     */
    public static final String DISABLED_ICON_CHANGED_PROPERTY = &quot;disabledIcon&quot;;
    /**
     * Identifies a change to the icon used when the button has been
     * disabled and selected.
     */
    public static final String DISABLED_SELECTED_ICON_CHANGED_PROPERTY = &quot;disabledSelectedIcon&quot;;


    /** The data model that determines the button's state. */
<span class="nc" id="L161">    protected ButtonModel model                = null;</span>

<span class="nc" id="L163">    private String     text                    = &quot;&quot;; // for BeanBox</span>
<span class="nc" id="L164">    private Insets     margin                  = null;</span>
<span class="nc" id="L165">    private Insets     defaultMargin           = null;</span>

    // Button icons
    // PENDING(jeff) - hold icons in an array
<span class="nc" id="L169">    private Icon       defaultIcon             = null;</span>
<span class="nc" id="L170">    private Icon       pressedIcon             = null;</span>
<span class="nc" id="L171">    private Icon       disabledIcon            = null;</span>

<span class="nc" id="L173">    private Icon       selectedIcon            = null;</span>
<span class="nc" id="L174">    private Icon       disabledSelectedIcon    = null;</span>

<span class="nc" id="L176">    private Icon       rolloverIcon            = null;</span>
<span class="nc" id="L177">    private Icon       rolloverSelectedIcon    = null;</span>

    // Display properties
<span class="nc" id="L180">    private boolean    paintBorder             = true;</span>
<span class="nc" id="L181">    private boolean    paintFocus              = true;</span>
<span class="nc" id="L182">    private boolean    rolloverEnabled         = false;</span>
<span class="nc" id="L183">    private boolean    contentAreaFilled         = true;</span>

    // Icon/Label Alignment
<span class="nc" id="L186">    private int        verticalAlignment       = CENTER;</span>
<span class="nc" id="L187">    private int        horizontalAlignment     = CENTER;</span>

<span class="nc" id="L189">    private int        verticalTextPosition    = CENTER;</span>
<span class="nc" id="L190">    private int        horizontalTextPosition  = TRAILING;</span>

<span class="nc" id="L192">    private int        iconTextGap             = 4;</span>

    private int        mnemonic;
<span class="nc" id="L195">    private int        mnemonicIndex           = -1;</span>

<span class="nc" id="L197">    private long       multiClickThreshhold    = 0;</span>

<span class="nc" id="L199">    private boolean    borderPaintedSet        = false;</span>
<span class="nc" id="L200">    private boolean    rolloverEnabledSet      = false;</span>
<span class="nc" id="L201">    private boolean    iconTextGapSet          = false;</span>
<span class="nc" id="L202">    private boolean    contentAreaFilledSet    = false;</span>

    // Whether or not we've set the LayoutManager.
<span class="nc" id="L205">    private boolean setLayout = false;</span>

    // This is only used by JButton, promoted to avoid an extra
    // boolean field in JButton
<span class="nc" id="L209">    boolean defaultCapable = true;</span>

    /**
     * Combined listeners: ActionListener, ChangeListener, ItemListener.
     */
    private Handler handler;

    /**
     * The button model's &lt;code&gt;changeListener&lt;/code&gt;.
     */
<span class="nc" id="L219">    protected ChangeListener changeListener = null;</span>
    /**
     * The button model's &lt;code&gt;ActionListener&lt;/code&gt;.
     */
<span class="nc" id="L223">    protected ActionListener actionListener = null;</span>
    /**
     * The button model's &lt;code&gt;ItemListener&lt;/code&gt;.
     */
<span class="nc" id="L227">    protected ItemListener itemListener = null;</span>

    /**
     * Only one &lt;code&gt;ChangeEvent&lt;/code&gt; is needed per button
     * instance since the
     * event's only state is the source property.  The source of events
     * generated is always &quot;this&quot;.
     */
    protected transient ChangeEvent changeEvent;

<span class="nc" id="L237">    private boolean hideActionText = false;</span>

    /**
     * Sets the &lt;code&gt;hideActionText&lt;/code&gt; property, which determines
     * whether the button displays text from the &lt;code&gt;Action&lt;/code&gt;.
     * This is useful only if an &lt;code&gt;Action&lt;/code&gt; has been
     * installed on the button.
     *
     * @param hideActionText &lt;code&gt;true&lt;/code&gt; if the button's
     *                       &lt;code&gt;text&lt;/code&gt; property should not reflect
     *                       that of the &lt;code&gt;Action&lt;/code&gt;; the default is
     *                       &lt;code&gt;false&lt;/code&gt;
     * @see &lt;a href=&quot;Action.html#buttonActions&quot;&gt;Swing Components Supporting
     *      &lt;code&gt;Action&lt;/code&gt;&lt;/a&gt;
     * @since 1.6
     * @beaninfo
     *        bound: true
     *    expert: true
     *  description: Whether the text of the button should come from
     *               the &lt;code&gt;Action&lt;/code&gt;.
     */
    public void setHideActionText(boolean hideActionText) {
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (hideActionText != this.hideActionText) {</span>
<span class="nc" id="L260">            this.hideActionText = hideActionText;</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">            if (getAction() != null) {</span>
<span class="nc" id="L262">                setTextFromAction(getAction(), false);</span>
            }
<span class="nc bnc" id="L264" title="All 2 branches missed.">            firePropertyChange(&quot;hideActionText&quot;, !hideActionText,</span>
                               hideActionText);
        }
<span class="nc" id="L267">    }</span>

    /**
     * Returns the value of the &lt;code&gt;hideActionText&lt;/code&gt; property, which
     * determines whether the button displays text from the
     * &lt;code&gt;Action&lt;/code&gt;.  This is useful only if an &lt;code&gt;Action&lt;/code&gt;
     * has been installed on the button.
     *
     * @return &lt;code&gt;true&lt;/code&gt; if the button's &lt;code&gt;text&lt;/code&gt;
     *         property should not reflect that of the
     *         &lt;code&gt;Action&lt;/code&gt;; the default is &lt;code&gt;false&lt;/code&gt;
     * @since 1.6
     */
    public boolean getHideActionText() {
<span class="nc" id="L281">        return hideActionText;</span>
    }

    /**
     * Returns the button's text.
     * @return the buttons text
     * @see #setText
     */
    public String getText() {
<span class="nc" id="L290">        return text;</span>
    }

    /**
     * Sets the button's text.
     * @param text the string used to set the text
     * @see #getText
     * @beaninfo
     *        bound: true
     *    preferred: true
     *    attribute: visualUpdate true
     *  description: The button's text.
     */
    public void setText(String text) {
<span class="nc" id="L304">        String oldValue = this.text;</span>
<span class="nc" id="L305">        this.text = text;</span>
<span class="nc" id="L306">        firePropertyChange(TEXT_CHANGED_PROPERTY, oldValue, text);</span>
<span class="nc" id="L307">        updateDisplayedMnemonicIndex(text, getMnemonic());</span>

<span class="nc bnc" id="L309" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L310">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, text);
        }
<span class="nc bnc" id="L314" title="All 6 branches missed.">        if (text == null || oldValue == null || !text.equals(oldValue)) {</span>
<span class="nc" id="L315">            revalidate();</span>
<span class="nc" id="L316">            repaint();</span>
        }
<span class="nc" id="L318">    }</span>


    /**
     * Returns the state of the button. True if the
     * toggle button is selected, false if it's not.
     * @return true if the toggle button is selected, otherwise false
     */
    public boolean isSelected() {
<span class="nc" id="L327">        return model.isSelected();</span>
    }

    /**
     * Sets the state of the button. Note that this method does not
     * trigger an &lt;code&gt;actionEvent&lt;/code&gt;.
     * Call &lt;code&gt;doClick&lt;/code&gt; to perform a programmatic action change.
     *
     * @param b  true if the button is selected, otherwise false
     */
    public void setSelected(boolean b) {
<span class="nc" id="L338">        boolean oldValue = isSelected();</span>

        // TIGER - 4840653
        // Removed code which fired an AccessibleState.SELECTED
        // PropertyChangeEvent since this resulted in two
        // identical events being fired since
        // AbstractButton.fireItemStateChanged also fires the
        // same event. This caused screen readers to speak the
        // name of the item twice.

<span class="nc" id="L348">        model.setSelected(b);</span>
<span class="nc" id="L349">    }</span>

    /**
     * Programmatically perform a &quot;click&quot;. This does the same
     * thing as if the user had pressed and released the button.
     */
    public void doClick() {
<span class="nc" id="L356">        doClick(68);</span>
<span class="nc" id="L357">    }</span>

    /**
     * Programmatically perform a &quot;click&quot;. This does the same
     * thing as if the user had pressed and released the button.
     * The button stays visually &quot;pressed&quot; for &lt;code&gt;pressTime&lt;/code&gt;
     *  milliseconds.
     *
     * @param pressTime the time to &quot;hold down&quot; the button, in milliseconds
     */
    public void doClick(int pressTime) {
<span class="nc" id="L368">        Dimension size = getSize();</span>
<span class="nc" id="L369">        model.setArmed(true);</span>
<span class="nc" id="L370">        model.setPressed(true);</span>
<span class="nc" id="L371">        paintImmediately(new Rectangle(0,0, size.width, size.height));</span>
        try {
<span class="nc" id="L373">            Thread.currentThread().sleep(pressTime);</span>
<span class="nc" id="L374">        } catch(InterruptedException ie) {</span>
<span class="nc" id="L375">        }</span>
<span class="nc" id="L376">        model.setPressed(false);</span>
<span class="nc" id="L377">        model.setArmed(false);</span>
<span class="nc" id="L378">    }</span>

    /**
     * Sets space for margin between the button's border and
     * the label. Setting to &lt;code&gt;null&lt;/code&gt; will cause the button to
     * use the default margin.  The button's default &lt;code&gt;Border&lt;/code&gt;
     * object will use this value to create the proper margin.
     * However, if a non-default border is set on the button,
     * it is that &lt;code&gt;Border&lt;/code&gt; object's responsibility to create the
     * appropriate margin space (else this property will
     * effectively be ignored).
     *
     * @param m the space between the border and the label
     *
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The space between the button's border and the label.
     */
    public void setMargin(Insets m) {
        // Cache the old margin if it comes from the UI
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if(m instanceof UIResource) {</span>
<span class="nc" id="L400">            defaultMargin = m;</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">        } else if(margin instanceof UIResource) {</span>
<span class="nc" id="L402">            defaultMargin = margin;</span>
        }

        // If the client passes in a null insets, restore the margin
        // from the UI if possible
<span class="nc bnc" id="L407" title="All 4 branches missed.">        if(m == null &amp;&amp; defaultMargin != null) {</span>
<span class="nc" id="L408">            m = defaultMargin;</span>
        }

<span class="nc" id="L411">        Insets old = margin;</span>
<span class="nc" id="L412">        margin = m;</span>
<span class="nc" id="L413">        firePropertyChange(MARGIN_CHANGED_PROPERTY, old, m);</span>
<span class="nc bnc" id="L414" title="All 4 branches missed.">        if (old == null || !old.equals(m)) {</span>
<span class="nc" id="L415">            revalidate();</span>
<span class="nc" id="L416">            repaint();</span>
        }
<span class="nc" id="L418">    }</span>

    /**
     * Returns the margin between the button's border and
     * the label.
     *
     * @return an &lt;code&gt;Insets&lt;/code&gt; object specifying the margin
     *          between the botton's border and the label
     * @see #setMargin
     */
    public Insets getMargin() {
<span class="nc bnc" id="L429" title="All 2 branches missed.">        return (margin == null) ? null : (Insets) margin.clone();</span>
    }

    /**
     * Returns the default icon.
     * @return the default &lt;code&gt;Icon&lt;/code&gt;
     * @see #setIcon
     */
    public Icon getIcon() {
<span class="nc" id="L438">        return defaultIcon;</span>
    }

    /**
     * Sets the button's default icon. This icon is
     * also used as the &quot;pressed&quot; and &quot;disabled&quot; icon if
     * there is no explicitly set pressed icon.
     *
     * @param defaultIcon the icon used as the default image
     * @see #getIcon
     * @see #setPressedIcon
     * @beaninfo
     *           bound: true
     *       attribute: visualUpdate true
     *     description: The button's default icon
     */
    public void setIcon(Icon defaultIcon) {
<span class="nc" id="L455">        Icon oldValue = this.defaultIcon;</span>
<span class="nc" id="L456">        this.defaultIcon = defaultIcon;</span>

        /* If the default icon has really changed and we had
         * generated the disabled icon for this component,
         * (i.e. setDisabledIcon() was never called) then
         * clear the disabledIcon field.
         */
<span class="nc bnc" id="L463" title="All 4 branches missed.">        if (defaultIcon != oldValue &amp;&amp; (disabledIcon instanceof UIResource)) {</span>
<span class="nc" id="L464">            disabledIcon = null;</span>
        }

<span class="nc" id="L467">        firePropertyChange(ICON_CHANGED_PROPERTY, oldValue, defaultIcon);</span>
<span class="nc bnc" id="L468" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L469">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, defaultIcon);
        }
<span class="nc bnc" id="L473" title="All 2 branches missed.">        if (defaultIcon != oldValue) {</span>
<span class="nc bnc" id="L474" title="All 4 branches missed.">            if (defaultIcon == null || oldValue == null ||</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">                defaultIcon.getIconWidth() != oldValue.getIconWidth() ||</span>
<span class="nc bnc" id="L476" title="All 2 branches missed.">                defaultIcon.getIconHeight() != oldValue.getIconHeight()) {</span>
<span class="nc" id="L477">                revalidate();</span>
            }
<span class="nc" id="L479">            repaint();</span>
        }
<span class="nc" id="L481">    }</span>

    /**
     * Returns the pressed icon for the button.
     * @return the &lt;code&gt;pressedIcon&lt;/code&gt; property
     * @see #setPressedIcon
     */
    public Icon getPressedIcon() {
<span class="nc" id="L489">        return pressedIcon;</span>
    }

    /**
     * Sets the pressed icon for the button.
     * @param pressedIcon the icon used as the &quot;pressed&quot; image
     * @see #getPressedIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The pressed icon for the button.
     */
    public void setPressedIcon(Icon pressedIcon) {
<span class="nc" id="L502">        Icon oldValue = this.pressedIcon;</span>
<span class="nc" id="L503">        this.pressedIcon = pressedIcon;</span>
<span class="nc" id="L504">        firePropertyChange(PRESSED_ICON_CHANGED_PROPERTY, oldValue, pressedIcon);</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L506">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, pressedIcon);
        }
<span class="nc bnc" id="L510" title="All 2 branches missed.">        if (pressedIcon != oldValue) {</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">            if (getModel().isPressed()) {</span>
<span class="nc" id="L512">                repaint();</span>
            }
        }
<span class="nc" id="L515">    }</span>

    /**
     * Returns the selected icon for the button.
     * @return the &lt;code&gt;selectedIcon&lt;/code&gt; property
     * @see #setSelectedIcon
     */
    public Icon getSelectedIcon() {
<span class="nc" id="L523">        return selectedIcon;</span>
    }

    /**
     * Sets the selected icon for the button.
     * @param selectedIcon the icon used as the &quot;selected&quot; image
     * @see #getSelectedIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The selected icon for the button.
     */
    public void setSelectedIcon(Icon selectedIcon) {
<span class="nc" id="L536">        Icon oldValue = this.selectedIcon;</span>
<span class="nc" id="L537">        this.selectedIcon = selectedIcon;</span>

        /* If the default selected icon has really changed and we had
         * generated the disabled selected icon for this component,
         * (i.e. setDisabledSelectedIcon() was never called) then
         * clear the disabledSelectedIcon field.
         */
<span class="nc bnc" id="L544" title="All 4 branches missed.">        if (selectedIcon != oldValue &amp;&amp;</span>
            disabledSelectedIcon instanceof UIResource) {

<span class="nc" id="L547">            disabledSelectedIcon = null;</span>
        }

<span class="nc" id="L550">        firePropertyChange(SELECTED_ICON_CHANGED_PROPERTY, oldValue, selectedIcon);</span>
<span class="nc bnc" id="L551" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L552">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, selectedIcon);
        }
<span class="nc bnc" id="L556" title="All 2 branches missed.">        if (selectedIcon != oldValue) {</span>
<span class="nc bnc" id="L557" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L558">                repaint();</span>
            }
        }
<span class="nc" id="L561">    }</span>

    /**
     * Returns the rollover icon for the button.
     * @return the &lt;code&gt;rolloverIcon&lt;/code&gt; property
     * @see #setRolloverIcon
     */
    public Icon getRolloverIcon() {
<span class="nc" id="L569">        return rolloverIcon;</span>
    }

    /**
     * Sets the rollover icon for the button.
     * @param rolloverIcon the icon used as the &quot;rollover&quot; image
     * @see #getRolloverIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The rollover icon for the button.
     */
    public void setRolloverIcon(Icon rolloverIcon) {
<span class="nc" id="L582">        Icon oldValue = this.rolloverIcon;</span>
<span class="nc" id="L583">        this.rolloverIcon = rolloverIcon;</span>
<span class="nc" id="L584">        firePropertyChange(ROLLOVER_ICON_CHANGED_PROPERTY, oldValue, rolloverIcon);</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L586">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, rolloverIcon);
        }
<span class="nc" id="L590">        setRolloverEnabled(true);</span>
<span class="nc bnc" id="L591" title="All 2 branches missed.">        if (rolloverIcon != oldValue) {</span>
            // No way to determine whether we are currently in
            // a rollover state, so repaint regardless
<span class="nc" id="L594">            repaint();</span>
        }

<span class="nc" id="L597">    }</span>

    /**
     * Returns the rollover selection icon for the button.
     * @return the &lt;code&gt;rolloverSelectedIcon&lt;/code&gt; property
     * @see #setRolloverSelectedIcon
     */
    public Icon getRolloverSelectedIcon() {
<span class="nc" id="L605">        return rolloverSelectedIcon;</span>
    }

    /**
     * Sets the rollover selected icon for the button.
     * @param rolloverSelectedIcon the icon used as the
     *          &quot;selected rollover&quot; image
     * @see #getRolloverSelectedIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The rollover selected icon for the button.
     */
    public void setRolloverSelectedIcon(Icon rolloverSelectedIcon) {
<span class="nc" id="L619">        Icon oldValue = this.rolloverSelectedIcon;</span>
<span class="nc" id="L620">        this.rolloverSelectedIcon = rolloverSelectedIcon;</span>
<span class="nc" id="L621">        firePropertyChange(ROLLOVER_SELECTED_ICON_CHANGED_PROPERTY, oldValue, rolloverSelectedIcon);</span>
<span class="nc bnc" id="L622" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L623">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, rolloverSelectedIcon);
        }
<span class="nc" id="L627">        setRolloverEnabled(true);</span>
<span class="nc bnc" id="L628" title="All 2 branches missed.">        if (rolloverSelectedIcon != oldValue) {</span>
            // No way to determine whether we are currently in
            // a rollover state, so repaint regardless
<span class="nc bnc" id="L631" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L632">                repaint();</span>
            }
        }
<span class="nc" id="L635">    }</span>

    /**
     * Returns the icon used by the button when it's disabled.
     * If no disabled icon has been set this will forward the call to
     * the look and feel to construct an appropriate disabled Icon.
     * &lt;p&gt;
     * Some look and feels might not render the disabled Icon, in which
     * case they will ignore this.
     *
     * @return the &lt;code&gt;disabledIcon&lt;/code&gt; property
     * @see #getPressedIcon
     * @see #setDisabledIcon
     * @see javax.swing.LookAndFeel#getDisabledIcon
     */
    @Transient
    public Icon getDisabledIcon() {
<span class="nc bnc" id="L652" title="All 2 branches missed.">        if (disabledIcon == null) {</span>
<span class="nc" id="L653">            disabledIcon = UIManager.getLookAndFeel().getDisabledIcon(this, getIcon());</span>
<span class="nc bnc" id="L654" title="All 2 branches missed.">            if (disabledIcon != null) {</span>
<span class="nc" id="L655">                firePropertyChange(DISABLED_ICON_CHANGED_PROPERTY, null, disabledIcon);</span>
            }
        }
<span class="nc" id="L658">        return disabledIcon;</span>
    }

    /**
     * Sets the disabled icon for the button.
     * @param disabledIcon the icon used as the disabled image
     * @see #getDisabledIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The disabled icon for the button.
     */
    public void setDisabledIcon(Icon disabledIcon) {
<span class="nc" id="L671">        Icon oldValue = this.disabledIcon;</span>
<span class="nc" id="L672">        this.disabledIcon = disabledIcon;</span>
<span class="nc" id="L673">        firePropertyChange(DISABLED_ICON_CHANGED_PROPERTY, oldValue, disabledIcon);</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L675">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, disabledIcon);
        }
<span class="nc bnc" id="L679" title="All 2 branches missed.">        if (disabledIcon != oldValue) {</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">            if (!isEnabled()) {</span>
<span class="nc" id="L681">                repaint();</span>
            }
        }
<span class="nc" id="L684">    }</span>

    /**
     * Returns the icon used by the button when it's disabled and selected.
     * If no disabled selection icon has been set, this will forward
     * the call to the LookAndFeel to construct an appropriate disabled
     * Icon from the selection icon if it has been set and to
     * &lt;code&gt;getDisabledIcon()&lt;/code&gt; otherwise.
     * &lt;p&gt;
     * Some look and feels might not render the disabled selected Icon, in
     * which case they will ignore this.
     *
     * @return the &lt;code&gt;disabledSelectedIcon&lt;/code&gt; property
     * @see #getDisabledIcon
     * @see #setDisabledSelectedIcon
     * @see javax.swing.LookAndFeel#getDisabledSelectedIcon
     */
    public Icon getDisabledSelectedIcon() {
<span class="nc bnc" id="L702" title="All 2 branches missed.">        if (disabledSelectedIcon == null) {</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">             if (selectedIcon != null) {</span>
<span class="nc" id="L704">                 disabledSelectedIcon = UIManager.getLookAndFeel().</span>
<span class="nc" id="L705">                         getDisabledSelectedIcon(this, getSelectedIcon());</span>
             } else {
<span class="nc" id="L707">                 return getDisabledIcon();</span>
             }
        }
<span class="nc" id="L710">        return disabledSelectedIcon;</span>
    }

    /**
     * Sets the disabled selection icon for the button.
     * @param disabledSelectedIcon the icon used as the disabled
     *          selection image
     * @see #getDisabledSelectedIcon
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The disabled selection icon for the button.
     */
    public void setDisabledSelectedIcon(Icon disabledSelectedIcon) {
<span class="nc" id="L724">        Icon oldValue = this.disabledSelectedIcon;</span>
<span class="nc" id="L725">        this.disabledSelectedIcon = disabledSelectedIcon;</span>
<span class="nc" id="L726">        firePropertyChange(DISABLED_SELECTED_ICON_CHANGED_PROPERTY, oldValue, disabledSelectedIcon);</span>
<span class="nc bnc" id="L727" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc" id="L728">            accessibleContext.firePropertyChange(</span>
                AccessibleContext.ACCESSIBLE_VISIBLE_DATA_PROPERTY,
                oldValue, disabledSelectedIcon);
        }
<span class="nc bnc" id="L732" title="All 2 branches missed.">        if (disabledSelectedIcon != oldValue) {</span>
<span class="nc bnc" id="L733" title="All 4 branches missed.">            if (disabledSelectedIcon == null || oldValue == null ||</span>
<span class="nc bnc" id="L734" title="All 2 branches missed.">                disabledSelectedIcon.getIconWidth() != oldValue.getIconWidth() ||</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">                disabledSelectedIcon.getIconHeight() != oldValue.getIconHeight()) {</span>
<span class="nc" id="L736">                revalidate();</span>
            }
<span class="nc bnc" id="L738" title="All 4 branches missed.">            if (!isEnabled() &amp;&amp; isSelected()) {</span>
<span class="nc" id="L739">                repaint();</span>
            }
        }
<span class="nc" id="L742">    }</span>

    /**
     * Returns the vertical alignment of the text and icon.
     *
     * @return the &lt;code&gt;verticalAlignment&lt;/code&gt; property, one of the
     *          following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.CENTER} (the default)
     * &lt;li&gt;{@code SwingConstants.TOP}
     * &lt;li&gt;{@code SwingConstants.BOTTOM}
     * &lt;/ul&gt;
     */
    public int getVerticalAlignment() {
<span class="nc" id="L756">        return verticalAlignment;</span>
    }

    /**
     * Sets the vertical alignment of the icon and text.
     * @param alignment one of the following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.CENTER} (the default)
     * &lt;li&gt;{@code SwingConstants.TOP}
     * &lt;li&gt;{@code SwingConstants.BOTTOM}
     * &lt;/ul&gt;
     * @throws IllegalArgumentException if the alignment is not one of the legal
     *         values listed above
     * @beaninfo
     *        bound: true
     *         enum: TOP    SwingConstants.TOP
     *               CENTER SwingConstants.CENTER
     *               BOTTOM  SwingConstants.BOTTOM
     *    attribute: visualUpdate true
     *  description: The vertical alignment of the icon and text.
     */
    public void setVerticalAlignment(int alignment) {
<span class="nc bnc" id="L778" title="All 2 branches missed.">        if (alignment == verticalAlignment) return;</span>
<span class="nc" id="L779">        int oldValue = verticalAlignment;</span>
<span class="nc" id="L780">        verticalAlignment = checkVerticalKey(alignment, &quot;verticalAlignment&quot;);</span>
<span class="nc" id="L781">        firePropertyChange(VERTICAL_ALIGNMENT_CHANGED_PROPERTY, oldValue, verticalAlignment);         repaint();</span>
<span class="nc" id="L782">    }</span>

    /**
     * Returns the horizontal alignment of the icon and text.
     * {@code AbstractButton}'s default is {@code SwingConstants.CENTER},
     * but subclasses such as {@code JCheckBox} may use a different default.
     *
     * @return the &lt;code&gt;horizontalAlignment&lt;/code&gt; property,
     *             one of the following values:
     * &lt;ul&gt;
     *   &lt;li&gt;{@code SwingConstants.RIGHT}
     *   &lt;li&gt;{@code SwingConstants.LEFT}
     *   &lt;li&gt;{@code SwingConstants.CENTER}
     *   &lt;li&gt;{@code SwingConstants.LEADING}
     *   &lt;li&gt;{@code SwingConstants.TRAILING}
     * &lt;/ul&gt;
     */
    public int getHorizontalAlignment() {
<span class="nc" id="L800">        return horizontalAlignment;</span>
    }

    /**
     * Sets the horizontal alignment of the icon and text.
     * {@code AbstractButton}'s default is {@code SwingConstants.CENTER},
     * but subclasses such as {@code JCheckBox} may use a different default.
     *
     * @param alignment the alignment value, one of the following values:
     * &lt;ul&gt;
     *   &lt;li&gt;{@code SwingConstants.RIGHT}
     *   &lt;li&gt;{@code SwingConstants.LEFT}
     *   &lt;li&gt;{@code SwingConstants.CENTER}
     *   &lt;li&gt;{@code SwingConstants.LEADING}
     *   &lt;li&gt;{@code SwingConstants.TRAILING}
     * &lt;/ul&gt;
     * @throws IllegalArgumentException if the alignment is not one of the
     *         valid values
     * @beaninfo
     *        bound: true
     *         enum: LEFT     SwingConstants.LEFT
     *               CENTER   SwingConstants.CENTER
     *               RIGHT    SwingConstants.RIGHT
     *               LEADING  SwingConstants.LEADING
     *               TRAILING SwingConstants.TRAILING
     *    attribute: visualUpdate true
     *  description: The horizontal alignment of the icon and text.
     */
    public void setHorizontalAlignment(int alignment) {
<span class="nc bnc" id="L829" title="All 2 branches missed.">        if (alignment == horizontalAlignment) return;</span>
<span class="nc" id="L830">        int oldValue = horizontalAlignment;</span>
<span class="nc" id="L831">        horizontalAlignment = checkHorizontalKey(alignment,</span>
                                                 &quot;horizontalAlignment&quot;);
<span class="nc" id="L833">        firePropertyChange(HORIZONTAL_ALIGNMENT_CHANGED_PROPERTY,</span>
                           oldValue, horizontalAlignment);
<span class="nc" id="L835">        repaint();</span>
<span class="nc" id="L836">    }</span>


    /**
     * Returns the vertical position of the text relative to the icon.
     * @return the &lt;code&gt;verticalTextPosition&lt;/code&gt; property,
     *          one of the following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.CENTER} (the default)
     * &lt;li&gt;{@code SwingConstants.TOP}
     * &lt;li&gt;{@code SwingConstants.BOTTOM}
     * &lt;/ul&gt;
     */
    public int getVerticalTextPosition() {
<span class="nc" id="L850">        return verticalTextPosition;</span>
    }

    /**
     * Sets the vertical position of the text relative to the icon.
     * @param textPosition  one of the following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.CENTER} (the default)
     * &lt;li&gt;{@code SwingConstants.TOP}
     * &lt;li&gt;{@code SwingConstants.BOTTOM}
     * &lt;/ul&gt;
     * @beaninfo
     *        bound: true
     *         enum: TOP    SwingConstants.TOP
     *               CENTER SwingConstants.CENTER
     *               BOTTOM SwingConstants.BOTTOM
     *    attribute: visualUpdate true
     *  description: The vertical position of the text relative to the icon.
     */
    public void setVerticalTextPosition(int textPosition) {
<span class="nc bnc" id="L870" title="All 2 branches missed.">        if (textPosition == verticalTextPosition) return;</span>
<span class="nc" id="L871">        int oldValue = verticalTextPosition;</span>
<span class="nc" id="L872">        verticalTextPosition = checkVerticalKey(textPosition, &quot;verticalTextPosition&quot;);</span>
<span class="nc" id="L873">        firePropertyChange(VERTICAL_TEXT_POSITION_CHANGED_PROPERTY, oldValue, verticalTextPosition);</span>
<span class="nc" id="L874">        revalidate();</span>
<span class="nc" id="L875">        repaint();</span>
<span class="nc" id="L876">    }</span>

    /**
     * Returns the horizontal position of the text relative to the icon.
     * @return the &lt;code&gt;horizontalTextPosition&lt;/code&gt; property,
     *          one of the following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.RIGHT}
     * &lt;li&gt;{@code SwingConstants.LEFT}
     * &lt;li&gt;{@code SwingConstants.CENTER}
     * &lt;li&gt;{@code SwingConstants.LEADING}
     * &lt;li&gt;{@code SwingConstants.TRAILING} (the default)
     * &lt;/ul&gt;
     */
    public int getHorizontalTextPosition() {
<span class="nc" id="L891">        return horizontalTextPosition;</span>
    }

    /**
     * Sets the horizontal position of the text relative to the icon.
     * @param textPosition one of the following values:
     * &lt;ul&gt;
     * &lt;li&gt;{@code SwingConstants.RIGHT}
     * &lt;li&gt;{@code SwingConstants.LEFT}
     * &lt;li&gt;{@code SwingConstants.CENTER}
     * &lt;li&gt;{@code SwingConstants.LEADING}
     * &lt;li&gt;{@code SwingConstants.TRAILING} (the default)
     * &lt;/ul&gt;
     * @exception IllegalArgumentException if &lt;code&gt;textPosition&lt;/code&gt;
     *          is not one of the legal values listed above
     * @beaninfo
     *        bound: true
     *         enum: LEFT     SwingConstants.LEFT
     *               CENTER   SwingConstants.CENTER
     *               RIGHT    SwingConstants.RIGHT
     *               LEADING  SwingConstants.LEADING
     *               TRAILING SwingConstants.TRAILING
     *    attribute: visualUpdate true
     *  description: The horizontal position of the text relative to the icon.
     */
    public void setHorizontalTextPosition(int textPosition) {
<span class="nc bnc" id="L917" title="All 2 branches missed.">        if (textPosition == horizontalTextPosition) return;</span>
<span class="nc" id="L918">        int oldValue = horizontalTextPosition;</span>
<span class="nc" id="L919">        horizontalTextPosition = checkHorizontalKey(textPosition,</span>
                                                    &quot;horizontalTextPosition&quot;);
<span class="nc" id="L921">        firePropertyChange(HORIZONTAL_TEXT_POSITION_CHANGED_PROPERTY,</span>
                           oldValue,
                           horizontalTextPosition);
<span class="nc" id="L924">        revalidate();</span>
<span class="nc" id="L925">        repaint();</span>
<span class="nc" id="L926">    }</span>

    /**
     * Returns the amount of space between the text and the icon
     * displayed in this button.
     *
     * @return an int equal to the number of pixels between the text
     *         and the icon.
     * @since 1.4
     * @see #setIconTextGap
     */
    public int getIconTextGap() {
<span class="nc" id="L938">        return iconTextGap;</span>
    }

    /**
     * If both the icon and text properties are set, this property
     * defines the space between them.
     * &lt;p&gt;
     * The default value of this property is 4 pixels.
     * &lt;p&gt;
     * This is a JavaBeans bound property.
     *
     * @since 1.4
     * @see #getIconTextGap
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: If both the icon and text properties are set, this
     *               property defines the space between them.
     */
    public void setIconTextGap(int iconTextGap) {
<span class="nc" id="L958">        int oldValue = this.iconTextGap;</span>
<span class="nc" id="L959">        this.iconTextGap = iconTextGap;</span>
<span class="nc" id="L960">        iconTextGapSet = true;</span>
<span class="nc" id="L961">        firePropertyChange(&quot;iconTextGap&quot;, oldValue, iconTextGap);</span>
<span class="nc bnc" id="L962" title="All 2 branches missed.">        if (iconTextGap != oldValue) {</span>
<span class="nc" id="L963">            revalidate();</span>
<span class="nc" id="L964">            repaint();</span>
        }
<span class="nc" id="L966">    }</span>

    /**
     * Verify that the {@code key} argument is a legal value for the
     * {@code horizontalAlignment} and {@code horizontalTextPosition}
     * properties. Valid values are:
     * &lt;ul&gt;
     *   &lt;li&gt;{@code SwingConstants.RIGHT}
     *   &lt;li&gt;{@code SwingConstants.LEFT}
     *   &lt;li&gt;{@code SwingConstants.CENTER}
     *   &lt;li&gt;{@code SwingConstants.LEADING}
     *   &lt;li&gt;{@code SwingConstants.TRAILING}
     * &lt;/ul&gt;
     *
     * @param key the property value to check
     * @param exception the message to use in the
     *        {@code IllegalArgumentException} that is thrown for an invalid
     *        value
     * @return the {@code key} argument
     * @exception IllegalArgumentException if key is not one of the legal
     *            values listed above
     * @see #setHorizontalTextPosition
     * @see #setHorizontalAlignment
     */
    protected int checkHorizontalKey(int key, String exception) {
<span class="nc bnc" id="L991" title="All 10 branches missed.">        if ((key == LEFT) ||</span>
            (key == CENTER) ||
            (key == RIGHT) ||
            (key == LEADING) ||
            (key == TRAILING)) {
<span class="nc" id="L996">            return key;</span>
        } else {
<span class="nc" id="L998">            throw new IllegalArgumentException(exception);</span>
        }
    }

    /**
     * Verify that the {@code key} argument is a legal value for the
     * vertical properties. Valid values are:
     * &lt;ul&gt;
     *   &lt;li&gt;{@code SwingConstants.CENTER}
     *   &lt;li&gt;{@code SwingConstants.TOP}
     *   &lt;li&gt;{@code SwingConstants.BOTTOM}
     * &lt;/ul&gt;
     *
     * @param key the property value to check
     * @param exception the message to use in the
     *        {@code IllegalArgumentException} that is thrown for an invalid
     *        value
     * @return the {@code key} argument
     * @exception IllegalArgumentException if key is not one of the legal
     *            values listed above
     */
    protected int checkVerticalKey(int key, String exception) {
<span class="nc bnc" id="L1020" title="All 6 branches missed.">        if ((key == TOP) || (key == CENTER) || (key == BOTTOM)) {</span>
<span class="nc" id="L1021">            return key;</span>
        } else {
<span class="nc" id="L1023">            throw new IllegalArgumentException(exception);</span>
        }
    }

    /**
     *{@inheritDoc}
     *
     * @since 1.6
     */
    public void removeNotify() {
<span class="nc" id="L1033">        super.removeNotify();</span>
<span class="nc bnc" id="L1034" title="All 2 branches missed.">        if(isRolloverEnabled()) {</span>
<span class="nc" id="L1035">            getModel().setRollover(false);</span>
        }
<span class="nc" id="L1037">    }</span>

    /**
     * Sets the action command for this button.
     * @param actionCommand the action command for this button
     */
    public void setActionCommand(String actionCommand) {
<span class="nc" id="L1044">        getModel().setActionCommand(actionCommand);</span>
<span class="nc" id="L1045">    }</span>

    /**
     * Returns the action command for this button.
     * @return the action command for this button
     */
    public String getActionCommand() {
<span class="nc" id="L1052">        String ac = getModel().getActionCommand();</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">        if(ac == null) {</span>
<span class="nc" id="L1054">            ac = getText();</span>
        }
<span class="nc" id="L1056">        return ac;</span>
    }

    private Action action;
    private PropertyChangeListener actionPropertyChangeListener;

    /**
     * Sets the &lt;code&gt;Action&lt;/code&gt;.
     * The new &lt;code&gt;Action&lt;/code&gt; replaces any previously set
     * &lt;code&gt;Action&lt;/code&gt; but does not affect &lt;code&gt;ActionListeners&lt;/code&gt;
     * independently added with &lt;code&gt;addActionListener&lt;/code&gt;.
     * If the &lt;code&gt;Action&lt;/code&gt; is already a registered
     * &lt;code&gt;ActionListener&lt;/code&gt; for the button, it is not re-registered.
     * &lt;p&gt;
     * Setting the &lt;code&gt;Action&lt;/code&gt; results in immediately changing
     * all the properties described in &lt;a href=&quot;Action.html#buttonActions&quot;&gt;
     * Swing Components Supporting &lt;code&gt;Action&lt;/code&gt;&lt;/a&gt;.
     * Subsequently, the button's properties are automatically updated
     * as the &lt;code&gt;Action&lt;/code&gt;'s properties change.
     * &lt;p&gt;
     * This method uses three other methods to set
     * and help track the &lt;code&gt;Action&lt;/code&gt;'s property values.
     * It uses the &lt;code&gt;configurePropertiesFromAction&lt;/code&gt; method
     * to immediately change the button's properties.
     * To track changes in the &lt;code&gt;Action&lt;/code&gt;'s property values,
     * this method registers the &lt;code&gt;PropertyChangeListener&lt;/code&gt;
     * returned by &lt;code&gt;createActionPropertyChangeListener&lt;/code&gt;. The
     * default {@code PropertyChangeListener} invokes the
     * {@code actionPropertyChanged} method when a property in the
     * {@code Action} changes.
     *
     * @param a the &lt;code&gt;Action&lt;/code&gt; for the &lt;code&gt;AbstractButton&lt;/code&gt;,
     *          or &lt;code&gt;null&lt;/code&gt;
     * @since 1.3
     * @see Action
     * @see #getAction
     * @see #configurePropertiesFromAction
     * @see #createActionPropertyChangeListener
     * @see #actionPropertyChanged
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: the Action instance connected with this ActionEvent source
     */
    public void setAction(Action a) {
<span class="nc" id="L1101">        Action oldValue = getAction();</span>
<span class="nc bnc" id="L1102" title="All 4 branches missed.">        if (action==null || !action.equals(a)) {</span>
<span class="nc" id="L1103">            action = a;</span>
<span class="nc bnc" id="L1104" title="All 2 branches missed.">            if (oldValue!=null) {</span>
<span class="nc" id="L1105">                removeActionListener(oldValue);</span>
<span class="nc" id="L1106">                oldValue.removePropertyChangeListener(actionPropertyChangeListener);</span>
<span class="nc" id="L1107">                actionPropertyChangeListener = null;</span>
            }
<span class="nc" id="L1109">            configurePropertiesFromAction(action);</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">            if (action!=null) {</span>
                // Don't add if it is already a listener
<span class="nc bnc" id="L1112" title="All 2 branches missed.">                if (!isListener(ActionListener.class, action)) {</span>
<span class="nc" id="L1113">                    addActionListener(action);</span>
                }
                // Reverse linkage:
<span class="nc" id="L1116">                actionPropertyChangeListener = createActionPropertyChangeListener(action);</span>
<span class="nc" id="L1117">                action.addPropertyChangeListener(actionPropertyChangeListener);</span>
            }
<span class="nc" id="L1119">            firePropertyChange(&quot;action&quot;, oldValue, action);</span>
        }
<span class="nc" id="L1121">    }</span>

    private boolean isListener(Class c, ActionListener a) {
<span class="nc" id="L1124">        boolean isListener = false;</span>
<span class="nc" id="L1125">        Object[] listeners = listenerList.getListenerList();</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">        for (int i = listeners.length-2; i&gt;=0; i-=2) {</span>
<span class="nc bnc" id="L1127" title="All 4 branches missed.">            if (listeners[i]==c &amp;&amp; listeners[i+1]==a) {</span>
<span class="nc" id="L1128">                    isListener=true;</span>
            }
        }
<span class="nc" id="L1131">        return isListener;</span>
    }

    /**
     * Returns the currently set &lt;code&gt;Action&lt;/code&gt; for this
     * &lt;code&gt;ActionEvent&lt;/code&gt; source, or &lt;code&gt;null&lt;/code&gt;
     * if no &lt;code&gt;Action&lt;/code&gt; is set.
     *
     * @return the &lt;code&gt;Action&lt;/code&gt; for this &lt;code&gt;ActionEvent&lt;/code&gt;
     *          source, or &lt;code&gt;null&lt;/code&gt;
     * @since 1.3
     * @see Action
     * @see #setAction
     */
    public Action getAction() {
<span class="nc" id="L1146">        return action;</span>
    }

    /**
     * Sets the properties on this button to match those in the specified
     * &lt;code&gt;Action&lt;/code&gt;.  Refer to &lt;a href=&quot;Action.html#buttonActions&quot;&gt;
     * Swing Components Supporting &lt;code&gt;Action&lt;/code&gt;&lt;/a&gt; for more
     * details as to which properties this sets.
     *
     * @param a the &lt;code&gt;Action&lt;/code&gt; from which to get the properties,
     *          or &lt;code&gt;null&lt;/code&gt;
     * @since 1.3
     * @see Action
     * @see #setAction
     */
    protected void configurePropertiesFromAction(Action a) {
<span class="nc" id="L1162">        setMnemonicFromAction(a);</span>
<span class="nc" id="L1163">        setTextFromAction(a, false);</span>
<span class="nc" id="L1164">        AbstractAction.setToolTipTextFromAction(this, a);</span>
<span class="nc" id="L1165">        setIconFromAction(a);</span>
<span class="nc" id="L1166">        setActionCommandFromAction(a);</span>
<span class="nc" id="L1167">        AbstractAction.setEnabledFromAction(this, a);</span>
<span class="nc bnc" id="L1168" title="All 2 branches missed.">        if (AbstractAction.hasSelectedKey(a) &amp;&amp;</span>
<span class="nc bnc" id="L1169" title="All 2 branches missed.">                shouldUpdateSelectedStateFromAction()) {</span>
<span class="nc" id="L1170">            setSelectedFromAction(a);</span>
        }
<span class="nc" id="L1172">        setDisplayedMnemonicIndexFromAction(a, false);</span>
<span class="nc" id="L1173">    }</span>

    void clientPropertyChanged(Object key, Object oldValue,
                               Object newValue) {
<span class="nc bnc" id="L1177" title="All 2 branches missed.">        if (key == &quot;hideActionText&quot;) {</span>
<span class="nc bnc" id="L1178" title="All 2 branches missed.">            boolean current = (newValue instanceof Boolean) ?</span>
<span class="nc" id="L1179">                                (Boolean)newValue : false;</span>
<span class="nc bnc" id="L1180" title="All 2 branches missed.">            if (getHideActionText() != current) {</span>
<span class="nc" id="L1181">                setHideActionText(current);</span>
            }
        }
<span class="nc" id="L1184">    }</span>

    /**
     * Button subclasses that support mirroring the selected state from
     * the action should override this to return true.  AbstractButton's
     * implementation returns false.
     */
    boolean shouldUpdateSelectedStateFromAction() {
<span class="nc" id="L1192">        return false;</span>
    }

    /**
     * Updates the button's state in response to property changes in the
     * associated action. This method is invoked from the
     * {@code PropertyChangeListener} returned from
     * {@code createActionPropertyChangeListener}. Subclasses do not normally
     * need to invoke this. Subclasses that support additional {@code Action}
     * properties should override this and
     * {@code configurePropertiesFromAction}.
     * &lt;p&gt;
     * Refer to the table at &lt;a href=&quot;Action.html#buttonActions&quot;&gt;
     * Swing Components Supporting &lt;code&gt;Action&lt;/code&gt;&lt;/a&gt; for a list of
     * the properties this method sets.
     *
     * @param action the &lt;code&gt;Action&lt;/code&gt; associated with this button
     * @param propertyName the name of the property that changed
     * @since 1.6
     * @see Action
     * @see #configurePropertiesFromAction
     */
    protected void actionPropertyChanged(Action action, String propertyName) {
<span class="nc bnc" id="L1215" title="All 2 branches missed.">        if (propertyName == Action.NAME) {</span>
<span class="nc" id="L1216">            setTextFromAction(action, true);</span>
<span class="nc bnc" id="L1217" title="All 2 branches missed.">        } else if (propertyName == &quot;enabled&quot;) {</span>
<span class="nc" id="L1218">            AbstractAction.setEnabledFromAction(this, action);</span>
<span class="nc bnc" id="L1219" title="All 2 branches missed.">        } else if (propertyName == Action.SHORT_DESCRIPTION) {</span>
<span class="nc" id="L1220">            AbstractAction.setToolTipTextFromAction(this, action);</span>
<span class="nc bnc" id="L1221" title="All 2 branches missed.">        } else if (propertyName == Action.SMALL_ICON) {</span>
<span class="nc" id="L1222">            smallIconChanged(action);</span>
<span class="nc bnc" id="L1223" title="All 2 branches missed.">        } else if (propertyName == Action.MNEMONIC_KEY) {</span>
<span class="nc" id="L1224">            setMnemonicFromAction(action);</span>
<span class="nc bnc" id="L1225" title="All 2 branches missed.">        } else if (propertyName == Action.ACTION_COMMAND_KEY) {</span>
<span class="nc" id="L1226">            setActionCommandFromAction(action);</span>
<span class="nc bnc" id="L1227" title="All 2 branches missed.">        } else if (propertyName == Action.SELECTED_KEY &amp;&amp;</span>
<span class="nc bnc" id="L1228" title="All 2 branches missed.">                   AbstractAction.hasSelectedKey(action) &amp;&amp;</span>
<span class="nc bnc" id="L1229" title="All 2 branches missed.">                   shouldUpdateSelectedStateFromAction()) {</span>
<span class="nc" id="L1230">            setSelectedFromAction(action);</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">        } else if (propertyName == Action.DISPLAYED_MNEMONIC_INDEX_KEY) {</span>
<span class="nc" id="L1232">            setDisplayedMnemonicIndexFromAction(action, true);</span>
<span class="nc bnc" id="L1233" title="All 2 branches missed.">        } else if (propertyName == Action.LARGE_ICON_KEY) {</span>
<span class="nc" id="L1234">            largeIconChanged(action);</span>
        }
<span class="nc" id="L1236">    }</span>

    private void setDisplayedMnemonicIndexFromAction(
            Action a, boolean fromPropertyChange) {
<span class="nc bnc" id="L1240" title="All 2 branches missed.">        Integer iValue = (a == null) ? null :</span>
<span class="nc" id="L1241">                (Integer)a.getValue(Action.DISPLAYED_MNEMONIC_INDEX_KEY);</span>
<span class="nc bnc" id="L1242" title="All 4 branches missed.">        if (fromPropertyChange || iValue != null) {</span>
            int value;
<span class="nc bnc" id="L1244" title="All 2 branches missed.">            if (iValue == null) {</span>
<span class="nc" id="L1245">                value = -1;</span>
            } else {
<span class="nc" id="L1247">                value = iValue;</span>
<span class="nc" id="L1248">                String text = getText();</span>
<span class="nc bnc" id="L1249" title="All 4 branches missed.">                if (text == null || value &gt;= text.length()) {</span>
<span class="nc" id="L1250">                    value = -1;</span>
                }
            }
<span class="nc" id="L1253">            setDisplayedMnemonicIndex(value);</span>
        }
<span class="nc" id="L1255">    }</span>

    private void setMnemonicFromAction(Action a) {
<span class="nc bnc" id="L1258" title="All 2 branches missed.">        Integer n = (a == null) ? null :</span>
<span class="nc" id="L1259">                                  (Integer)a.getValue(Action.MNEMONIC_KEY);</span>
<span class="nc bnc" id="L1260" title="All 2 branches missed.">        setMnemonic((n == null) ? '\0' : n);</span>
<span class="nc" id="L1261">    }</span>

    private void setTextFromAction(Action a, boolean propertyChange) {
<span class="nc" id="L1264">        boolean hideText = getHideActionText();</span>
<span class="nc bnc" id="L1265" title="All 2 branches missed.">        if (!propertyChange) {</span>
<span class="nc bnc" id="L1266" title="All 4 branches missed.">            setText((a != null &amp;&amp; !hideText) ?</span>
<span class="nc" id="L1267">                        (String)a.getValue(Action.NAME) : null);</span>
        }
<span class="nc bnc" id="L1269" title="All 2 branches missed.">        else if (!hideText) {</span>
<span class="nc" id="L1270">            setText((String)a.getValue(Action.NAME));</span>
        }
<span class="nc" id="L1272">    }</span>

    void setIconFromAction(Action a) {
<span class="nc" id="L1275">        Icon icon = null;</span>
<span class="nc bnc" id="L1276" title="All 2 branches missed.">        if (a != null) {</span>
<span class="nc" id="L1277">            icon = (Icon)a.getValue(Action.LARGE_ICON_KEY);</span>
<span class="nc bnc" id="L1278" title="All 2 branches missed.">            if (icon == null) {</span>
<span class="nc" id="L1279">                icon = (Icon)a.getValue(Action.SMALL_ICON);</span>
            }
        }
<span class="nc" id="L1282">        setIcon(icon);</span>
<span class="nc" id="L1283">    }</span>

    void smallIconChanged(Action a) {
<span class="nc bnc" id="L1286" title="All 2 branches missed.">        if (a.getValue(Action.LARGE_ICON_KEY) == null) {</span>
<span class="nc" id="L1287">            setIconFromAction(a);</span>
        }
<span class="nc" id="L1289">    }</span>

    void largeIconChanged(Action a) {
<span class="nc" id="L1292">        setIconFromAction(a);</span>
<span class="nc" id="L1293">    }</span>

    private void setActionCommandFromAction(Action a) {
<span class="nc bnc" id="L1296" title="All 2 branches missed.">        setActionCommand((a != null) ?</span>
<span class="nc" id="L1297">                             (String)a.getValue(Action.ACTION_COMMAND_KEY) :</span>
                             null);
<span class="nc" id="L1299">    }</span>

    /**
     * Sets the seleted state of the button from the action.  This is defined
     * here, but not wired up.  Subclasses like JToggleButton and
     * JCheckBoxMenuItem make use of it.
     *
     * @param a the Action
     */
    private void setSelectedFromAction(Action a) {
<span class="nc" id="L1309">        boolean selected = false;</span>
<span class="nc bnc" id="L1310" title="All 2 branches missed.">        if (a != null) {</span>
<span class="nc" id="L1311">            selected = AbstractAction.isSelected(a);</span>
        }
<span class="nc bnc" id="L1313" title="All 2 branches missed.">        if (selected != isSelected()) {</span>
            // This won't notify ActionListeners, but that should be
            // ok as the change is coming from the Action.
<span class="nc" id="L1316">            setSelected(selected);</span>
            // Make sure the change actually took effect
<span class="nc bnc" id="L1318" title="All 4 branches missed.">            if (!selected &amp;&amp; isSelected()) {</span>
<span class="nc bnc" id="L1319" title="All 2 branches missed.">                if (getModel() instanceof DefaultButtonModel) {</span>
<span class="nc" id="L1320">                    ButtonGroup group = ((DefaultButtonModel)getModel()).getGroup();</span>
<span class="nc bnc" id="L1321" title="All 2 branches missed.">                    if (group != null) {</span>
<span class="nc" id="L1322">                        group.clearSelection();</span>
                    }
                }
            }
        }
<span class="nc" id="L1327">    }</span>

    /**
     * Creates and returns a &lt;code&gt;PropertyChangeListener&lt;/code&gt; that is
     * responsible for listening for changes from the specified
     * &lt;code&gt;Action&lt;/code&gt; and updating the appropriate properties.
     * &lt;p&gt;
     * &lt;b&gt;Warning:&lt;/b&gt; If you subclass this do not create an anonymous
     * inner class.  If you do the lifetime of the button will be tied to
     * that of the &lt;code&gt;Action&lt;/code&gt;.
     *
     * @param a the button's action
     * @since 1.3
     * @see Action
     * @see #setAction
     */
    protected PropertyChangeListener createActionPropertyChangeListener(Action a) {
<span class="nc" id="L1344">        return createActionPropertyChangeListener0(a);</span>
    }


    PropertyChangeListener createActionPropertyChangeListener0(Action a) {
<span class="nc" id="L1349">        return new ButtonActionPropertyChangeListener(this, a);</span>
    }

    @SuppressWarnings(&quot;serial&quot;)
    private static class ButtonActionPropertyChangeListener
                 extends ActionPropertyChangeListener&lt;AbstractButton&gt; {
        ButtonActionPropertyChangeListener(AbstractButton b, Action a) {
<span class="nc" id="L1356">            super(b, a);</span>
<span class="nc" id="L1357">        }</span>
        protected void actionPropertyChanged(AbstractButton button,
                                             Action action,
                                             PropertyChangeEvent e) {
<span class="nc bnc" id="L1361" title="All 2 branches missed.">            if (AbstractAction.shouldReconfigure(e)) {</span>
<span class="nc" id="L1362">                button.configurePropertiesFromAction(action);</span>
            } else {
<span class="nc" id="L1364">                button.actionPropertyChanged(action, e.getPropertyName());</span>
            }
<span class="nc" id="L1366">        }</span>
    }

    /**
     * Gets the &lt;code&gt;borderPainted&lt;/code&gt; property.
     *
     * @return the value of the &lt;code&gt;borderPainted&lt;/code&gt; property
     * @see #setBorderPainted
     */
    public boolean isBorderPainted() {
<span class="nc" id="L1376">        return paintBorder;</span>
    }

    /**
     * Sets the &lt;code&gt;borderPainted&lt;/code&gt; property.
     * If &lt;code&gt;true&lt;/code&gt; and the button has a border,
     * the border is painted. The default value for the
     * &lt;code&gt;borderPainted&lt;/code&gt; property is &lt;code&gt;true&lt;/code&gt;.
     * &lt;p&gt;
     * Some look and feels might not support
     * the &lt;code&gt;borderPainted&lt;/code&gt; property,
     * in which case they ignore this.
     *
     * @param b if true and border property is not &lt;code&gt;null&lt;/code&gt;,
     *          the border is painted
     * @see #isBorderPainted
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: Whether the border should be painted.
     */
    public void setBorderPainted(boolean b) {
<span class="nc" id="L1398">        boolean oldValue = paintBorder;</span>
<span class="nc" id="L1399">        paintBorder = b;</span>
<span class="nc" id="L1400">        borderPaintedSet = true;</span>
<span class="nc" id="L1401">        firePropertyChange(BORDER_PAINTED_CHANGED_PROPERTY, oldValue, paintBorder);</span>
<span class="nc bnc" id="L1402" title="All 2 branches missed.">        if (b != oldValue) {</span>
<span class="nc" id="L1403">            revalidate();</span>
<span class="nc" id="L1404">            repaint();</span>
        }
<span class="nc" id="L1406">    }</span>

    /**
     * Paint the button's border if &lt;code&gt;BorderPainted&lt;/code&gt;
     * property is true and the button has a border.
     * @param g the &lt;code&gt;Graphics&lt;/code&gt; context in which to paint
     *
     * @see #paint
     * @see #setBorder
     */
    protected void paintBorder(Graphics g) {
<span class="nc bnc" id="L1417" title="All 2 branches missed.">        if (isBorderPainted()) {</span>
<span class="nc" id="L1418">            super.paintBorder(g);</span>
        }
<span class="nc" id="L1420">    }</span>

    /**
     * Gets the &lt;code&gt;paintFocus&lt;/code&gt; property.
     *
     * @return the &lt;code&gt;paintFocus&lt;/code&gt; property
     * @see #setFocusPainted
     */
    public boolean isFocusPainted() {
<span class="nc" id="L1429">        return paintFocus;</span>
    }

    /**
     * Sets the &lt;code&gt;paintFocus&lt;/code&gt; property, which must
     * be &lt;code&gt;true&lt;/code&gt; for the focus state to be painted.
     * The default value for the &lt;code&gt;paintFocus&lt;/code&gt; property
     * is &lt;code&gt;true&lt;/code&gt;.
     * Some look and feels might not paint focus state;
     * they will ignore this property.
     *
     * @param b if &lt;code&gt;true&lt;/code&gt;, the focus state should be painted
     * @see #isFocusPainted
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: Whether focus should be painted
     */
    public void setFocusPainted(boolean b) {
<span class="nc" id="L1448">        boolean oldValue = paintFocus;</span>
<span class="nc" id="L1449">        paintFocus = b;</span>
<span class="nc" id="L1450">        firePropertyChange(FOCUS_PAINTED_CHANGED_PROPERTY, oldValue, paintFocus);</span>
<span class="nc bnc" id="L1451" title="All 4 branches missed.">        if (b != oldValue &amp;&amp; isFocusOwner()) {</span>
<span class="nc" id="L1452">            revalidate();</span>
<span class="nc" id="L1453">            repaint();</span>
        }
<span class="nc" id="L1455">    }</span>

    /**
     * Gets the &lt;code&gt;contentAreaFilled&lt;/code&gt; property.
     *
     * @return the &lt;code&gt;contentAreaFilled&lt;/code&gt; property
     * @see #setContentAreaFilled
     */
    public boolean isContentAreaFilled() {
<span class="nc" id="L1464">        return contentAreaFilled;</span>
    }

    /**
     * Sets the &lt;code&gt;contentAreaFilled&lt;/code&gt; property.
     * If &lt;code&gt;true&lt;/code&gt; the button will paint the content
     * area.  If you wish to have a transparent button, such as
     * an icon only button, for example, then you should set
     * this to &lt;code&gt;false&lt;/code&gt;. Do not call &lt;code&gt;setOpaque(false)&lt;/code&gt;.
     * The default value for the the &lt;code&gt;contentAreaFilled&lt;/code&gt;
     * property is &lt;code&gt;true&lt;/code&gt;.
     * &lt;p&gt;
     * This function may cause the component's opaque property to change.
     * &lt;p&gt;
     * The exact behavior of calling this function varies on a
     * component-by-component and L&amp;amp;F-by-L&amp;amp;F basis.
     *
     * @param b if true, the content should be filled; if false
     *          the content area is not filled
     * @see #isContentAreaFilled
     * @see #setOpaque
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: Whether the button should paint the content area
     *               or leave it transparent.
     */
    public void setContentAreaFilled(boolean b) {
<span class="nc" id="L1492">        boolean oldValue = contentAreaFilled;</span>
<span class="nc" id="L1493">        contentAreaFilled = b;</span>
<span class="nc" id="L1494">        contentAreaFilledSet = true;</span>
<span class="nc" id="L1495">        firePropertyChange(CONTENT_AREA_FILLED_CHANGED_PROPERTY, oldValue, contentAreaFilled);</span>
<span class="nc bnc" id="L1496" title="All 2 branches missed.">        if (b != oldValue) {</span>
<span class="nc" id="L1497">            repaint();</span>
        }
<span class="nc" id="L1499">    }</span>

    /**
     * Gets the &lt;code&gt;rolloverEnabled&lt;/code&gt; property.
     *
     * @return the value of the &lt;code&gt;rolloverEnabled&lt;/code&gt; property
     * @see #setRolloverEnabled
     */
    public boolean isRolloverEnabled() {
<span class="nc" id="L1508">        return rolloverEnabled;</span>
    }

    /**
     * Sets the &lt;code&gt;rolloverEnabled&lt;/code&gt; property, which
     * must be &lt;code&gt;true&lt;/code&gt; for rollover effects to occur.
     * The default value for the &lt;code&gt;rolloverEnabled&lt;/code&gt;
     * property is &lt;code&gt;false&lt;/code&gt;.
     * Some look and feels might not implement rollover effects;
     * they will ignore this property.
     *
     * @param b if &lt;code&gt;true&lt;/code&gt;, rollover effects should be painted
     * @see #isRolloverEnabled
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: Whether rollover effects should be enabled.
     */
    public void setRolloverEnabled(boolean b) {
<span class="nc" id="L1527">        boolean oldValue = rolloverEnabled;</span>
<span class="nc" id="L1528">        rolloverEnabled = b;</span>
<span class="nc" id="L1529">        rolloverEnabledSet = true;</span>
<span class="nc" id="L1530">        firePropertyChange(ROLLOVER_ENABLED_CHANGED_PROPERTY, oldValue, rolloverEnabled);</span>
<span class="nc bnc" id="L1531" title="All 2 branches missed.">        if (b != oldValue) {</span>
<span class="nc" id="L1532">            repaint();</span>
        }
<span class="nc" id="L1534">    }</span>

    /**
     * Returns the keyboard mnemonic from the the current model.
     * @return the keyboard mnemonic from the model
     */
    public int getMnemonic() {
<span class="nc" id="L1541">        return mnemonic;</span>
    }

    /**
     * Sets the keyboard mnemonic on the current model.
     * The mnemonic is the key which when combined with the look and feel's
     * mouseless modifier (usually Alt) will activate this button
     * if focus is contained somewhere within this button's ancestor
     * window.
     * &lt;p&gt;
     * A mnemonic must correspond to a single key on the keyboard
     * and should be specified using one of the &lt;code&gt;VK_XXX&lt;/code&gt;
     * keycodes defined in &lt;code&gt;java.awt.event.KeyEvent&lt;/code&gt;.
     * These codes and the wider array of codes for international
     * keyboards may be obtained through
     * &lt;code&gt;java.awt.event.KeyEvent.getExtendedKeyCodeForChar&lt;/code&gt;.
     * Mnemonics are case-insensitive, therefore a key event
     * with the corresponding keycode would cause the button to be
     * activated whether or not the Shift modifier was pressed.
     * &lt;p&gt;
     * If the character defined by the mnemonic is found within
     * the button's label string, the first occurrence of it
     * will be underlined to indicate the mnemonic to the user.
     *
     * @param mnemonic the key code which represents the mnemonic
     * @see     java.awt.event.KeyEvent
     * @see     #setDisplayedMnemonicIndex
     *
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: the keyboard character mnemonic
     */
    public void setMnemonic(int mnemonic) {
<span class="nc" id="L1575">        int oldValue = getMnemonic();</span>
<span class="nc" id="L1576">        model.setMnemonic(mnemonic);</span>
<span class="nc" id="L1577">        updateMnemonicProperties();</span>
<span class="nc" id="L1578">    }</span>

    /**
     * This method is now obsolete, please use &lt;code&gt;setMnemonic(int)&lt;/code&gt;
     * to set the mnemonic for a button.  This method is only designed
     * to handle character values which fall between 'a' and 'z' or
     * 'A' and 'Z'.
     *
     * @param mnemonic  a char specifying the mnemonic value
     * @see #setMnemonic(int)
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: the keyboard character mnemonic
     */
    public void setMnemonic(char mnemonic) {
<span class="nc" id="L1594">        int vk = (int) mnemonic;</span>
<span class="nc bnc" id="L1595" title="All 4 branches missed.">        if(vk &gt;= 'a' &amp;&amp; vk &lt;='z')</span>
<span class="nc" id="L1596">            vk -= ('a' - 'A');</span>
<span class="nc" id="L1597">        setMnemonic(vk);</span>
<span class="nc" id="L1598">    }</span>

    /**
     * Provides a hint to the look and feel as to which character in the
     * text should be decorated to represent the mnemonic. Not all look and
     * feels may support this. A value of -1 indicates either there is no
     * mnemonic, the mnemonic character is not contained in the string, or
     * the developer does not wish the mnemonic to be displayed.
     * &lt;p&gt;
     * The value of this is updated as the properties relating to the
     * mnemonic change (such as the mnemonic itself, the text...).
     * You should only ever have to call this if
     * you do not wish the default character to be underlined. For example, if
     * the text was 'Save As', with a mnemonic of 'a', and you wanted the 'A'
     * to be decorated, as 'Save &lt;u&gt;A&lt;/u&gt;s', you would have to invoke
     * &lt;code&gt;setDisplayedMnemonicIndex(5)&lt;/code&gt; after invoking
     * &lt;code&gt;setMnemonic(KeyEvent.VK_A)&lt;/code&gt;.
     *
     * @since 1.4
     * @param index Index into the String to underline
     * @exception IllegalArgumentException will be thrown if &lt;code&gt;index&lt;/code&gt;
     *            is &amp;gt;= length of the text, or &amp;lt; -1
     * @see #getDisplayedMnemonicIndex
     *
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: the index into the String to draw the keyboard character
     *               mnemonic at
     */
    public void setDisplayedMnemonicIndex(int index)
                                          throws IllegalArgumentException {
<span class="nc" id="L1630">        int oldValue = mnemonicIndex;</span>
<span class="nc bnc" id="L1631" title="All 2 branches missed.">        if (index == -1) {</span>
<span class="nc" id="L1632">            mnemonicIndex = -1;</span>
        } else {
<span class="nc" id="L1634">            String text = getText();</span>
<span class="nc bnc" id="L1635" title="All 2 branches missed.">            int textLength = (text == null) ? 0 : text.length();</span>
<span class="nc bnc" id="L1636" title="All 4 branches missed.">            if (index &lt; -1 || index &gt;= textLength) {  // index out of range</span>
<span class="nc" id="L1637">                throw new IllegalArgumentException(&quot;index == &quot; + index);</span>
            }
        }
<span class="nc" id="L1640">        mnemonicIndex = index;</span>
<span class="nc" id="L1641">        firePropertyChange(&quot;displayedMnemonicIndex&quot;, oldValue, index);</span>
<span class="nc bnc" id="L1642" title="All 2 branches missed.">        if (index != oldValue) {</span>
<span class="nc" id="L1643">            revalidate();</span>
<span class="nc" id="L1644">            repaint();</span>
        }
<span class="nc" id="L1646">    }</span>

    /**
     * Returns the character, as an index, that the look and feel should
     * provide decoration for as representing the mnemonic character.
     *
     * @since 1.4
     * @return index representing mnemonic character
     * @see #setDisplayedMnemonicIndex
     */
    public int getDisplayedMnemonicIndex() {
<span class="nc" id="L1657">        return mnemonicIndex;</span>
    }

    /**
     * Update the displayedMnemonicIndex property. This method
     * is called when either text or mnemonic changes. The new
     * value of the displayedMnemonicIndex property is the index
     * of the first occurrence of mnemonic in text.
     */
    private void updateDisplayedMnemonicIndex(String text, int mnemonic) {
<span class="nc" id="L1667">        setDisplayedMnemonicIndex(</span>
<span class="nc" id="L1668">            SwingUtilities.findDisplayedMnemonicIndex(text, mnemonic));</span>
<span class="nc" id="L1669">    }</span>

    /**
     * Brings the mnemonic property in accordance with model's mnemonic.
     * This is called when model's mnemonic changes. Also updates the
     * displayedMnemonicIndex property.
     */
    private void updateMnemonicProperties() {
<span class="nc" id="L1677">        int newMnemonic = model.getMnemonic();</span>
<span class="nc bnc" id="L1678" title="All 2 branches missed.">        if (mnemonic != newMnemonic) {</span>
<span class="nc" id="L1679">            int oldValue = mnemonic;</span>
<span class="nc" id="L1680">            mnemonic = newMnemonic;</span>
<span class="nc" id="L1681">            firePropertyChange(MNEMONIC_CHANGED_PROPERTY,</span>
                               oldValue, mnemonic);
<span class="nc" id="L1683">            updateDisplayedMnemonicIndex(getText(), mnemonic);</span>
<span class="nc" id="L1684">            revalidate();</span>
<span class="nc" id="L1685">            repaint();</span>
        }
<span class="nc" id="L1687">    }</span>

    /**
     * Sets the amount of time (in milliseconds) required between
     * mouse press events for the button to generate the corresponding
     * action events.  After the initial mouse press occurs (and action
     * event generated) any subsequent mouse press events which occur
     * on intervals less than the threshhold will be ignored and no
     * corresponding action event generated.  By default the threshhold is 0,
     * which means that for each mouse press, an action event will be
     * fired, no matter how quickly the mouse clicks occur.  In buttons
     * where this behavior is not desirable (for example, the &quot;OK&quot; button
     * in a dialog), this threshhold should be set to an appropriate
     * positive value.
     *
     * @see #getMultiClickThreshhold
     * @param threshhold the amount of time required between mouse
     *        press events to generate corresponding action events
     * @exception   IllegalArgumentException if threshhold &amp;lt; 0
     * @since 1.4
     */
    public void setMultiClickThreshhold(long threshhold) {
<span class="nc bnc" id="L1709" title="All 2 branches missed.">        if (threshhold &lt; 0) {</span>
<span class="nc" id="L1710">            throw new IllegalArgumentException(&quot;threshhold must be &gt;= 0&quot;);</span>
        }
<span class="nc" id="L1712">        this.multiClickThreshhold = threshhold;</span>
<span class="nc" id="L1713">    }</span>

    /**
     * Gets the amount of time (in milliseconds) required between
     * mouse press events for the button to generate the corresponding
     * action events.
     *
     * @see #setMultiClickThreshhold
     * @return the amount of time required between mouse press events
     *         to generate corresponding action events
     * @since 1.4
     */
    public long getMultiClickThreshhold() {
<span class="nc" id="L1726">        return multiClickThreshhold;</span>
    }

    /**
     * Returns the model that this button represents.
     * @return the &lt;code&gt;model&lt;/code&gt; property
     * @see #setModel
     */
    public ButtonModel getModel() {
<span class="nc" id="L1735">        return model;</span>
    }

    /**
     * Sets the model that this button represents.
     * @param newModel the new &lt;code&gt;ButtonModel&lt;/code&gt;
     * @see #getModel
     * @beaninfo
     *        bound: true
     *  description: Model that the Button uses.
     */
    public void setModel(ButtonModel newModel) {

<span class="nc" id="L1748">        ButtonModel oldModel = getModel();</span>

<span class="nc bnc" id="L1750" title="All 2 branches missed.">        if (oldModel != null) {</span>
<span class="nc" id="L1751">            oldModel.removeChangeListener(changeListener);</span>
<span class="nc" id="L1752">            oldModel.removeActionListener(actionListener);</span>
<span class="nc" id="L1753">            oldModel.removeItemListener(itemListener);</span>
<span class="nc" id="L1754">            changeListener = null;</span>
<span class="nc" id="L1755">            actionListener = null;</span>
<span class="nc" id="L1756">            itemListener = null;</span>
        }

<span class="nc" id="L1759">        model = newModel;</span>

<span class="nc bnc" id="L1761" title="All 2 branches missed.">        if (newModel != null) {</span>
<span class="nc" id="L1762">            changeListener = createChangeListener();</span>
<span class="nc" id="L1763">            actionListener = createActionListener();</span>
<span class="nc" id="L1764">            itemListener = createItemListener();</span>
<span class="nc" id="L1765">            newModel.addChangeListener(changeListener);</span>
<span class="nc" id="L1766">            newModel.addActionListener(actionListener);</span>
<span class="nc" id="L1767">            newModel.addItemListener(itemListener);</span>

<span class="nc" id="L1769">            updateMnemonicProperties();</span>
            //We invoke setEnabled() from JComponent
            //because setModel() can be called from a constructor
            //when the button is not fully initialized
<span class="nc" id="L1773">            super.setEnabled(newModel.isEnabled());</span>

        } else {
<span class="nc" id="L1776">            mnemonic = '\0';</span>
        }

<span class="nc" id="L1779">        updateDisplayedMnemonicIndex(getText(), mnemonic);</span>

<span class="nc" id="L1781">        firePropertyChange(MODEL_CHANGED_PROPERTY, oldModel, newModel);</span>
<span class="nc bnc" id="L1782" title="All 2 branches missed.">        if (newModel != oldModel) {</span>
<span class="nc" id="L1783">            revalidate();</span>
<span class="nc" id="L1784">            repaint();</span>
        }
<span class="nc" id="L1786">    }</span>


    /**
     * Returns the L&amp;amp;F object that renders this component.
     * @return the ButtonUI object
     * @see #setUI
     */
    public ButtonUI getUI() {
<span class="nc" id="L1795">        return (ButtonUI) ui;</span>
    }


    /**
     * Sets the L&amp;amp;F object that renders this component.
     * @param ui the &lt;code&gt;ButtonUI&lt;/code&gt; L&amp;amp;F object
     * @see #getUI
     * @beaninfo
     *        bound: true
     *       hidden: true
     *    attribute: visualUpdate true
     *  description: The UI object that implements the LookAndFeel.
     */
    public void setUI(ButtonUI ui) {
<span class="nc" id="L1810">        super.setUI(ui);</span>
        // disabled icons are generated by the LF so they should be unset here
<span class="nc bnc" id="L1812" title="All 2 branches missed.">        if (disabledIcon instanceof UIResource) {</span>
<span class="nc" id="L1813">            setDisabledIcon(null);</span>
        }
<span class="nc bnc" id="L1815" title="All 2 branches missed.">        if (disabledSelectedIcon instanceof UIResource) {</span>
<span class="nc" id="L1816">            setDisabledSelectedIcon(null);</span>
        }
<span class="nc" id="L1818">    }</span>


    /**
     * Resets the UI property to a value from the current look
     * and feel.  Subtypes of &lt;code&gt;AbstractButton&lt;/code&gt;
     * should override this to update the UI. For
     * example, &lt;code&gt;JButton&lt;/code&gt; might do the following:
     * &lt;pre&gt;
     *      setUI((ButtonUI)UIManager.getUI(
     *          &quot;ButtonUI&quot;, &quot;javax.swing.plaf.basic.BasicButtonUI&quot;, this));
     * &lt;/pre&gt;
     */
    public void updateUI() {
<span class="nc" id="L1832">    }</span>

    /**
     * Adds the specified component to this container at the specified
     * index, refer to
     * {@link java.awt.Container#addImpl(Component, Object, int)}
     * for a complete description of this method.
     *
     * @param     comp the component to be added
     * @param     constraints an object expressing layout constraints
     *                 for this component
     * @param     index the position in the container's list at which to
     *                 insert the component, where &lt;code&gt;-1&lt;/code&gt;
     *                 means append to the end
     * @exception IllegalArgumentException if &lt;code&gt;index&lt;/code&gt; is invalid
     * @exception IllegalArgumentException if adding the container's parent
     *                  to itself
     * @exception IllegalArgumentException if adding a window to a container
     * @since 1.5
     */
    protected void addImpl(Component comp, Object constraints, int index) {
<span class="nc bnc" id="L1853" title="All 2 branches missed.">        if (!setLayout) {</span>
<span class="nc" id="L1854">            setLayout(new OverlayLayout(this));</span>
        }
<span class="nc" id="L1856">        super.addImpl(comp, constraints, index);</span>
<span class="nc" id="L1857">    }</span>

    /**
     * Sets the layout manager for this container, refer to
     * {@link java.awt.Container#setLayout(LayoutManager)}
     * for a complete description of this method.
     *
     * @param mgr the specified layout manager
     * @since 1.5
     */
    public void setLayout(LayoutManager mgr) {
<span class="nc" id="L1868">        setLayout = true;</span>
<span class="nc" id="L1869">        super.setLayout(mgr);</span>
<span class="nc" id="L1870">    }</span>

    /**
     * Adds a &lt;code&gt;ChangeListener&lt;/code&gt; to the button.
     * @param l the listener to be added
     */
    public void addChangeListener(ChangeListener l) {
<span class="nc" id="L1877">        listenerList.add(ChangeListener.class, l);</span>
<span class="nc" id="L1878">    }</span>

    /**
     * Removes a ChangeListener from the button.
     * @param l the listener to be removed
     */
    public void removeChangeListener(ChangeListener l) {
<span class="nc" id="L1885">        listenerList.remove(ChangeListener.class, l);</span>
<span class="nc" id="L1886">    }</span>

    /**
     * Returns an array of all the &lt;code&gt;ChangeListener&lt;/code&gt;s added
     * to this AbstractButton with addChangeListener().
     *
     * @return all of the &lt;code&gt;ChangeListener&lt;/code&gt;s added or an empty
     *         array if no listeners have been added
     * @since 1.4
     */
    public ChangeListener[] getChangeListeners() {
<span class="nc" id="L1897">        return listenerList.getListeners(ChangeListener.class);</span>
    }

    /**
     * Notifies all listeners that have registered interest for
     * notification on this event type.  The event instance
     * is lazily created.
     * @see EventListenerList
     */
    protected void fireStateChanged() {
        // Guaranteed to return a non-null array
<span class="nc" id="L1908">        Object[] listeners = listenerList.getListenerList();</span>
        // Process the listeners last to first, notifying
        // those that are interested in this event
<span class="nc bnc" id="L1911" title="All 2 branches missed.">        for (int i = listeners.length-2; i&gt;=0; i-=2) {</span>
<span class="nc bnc" id="L1912" title="All 2 branches missed.">            if (listeners[i]==ChangeListener.class) {</span>
                // Lazily create the event:
<span class="nc bnc" id="L1914" title="All 2 branches missed.">                if (changeEvent == null)</span>
<span class="nc" id="L1915">                    changeEvent = new ChangeEvent(this);</span>
<span class="nc" id="L1916">                ((ChangeListener)listeners[i+1]).stateChanged(changeEvent);</span>
            }
        }
<span class="nc" id="L1919">    }</span>

    /**
     * Adds an &lt;code&gt;ActionListener&lt;/code&gt; to the button.
     * @param l the &lt;code&gt;ActionListener&lt;/code&gt; to be added
     */
    public void addActionListener(ActionListener l) {
<span class="nc" id="L1926">        listenerList.add(ActionListener.class, l);</span>
<span class="nc" id="L1927">    }</span>

    /**
     * Removes an &lt;code&gt;ActionListener&lt;/code&gt; from the button.
     * If the listener is the currently set &lt;code&gt;Action&lt;/code&gt;
     * for the button, then the &lt;code&gt;Action&lt;/code&gt;
     * is set to &lt;code&gt;null&lt;/code&gt;.
     *
     * @param l the listener to be removed
     */
    public void removeActionListener(ActionListener l) {
<span class="nc bnc" id="L1938" title="All 4 branches missed.">        if ((l != null) &amp;&amp; (getAction() == l)) {</span>
<span class="nc" id="L1939">            setAction(null);</span>
        } else {
<span class="nc" id="L1941">            listenerList.remove(ActionListener.class, l);</span>
        }
<span class="nc" id="L1943">    }</span>

    /**
     * Returns an array of all the &lt;code&gt;ActionListener&lt;/code&gt;s added
     * to this AbstractButton with addActionListener().
     *
     * @return all of the &lt;code&gt;ActionListener&lt;/code&gt;s added or an empty
     *         array if no listeners have been added
     * @since 1.4
     */
    public ActionListener[] getActionListeners() {
<span class="nc" id="L1954">        return listenerList.getListeners(ActionListener.class);</span>
    }

    /**
     * Subclasses that want to handle &lt;code&gt;ChangeEvents&lt;/code&gt; differently
     * can override this to return another &lt;code&gt;ChangeListener&lt;/code&gt;
     * implementation.
     *
     * @return the new &lt;code&gt;ChangeListener&lt;/code&gt;
     */
    protected ChangeListener createChangeListener() {
<span class="nc" id="L1965">        return getHandler();</span>
    }

    /**
     * Extends &lt;code&gt;ChangeListener&lt;/code&gt; to be serializable.
     * &lt;p&gt;
     * &lt;strong&gt;Warning:&lt;/strong&gt;
     * Serialized objects of this class will not be compatible with
     * future Swing releases. The current serialization support is
     * appropriate for short term storage or RMI between applications running
     * the same version of Swing.  As of 1.4, support for long term storage
     * of all JavaBeans&amp;trade;
     * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
     * Please see {@link java.beans.XMLEncoder}.
     */
    @SuppressWarnings(&quot;serial&quot;)
    protected class ButtonChangeListener implements ChangeListener, Serializable {
        // NOTE: This class is NOT used, instead the functionality has
        // been moved to Handler.
<span class="nc" id="L1984">        ButtonChangeListener() {</span>
<span class="nc" id="L1985">        }</span>

        public void stateChanged(ChangeEvent e) {
<span class="nc" id="L1988">            getHandler().stateChanged(e);</span>
<span class="nc" id="L1989">        }</span>
    }


    /**
     * Notifies all listeners that have registered interest for
     * notification on this event type.  The event instance
     * is lazily created using the &lt;code&gt;event&lt;/code&gt;
     * parameter.
     *
     * @param event  the &lt;code&gt;ActionEvent&lt;/code&gt; object
     * @see EventListenerList
     */
    protected void fireActionPerformed(ActionEvent event) {
        // Guaranteed to return a non-null array
<span class="nc" id="L2004">        Object[] listeners = listenerList.getListenerList();</span>
<span class="nc" id="L2005">        ActionEvent e = null;</span>
        // Process the listeners last to first, notifying
        // those that are interested in this event
<span class="nc bnc" id="L2008" title="All 2 branches missed.">        for (int i = listeners.length-2; i&gt;=0; i-=2) {</span>
<span class="nc bnc" id="L2009" title="All 2 branches missed.">            if (listeners[i]==ActionListener.class) {</span>
                // Lazily create the event:
<span class="nc bnc" id="L2011" title="All 2 branches missed.">                if (e == null) {</span>
<span class="nc" id="L2012">                      String actionCommand = event.getActionCommand();</span>
<span class="nc bnc" id="L2013" title="All 2 branches missed.">                      if(actionCommand == null) {</span>
<span class="nc" id="L2014">                         actionCommand = getActionCommand();</span>
                      }
<span class="nc" id="L2016">                      e = new ActionEvent(AbstractButton.this,</span>
                                          ActionEvent.ACTION_PERFORMED,
                                          actionCommand,
<span class="nc" id="L2019">                                          event.getWhen(),</span>
<span class="nc" id="L2020">                                          event.getModifiers());</span>
                }
<span class="nc" id="L2022">                ((ActionListener)listeners[i+1]).actionPerformed(e);</span>
            }
        }
<span class="nc" id="L2025">    }</span>

    /**
     * Notifies all listeners that have registered interest for
     * notification on this event type.  The event instance
     * is lazily created using the &lt;code&gt;event&lt;/code&gt; parameter.
     *
     * @param event  the &lt;code&gt;ItemEvent&lt;/code&gt; object
     * @see EventListenerList
     */
    protected void fireItemStateChanged(ItemEvent event) {
        // Guaranteed to return a non-null array
<span class="nc" id="L2037">        Object[] listeners = listenerList.getListenerList();</span>
<span class="nc" id="L2038">        ItemEvent e = null;</span>
        // Process the listeners last to first, notifying
        // those that are interested in this event
<span class="nc bnc" id="L2041" title="All 2 branches missed.">        for (int i = listeners.length-2; i&gt;=0; i-=2) {</span>
<span class="nc bnc" id="L2042" title="All 2 branches missed.">            if (listeners[i]==ItemListener.class) {</span>
                // Lazily create the event:
<span class="nc bnc" id="L2044" title="All 2 branches missed.">                if (e == null) {</span>
<span class="nc" id="L2045">                    e = new ItemEvent(AbstractButton.this,</span>
                                      ItemEvent.ITEM_STATE_CHANGED,
                                      AbstractButton.this,
<span class="nc" id="L2048">                                      event.getStateChange());</span>
                }
<span class="nc" id="L2050">                ((ItemListener)listeners[i+1]).itemStateChanged(e);</span>
            }
        }
<span class="nc bnc" id="L2053" title="All 2 branches missed.">        if (accessibleContext != null) {</span>
<span class="nc bnc" id="L2054" title="All 2 branches missed.">            if (event.getStateChange() == ItemEvent.SELECTED) {</span>
<span class="nc" id="L2055">                accessibleContext.firePropertyChange(</span>
                    AccessibleContext.ACCESSIBLE_STATE_PROPERTY,
                    null, AccessibleState.SELECTED);
<span class="nc" id="L2058">                accessibleContext.firePropertyChange(</span>
                    AccessibleContext.ACCESSIBLE_VALUE_PROPERTY,
<span class="nc" id="L2060">                    Integer.valueOf(0), Integer.valueOf(1));</span>
            } else {
<span class="nc" id="L2062">                accessibleContext.firePropertyChange(</span>
                    AccessibleContext.ACCESSIBLE_STATE_PROPERTY,
                    AccessibleState.SELECTED, null);
<span class="nc" id="L2065">                accessibleContext.firePropertyChange(</span>
                    AccessibleContext.ACCESSIBLE_VALUE_PROPERTY,
<span class="nc" id="L2067">                    Integer.valueOf(1), Integer.valueOf(0));</span>
            }
        }
<span class="nc" id="L2070">    }</span>


    protected ActionListener createActionListener() {
<span class="nc" id="L2074">        return getHandler();</span>
    }


    protected ItemListener createItemListener() {
<span class="nc" id="L2079">        return getHandler();</span>
    }


    /**
     * Enables (or disables) the button.
     * @param b  true to enable the button, otherwise false
     */
    public void setEnabled(boolean b) {
<span class="nc bnc" id="L2088" title="All 4 branches missed.">        if (!b &amp;&amp; model.isRollover()) {</span>
<span class="nc" id="L2089">            model.setRollover(false);</span>
        }
<span class="nc" id="L2091">        super.setEnabled(b);</span>
<span class="nc" id="L2092">        model.setEnabled(b);</span>
<span class="nc" id="L2093">    }</span>

    // *** Deprecated java.awt.Button APIs below *** //

    /**
     * Returns the label text.
     *
     * @return a &lt;code&gt;String&lt;/code&gt; containing the label
     * @deprecated - Replaced by &lt;code&gt;getText&lt;/code&gt;
     */
    @Deprecated
    public String getLabel() {
<span class="nc" id="L2105">        return getText();</span>
    }

    /**
     * Sets the label text.
     *
     * @param label  a &lt;code&gt;String&lt;/code&gt; containing the text
     * @deprecated - Replaced by &lt;code&gt;setText(text)&lt;/code&gt;
     * @beaninfo
     *        bound: true
     *  description: Replace by setText(text)
     */
    @Deprecated
    public void setLabel(String label) {
<span class="nc" id="L2119">        setText(label);</span>
<span class="nc" id="L2120">    }</span>

    /**
     * Adds an &lt;code&gt;ItemListener&lt;/code&gt; to the &lt;code&gt;checkbox&lt;/code&gt;.
     * @param l  the &lt;code&gt;ItemListener&lt;/code&gt; to be added
     */
    public void addItemListener(ItemListener l) {
<span class="nc" id="L2127">        listenerList.add(ItemListener.class, l);</span>
<span class="nc" id="L2128">    }</span>

    /**
     * Removes an &lt;code&gt;ItemListener&lt;/code&gt; from the button.
     * @param l the &lt;code&gt;ItemListener&lt;/code&gt; to be removed
     */
    public void removeItemListener(ItemListener l) {
<span class="nc" id="L2135">        listenerList.remove(ItemListener.class, l);</span>
<span class="nc" id="L2136">    }</span>

    /**
     * Returns an array of all the &lt;code&gt;ItemListener&lt;/code&gt;s added
     * to this AbstractButton with addItemListener().
     *
     * @return all of the &lt;code&gt;ItemListener&lt;/code&gt;s added or an empty
     *         array if no listeners have been added
     * @since 1.4
     */
    public ItemListener[] getItemListeners() {
<span class="nc" id="L2147">        return listenerList.getListeners(ItemListener.class);</span>
    }

   /**
     * Returns an array (length 1) containing the label or
     * &lt;code&gt;null&lt;/code&gt; if the button is not selected.
     *
     * @return an array containing 1 Object: the text of the button,
     *         if the item is selected; otherwise &lt;code&gt;null&lt;/code&gt;
     */
    public Object[] getSelectedObjects() {
<span class="nc bnc" id="L2158" title="All 2 branches missed.">        if (isSelected() == false) {</span>
<span class="nc" id="L2159">            return null;</span>
        }
<span class="nc" id="L2161">        Object[] selectedObjects = new Object[1];</span>
<span class="nc" id="L2162">        selectedObjects[0] = getText();</span>
<span class="nc" id="L2163">        return selectedObjects;</span>
    }

    protected void init(String text, Icon icon) {
<span class="nc bnc" id="L2167" title="All 2 branches missed.">        if(text != null) {</span>
<span class="nc" id="L2168">            setText(text);</span>
        }

<span class="nc bnc" id="L2171" title="All 2 branches missed.">        if(icon != null) {</span>
<span class="nc" id="L2172">            setIcon(icon);</span>
        }

        // Set the UI
<span class="nc" id="L2176">        updateUI();</span>

<span class="nc" id="L2178">        setAlignmentX(LEFT_ALIGNMENT);</span>
<span class="nc" id="L2179">        setAlignmentY(CENTER_ALIGNMENT);</span>
<span class="nc" id="L2180">    }</span>


    /**
     * This is overridden to return false if the current &lt;code&gt;Icon&lt;/code&gt;'s
     * &lt;code&gt;Image&lt;/code&gt; is not equal to the
     * passed in &lt;code&gt;Image&lt;/code&gt; &lt;code&gt;img&lt;/code&gt;.
     *
     * @param img  the &lt;code&gt;Image&lt;/code&gt; to be compared
     * @param infoflags flags used to repaint the button when the image
     *          is updated and which determine how much is to be painted
     * @param x  the x coordinate
     * @param y  the y coordinate
     * @param w  the width
     * @param h  the height
     * @see     java.awt.image.ImageObserver
     * @see     java.awt.Component#imageUpdate(java.awt.Image, int, int, int, int, int)
     */
    public boolean imageUpdate(Image img, int infoflags,
                               int x, int y, int w, int h) {
<span class="nc" id="L2200">        Icon iconDisplayed = getIcon();</span>
<span class="nc bnc" id="L2201" title="All 2 branches missed.">        if (iconDisplayed == null) {</span>
<span class="nc" id="L2202">            return false;</span>
        }

<span class="nc bnc" id="L2205" title="All 2 branches missed.">        if (!model.isEnabled()) {</span>
<span class="nc bnc" id="L2206" title="All 2 branches missed.">            if (model.isSelected()) {</span>
<span class="nc" id="L2207">                iconDisplayed = getDisabledSelectedIcon();</span>
            } else {
<span class="nc" id="L2209">                iconDisplayed = getDisabledIcon();</span>
            }
<span class="nc bnc" id="L2211" title="All 4 branches missed.">        } else if (model.isPressed() &amp;&amp; model.isArmed()) {</span>
<span class="nc" id="L2212">            iconDisplayed = getPressedIcon();</span>
<span class="nc bnc" id="L2213" title="All 4 branches missed.">        } else if (isRolloverEnabled() &amp;&amp; model.isRollover()) {</span>
<span class="nc bnc" id="L2214" title="All 2 branches missed.">            if (model.isSelected()) {</span>
<span class="nc" id="L2215">                iconDisplayed = getRolloverSelectedIcon();</span>
            } else {
<span class="nc" id="L2217">                iconDisplayed = getRolloverIcon();</span>
            }
<span class="nc bnc" id="L2219" title="All 2 branches missed.">        } else if (model.isSelected()) {</span>
<span class="nc" id="L2220">            iconDisplayed = getSelectedIcon();</span>
        }

<span class="nc bnc" id="L2223" title="All 2 branches missed.">        if (!SwingUtilities.doesIconReferenceImage(iconDisplayed, img)) {</span>
            // We don't know about this image, disable the notification so
            // we don't keep repainting.
<span class="nc" id="L2226">            return false;</span>
        }
<span class="nc" id="L2228">        return super.imageUpdate(img, infoflags, x, y, w, h);</span>
    }

    void setUIProperty(String propertyName, Object value) {
<span class="nc bnc" id="L2232" title="All 2 branches missed.">        if (propertyName == &quot;borderPainted&quot;) {</span>
<span class="nc bnc" id="L2233" title="All 2 branches missed.">            if (!borderPaintedSet) {</span>
<span class="nc" id="L2234">                setBorderPainted(((Boolean)value).booleanValue());</span>
<span class="nc" id="L2235">                borderPaintedSet = false;</span>
            }
<span class="nc bnc" id="L2237" title="All 2 branches missed.">        } else if (propertyName == &quot;rolloverEnabled&quot;) {</span>
<span class="nc bnc" id="L2238" title="All 2 branches missed.">            if (!rolloverEnabledSet) {</span>
<span class="nc" id="L2239">                setRolloverEnabled(((Boolean)value).booleanValue());</span>
<span class="nc" id="L2240">                rolloverEnabledSet = false;</span>
            }
<span class="nc bnc" id="L2242" title="All 2 branches missed.">        } else if (propertyName == &quot;iconTextGap&quot;) {</span>
<span class="nc bnc" id="L2243" title="All 2 branches missed.">            if (!iconTextGapSet) {</span>
<span class="nc" id="L2244">                setIconTextGap(((Number)value).intValue());</span>
<span class="nc" id="L2245">                iconTextGapSet = false;</span>
            }
<span class="nc bnc" id="L2247" title="All 2 branches missed.">        } else if (propertyName == &quot;contentAreaFilled&quot;) {</span>
<span class="nc bnc" id="L2248" title="All 2 branches missed.">            if (!contentAreaFilledSet) {</span>
<span class="nc" id="L2249">                setContentAreaFilled(((Boolean)value).booleanValue());</span>
<span class="nc" id="L2250">                contentAreaFilledSet = false;</span>
            }
        } else {
<span class="nc" id="L2253">            super.setUIProperty(propertyName, value);</span>
        }
<span class="nc" id="L2255">    }</span>

    /**
     * Returns a string representation of this &lt;code&gt;AbstractButton&lt;/code&gt;.
     * This method
     * is intended to be used only for debugging purposes, and the
     * content and format of the returned string may vary between
     * implementations. The returned string may be empty but may not
     * be &lt;code&gt;null&lt;/code&gt;.
     * &lt;P&gt;
     * Overriding &lt;code&gt;paramString&lt;/code&gt; to provide information about the
     * specific new aspects of the JFC components.
     *
     * @return  a string representation of this &lt;code&gt;AbstractButton&lt;/code&gt;
     */
    protected String paramString() {
<span class="nc bnc" id="L2271" title="All 4 branches missed.">        String defaultIconString = ((defaultIcon != null)</span>
                                    &amp;&amp; (defaultIcon != this) ?
<span class="nc" id="L2273">                                    defaultIcon.toString() : &quot;&quot;);</span>
<span class="nc bnc" id="L2274" title="All 4 branches missed.">        String pressedIconString = ((pressedIcon != null)</span>
                                    &amp;&amp; (pressedIcon != this) ?
<span class="nc" id="L2276">                                    pressedIcon.toString() : &quot;&quot;);</span>
<span class="nc bnc" id="L2277" title="All 4 branches missed.">        String disabledIconString = ((disabledIcon != null)</span>
                                     &amp;&amp; (disabledIcon != this) ?
<span class="nc" id="L2279">                                     disabledIcon.toString() : &quot;&quot;);</span>
<span class="nc bnc" id="L2280" title="All 4 branches missed.">        String selectedIconString = ((selectedIcon != null)</span>
                                     &amp;&amp; (selectedIcon != this) ?
<span class="nc" id="L2282">                                     selectedIcon.toString() : &quot;&quot;);</span>
<span class="nc bnc" id="L2283" title="All 4 branches missed.">        String disabledSelectedIconString = ((disabledSelectedIcon != null) &amp;&amp;</span>
                                             (disabledSelectedIcon != this) ?
<span class="nc" id="L2285">                                             disabledSelectedIcon.toString()</span>
                                             : &quot;&quot;);
<span class="nc bnc" id="L2287" title="All 4 branches missed.">        String rolloverIconString = ((rolloverIcon != null)</span>
                                     &amp;&amp; (rolloverIcon != this) ?
<span class="nc" id="L2289">                                     rolloverIcon.toString() : &quot;&quot;);</span>
<span class="nc bnc" id="L2290" title="All 4 branches missed.">        String rolloverSelectedIconString = ((rolloverSelectedIcon != null) &amp;&amp;</span>
                                             (rolloverSelectedIcon != this) ?
<span class="nc" id="L2292">                                             rolloverSelectedIcon.toString()</span>
                                             : &quot;&quot;);
<span class="nc bnc" id="L2294" title="All 2 branches missed.">        String paintBorderString = (paintBorder ? &quot;true&quot; : &quot;false&quot;);</span>
<span class="nc bnc" id="L2295" title="All 2 branches missed.">        String paintFocusString = (paintFocus ? &quot;true&quot; : &quot;false&quot;);</span>
<span class="nc bnc" id="L2296" title="All 2 branches missed.">        String rolloverEnabledString = (rolloverEnabled ? &quot;true&quot; : &quot;false&quot;);</span>

<span class="nc" id="L2298">        return super.paramString() +</span>
        &quot;,defaultIcon=&quot; + defaultIconString +
        &quot;,disabledIcon=&quot; + disabledIconString +
        &quot;,disabledSelectedIcon=&quot; + disabledSelectedIconString +
        &quot;,margin=&quot; + margin +
        &quot;,paintBorder=&quot; + paintBorderString +
        &quot;,paintFocus=&quot; + paintFocusString +
        &quot;,pressedIcon=&quot; + pressedIconString +
        &quot;,rolloverEnabled=&quot; + rolloverEnabledString +
        &quot;,rolloverIcon=&quot; + rolloverIconString +
        &quot;,rolloverSelectedIcon=&quot; + rolloverSelectedIconString +
        &quot;,selectedIcon=&quot; + selectedIconString +
        &quot;,text=&quot; + text;
    }


    private Handler getHandler() {
<span class="nc bnc" id="L2315" title="All 2 branches missed.">        if (handler == null) {</span>
<span class="nc" id="L2316">            handler = new Handler();</span>
        }
<span class="nc" id="L2318">        return handler;</span>
    }


    //
    // Listeners that are added to model
    //
    @SuppressWarnings(&quot;serial&quot;)
<span class="nc" id="L2326">    class Handler implements ActionListener, ChangeListener, ItemListener,</span>
                             Serializable {
        //
        // ChangeListener
        //
        public void stateChanged(ChangeEvent e) {
<span class="nc" id="L2332">            Object source = e.getSource();</span>

<span class="nc" id="L2334">            updateMnemonicProperties();</span>
<span class="nc bnc" id="L2335" title="All 2 branches missed.">            if (isEnabled() != model.isEnabled()) {</span>
<span class="nc" id="L2336">                setEnabled(model.isEnabled());</span>
            }
<span class="nc" id="L2338">            fireStateChanged();</span>
<span class="nc" id="L2339">            repaint();</span>
<span class="nc" id="L2340">        }</span>

        //
        // ActionListener
        //
        public void actionPerformed(ActionEvent event) {
<span class="nc" id="L2346">            fireActionPerformed(event);</span>
<span class="nc" id="L2347">        }</span>

        //
        // ItemListener
        //
        public void itemStateChanged(ItemEvent event) {
<span class="nc" id="L2353">            fireItemStateChanged(event);</span>
<span class="nc bnc" id="L2354" title="All 2 branches missed.">            if (shouldUpdateSelectedStateFromAction()) {</span>
<span class="nc" id="L2355">                Action action = getAction();</span>
<span class="nc bnc" id="L2356" title="All 4 branches missed.">                if (action != null &amp;&amp; AbstractAction.hasSelectedKey(action)) {</span>
<span class="nc" id="L2357">                    boolean selected = isSelected();</span>
<span class="nc" id="L2358">                    boolean isActionSelected = AbstractAction.isSelected(</span>
                              action);
<span class="nc bnc" id="L2360" title="All 2 branches missed.">                    if (isActionSelected != selected) {</span>
<span class="nc" id="L2361">                        action.putValue(Action.SELECTED_KEY, selected);</span>
                    }
                }
            }
<span class="nc" id="L2365">        }</span>
    }

///////////////////
// Accessibility support
///////////////////
    /**
     * This class implements accessibility support for the
     * &lt;code&gt;AbstractButton&lt;/code&gt; class.  It provides an implementation of the
     * Java Accessibility API appropriate to button and menu item
     * user-interface elements.
     * &lt;p&gt;
     * &lt;strong&gt;Warning:&lt;/strong&gt;
     * Serialized objects of this class will not be compatible with
     * future Swing releases. The current serialization support is
     * appropriate for short term storage or RMI between applications running
     * the same version of Swing.  As of 1.4, support for long term storage
     * of all JavaBeans&amp;trade;
     * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
     * Please see {@link java.beans.XMLEncoder}.
     * @since 1.4
     */
<span class="nc" id="L2387">    protected abstract class AccessibleAbstractButton</span>
        extends AccessibleJComponent implements AccessibleAction,
        AccessibleValue, AccessibleText, AccessibleExtendedComponent {

        /**
         * Returns the accessible name of this object.
         *
         * @return the localized name of the object -- can be
         *              &lt;code&gt;null&lt;/code&gt; if this
         *              object does not have a name
         */
        public String getAccessibleName() {
<span class="nc" id="L2399">            String name = accessibleName;</span>

<span class="nc bnc" id="L2401" title="All 2 branches missed.">            if (name == null) {</span>
<span class="nc" id="L2402">                name = (String)getClientProperty(AccessibleContext.ACCESSIBLE_NAME_PROPERTY);</span>
            }
<span class="nc bnc" id="L2404" title="All 2 branches missed.">            if (name == null) {</span>
<span class="nc" id="L2405">                name = AbstractButton.this.getText();</span>
            }
<span class="nc bnc" id="L2407" title="All 2 branches missed.">            if (name == null) {</span>
<span class="nc" id="L2408">                name = super.getAccessibleName();</span>
            }
<span class="nc" id="L2410">            return name;</span>
        }

        /**
         * Get the AccessibleIcons associated with this object if one
         * or more exist.  Otherwise return null.
         * @since 1.3
         */
        public AccessibleIcon [] getAccessibleIcon() {
<span class="nc" id="L2419">            Icon defaultIcon = getIcon();</span>

<span class="nc bnc" id="L2421" title="All 2 branches missed.">            if (defaultIcon instanceof Accessible) {</span>
<span class="nc" id="L2422">                AccessibleContext ac =</span>
<span class="nc" id="L2423">                    ((Accessible)defaultIcon).getAccessibleContext();</span>
<span class="nc bnc" id="L2424" title="All 4 branches missed.">                if (ac != null &amp;&amp; ac instanceof AccessibleIcon) {</span>
<span class="nc" id="L2425">                    return new AccessibleIcon[] { (AccessibleIcon)ac };</span>
                }
            }
<span class="nc" id="L2428">            return null;</span>
        }

        /**
         * Get the state set of this object.
         *
         * @return an instance of AccessibleState containing the current state
         * of the object
         * @see AccessibleState
         */
        public AccessibleStateSet getAccessibleStateSet() {
<span class="nc" id="L2439">        AccessibleStateSet states = super.getAccessibleStateSet();</span>
<span class="nc bnc" id="L2440" title="All 2 branches missed.">            if (getModel().isArmed()) {</span>
<span class="nc" id="L2441">                states.add(AccessibleState.ARMED);</span>
            }
<span class="nc bnc" id="L2443" title="All 2 branches missed.">            if (isFocusOwner()) {</span>
<span class="nc" id="L2444">                states.add(AccessibleState.FOCUSED);</span>
            }
<span class="nc bnc" id="L2446" title="All 2 branches missed.">            if (getModel().isPressed()) {</span>
<span class="nc" id="L2447">                states.add(AccessibleState.PRESSED);</span>
            }
<span class="nc bnc" id="L2449" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L2450">                states.add(AccessibleState.CHECKED);</span>
            }
<span class="nc" id="L2452">            return states;</span>
        }

        /**
         * Get the AccessibleRelationSet associated with this object if one
         * exists.  Otherwise return null.
         * @see AccessibleRelation
         * @since 1.3
         */
        public AccessibleRelationSet getAccessibleRelationSet() {

            // Check where the AccessibleContext's relation
            // set already contains a MEMBER_OF relation.
<span class="nc" id="L2465">            AccessibleRelationSet relationSet</span>
<span class="nc" id="L2466">                = super.getAccessibleRelationSet();</span>

<span class="nc bnc" id="L2468" title="All 2 branches missed.">            if (!relationSet.contains(AccessibleRelation.MEMBER_OF)) {</span>
                // get the members of the button group if one exists
<span class="nc" id="L2470">                ButtonModel model = getModel();</span>
<span class="nc bnc" id="L2471" title="All 4 branches missed.">                if (model != null &amp;&amp; model instanceof DefaultButtonModel) {</span>
<span class="nc" id="L2472">                    ButtonGroup group = ((DefaultButtonModel)model).getGroup();</span>
<span class="nc bnc" id="L2473" title="All 2 branches missed.">                    if (group != null) {</span>
                        // set the target of the MEMBER_OF relation to be
                        // the members of the button group.
<span class="nc" id="L2476">                        int len = group.getButtonCount();</span>
<span class="nc" id="L2477">                        Object [] target = new Object[len];</span>
<span class="nc" id="L2478">                        Enumeration&lt;AbstractButton&gt; elem = group.getElements();</span>
<span class="nc bnc" id="L2479" title="All 2 branches missed.">                        for (int i = 0; i &lt; len; i++) {</span>
<span class="nc bnc" id="L2480" title="All 2 branches missed.">                            if (elem.hasMoreElements()) {</span>
<span class="nc" id="L2481">                                target[i] = elem.nextElement();</span>
                            }
                        }
<span class="nc" id="L2484">                        AccessibleRelation relation =</span>
                            new AccessibleRelation(AccessibleRelation.MEMBER_OF);
<span class="nc" id="L2486">                        relation.setTarget(target);</span>
<span class="nc" id="L2487">                        relationSet.add(relation);</span>
                    }
                }
            }
<span class="nc" id="L2491">            return relationSet;</span>
        }

        /**
         * Get the AccessibleAction associated with this object.  In the
         * implementation of the Java Accessibility API for this class,
         * return this object, which is responsible for implementing the
         * AccessibleAction interface on behalf of itself.
         *
         * @return this object
         */
        public AccessibleAction getAccessibleAction() {
<span class="nc" id="L2503">            return this;</span>
        }

        /**
         * Get the AccessibleValue associated with this object.  In the
         * implementation of the Java Accessibility API for this class,
         * return this object, which is responsible for implementing the
         * AccessibleValue interface on behalf of itself.
         *
         * @return this object
         */
        public AccessibleValue getAccessibleValue() {
<span class="nc" id="L2515">            return this;</span>
        }

        /**
         * Returns the number of Actions available in this object.  The
         * default behavior of a button is to have one action - toggle
         * the button.
         *
         * @return 1, the number of Actions in this object
         */
        public int getAccessibleActionCount() {
<span class="nc" id="L2526">            return 1;</span>
        }

        /**
         * Return a description of the specified action of the object.
         *
         * @param i zero-based index of the actions
         */
        public String getAccessibleActionDescription(int i) {
<span class="nc bnc" id="L2535" title="All 2 branches missed.">            if (i == 0) {</span>
<span class="nc" id="L2536">                return UIManager.getString(&quot;AbstractButton.clickText&quot;);</span>
            } else {
<span class="nc" id="L2538">                return null;</span>
            }
        }

        /**
         * Perform the specified Action on the object
         *
         * @param i zero-based index of actions
         * @return true if the the action was performed; else false.
         */
        public boolean doAccessibleAction(int i) {
<span class="nc bnc" id="L2549" title="All 2 branches missed.">            if (i == 0) {</span>
<span class="nc" id="L2550">                doClick();</span>
<span class="nc" id="L2551">                return true;</span>
            } else {
<span class="nc" id="L2553">                return false;</span>
            }
        }

        /**
         * Get the value of this object as a Number.
         *
         * @return An Integer of 0 if this isn't selected or an Integer of 1 if
         * this is selected.
         * @see AbstractButton#isSelected
         */
        public Number getCurrentAccessibleValue() {
<span class="nc bnc" id="L2565" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L2566">                return Integer.valueOf(1);</span>
            } else {
<span class="nc" id="L2568">                return Integer.valueOf(0);</span>
            }
        }

        /**
         * Set the value of this object as a Number.
         *
         * @return True if the value was set.
         */
        public boolean setCurrentAccessibleValue(Number n) {
            // TIGER - 4422535
<span class="nc bnc" id="L2579" title="All 2 branches missed.">            if (n == null) {</span>
<span class="nc" id="L2580">                return false;</span>
            }
<span class="nc" id="L2582">            int i = n.intValue();</span>
<span class="nc bnc" id="L2583" title="All 2 branches missed.">            if (i == 0) {</span>
<span class="nc" id="L2584">                setSelected(false);</span>
            } else {
<span class="nc" id="L2586">                setSelected(true);</span>
            }
<span class="nc" id="L2588">            return true;</span>
        }

        /**
         * Get the minimum value of this object as a Number.
         *
         * @return an Integer of 0.
         */
        public Number getMinimumAccessibleValue() {
<span class="nc" id="L2597">            return Integer.valueOf(0);</span>
        }

        /**
         * Get the maximum value of this object as a Number.
         *
         * @return An Integer of 1.
         */
        public Number getMaximumAccessibleValue() {
<span class="nc" id="L2606">            return Integer.valueOf(1);</span>
        }


        /* AccessibleText ---------- */

        public AccessibleText getAccessibleText() {
<span class="nc" id="L2613">            View view = (View)AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2614" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2615">                return this;</span>
            } else {
<span class="nc" id="L2617">                return null;</span>
            }
        }

        /**
         * Given a point in local coordinates, return the zero-based index
         * of the character under that Point.  If the point is invalid,
         * this method returns -1.
         *
         * Note: the AbstractButton must have a valid size (e.g. have
         * been added to a parent container whose ancestor container
         * is a valid top-level window) for this method to be able
         * to return a meaningful value.
         *
         * @param p the Point in local coordinates
         * @return the zero-based index of the character under Point p; if
         * Point is invalid returns -1.
         * @since 1.3
         */
        public int getIndexAtPoint(Point p) {
<span class="nc" id="L2637">            View view = (View) AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2638" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2639">                Rectangle r = getTextRectangle();</span>
<span class="nc bnc" id="L2640" title="All 2 branches missed.">                if (r == null) {</span>
<span class="nc" id="L2641">                    return -1;</span>
                }
<span class="nc" id="L2643">                Rectangle2D.Float shape =</span>
                    new Rectangle2D.Float(r.x, r.y, r.width, r.height);
<span class="nc" id="L2645">                Position.Bias bias[] = new Position.Bias[1];</span>
<span class="nc" id="L2646">                return view.viewToModel(p.x, p.y, shape, bias);</span>
            } else {
<span class="nc" id="L2648">                return -1;</span>
            }
        }

        /**
         * Determine the bounding box of the character at the given
         * index into the string.  The bounds are returned in local
         * coordinates.  If the index is invalid an empty rectangle is
         * returned.
         *
         * Note: the AbstractButton must have a valid size (e.g. have
         * been added to a parent container whose ancestor container
         * is a valid top-level window) for this method to be able
         * to return a meaningful value.
         *
         * @param i the index into the String
         * @return the screen coordinates of the character's the bounding box,
         * if index is invalid returns an empty rectangle.
         * @since 1.3
         */
        public Rectangle getCharacterBounds(int i) {
<span class="nc" id="L2669">            View view = (View) AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2670" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2671">                Rectangle r = getTextRectangle();</span>
<span class="nc bnc" id="L2672" title="All 2 branches missed.">                if (r == null) {</span>
<span class="nc" id="L2673">                    return null;</span>
                }
<span class="nc" id="L2675">                Rectangle2D.Float shape =</span>
                    new Rectangle2D.Float(r.x, r.y, r.width, r.height);
                try {
<span class="nc" id="L2678">                    Shape charShape =</span>
<span class="nc" id="L2679">                        view.modelToView(i, shape, Position.Bias.Forward);</span>
<span class="nc" id="L2680">                    return charShape.getBounds();</span>
<span class="nc" id="L2681">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2682">                    return null;</span>
                }
            } else {
<span class="nc" id="L2685">                return null;</span>
            }
        }

        /**
         * Return the number of characters (valid indicies)
         *
         * @return the number of characters
         * @since 1.3
         */
        public int getCharCount() {
<span class="nc" id="L2696">            View view = (View) AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2697" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2698">                Document d = view.getDocument();</span>
<span class="nc bnc" id="L2699" title="All 2 branches missed.">                if (d instanceof StyledDocument) {</span>
<span class="nc" id="L2700">                    StyledDocument doc = (StyledDocument)d;</span>
<span class="nc" id="L2701">                    return doc.getLength();</span>
                }
            }
<span class="nc" id="L2704">            return accessibleContext.getAccessibleName().length();</span>
        }

        /**
         * Return the zero-based offset of the caret.
         *
         * Note: That to the right of the caret will have the same index
         * value as the offset (the caret is between two characters).
         * @return the zero-based offset of the caret.
         * @since 1.3
         */
        public int getCaretPosition() {
            // There is no caret.
<span class="nc" id="L2717">            return -1;</span>
        }

        /**
         * Returns the String at a given index.
         *
         * @param part the AccessibleText.CHARACTER, AccessibleText.WORD,
         * or AccessibleText.SENTENCE to retrieve
         * @param index an index within the text &amp;gt;= 0
         * @return the letter, word, or sentence,
         *   null for an invalid index or part
         * @since 1.3
         */
        public String getAtIndex(int part, int index) {
<span class="nc bnc" id="L2731" title="All 4 branches missed.">            if (index &lt; 0 || index &gt;= getCharCount()) {</span>
<span class="nc" id="L2732">                return null;</span>
            }
<span class="nc bnc" id="L2734" title="All 4 branches missed.">            switch (part) {</span>
            case AccessibleText.CHARACTER:
                try {
<span class="nc" id="L2737">                    return getText(index, 1);</span>
<span class="nc" id="L2738">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2739">                    return null;</span>
                }
            case AccessibleText.WORD:
                try {
<span class="nc" id="L2743">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2744">                    BreakIterator words = BreakIterator.getWordInstance(getLocale());</span>
<span class="nc" id="L2745">                    words.setText(s);</span>
<span class="nc" id="L2746">                    int end = words.following(index);</span>
<span class="nc" id="L2747">                    return s.substring(words.previous(), end);</span>
<span class="nc" id="L2748">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2749">                    return null;</span>
                }
            case AccessibleText.SENTENCE:
                try {
<span class="nc" id="L2753">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2754">                    BreakIterator sentence =</span>
<span class="nc" id="L2755">                        BreakIterator.getSentenceInstance(getLocale());</span>
<span class="nc" id="L2756">                    sentence.setText(s);</span>
<span class="nc" id="L2757">                    int end = sentence.following(index);</span>
<span class="nc" id="L2758">                    return s.substring(sentence.previous(), end);</span>
<span class="nc" id="L2759">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2760">                    return null;</span>
                }
            default:
<span class="nc" id="L2763">                return null;</span>
            }
        }

        /**
         * Returns the String after a given index.
         *
         * @param part the AccessibleText.CHARACTER, AccessibleText.WORD,
         * or AccessibleText.SENTENCE to retrieve
         * @param index an index within the text &amp;gt;= 0
         * @return the letter, word, or sentence, null for an invalid
         *  index or part
         * @since 1.3
         */
        public String getAfterIndex(int part, int index) {
<span class="nc bnc" id="L2778" title="All 4 branches missed.">            if (index &lt; 0 || index &gt;= getCharCount()) {</span>
<span class="nc" id="L2779">                return null;</span>
            }
<span class="nc bnc" id="L2781" title="All 4 branches missed.">            switch (part) {</span>
            case AccessibleText.CHARACTER:
<span class="nc bnc" id="L2783" title="All 2 branches missed.">                if (index+1 &gt;= getCharCount()) {</span>
<span class="nc" id="L2784">                   return null;</span>
                }
                try {
<span class="nc" id="L2787">                    return getText(index+1, 1);</span>
<span class="nc" id="L2788">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2789">                    return null;</span>
                }
            case AccessibleText.WORD:
                try {
<span class="nc" id="L2793">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2794">                    BreakIterator words = BreakIterator.getWordInstance(getLocale());</span>
<span class="nc" id="L2795">                    words.setText(s);</span>
<span class="nc" id="L2796">                    int start = words.following(index);</span>
<span class="nc bnc" id="L2797" title="All 4 branches missed.">                    if (start == BreakIterator.DONE || start &gt;= s.length()) {</span>
<span class="nc" id="L2798">                        return null;</span>
                    }
<span class="nc" id="L2800">                    int end = words.following(start);</span>
<span class="nc bnc" id="L2801" title="All 4 branches missed.">                    if (end == BreakIterator.DONE || end &gt;= s.length()) {</span>
<span class="nc" id="L2802">                        return null;</span>
                    }
<span class="nc" id="L2804">                    return s.substring(start, end);</span>
<span class="nc" id="L2805">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2806">                    return null;</span>
                }
            case AccessibleText.SENTENCE:
                try {
<span class="nc" id="L2810">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2811">                    BreakIterator sentence =</span>
<span class="nc" id="L2812">                        BreakIterator.getSentenceInstance(getLocale());</span>
<span class="nc" id="L2813">                    sentence.setText(s);</span>
<span class="nc" id="L2814">                    int start = sentence.following(index);</span>
<span class="nc bnc" id="L2815" title="All 4 branches missed.">                    if (start == BreakIterator.DONE || start &gt; s.length()) {</span>
<span class="nc" id="L2816">                        return null;</span>
                    }
<span class="nc" id="L2818">                    int end = sentence.following(start);</span>
<span class="nc bnc" id="L2819" title="All 4 branches missed.">                    if (end == BreakIterator.DONE || end &gt; s.length()) {</span>
<span class="nc" id="L2820">                        return null;</span>
                    }
<span class="nc" id="L2822">                    return s.substring(start, end);</span>
<span class="nc" id="L2823">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2824">                    return null;</span>
                }
            default:
<span class="nc" id="L2827">                return null;</span>
            }
        }

        /**
         * Returns the String before a given index.
         *
         * @param part the AccessibleText.CHARACTER, AccessibleText.WORD,
         *   or AccessibleText.SENTENCE to retrieve
         * @param index an index within the text &amp;gt;= 0
         * @return the letter, word, or sentence, null for an invalid index
         *  or part
         * @since 1.3
         */
        public String getBeforeIndex(int part, int index) {
<span class="nc bnc" id="L2842" title="All 4 branches missed.">            if (index &lt; 0 || index &gt; getCharCount()-1) {</span>
<span class="nc" id="L2843">                return null;</span>
            }
<span class="nc bnc" id="L2845" title="All 4 branches missed.">            switch (part) {</span>
            case AccessibleText.CHARACTER:
<span class="nc bnc" id="L2847" title="All 2 branches missed.">                if (index == 0) {</span>
<span class="nc" id="L2848">                    return null;</span>
                }
                try {
<span class="nc" id="L2851">                    return getText(index-1, 1);</span>
<span class="nc" id="L2852">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2853">                    return null;</span>
                }
            case AccessibleText.WORD:
                try {
<span class="nc" id="L2857">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2858">                    BreakIterator words = BreakIterator.getWordInstance(getLocale());</span>
<span class="nc" id="L2859">                    words.setText(s);</span>
<span class="nc" id="L2860">                    int end = words.following(index);</span>
<span class="nc" id="L2861">                    end = words.previous();</span>
<span class="nc" id="L2862">                    int start = words.previous();</span>
<span class="nc bnc" id="L2863" title="All 2 branches missed.">                    if (start == BreakIterator.DONE) {</span>
<span class="nc" id="L2864">                        return null;</span>
                    }
<span class="nc" id="L2866">                    return s.substring(start, end);</span>
<span class="nc" id="L2867">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2868">                    return null;</span>
                }
            case AccessibleText.SENTENCE:
                try {
<span class="nc" id="L2872">                    String s = getText(0, getCharCount());</span>
<span class="nc" id="L2873">                    BreakIterator sentence =</span>
<span class="nc" id="L2874">                        BreakIterator.getSentenceInstance(getLocale());</span>
<span class="nc" id="L2875">                    sentence.setText(s);</span>
<span class="nc" id="L2876">                    int end = sentence.following(index);</span>
<span class="nc" id="L2877">                    end = sentence.previous();</span>
<span class="nc" id="L2878">                    int start = sentence.previous();</span>
<span class="nc bnc" id="L2879" title="All 2 branches missed.">                    if (start == BreakIterator.DONE) {</span>
<span class="nc" id="L2880">                        return null;</span>
                    }
<span class="nc" id="L2882">                    return s.substring(start, end);</span>
<span class="nc" id="L2883">                } catch (BadLocationException e) {</span>
<span class="nc" id="L2884">                    return null;</span>
                }
            default:
<span class="nc" id="L2887">                return null;</span>
            }
        }

        /**
         * Return the AttributeSet for a given character at a given index
         *
         * @param i the zero-based index into the text
         * @return the AttributeSet of the character
         * @since 1.3
         */
        public AttributeSet getCharacterAttribute(int i) {
<span class="nc" id="L2899">            View view = (View) AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2900" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2901">                Document d = view.getDocument();</span>
<span class="nc bnc" id="L2902" title="All 2 branches missed.">                if (d instanceof StyledDocument) {</span>
<span class="nc" id="L2903">                    StyledDocument doc = (StyledDocument)d;</span>
<span class="nc" id="L2904">                    Element elem = doc.getCharacterElement(i);</span>
<span class="nc bnc" id="L2905" title="All 2 branches missed.">                    if (elem != null) {</span>
<span class="nc" id="L2906">                        return elem.getAttributes();</span>
                    }
                }
            }
<span class="nc" id="L2910">            return null;</span>
        }

        /**
         * Returns the start offset within the selected text.
         * If there is no selection, but there is
         * a caret, the start and end offsets will be the same.
         *
         * @return the index into the text of the start of the selection
         * @since 1.3
         */
        public int getSelectionStart() {
            // Text cannot be selected.
<span class="nc" id="L2923">            return -1;</span>
        }

        /**
         * Returns the end offset within the selected text.
         * If there is no selection, but there is
         * a caret, the start and end offsets will be the same.
         *
         * @return the index into the text of the end of the selection
         * @since 1.3
         */
        public int getSelectionEnd() {
            // Text cannot be selected.
<span class="nc" id="L2936">            return -1;</span>
        }

        /**
         * Returns the portion of the text that is selected.
         *
         * @return the String portion of the text that is selected
         * @since 1.3
         */
        public String getSelectedText() {
            // Text cannot be selected.
<span class="nc" id="L2947">            return null;</span>
        }

        /*
         * Returns the text substring starting at the specified
         * offset with the specified length.
         */
        private String getText(int offset, int length)
            throws BadLocationException {

<span class="nc" id="L2957">            View view = (View) AbstractButton.this.getClientProperty(&quot;html&quot;);</span>
<span class="nc bnc" id="L2958" title="All 2 branches missed.">            if (view != null) {</span>
<span class="nc" id="L2959">                Document d = view.getDocument();</span>
<span class="nc bnc" id="L2960" title="All 2 branches missed.">                if (d instanceof StyledDocument) {</span>
<span class="nc" id="L2961">                    StyledDocument doc = (StyledDocument)d;</span>
<span class="nc" id="L2962">                    return doc.getText(offset, length);</span>
                }
            }
<span class="nc" id="L2965">            return null;</span>
        }

        /*
         * Returns the bounding rectangle for the component text.
         */
        private Rectangle getTextRectangle() {

<span class="nc" id="L2973">            String text = AbstractButton.this.getText();</span>
<span class="nc bnc" id="L2974" title="All 2 branches missed.">            Icon icon = (AbstractButton.this.isEnabled()) ? AbstractButton.this.getIcon() : AbstractButton.this.getDisabledIcon();</span>

<span class="nc bnc" id="L2976" title="All 4 branches missed.">            if ((icon == null) &amp;&amp; (text == null)) {</span>
<span class="nc" id="L2977">                return null;</span>
            }

<span class="nc" id="L2980">            Rectangle paintIconR = new Rectangle();</span>
<span class="nc" id="L2981">            Rectangle paintTextR = new Rectangle();</span>
<span class="nc" id="L2982">            Rectangle paintViewR = new Rectangle();</span>
<span class="nc" id="L2983">            Insets paintViewInsets = new Insets(0, 0, 0, 0);</span>

<span class="nc" id="L2985">            paintViewInsets = AbstractButton.this.getInsets(paintViewInsets);</span>
<span class="nc" id="L2986">            paintViewR.x = paintViewInsets.left;</span>
<span class="nc" id="L2987">            paintViewR.y = paintViewInsets.top;</span>
<span class="nc" id="L2988">            paintViewR.width = AbstractButton.this.getWidth() - (paintViewInsets.left + paintViewInsets.right);</span>
<span class="nc" id="L2989">            paintViewR.height = AbstractButton.this.getHeight() - (paintViewInsets.top + paintViewInsets.bottom);</span>

<span class="nc" id="L2991">            String clippedText = SwingUtilities.layoutCompoundLabel(</span>
                AbstractButton.this,
<span class="nc" id="L2993">                getFontMetrics(getFont()),</span>
                text,
                icon,
<span class="nc" id="L2996">                AbstractButton.this.getVerticalAlignment(),</span>
<span class="nc" id="L2997">                AbstractButton.this.getHorizontalAlignment(),</span>
<span class="nc" id="L2998">                AbstractButton.this.getVerticalTextPosition(),</span>
<span class="nc" id="L2999">                AbstractButton.this.getHorizontalTextPosition(),</span>
                paintViewR,
                paintIconR,
                paintTextR,
                0);

<span class="nc" id="L3005">            return paintTextR;</span>
        }

        // ----- AccessibleExtendedComponent

        /**
         * Returns the AccessibleExtendedComponent
         *
         * @return the AccessibleExtendedComponent
         */
        AccessibleExtendedComponent getAccessibleExtendedComponent() {
<span class="nc" id="L3016">            return this;</span>
        }

        /**
         * Returns the tool tip text
         *
         * @return the tool tip text, if supported, of the object;
         * otherwise, null
         * @since 1.4
         */
        public String getToolTipText() {
<span class="nc" id="L3027">            return AbstractButton.this.getToolTipText();</span>
        }

        /**
         * Returns the titled border text
         *
         * @return the titled border text, if supported, of the object;
         * otherwise, null
         * @since 1.4
         */
        public String getTitledBorderText() {
<span class="nc" id="L3038">            return super.getTitledBorderText();</span>
        }

        /**
         * Returns key bindings associated with this object
         *
         * @return the key bindings, if supported, of the object;
         * otherwise, null
         * @see AccessibleKeyBinding
         * @since 1.4
         */
        public AccessibleKeyBinding getAccessibleKeyBinding() {
<span class="nc" id="L3050">            int mnemonic = AbstractButton.this.getMnemonic();</span>
<span class="nc bnc" id="L3051" title="All 2 branches missed.">            if (mnemonic == 0) {</span>
<span class="nc" id="L3052">                return null;</span>
            }
<span class="nc" id="L3054">            return new ButtonKeyBinding(mnemonic);</span>
        }

<span class="nc" id="L3057">        class ButtonKeyBinding implements AccessibleKeyBinding {</span>
            int mnemonic;

<span class="nc" id="L3060">            ButtonKeyBinding(int mnemonic) {</span>
<span class="nc" id="L3061">                this.mnemonic = mnemonic;</span>
<span class="nc" id="L3062">            }</span>

            /**
             * Returns the number of key bindings for this object
             *
             * @return the zero-based number of key bindings for this object
             */
            public int getAccessibleKeyBindingCount() {
<span class="nc" id="L3070">                return 1;</span>
            }

            /**
             * Returns a key binding for this object.  The value returned is an
             * java.lang.Object which must be cast to appropriate type depending
             * on the underlying implementation of the key.  For example, if the
             * Object returned is a javax.swing.KeyStroke, the user of this
             * method should do the following:
             * &lt;nf&gt;&lt;code&gt;
             * Component c = &lt;get the component that has the key bindings&gt;
             * AccessibleContext ac = c.getAccessibleContext();
             * AccessibleKeyBinding akb = ac.getAccessibleKeyBinding();
             * for (int i = 0; i &lt; akb.getAccessibleKeyBindingCount(); i++) {
             *     Object o = akb.getAccessibleKeyBinding(i);
             *     if (o instanceof javax.swing.KeyStroke) {
             *         javax.swing.KeyStroke keyStroke = (javax.swing.KeyStroke)o;
             *         &lt;do something with the key binding&gt;
             *     }
             * }
             * &lt;/code&gt;&lt;/nf&gt;
             *
             * @param i zero-based index of the key bindings
             * @return a javax.lang.Object which specifies the key binding
             * @exception IllegalArgumentException if the index is
             * out of bounds
             * @see #getAccessibleKeyBindingCount
             */
            public java.lang.Object getAccessibleKeyBinding(int i) {
<span class="nc bnc" id="L3099" title="All 2 branches missed.">                if (i != 0) {</span>
<span class="nc" id="L3100">                    throw new IllegalArgumentException();</span>
                }
<span class="nc" id="L3102">                return KeyStroke.getKeyStroke(mnemonic, 0);</span>
            }
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>