<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>JMenuBar.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing</a> &gt; <span class="el_source">JMenuBar.java</span></div><h1>JMenuBar.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing;

import java.awt.Component;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Insets;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.event.*;
import java.beans.Transient;
import java.util.Vector;
import java.util.Enumeration;

import java.io.Serializable;
import java.io.ObjectOutputStream;
import java.io.ObjectInputStream;
import java.io.IOException;

import javax.swing.event.*;
import javax.swing.border.Border;
import javax.swing.plaf.*;
import javax.accessibility.*;

/**
 * An implementation of a menu bar. You add &lt;code&gt;JMenu&lt;/code&gt; objects to the
 * menu bar to construct a menu. When the user selects a &lt;code&gt;JMenu&lt;/code&gt;
 * object, its associated &lt;code&gt;JPopupMenu&lt;/code&gt; is displayed, allowing the
 * user to select one of the &lt;code&gt;JMenuItems&lt;/code&gt; on it.
 * &lt;p&gt;
 * For information and examples of using menu bars see
 * &lt;a
 href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/components/menu.html&quot;&gt;How to Use Menus&lt;/a&gt;,
 * a section in &lt;em&gt;The Java Tutorial.&lt;/em&gt;
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt; Swing is not thread safe. For more
 * information see &lt;a
 * href=&quot;package-summary.html#threading&quot;&gt;Swing's Threading
 * Policy&lt;/a&gt;.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * Serialized objects of this class will not be compatible with
 * future Swing releases. The current serialization support is
 * appropriate for short term storage or RMI between applications running
 * the same version of Swing.  As of 1.4, support for long term storage
 * of all JavaBeans&amp;trade;
 * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
 * Please see {@link java.beans.XMLEncoder}.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * By default, pressing the Tab key does not transfer focus from a &lt;code&gt;
 * JMenuBar&lt;/code&gt; which is added to a container together with other Swing
 * components, because the &lt;code&gt;focusTraversalKeysEnabled&lt;/code&gt; property
 * of &lt;code&gt;JMenuBar&lt;/code&gt; is set to &lt;code&gt;false&lt;/code&gt;. To resolve this,
 * you should call the &lt;code&gt;JMenuBar.setFocusTraversalKeysEnabled(true)&lt;/code&gt;
 * method.
 * @beaninfo
 *   attribute: isContainer true
 * description: A container for holding and displaying menus.
 *
 * @author Georges Saab
 * @author David Karlton
 * @author Arnaud Weber
 * @see JMenu
 * @see JPopupMenu
 * @see JMenuItem
 */
@SuppressWarnings(&quot;serial&quot;)
public class JMenuBar extends JComponent implements Accessible,MenuElement
{
    /**
     * @see #getUIClassID
     * @see #readObject
     */
    private static final String uiClassID = &quot;MenuBarUI&quot;;

    /*
     * Model for the selected subcontrol.
     */
    private transient SingleSelectionModel selectionModel;

<span class="nc" id="L106">    private boolean paintBorder           = true;</span>
<span class="nc" id="L107">    private Insets     margin             = null;</span>

    /* diagnostic aids -- should be false for production builds. */
    private static final boolean TRACE =   false; // trace creates and disposes
    private static final boolean VERBOSE = false; // show reuse hits/misses
    private static final boolean DEBUG =   false;  // show bad params, misc.

    /**
     * Creates a new menu bar.
     */
    public JMenuBar() {
<span class="nc" id="L118">        super();</span>
<span class="nc" id="L119">        setFocusTraversalKeysEnabled(false);</span>
<span class="nc" id="L120">        setSelectionModel(new DefaultSingleSelectionModel());</span>
<span class="nc" id="L121">        updateUI();</span>
<span class="nc" id="L122">    }</span>

    /**
     * Returns the menubar's current UI.
     * @see #setUI
     */
    public MenuBarUI getUI() {
<span class="nc" id="L129">        return (MenuBarUI)ui;</span>
    }

    /**
     * Sets the L&amp;amp;F object that renders this component.
     *
     * @param ui the new MenuBarUI L&amp;amp;F object
     * @see UIDefaults#getUI
     * @beaninfo
     *        bound: true
     *       hidden: true
     *    attribute: visualUpdate true
     *  description: The UI object that implements the Component's LookAndFeel.
     */
    public void setUI(MenuBarUI ui) {
<span class="nc" id="L144">        super.setUI(ui);</span>
<span class="nc" id="L145">    }</span>

    /**
     * Resets the UI property with a value from the current look and feel.
     *
     * @see JComponent#updateUI
     */
    public void updateUI() {
<span class="nc" id="L153">        setUI((MenuBarUI)UIManager.getUI(this));</span>
<span class="nc" id="L154">    }</span>


    /**
     * Returns the name of the L&amp;amp;F class that renders this component.
     *
     * @return the string &quot;MenuBarUI&quot;
     * @see JComponent#getUIClassID
     * @see UIDefaults#getUI
     */
    public String getUIClassID() {
<span class="nc" id="L165">        return uiClassID;</span>
    }


    /**
     * Returns the model object that handles single selections.
     *
     * @return the &lt;code&gt;SingleSelectionModel&lt;/code&gt; property
     * @see SingleSelectionModel
     */
    public SingleSelectionModel getSelectionModel() {
<span class="nc" id="L176">        return selectionModel;</span>
    }

    /**
     * Sets the model object to handle single selections.
     *
     * @param model the &lt;code&gt;SingleSelectionModel&lt;/code&gt; to use
     * @see SingleSelectionModel
     * @beaninfo
     *       bound: true
     * description: The selection model, recording which child is selected.
     */
    public void setSelectionModel(SingleSelectionModel model) {
<span class="nc" id="L189">        SingleSelectionModel oldValue = selectionModel;</span>
<span class="nc" id="L190">        this.selectionModel = model;</span>
<span class="nc" id="L191">        firePropertyChange(&quot;selectionModel&quot;, oldValue, selectionModel);</span>
<span class="nc" id="L192">    }</span>


    /**
     * Appends the specified menu to the end of the menu bar.
     *
     * @param c the &lt;code&gt;JMenu&lt;/code&gt; component to add
     * @return the menu component
     */
    public JMenu add(JMenu c) {
<span class="nc" id="L202">        super.add(c);</span>
<span class="nc" id="L203">        return c;</span>
    }

    /**
     * Returns the menu at the specified position in the menu bar.
     *
     * @param index  an integer giving the position in the menu bar, where
     *               0 is the first position
     * @return the &lt;code&gt;JMenu&lt;/code&gt; at that position, or &lt;code&gt;null&lt;/code&gt; if
     *          if there is no &lt;code&gt;JMenu&lt;/code&gt; at that position (ie. if
     *          it is a &lt;code&gt;JMenuItem&lt;/code&gt;)
     */
    public JMenu getMenu(int index) {
<span class="nc" id="L216">        Component c = getComponentAtIndex(index);</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if (c instanceof JMenu)</span>
<span class="nc" id="L218">            return (JMenu) c;</span>
<span class="nc" id="L219">        return null;</span>
    }

    /**
     * Returns the number of items in the menu bar.
     *
     * @return the number of items in the menu bar
     */
    public int getMenuCount() {
<span class="nc" id="L228">        return getComponentCount();</span>
    }

    /**
     * Sets the help menu that appears when the user selects the
     * &quot;help&quot; option in the menu bar. This method is not yet implemented
     * and will throw an exception.
     *
     * @param menu the JMenu that delivers help to the user
     */
    public void setHelpMenu(JMenu menu) {
<span class="nc" id="L239">        throw new Error(&quot;setHelpMenu() not yet implemented.&quot;);</span>
    }

    /**
     * Gets the help menu for the menu bar.  This method is not yet
     * implemented and will throw an exception.
     *
     * @return the &lt;code&gt;JMenu&lt;/code&gt; that delivers help to the user
     */
    @Transient
    public JMenu getHelpMenu() {
<span class="nc" id="L250">        throw new Error(&quot;getHelpMenu() not yet implemented.&quot;);</span>
    }

    /**
     * Returns the component at the specified index.
     *
     * @param i an integer specifying the position, where 0 is first
     * @return the &lt;code&gt;Component&lt;/code&gt; at the position,
     *          or &lt;code&gt;null&lt;/code&gt; for an invalid index
     * @deprecated replaced by &lt;code&gt;getComponent(int i)&lt;/code&gt;
     */
    @Deprecated
    public Component getComponentAtIndex(int i) {
<span class="nc bnc" id="L263" title="All 4 branches missed.">        if(i &lt; 0 || i &gt;= getComponentCount()) {</span>
<span class="nc" id="L264">            return null;</span>
        }
<span class="nc" id="L266">        return getComponent(i);</span>
    }

    /**
     * Returns the index of the specified component.
     *
     * @param c  the &lt;code&gt;Component&lt;/code&gt; to find
     * @return an integer giving the component's position, where 0 is first;
     *          or -1 if it can't be found
     */
    public int getComponentIndex(Component c) {
<span class="nc" id="L277">        int ncomponents = this.getComponentCount();</span>
<span class="nc" id="L278">        Component[] component = this.getComponents();</span>
<span class="nc bnc" id="L279" title="All 2 branches missed.">        for (int i = 0 ; i &lt; ncomponents ; i++) {</span>
<span class="nc" id="L280">            Component comp = component[i];</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">            if (comp == c)</span>
<span class="nc" id="L282">                return i;</span>
        }
<span class="nc" id="L284">        return -1;</span>
    }

    /**
     * Sets the currently selected component, producing a
     * a change to the selection model.
     *
     * @param sel the &lt;code&gt;Component&lt;/code&gt; to select
     */
    public void setSelected(Component sel) {
<span class="nc" id="L294">        SingleSelectionModel model = getSelectionModel();</span>
<span class="nc" id="L295">        int index = getComponentIndex(sel);</span>
<span class="nc" id="L296">        model.setSelectedIndex(index);</span>
<span class="nc" id="L297">    }</span>

    /**
     * Returns true if the menu bar currently has a component selected.
     *
     * @return true if a selection has been made, else false
     */
    public boolean isSelected() {
<span class="nc" id="L305">        return selectionModel.isSelected();</span>
    }

    /**
     * Returns true if the menu bars border should be painted.
     *
     * @return  true if the border should be painted, else false
     */
    public boolean isBorderPainted() {
<span class="nc" id="L314">        return paintBorder;</span>
    }

    /**
     * Sets whether the border should be painted.
     *
     * @param b if true and border property is not &lt;code&gt;null&lt;/code&gt;,
     *          the border is painted.
     * @see #isBorderPainted
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: Whether the border should be painted.
     */
    public void setBorderPainted(boolean b) {
<span class="nc" id="L329">        boolean oldValue = paintBorder;</span>
<span class="nc" id="L330">        paintBorder = b;</span>
<span class="nc" id="L331">        firePropertyChange(&quot;borderPainted&quot;, oldValue, paintBorder);</span>
<span class="nc bnc" id="L332" title="All 2 branches missed.">        if (b != oldValue) {</span>
<span class="nc" id="L333">            revalidate();</span>
<span class="nc" id="L334">            repaint();</span>
        }
<span class="nc" id="L336">    }</span>

    /**
     * Paints the menubar's border if &lt;code&gt;BorderPainted&lt;/code&gt;
     * property is true.
     *
     * @param g the &lt;code&gt;Graphics&lt;/code&gt; context to use for painting
     * @see JComponent#paint
     * @see JComponent#setBorder
     */
    protected void paintBorder(Graphics g) {
<span class="nc bnc" id="L347" title="All 2 branches missed.">        if (isBorderPainted()) {</span>
<span class="nc" id="L348">            super.paintBorder(g);</span>
        }
<span class="nc" id="L350">    }</span>

    /**
     * Sets the margin between the menubar's border and
     * its menus. Setting to &lt;code&gt;null&lt;/code&gt; will cause the menubar to
     * use the default margins.
     *
     * @param m an Insets object containing the margin values
     * @see Insets
     * @beaninfo
     *        bound: true
     *    attribute: visualUpdate true
     *  description: The space between the menubar's border and its contents
     */
    public void setMargin(Insets m) {
<span class="nc" id="L365">        Insets old = margin;</span>
<span class="nc" id="L366">        this.margin = m;</span>
<span class="nc" id="L367">        firePropertyChange(&quot;margin&quot;, old, m);</span>
<span class="nc bnc" id="L368" title="All 4 branches missed.">        if (old == null || !old.equals(m)) {</span>
<span class="nc" id="L369">            revalidate();</span>
<span class="nc" id="L370">            repaint();</span>
        }
<span class="nc" id="L372">    }</span>

    /**
     * Returns the margin between the menubar's border and
     * its menus.  If there is no previous margin, it will create
     * a default margin with zero size.
     *
     * @return an &lt;code&gt;Insets&lt;/code&gt; object containing the margin values
     * @see Insets
     */
    public Insets getMargin() {
<span class="nc bnc" id="L383" title="All 2 branches missed.">        if(margin == null) {</span>
<span class="nc" id="L384">            return new Insets(0,0,0,0);</span>
        } else {
<span class="nc" id="L386">            return margin;</span>
        }
    }


    /**
     * Implemented to be a &lt;code&gt;MenuElement&lt;/code&gt; -- does nothing.
     *
     * @see #getSubElements
     */
    public void processMouseEvent(MouseEvent event,MenuElement path[],MenuSelectionManager manager) {
<span class="nc" id="L397">    }</span>

    /**
     * Implemented to be a &lt;code&gt;MenuElement&lt;/code&gt; -- does nothing.
     *
     * @see #getSubElements
     */
    public void processKeyEvent(KeyEvent e,MenuElement path[],MenuSelectionManager manager) {
<span class="nc" id="L405">    }</span>

    /**
     * Implemented to be a &lt;code&gt;MenuElement&lt;/code&gt; -- does nothing.
     *
     * @see #getSubElements
     */
    public void menuSelectionChanged(boolean isIncluded) {
<span class="nc" id="L413">    }</span>

    /**
     * Implemented to be a &lt;code&gt;MenuElement&lt;/code&gt; -- returns the
     * menus in this menu bar.
     * This is the reason for implementing the &lt;code&gt;MenuElement&lt;/code&gt;
     * interface -- so that the menu bar can be treated the same as
     * other menu elements.
     * @return an array of menu items in the menu bar.
     */
    public MenuElement[] getSubElements() {
        MenuElement result[];
<span class="nc" id="L425">        Vector&lt;MenuElement&gt; tmp = new Vector&lt;MenuElement&gt;();</span>
<span class="nc" id="L426">        int c = getComponentCount();</span>
        int i;
        Component m;

<span class="nc bnc" id="L430" title="All 2 branches missed.">        for(i=0 ; i &lt; c ; i++) {</span>
<span class="nc" id="L431">            m = getComponent(i);</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">            if(m instanceof MenuElement)</span>
<span class="nc" id="L433">                tmp.addElement((MenuElement) m);</span>
        }

<span class="nc" id="L436">        result = new MenuElement[tmp.size()];</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">        for(i=0,c=tmp.size() ; i &lt; c ; i++)</span>
<span class="nc" id="L438">            result[i] = tmp.elementAt(i);</span>
<span class="nc" id="L439">        return result;</span>
    }

    /**
     * Implemented to be a &lt;code&gt;MenuElement&lt;/code&gt;. Returns this object.
     *
     * @return the current &lt;code&gt;Component&lt;/code&gt; (this)
     * @see #getSubElements
     */
    public Component getComponent() {
<span class="nc" id="L449">        return this;</span>
    }


    /**
     * Returns a string representation of this &lt;code&gt;JMenuBar&lt;/code&gt;.
     * This method
     * is intended to be used only for debugging purposes, and the
     * content and format of the returned string may vary between
     * implementations. The returned string may be empty but may not
     * be &lt;code&gt;null&lt;/code&gt;.
     *
     * @return  a string representation of this &lt;code&gt;JMenuBar&lt;/code&gt;
     */
    protected String paramString() {
<span class="nc bnc" id="L464" title="All 2 branches missed.">        String paintBorderString = (paintBorder ?</span>
                                    &quot;true&quot; : &quot;false&quot;);
<span class="nc bnc" id="L466" title="All 2 branches missed.">        String marginString = (margin != null ?</span>
<span class="nc" id="L467">                               margin.toString() : &quot;&quot;);</span>

<span class="nc" id="L469">        return super.paramString() +</span>
        &quot;,margin=&quot; + marginString +
        &quot;,paintBorder=&quot; + paintBorderString;
    }

/////////////////
// Accessibility support
////////////////

    /**
     * Gets the AccessibleContext associated with this JMenuBar.
     * For JMenuBars, the AccessibleContext takes the form of an
     * AccessibleJMenuBar.
     * A new AccessibleJMenuBar instance is created if necessary.
     *
     * @return an AccessibleJMenuBar that serves as the
     *         AccessibleContext of this JMenuBar
     */
    public AccessibleContext getAccessibleContext() {
<span class="nc bnc" id="L488" title="All 2 branches missed.">        if (accessibleContext == null) {</span>
<span class="nc" id="L489">            accessibleContext = new AccessibleJMenuBar();</span>
        }
<span class="nc" id="L491">        return accessibleContext;</span>
    }

    /**
     * This class implements accessibility support for the
     * &lt;code&gt;JMenuBar&lt;/code&gt; class.  It provides an implementation of the
     * Java Accessibility API appropriate to menu bar user-interface
     * elements.
     * &lt;p&gt;
     * &lt;strong&gt;Warning:&lt;/strong&gt;
     * Serialized objects of this class will not be compatible with
     * future Swing releases. The current serialization support is
     * appropriate for short term storage or RMI between applications running
     * the same version of Swing.  As of 1.4, support for long term storage
     * of all JavaBeans&amp;trade;
     * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
     * Please see {@link java.beans.XMLEncoder}.
     */
    @SuppressWarnings(&quot;serial&quot;)
<span class="nc" id="L510">    protected class AccessibleJMenuBar extends AccessibleJComponent</span>
        implements AccessibleSelection {

        /**
         * Get the accessible state set of this object.
         *
         * @return an instance of AccessibleState containing the current state
         *         of the object
         */
        public AccessibleStateSet getAccessibleStateSet() {
<span class="nc" id="L520">            AccessibleStateSet states = super.getAccessibleStateSet();</span>
<span class="nc" id="L521">            return states;</span>
        }

        /**
         * Get the role of this object.
         *
         * @return an instance of AccessibleRole describing the role of the
         * object
         */
        public AccessibleRole getAccessibleRole() {
<span class="nc" id="L531">            return AccessibleRole.MENU_BAR;</span>
        }

        /**
         * Get the AccessibleSelection associated with this object.  In the
         * implementation of the Java Accessibility API for this class,
         * return this object, which is responsible for implementing the
         * AccessibleSelection interface on behalf of itself.
         *
         * @return this object
         */
        public AccessibleSelection getAccessibleSelection() {
<span class="nc" id="L543">            return this;</span>
        }

        /**
         * Returns 1 if a menu is currently selected in this menu bar.
         *
         * @return 1 if a menu is currently selected, else 0
         */
         public int getAccessibleSelectionCount() {
<span class="nc bnc" id="L552" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L553">                return 1;</span>
            } else {
<span class="nc" id="L555">                return 0;</span>
            }
         }

        /**
         * Returns the currently selected menu if one is selected,
         * otherwise null.
         */
         public Accessible getAccessibleSelection(int i) {
<span class="nc bnc" id="L564" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc bnc" id="L565" title="All 2 branches missed.">                if (i != 0) {   // single selection model for JMenuBar</span>
<span class="nc" id="L566">                    return null;</span>
                }
<span class="nc" id="L568">                int j = getSelectionModel().getSelectedIndex();</span>
<span class="nc bnc" id="L569" title="All 2 branches missed.">                if (getComponentAtIndex(j) instanceof Accessible) {</span>
<span class="nc" id="L570">                    return (Accessible) getComponentAtIndex(j);</span>
                }
            }
<span class="nc" id="L573">            return null;</span>
         }

        /**
         * Returns true if the current child of this object is selected.
         *
         * @param i the zero-based index of the child in this Accessible
         * object.
         * @see AccessibleContext#getAccessibleChild
         */
        public boolean isAccessibleChildSelected(int i) {
<span class="nc bnc" id="L584" title="All 2 branches missed.">            return (i == getSelectionModel().getSelectedIndex());</span>
        }

        /**
         * Selects the nth menu in the menu bar, forcing it to
         * pop up.  If another menu is popped up, this will force
         * it to close.  If the nth menu is already selected, this
         * method has no effect.
         *
         * @param i the zero-based index of selectable items
         * @see #getAccessibleStateSet
         */
        public void addAccessibleSelection(int i) {
            // first close up any open menu
<span class="nc" id="L598">            int j = getSelectionModel().getSelectedIndex();</span>
<span class="nc bnc" id="L599" title="All 2 branches missed.">            if (i == j) {</span>
<span class="nc" id="L600">                return;</span>
            }
<span class="nc bnc" id="L602" title="All 4 branches missed.">            if (j &gt;= 0 &amp;&amp; j &lt; getMenuCount()) {</span>
<span class="nc" id="L603">                JMenu menu = getMenu(j);</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">                if (menu != null) {</span>
<span class="nc" id="L605">                    MenuSelectionManager.defaultManager().setSelectedPath(null);</span>
//                  menu.setPopupMenuVisible(false);
                }
            }
            // now popup the new menu
<span class="nc" id="L610">            getSelectionModel().setSelectedIndex(i);</span>
<span class="nc" id="L611">            JMenu menu = getMenu(i);</span>
<span class="nc bnc" id="L612" title="All 2 branches missed.">            if (menu != null) {</span>
<span class="nc" id="L613">                MenuElement me[] = new MenuElement[3];</span>
<span class="nc" id="L614">                me[0] = JMenuBar.this;</span>
<span class="nc" id="L615">                me[1] = menu;</span>
<span class="nc" id="L616">                me[2] = menu.getPopupMenu();</span>
<span class="nc" id="L617">                MenuSelectionManager.defaultManager().setSelectedPath(me);</span>
//              menu.setPopupMenuVisible(true);
            }
<span class="nc" id="L620">        }</span>

        /**
         * Removes the nth selected item in the object from the object's
         * selection.  If the nth item isn't currently selected, this
         * method has no effect.  Otherwise, it closes the popup menu.
         *
         * @param i the zero-based index of selectable items
         */
        public void removeAccessibleSelection(int i) {
<span class="nc bnc" id="L630" title="All 4 branches missed.">            if (i &gt;= 0 &amp;&amp; i &lt; getMenuCount()) {</span>
<span class="nc" id="L631">                JMenu menu = getMenu(i);</span>
<span class="nc bnc" id="L632" title="All 2 branches missed.">                if (menu != null) {</span>
<span class="nc" id="L633">                    MenuSelectionManager.defaultManager().setSelectedPath(null);</span>
//                  menu.setPopupMenuVisible(false);
                }
<span class="nc" id="L636">                getSelectionModel().setSelectedIndex(-1);</span>
            }
<span class="nc" id="L638">        }</span>

        /**
         * Clears the selection in the object, so that nothing in the
         * object is selected.  This will close any open menu.
         */
        public void clearAccessibleSelection() {
<span class="nc" id="L645">            int i = getSelectionModel().getSelectedIndex();</span>
<span class="nc bnc" id="L646" title="All 4 branches missed.">            if (i &gt;= 0 &amp;&amp; i &lt; getMenuCount()) {</span>
<span class="nc" id="L647">                JMenu menu = getMenu(i);</span>
<span class="nc bnc" id="L648" title="All 2 branches missed.">                if (menu != null) {</span>
<span class="nc" id="L649">                    MenuSelectionManager.defaultManager().setSelectedPath(null);</span>
//                  menu.setPopupMenuVisible(false);
                }
            }
<span class="nc" id="L653">            getSelectionModel().setSelectedIndex(-1);</span>
<span class="nc" id="L654">        }</span>

        /**
         * Normally causes every selected item in the object to be selected
         * if the object supports multiple selections.  This method
         * makes no sense in a menu bar, and so does nothing.
         */
        public void selectAllAccessibleSelection() {
<span class="nc" id="L662">        }</span>
    } // internal class AccessibleJMenuBar


    /**
     * Subclassed to check all the child menus.
     * @since 1.3
     */
    protected boolean processKeyBinding(KeyStroke ks, KeyEvent e,
                                        int condition, boolean pressed) {
        // See if we have a local binding.
<span class="nc" id="L673">        boolean retValue = super.processKeyBinding(ks, e, condition, pressed);</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">        if (!retValue) {</span>
<span class="nc" id="L675">            MenuElement[] subElements = getSubElements();</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">            for (MenuElement subElement : subElements) {</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">                if (processBindingForKeyStrokeRecursive(</span>
                        subElement, ks, e, condition, pressed)) {
<span class="nc" id="L679">                    return true;</span>
                }
            }
        }
<span class="nc" id="L683">        return retValue;</span>
    }

    static boolean processBindingForKeyStrokeRecursive(MenuElement elem,
                                                       KeyStroke ks, KeyEvent e, int condition, boolean pressed) {
<span class="nc bnc" id="L688" title="All 2 branches missed.">        if (elem == null) {</span>
<span class="nc" id="L689">            return false;</span>
        }

<span class="nc" id="L692">        Component c = elem.getComponent();</span>

<span class="nc bnc" id="L694" title="All 6 branches missed.">        if ( !(c.isVisible() || (c instanceof JPopupMenu)) || !c.isEnabled() ) {</span>
<span class="nc" id="L695">            return false;</span>
        }

<span class="nc bnc" id="L698" title="All 4 branches missed.">        if (c != null &amp;&amp; c instanceof JComponent &amp;&amp;</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">            ((JComponent)c).processKeyBinding(ks, e, condition, pressed)) {</span>

<span class="nc" id="L701">            return true;</span>
        }

<span class="nc" id="L704">        MenuElement[] subElements = elem.getSubElements();</span>
<span class="nc bnc" id="L705" title="All 2 branches missed.">        for (MenuElement subElement : subElements) {</span>
<span class="nc bnc" id="L706" title="All 2 branches missed.">            if (processBindingForKeyStrokeRecursive(subElement, ks, e, condition, pressed)) {</span>
<span class="nc" id="L707">                return true;</span>
                // We don't, pass along to children JMenu's
            }
        }
<span class="nc" id="L711">        return false;</span>
    }

    /**
     * Overrides &lt;code&gt;JComponent.addNotify&lt;/code&gt; to register this
     * menu bar with the current keyboard manager.
     */
    public void addNotify() {
<span class="nc" id="L719">        super.addNotify();</span>
<span class="nc" id="L720">        KeyboardManager.getCurrentManager().registerMenuBar(this);</span>
<span class="nc" id="L721">    }</span>

    /**
     * Overrides &lt;code&gt;JComponent.removeNotify&lt;/code&gt; to unregister this
     * menu bar with the current keyboard manager.
     */
    public void removeNotify() {
<span class="nc" id="L728">        super.removeNotify();</span>
<span class="nc" id="L729">        KeyboardManager.getCurrentManager().unregisterMenuBar(this);</span>
<span class="nc" id="L730">    }</span>


    private void writeObject(ObjectOutputStream s) throws IOException {
<span class="nc" id="L734">        s.defaultWriteObject();</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">        if (getUIClassID().equals(uiClassID)) {</span>
<span class="nc" id="L736">            byte count = JComponent.getWriteObjCounter(this);</span>
<span class="nc" id="L737">            JComponent.setWriteObjCounter(this, --count);</span>
<span class="nc bnc" id="L738" title="All 4 branches missed.">            if (count == 0 &amp;&amp; ui != null) {</span>
<span class="nc" id="L739">                ui.installUI(this);</span>
            }
        }

<span class="nc" id="L743">        Object[] kvData = new Object[4];</span>
<span class="nc" id="L744">        int n = 0;</span>

<span class="nc bnc" id="L746" title="All 2 branches missed.">        if (selectionModel instanceof Serializable) {</span>
<span class="nc" id="L747">            kvData[n++] = &quot;selectionModel&quot;;</span>
<span class="nc" id="L748">            kvData[n++] = selectionModel;</span>
        }

<span class="nc" id="L751">        s.writeObject(kvData);</span>
<span class="nc" id="L752">    }</span>


    /**
     * See JComponent.readObject() for information about serialization
     * in Swing.
     */
    private void readObject(ObjectInputStream s) throws IOException, ClassNotFoundException
    {
<span class="nc" id="L761">        s.defaultReadObject();</span>
<span class="nc" id="L762">        Object[] kvData = (Object[])(s.readObject());</span>

<span class="nc bnc" id="L764" title="All 2 branches missed.">        for(int i = 0; i &lt; kvData.length; i += 2) {</span>
<span class="nc bnc" id="L765" title="All 2 branches missed.">            if (kvData[i] == null) {</span>
<span class="nc" id="L766">                break;</span>
            }
<span class="nc bnc" id="L768" title="All 2 branches missed.">            else if (kvData[i].equals(&quot;selectionModel&quot;)) {</span>
<span class="nc" id="L769">                selectionModel = (SingleSelectionModel)kvData[i + 1];</span>
            }
        }

<span class="nc" id="L773">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>