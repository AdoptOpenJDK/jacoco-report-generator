<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>ProgressMonitor.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing</a> &gt; <span class="el_source">ProgressMonitor.java</span></div><h1>ProgressMonitor.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2006, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */



package javax.swing;



import java.io.*;
import java.awt.BorderLayout;
import java.awt.Frame;
import java.awt.Dialog;
import java.awt.Window;
import java.awt.Component;
import java.awt.Container;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.awt.event.WindowListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import java.awt.IllegalComponentStateException;
import java.awt.Point;
import java.awt.Rectangle;
import java.text.*;
import java.util.Locale;
import javax.accessibility.*;
import javax.swing.event.*;
import javax.swing.text.*;


/** A class to monitor the progress of some operation. If it looks
 * like the operation will take a while, a progress dialog will be popped up.
 * When the ProgressMonitor is created it is given a numeric range and a
 * descriptive string. As the operation progresses, call the setProgress method
 * to indicate how far along the [min,max] range the operation is.
 * Initially, there is no ProgressDialog. After the first millisToDecideToPopup
 * milliseconds (default 500) the progress monitor will predict how long
 * the operation will take.  If it is longer than millisToPopup (default 2000,
 * 2 seconds) a ProgressDialog will be popped up.
 * &lt;p&gt;
 * From time to time, when the Dialog box is visible, the progress bar will
 * be updated when setProgress is called.  setProgress won't always update
 * the progress bar, it will only be done if the amount of progress is
 * visibly significant.
 *
 * &lt;p&gt;
 *
 * For further documentation and examples see
 * &lt;a
 href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html&quot;&gt;How to Monitor Progress&lt;/a&gt;,
 * a section in &lt;em&gt;The Java Tutorial.&lt;/em&gt;
 *
 * @see ProgressMonitorInputStream
 * @author James Gosling
 * @author Lynn Monsanto (accessibility)
 */
public class ProgressMonitor implements Accessible
{
    private ProgressMonitor root;
    private JDialog         dialog;
    private JOptionPane     pane;
    private JProgressBar    myBar;
    private JLabel          noteLabel;
    private Component       parentComponent;
    private String          note;
<span class="nc" id="L90">    private Object[]        cancelOption = null;</span>
    private Object          message;
    private long            T0;
<span class="nc" id="L93">    private int             millisToDecideToPopup = 500;</span>
<span class="nc" id="L94">    private int             millisToPopup = 2000;</span>
    private int             min;
    private int             max;


    /**
     * Constructs a graphic object that shows progress, typically by filling
     * in a rectangular bar as the process nears completion.
     *
     * @param parentComponent the parent component for the dialog box
     * @param message a descriptive message that will be shown
     *        to the user to indicate what operation is being monitored.
     *        This does not change as the operation progresses.
     *        See the message parameters to methods in
     *        {@link JOptionPane#message}
     *        for the range of values.
     * @param note a short note describing the state of the
     *        operation.  As the operation progresses, you can call
     *        setNote to change the note displayed.  This is used,
     *        for example, in operations that iterate through a
     *        list of files to show the name of the file being processes.
     *        If note is initially null, there will be no note line
     *        in the dialog box and setNote will be ineffective
     * @param min the lower bound of the range
     * @param max the upper bound of the range
     * @see JDialog
     * @see JOptionPane
     */
    public ProgressMonitor(Component parentComponent,
                           Object message,
                           String note,
                           int min,
                           int max) {
<span class="nc" id="L127">        this(parentComponent, message, note, min, max, null);</span>
<span class="nc" id="L128">    }</span>


    private ProgressMonitor(Component parentComponent,
                            Object message,
                            String note,
                            int min,
                            int max,
<span class="nc" id="L136">                            ProgressMonitor group) {</span>
<span class="nc" id="L137">        this.min = min;</span>
<span class="nc" id="L138">        this.max = max;</span>
<span class="nc" id="L139">        this.parentComponent = parentComponent;</span>

<span class="nc" id="L141">        cancelOption = new Object[1];</span>
<span class="nc" id="L142">        cancelOption[0] = UIManager.getString(&quot;OptionPane.cancelButtonText&quot;);</span>

<span class="nc" id="L144">        this.message = message;</span>
<span class="nc" id="L145">        this.note = note;</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">        if (group != null) {</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">            root = (group.root != null) ? group.root : group;</span>
<span class="nc" id="L148">            T0 = root.T0;</span>
<span class="nc" id="L149">            dialog = root.dialog;</span>
        }
        else {
<span class="nc" id="L152">            T0 = System.currentTimeMillis();</span>
        }
<span class="nc" id="L154">    }</span>


    private class ProgressOptionPane extends JOptionPane
    {
<span class="nc" id="L159">        ProgressOptionPane(Object messageList) {</span>
<span class="nc" id="L160">            super(messageList,</span>
                  JOptionPane.INFORMATION_MESSAGE,
                  JOptionPane.DEFAULT_OPTION,
                  null,
<span class="nc" id="L164">                  ProgressMonitor.this.cancelOption,</span>
                  null);
<span class="nc" id="L166">        }</span>


        public int getMaxCharactersPerLineCount() {
<span class="nc" id="L170">            return 60;</span>
        }


        // Equivalent to JOptionPane.createDialog,
        // but create a modeless dialog.
        // This is necessary because the Solaris implementation doesn't
        // support Dialog.setModal yet.
        public JDialog createDialog(Component parentComponent, String title) {
            final JDialog dialog;

<span class="nc" id="L181">            Window window = JOptionPane.getWindowForComponent(parentComponent);</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">            if (window instanceof Frame) {</span>
<span class="nc" id="L183">                dialog = new JDialog((Frame)window, title, false);</span>
            } else {
<span class="nc" id="L185">                dialog = new JDialog((Dialog)window, title, false);</span>
            }
<span class="nc bnc" id="L187" title="All 2 branches missed.">            if (window instanceof SwingUtilities.SharedOwnerFrame) {</span>
                WindowListener ownerShutdownListener =
<span class="nc" id="L189">                        SwingUtilities.getSharedOwnerFrameShutdownListener();</span>
<span class="nc" id="L190">                dialog.addWindowListener(ownerShutdownListener);</span>
            }
<span class="nc" id="L192">            Container contentPane = dialog.getContentPane();</span>

<span class="nc" id="L194">            contentPane.setLayout(new BorderLayout());</span>
<span class="nc" id="L195">            contentPane.add(this, BorderLayout.CENTER);</span>
<span class="nc" id="L196">            dialog.pack();</span>
<span class="nc" id="L197">            dialog.setLocationRelativeTo(parentComponent);</span>
<span class="nc" id="L198">            dialog.addWindowListener(new WindowAdapter() {</span>
<span class="nc" id="L199">                boolean gotFocus = false;</span>

                public void windowClosing(WindowEvent we) {
<span class="nc" id="L202">                    setValue(cancelOption[0]);</span>
<span class="nc" id="L203">                }</span>

                public void windowActivated(WindowEvent we) {
                    // Once window gets focus, set initial focus
<span class="nc bnc" id="L207" title="All 2 branches missed.">                    if (!gotFocus) {</span>
<span class="nc" id="L208">                        selectInitialValue();</span>
<span class="nc" id="L209">                        gotFocus = true;</span>
                    }
<span class="nc" id="L211">                }</span>
            });

<span class="nc" id="L214">            addPropertyChangeListener(new PropertyChangeListener() {</span>
                public void propertyChange(PropertyChangeEvent event) {
<span class="nc bnc" id="L216" title="All 2 branches missed.">                    if(dialog.isVisible() &amp;&amp;</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">                       event.getSource() == ProgressOptionPane.this &amp;&amp;</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">                       (event.getPropertyName().equals(VALUE_PROPERTY) ||</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">                        event.getPropertyName().equals(INPUT_VALUE_PROPERTY))){</span>
<span class="nc" id="L220">                        dialog.setVisible(false);</span>
<span class="nc" id="L221">                        dialog.dispose();</span>
                    }
<span class="nc" id="L223">                }</span>
            });

<span class="nc" id="L226">            return dialog;</span>
        }

        /////////////////
        // Accessibility support for ProgressOptionPane
        ////////////////

        /**
         * Gets the AccessibleContext for the ProgressOptionPane
         *
         * @return the AccessibleContext for the ProgressOptionPane
         * @since 1.5
         */
        public AccessibleContext getAccessibleContext() {
<span class="nc" id="L240">            return ProgressMonitor.this.getAccessibleContext();</span>
        }

        /*
         * Returns the AccessibleJOptionPane
         */
        private AccessibleContext getAccessibleJOptionPane() {
<span class="nc" id="L247">            return super.getAccessibleContext();</span>
        }
    }


    /**
     * Indicate the progress of the operation being monitored.
     * If the specified value is &amp;gt;= the maximum, the progress
     * monitor is closed.
     * @param nv an int specifying the current value, between the
     *        maximum and minimum specified for this component
     * @see #setMinimum
     * @see #setMaximum
     * @see #close
     */
    public void setProgress(int nv) {
<span class="nc bnc" id="L263" title="All 2 branches missed.">        if (nv &gt;= max) {</span>
<span class="nc" id="L264">            close();</span>
        }
        else {
<span class="nc bnc" id="L267" title="All 2 branches missed.">            if (myBar != null) {</span>
<span class="nc" id="L268">                myBar.setValue(nv);</span>
            }
            else {
<span class="nc" id="L271">                long T = System.currentTimeMillis();</span>
<span class="nc" id="L272">                long dT = (int)(T-T0);</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">                if (dT &gt;= millisToDecideToPopup) {</span>
                    int predictedCompletionTime;
<span class="nc bnc" id="L275" title="All 2 branches missed.">                    if (nv &gt; min) {</span>
<span class="nc" id="L276">                        predictedCompletionTime = (int)(dT *</span>
                                                        (max - min) /
                                                        (nv - min));
                    }
                    else {
<span class="nc" id="L281">                        predictedCompletionTime = millisToPopup;</span>
                    }
<span class="nc bnc" id="L283" title="All 2 branches missed.">                    if (predictedCompletionTime &gt;= millisToPopup) {</span>
<span class="nc" id="L284">                        myBar = new JProgressBar();</span>
<span class="nc" id="L285">                        myBar.setMinimum(min);</span>
<span class="nc" id="L286">                        myBar.setMaximum(max);</span>
<span class="nc" id="L287">                        myBar.setValue(nv);</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">                        if (note != null) noteLabel = new JLabel(note);</span>
<span class="nc" id="L289">                        pane = new ProgressOptionPane(new Object[] {message,</span>
                                                                    noteLabel,
                                                                    myBar});
<span class="nc" id="L292">                        dialog = pane.createDialog(parentComponent,</span>
<span class="nc" id="L293">                            UIManager.getString(</span>
                                &quot;ProgressMonitor.progressText&quot;));
<span class="nc" id="L295">                        dialog.show();</span>
                    }
                }
            }
        }
<span class="nc" id="L300">    }</span>


    /**
     * Indicate that the operation is complete.  This happens automatically
     * when the value set by setProgress is &amp;gt;= max, but it may be called
     * earlier if the operation ends early.
     */
    public void close() {
<span class="nc bnc" id="L309" title="All 2 branches missed.">        if (dialog != null) {</span>
<span class="nc" id="L310">            dialog.setVisible(false);</span>
<span class="nc" id="L311">            dialog.dispose();</span>
<span class="nc" id="L312">            dialog = null;</span>
<span class="nc" id="L313">            pane = null;</span>
<span class="nc" id="L314">            myBar = null;</span>
        }
<span class="nc" id="L316">    }</span>


    /**
     * Returns the minimum value -- the lower end of the progress value.
     *
     * @return an int representing the minimum value
     * @see #setMinimum
     */
    public int getMinimum() {
<span class="nc" id="L326">        return min;</span>
    }


    /**
     * Specifies the minimum value.
     *
     * @param m  an int specifying the minimum value
     * @see #getMinimum
     */
    public void setMinimum(int m) {
<span class="nc bnc" id="L337" title="All 2 branches missed.">        if (myBar != null) {</span>
<span class="nc" id="L338">            myBar.setMinimum(m);</span>
        }
<span class="nc" id="L340">        min = m;</span>
<span class="nc" id="L341">    }</span>


    /**
     * Returns the maximum value -- the higher end of the progress value.
     *
     * @return an int representing the maximum value
     * @see #setMaximum
     */
    public int getMaximum() {
<span class="nc" id="L351">        return max;</span>
    }


    /**
     * Specifies the maximum value.
     *
     * @param m  an int specifying the maximum value
     * @see #getMaximum
     */
    public void setMaximum(int m) {
<span class="nc bnc" id="L362" title="All 2 branches missed.">        if (myBar != null) {</span>
<span class="nc" id="L363">            myBar.setMaximum(m);</span>
        }
<span class="nc" id="L365">        max = m;</span>
<span class="nc" id="L366">    }</span>


    /**
     * Returns true if the user hits the Cancel button in the progress dialog.
     */
    public boolean isCanceled() {
<span class="nc bnc" id="L373" title="All 2 branches missed.">        if (pane == null) return false;</span>
<span class="nc" id="L374">        Object v = pane.getValue();</span>
<span class="nc bnc" id="L375" title="All 4 branches missed.">        return ((v != null) &amp;&amp;</span>
                (cancelOption.length == 1) &amp;&amp;
<span class="nc bnc" id="L377" title="All 2 branches missed.">                (v.equals(cancelOption[0])));</span>
    }


    /**
     * Specifies the amount of time to wait before deciding whether or
     * not to popup a progress monitor.
     *
     * @param millisToDecideToPopup  an int specifying the time to wait,
     *        in milliseconds
     * @see #getMillisToDecideToPopup
     */
    public void setMillisToDecideToPopup(int millisToDecideToPopup) {
<span class="nc" id="L390">        this.millisToDecideToPopup = millisToDecideToPopup;</span>
<span class="nc" id="L391">    }</span>


    /**
     * Returns the amount of time this object waits before deciding whether
     * or not to popup a progress monitor.
     *
     * @see #setMillisToDecideToPopup
     */
    public int getMillisToDecideToPopup() {
<span class="nc" id="L401">        return millisToDecideToPopup;</span>
    }


    /**
     * Specifies the amount of time it will take for the popup to appear.
     * (If the predicted time remaining is less than this time, the popup
     * won't be displayed.)
     *
     * @param millisToPopup  an int specifying the time in milliseconds
     * @see #getMillisToPopup
     */
    public void setMillisToPopup(int millisToPopup) {
<span class="nc" id="L414">        this.millisToPopup = millisToPopup;</span>
<span class="nc" id="L415">    }</span>


    /**
     * Returns the amount of time it will take for the popup to appear.
     *
     * @see #setMillisToPopup
     */
    public int getMillisToPopup() {
<span class="nc" id="L424">        return millisToPopup;</span>
    }


    /**
     * Specifies the additional note that is displayed along with the
     * progress message. Used, for example, to show which file the
     * is currently being copied during a multiple-file copy.
     *
     * @param note  a String specifying the note to display
     * @see #getNote
     */
    public void setNote(String note) {
<span class="nc" id="L437">        this.note = note;</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">        if (noteLabel != null) {</span>
<span class="nc" id="L439">            noteLabel.setText(note);</span>
        }
<span class="nc" id="L441">    }</span>


    /**
     * Specifies the additional note that is displayed along with the
     * progress message.
     *
     * @return a String specifying the note to display
     * @see #setNote
     */
    public String getNote() {
<span class="nc" id="L452">        return note;</span>
    }

    /////////////////
    // Accessibility support
    ////////////////

    /**
     * The &lt;code&gt;AccessibleContext&lt;/code&gt; for the &lt;code&gt;ProgressMonitor&lt;/code&gt;
     * @since 1.5
     */
<span class="nc" id="L463">    protected AccessibleContext accessibleContext = null;</span>

<span class="nc" id="L465">    private AccessibleContext accessibleJOptionPane = null;</span>

    /**
     * Gets the &lt;code&gt;AccessibleContext&lt;/code&gt; for the
     * &lt;code&gt;ProgressMonitor&lt;/code&gt;
     *
     * @return the &lt;code&gt;AccessibleContext&lt;/code&gt; for the
     * &lt;code&gt;ProgressMonitor&lt;/code&gt;
     * @since 1.5
     */
    public AccessibleContext getAccessibleContext() {
<span class="nc bnc" id="L476" title="All 2 branches missed.">        if (accessibleContext == null) {</span>
<span class="nc" id="L477">            accessibleContext = new AccessibleProgressMonitor();</span>
        }
<span class="nc bnc" id="L479" title="All 4 branches missed.">        if (pane != null &amp;&amp; accessibleJOptionPane == null) {</span>
            // Notify the AccessibleProgressMonitor that the
            // ProgressOptionPane was created. It is necessary
            // to poll for ProgressOptionPane creation because
            // the ProgressMonitor does not have a Component
            // to add a listener to until the ProgressOptionPane
            // is created.
<span class="nc bnc" id="L486" title="All 2 branches missed.">            if (accessibleContext instanceof AccessibleProgressMonitor) {</span>
<span class="nc" id="L487">                ((AccessibleProgressMonitor)accessibleContext).optionPaneCreated();</span>
            }
        }
<span class="nc" id="L490">        return accessibleContext;</span>
    }

    /**
     * &lt;code&gt;AccessibleProgressMonitor&lt;/code&gt; implements accessibility
     * support for the &lt;code&gt;ProgressMonitor&lt;/code&gt; class.
     * @since 1.5
     */
    protected class AccessibleProgressMonitor extends AccessibleContext
        implements AccessibleText, ChangeListener, PropertyChangeListener {

        /*
         * The accessibility hierarchy for ProgressMonitor is a flattened
         * version of the ProgressOptionPane component hierarchy.
         *
         * The ProgressOptionPane component hierarchy is:
         *   JDialog
         *     ProgressOptionPane
         *       JPanel
         *         JPanel
         *           JLabel
         *           JLabel
         *           JProgressBar
         *
         * The AccessibleProgessMonitor accessibility hierarchy is:
         *   AccessibleJDialog
         *     AccessibleProgressMonitor
         *       AccessibleJLabel
         *       AccessibleJLabel
         *       AccessibleJProgressBar
         *
         * The abstraction presented to assitive technologies by
         * the AccessibleProgressMonitor is that a dialog contains a
         * progress monitor with three children: a message, a note
         * label and a progress bar.
         */

        private Object oldModelValue;

        /**
         * AccessibleProgressMonitor constructor
         */
<span class="nc" id="L532">        protected AccessibleProgressMonitor() {</span>
<span class="nc" id="L533">        }</span>

        /*
         * Initializes the AccessibleContext now that the ProgressOptionPane
         * has been created. Because the ProgressMonitor is not a Component
         * implementing the Accessible interface, an AccessibleContext
         * must be synthesized from the ProgressOptionPane and its children.
         *
         * For other AWT and Swing classes, the inner class that implements
         * accessibility for the class extends the inner class that implements
         * implements accessibility for the super class. AccessibleProgressMonitor
         * cannot extend AccessibleJOptionPane and must therefore delegate calls
         * to the AccessibleJOptionPane.
         */
        private void optionPaneCreated() {
<span class="nc" id="L548">            accessibleJOptionPane =</span>
<span class="nc" id="L549">                ((ProgressOptionPane)pane).getAccessibleJOptionPane();</span>

            // add a listener for progress bar ChangeEvents
<span class="nc bnc" id="L552" title="All 2 branches missed.">            if (myBar != null) {</span>
<span class="nc" id="L553">                myBar.addChangeListener(this);</span>
            }

            // add a listener for note label PropertyChangeEvents
<span class="nc bnc" id="L557" title="All 2 branches missed.">            if (noteLabel != null) {</span>
<span class="nc" id="L558">                noteLabel.addPropertyChangeListener(this);</span>
            }
<span class="nc" id="L560">        }</span>

        /**
         * Invoked when the target of the listener has changed its state.
         *
         * @param e  a &lt;code&gt;ChangeEvent&lt;/code&gt; object. Must not be null.
         * @throws NullPointerException if the parameter is null.
         */
        public void stateChanged(ChangeEvent e) {
<span class="nc bnc" id="L569" title="All 2 branches missed.">            if (e == null) {</span>
<span class="nc" id="L570">                return;</span>
            }
<span class="nc bnc" id="L572" title="All 2 branches missed.">            if (myBar != null) {</span>
                // the progress bar value changed
<span class="nc" id="L574">                Object newModelValue = myBar.getValue();</span>
<span class="nc" id="L575">                firePropertyChange(ACCESSIBLE_VALUE_PROPERTY,</span>
                                   oldModelValue,
                                   newModelValue);
<span class="nc" id="L578">                oldModelValue = newModelValue;</span>
            }
<span class="nc" id="L580">        }</span>

        /**
         * This method gets called when a bound property is changed.
         *
         * @param e A &lt;code&gt;PropertyChangeEvent&lt;/code&gt; object describing
         * the event source and the property that has changed. Must not be null.
         * @throws NullPointerException if the parameter is null.
         */
        public void propertyChange(PropertyChangeEvent e) {
<span class="nc bnc" id="L590" title="All 4 branches missed.">            if (e.getSource() == noteLabel &amp;&amp; e.getPropertyName() == &quot;text&quot;) {</span>
                // the note label text changed
<span class="nc" id="L592">                firePropertyChange(ACCESSIBLE_TEXT_PROPERTY, null, 0);</span>
            }
<span class="nc" id="L594">        }</span>

        /* ===== Begin AccessileContext ===== */

        /**
         * Gets the accessibleName property of this object.  The accessibleName
         * property of an object is a localized String that designates the purpose
         * of the object.  For example, the accessibleName property of a label
         * or button might be the text of the label or button itself.  In the
         * case of an object that doesn't display its name, the accessibleName
         * should still be set.  For example, in the case of a text field used
         * to enter the name of a city, the accessibleName for the en_US locale
         * could be 'city.'
         *
         * @return the localized name of the object; null if this
         * object does not have a name
         *
         * @see #setAccessibleName
         */
        public String getAccessibleName() {
<span class="nc bnc" id="L614" title="All 2 branches missed.">            if (accessibleName != null) { // defined in AccessibleContext</span>
<span class="nc" id="L615">                return accessibleName;</span>
<span class="nc bnc" id="L616" title="All 2 branches missed.">            } else if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L618">                return accessibleJOptionPane.getAccessibleName();</span>
            }
<span class="nc" id="L620">            return null;</span>
        }

        /**
         * Gets the accessibleDescription property of this object.  The
         * accessibleDescription property of this object is a short localized
         * phrase describing the purpose of the object.  For example, in the
         * case of a 'Cancel' button, the accessibleDescription could be
         * 'Ignore changes and close dialog box.'
         *
         * @return the localized description of the object; null if
         * this object does not have a description
         *
         * @see #setAccessibleDescription
         */
        public String getAccessibleDescription() {
<span class="nc bnc" id="L636" title="All 2 branches missed.">            if (accessibleDescription != null) { // defined in AccessibleContext</span>
<span class="nc" id="L637">                return accessibleDescription;</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">            } else if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L640">                return accessibleJOptionPane.getAccessibleDescription();</span>
            }
<span class="nc" id="L642">            return null;</span>
        }

        /**
         * Gets the role of this object.  The role of the object is the generic
         * purpose or use of the class of this object.  For example, the role
         * of a push button is AccessibleRole.PUSH_BUTTON.  The roles in
         * AccessibleRole are provided so component developers can pick from
         * a set of predefined roles.  This enables assistive technologies to
         * provide a consistent interface to various tweaked subclasses of
         * components (e.g., use AccessibleRole.PUSH_BUTTON for all components
         * that act like a push button) as well as distinguish between subclasses
         * that behave differently (e.g., AccessibleRole.CHECK_BOX for check boxes
         * and AccessibleRole.RADIO_BUTTON for radio buttons).
         * &lt;p&gt;Note that the AccessibleRole class is also extensible, so
         * custom component developers can define their own AccessibleRole's
         * if the set of predefined roles is inadequate.
         *
         * @return an instance of AccessibleRole describing the role of the object
         * @see AccessibleRole
         */
        public AccessibleRole getAccessibleRole() {
<span class="nc" id="L664">            return AccessibleRole.PROGRESS_MONITOR;</span>
        }

        /**
         * Gets the state set of this object.  The AccessibleStateSet of an object
         * is composed of a set of unique AccessibleStates.  A change in the
         * AccessibleStateSet of an object will cause a PropertyChangeEvent to
         * be fired for the ACCESSIBLE_STATE_PROPERTY property.
         *
         * @return an instance of AccessibleStateSet containing the
         * current state set of the object
         * @see AccessibleStateSet
         * @see AccessibleState
         * @see #addPropertyChangeListener
         */
        public AccessibleStateSet getAccessibleStateSet() {
<span class="nc bnc" id="L680" title="All 2 branches missed.">            if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L682">                return accessibleJOptionPane.getAccessibleStateSet();</span>
            }
<span class="nc" id="L684">            return null;</span>
        }

        /**
         * Gets the Accessible parent of this object.
         *
         * @return the Accessible parent of this object; null if this
         * object does not have an Accessible parent
         */
        public Accessible getAccessibleParent() {
<span class="nc" id="L694">            return dialog;</span>
        }

        /*
         * Returns the parent AccessibleContext
         */
        private AccessibleContext getParentAccessibleContext() {
<span class="nc bnc" id="L701" title="All 2 branches missed.">            if (dialog != null) {</span>
<span class="nc" id="L702">                return dialog.getAccessibleContext();</span>
            }
<span class="nc" id="L704">            return null;</span>
        }

        /**
         * Gets the 0-based index of this object in its accessible parent.
         *
         * @return the 0-based index of this object in its parent; -1 if this
         * object does not have an accessible parent.
         *
         * @see #getAccessibleParent
         * @see #getAccessibleChildrenCount
         * @see #getAccessibleChild
         */
        public int getAccessibleIndexInParent() {
<span class="nc bnc" id="L718" title="All 2 branches missed.">            if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L720">                return accessibleJOptionPane.getAccessibleIndexInParent();</span>
            }
<span class="nc" id="L722">            return -1;</span>
        }

        /**
         * Returns the number of accessible children of the object.
         *
         * @return the number of accessible children of the object.
         */
        public int getAccessibleChildrenCount() {
            // return the number of children in the JPanel containing
            // the message, note label and progress bar
<span class="nc" id="L733">            AccessibleContext ac = getPanelAccessibleContext();</span>
<span class="nc bnc" id="L734" title="All 2 branches missed.">            if (ac != null) {</span>
<span class="nc" id="L735">                return ac.getAccessibleChildrenCount();</span>
            }
<span class="nc" id="L737">            return 0;</span>
        }

        /**
         * Returns the specified Accessible child of the object.  The Accessible
         * children of an Accessible object are zero-based, so the first child
         * of an Accessible child is at index 0, the second child is at index 1,
         * and so on.
         *
         * @param i zero-based index of child
         * @return the Accessible child of the object
         * @see #getAccessibleChildrenCount
         */
        public Accessible getAccessibleChild(int i) {
            // return a child in the JPanel containing the message, note label
            // and progress bar
<span class="nc" id="L753">            AccessibleContext ac = getPanelAccessibleContext();</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">            if (ac != null) {</span>
<span class="nc" id="L755">                return ac.getAccessibleChild(i);</span>
            }
<span class="nc" id="L757">            return null;</span>
        }

        /*
         * Returns the AccessibleContext for the JPanel containing the
         * message, note label and progress bar
         */
        private AccessibleContext getPanelAccessibleContext() {
<span class="nc bnc" id="L765" title="All 2 branches missed.">            if (myBar != null) {</span>
<span class="nc" id="L766">                Component c = myBar.getParent();</span>
<span class="nc bnc" id="L767" title="All 2 branches missed.">                if (c instanceof Accessible) {</span>
<span class="nc" id="L768">                    return c.getAccessibleContext();</span>
                }
            }
<span class="nc" id="L771">            return null;</span>
        }

        /**
         * Gets the locale of the component. If the component does not have a
         * locale, then the locale of its parent is returned.
         *
         * @return this component's locale.  If this component does not have
         * a locale, the locale of its parent is returned.
         *
         * @exception IllegalComponentStateException
         * If the Component does not have its own locale and has not yet been
         * added to a containment hierarchy such that the locale can be
         * determined from the containing parent.
         */
        public Locale getLocale() throws IllegalComponentStateException {
<span class="nc bnc" id="L787" title="All 2 branches missed.">            if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L789">                return accessibleJOptionPane.getLocale();</span>
            }
<span class="nc" id="L791">            return null;</span>
        }

        /* ===== end AccessibleContext ===== */

        /**
         * Gets the AccessibleComponent associated with this object that has a
         * graphical representation.
         *
         * @return AccessibleComponent if supported by object; else return null
         * @see AccessibleComponent
         */
        public AccessibleComponent getAccessibleComponent() {
<span class="nc bnc" id="L804" title="All 2 branches missed.">            if (accessibleJOptionPane != null) {</span>
                // delegate to the AccessibleJOptionPane
<span class="nc" id="L806">                return accessibleJOptionPane.getAccessibleComponent();</span>
            }
<span class="nc" id="L808">            return null;</span>
        }

        /**
         * Gets the AccessibleValue associated with this object that supports a
         * Numerical value.
         *
         * @return AccessibleValue if supported by object; else return null
         * @see AccessibleValue
         */
        public AccessibleValue getAccessibleValue() {
<span class="nc bnc" id="L819" title="All 2 branches missed.">            if (myBar != null) {</span>
                // delegate to the AccessibleJProgressBar
<span class="nc" id="L821">                return myBar.getAccessibleContext().getAccessibleValue();</span>
            }
<span class="nc" id="L823">            return null;</span>
        }

        /**
         * Gets the AccessibleText associated with this object presenting
         * text on the display.
         *
         * @return AccessibleText if supported by object; else return null
         * @see AccessibleText
         */
        public AccessibleText getAccessibleText() {
<span class="nc bnc" id="L834" title="All 2 branches missed.">            if (getNoteLabelAccessibleText() != null) {</span>
<span class="nc" id="L835">                return this;</span>
            }
<span class="nc" id="L837">            return null;</span>
        }

        /*
         * Returns the note label AccessibleText
         */
        private AccessibleText getNoteLabelAccessibleText() {
<span class="nc bnc" id="L844" title="All 2 branches missed.">            if (noteLabel != null) {</span>
                // AccessibleJLabel implements AccessibleText if the
                // JLabel contains HTML text
<span class="nc" id="L847">                return noteLabel.getAccessibleContext().getAccessibleText();</span>
            }
<span class="nc" id="L849">            return null;</span>
        }

        /* ===== Begin AccessibleText impl ===== */

        /**
         * Given a point in local coordinates, return the zero-based index
         * of the character under that Point.  If the point is invalid,
         * this method returns -1.
         *
         * @param p the Point in local coordinates
         * @return the zero-based index of the character under Point p; if
         * Point is invalid return -1.
         */
        public int getIndexAtPoint(Point p) {
<span class="nc" id="L864">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L865" title="All 4 branches missed.">            if (at != null &amp;&amp; sameWindowAncestor(pane, noteLabel)) {</span>
                // convert point from the option pane bounds
                // to the note label bounds.
<span class="nc" id="L868">                Point noteLabelPoint = SwingUtilities.convertPoint(pane,</span>
                                                                   p,
<span class="nc" id="L870">                                                                   noteLabel);</span>
<span class="nc bnc" id="L871" title="All 2 branches missed.">                if (noteLabelPoint != null) {</span>
<span class="nc" id="L872">                    return at.getIndexAtPoint(noteLabelPoint);</span>
                }
            }
<span class="nc" id="L875">            return -1;</span>
        }

        /**
         * Determines the bounding box of the character at the given
         * index into the string.  The bounds are returned in local
         * coordinates.  If the index is invalid an empty rectangle is returned.
         *
         * @param i the index into the String
         * @return the screen coordinates of the character's bounding box,
         * if index is invalid return an empty rectangle.
         */
        public Rectangle getCharacterBounds(int i) {
<span class="nc" id="L888">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L889" title="All 4 branches missed.">            if (at != null &amp;&amp; sameWindowAncestor(pane, noteLabel)) {</span>
                // return rectangle in the option pane bounds
<span class="nc" id="L891">                Rectangle noteLabelRect = at.getCharacterBounds(i);</span>
<span class="nc bnc" id="L892" title="All 2 branches missed.">                if (noteLabelRect != null) {</span>
<span class="nc" id="L893">                    return SwingUtilities.convertRectangle(noteLabel,</span>
                                                           noteLabelRect,
<span class="nc" id="L895">                                                           pane);</span>
                }
            }
<span class="nc" id="L898">            return null;</span>
        }

        /*
         * Returns whether source and destination components have the
         * same window ancestor
         */
        private boolean sameWindowAncestor(Component src, Component dest) {
<span class="nc bnc" id="L906" title="All 4 branches missed.">            if (src == null || dest == null) {</span>
<span class="nc" id="L907">                return false;</span>
            }
<span class="nc" id="L909">            return SwingUtilities.getWindowAncestor(src) ==</span>
<span class="nc bnc" id="L910" title="All 2 branches missed.">                SwingUtilities.getWindowAncestor(dest);</span>
        }

        /**
         * Returns the number of characters (valid indicies)
         *
         * @return the number of characters
         */
        public int getCharCount() {
<span class="nc" id="L919">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L921">                return at.getCharCount();</span>
            }
<span class="nc" id="L923">            return -1;</span>
        }

        /**
         * Returns the zero-based offset of the caret.
         *
         * Note: That to the right of the caret will have the same index
         * value as the offset (the caret is between two characters).
         * @return the zero-based offset of the caret.
         */
        public int getCaretPosition() {
<span class="nc" id="L934">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L935" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L936">                return at.getCaretPosition();</span>
            }
<span class="nc" id="L938">            return -1;</span>
        }

        /**
         * Returns the String at a given index.
         *
         * @param part the CHARACTER, WORD, or SENTENCE to retrieve
         * @param index an index within the text
         * @return the letter, word, or sentence
         */
        public String getAtIndex(int part, int index) {
<span class="nc" id="L949">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L950" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L951">                return at.getAtIndex(part, index);</span>
            }
<span class="nc" id="L953">            return null;</span>
        }

        /**
         * Returns the String after a given index.
         *
         * @param part the CHARACTER, WORD, or SENTENCE to retrieve
         * @param index an index within the text
         * @return the letter, word, or sentence
         */
        public String getAfterIndex(int part, int index) {
<span class="nc" id="L964">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L965" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L966">                return at.getAfterIndex(part, index);</span>
            }
<span class="nc" id="L968">            return null;</span>
        }

        /**
         * Returns the String before a given index.
         *
         * @param part the CHARACTER, WORD, or SENTENCE to retrieve
         * @param index an index within the text
         * @return the letter, word, or sentence
         */
        public String getBeforeIndex(int part, int index) {
<span class="nc" id="L979">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L980" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L981">                return at.getBeforeIndex(part, index);</span>
            }
<span class="nc" id="L983">            return null;</span>
        }

        /**
         * Returns the AttributeSet for a given character at a given index
         *
         * @param i the zero-based index into the text
         * @return the AttributeSet of the character
         */
        public AttributeSet getCharacterAttribute(int i) {
<span class="nc" id="L993">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L994" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L995">                return at.getCharacterAttribute(i);</span>
            }
<span class="nc" id="L997">            return null;</span>
        }

        /**
         * Returns the start offset within the selected text.
         * If there is no selection, but there is
         * a caret, the start and end offsets will be the same.
         *
         * @return the index into the text of the start of the selection
         */
        public int getSelectionStart() {
<span class="nc" id="L1008">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L1010">                return at.getSelectionStart();</span>
            }
<span class="nc" id="L1012">            return -1;</span>
        }

        /**
         * Returns the end offset within the selected text.
         * If there is no selection, but there is
         * a caret, the start and end offsets will be the same.
         *
         * @return the index into the text of the end of the selection
         */
        public int getSelectionEnd() {
<span class="nc" id="L1023">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L1024" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L1025">                return at.getSelectionEnd();</span>
            }
<span class="nc" id="L1027">            return -1;</span>
        }

        /**
         * Returns the portion of the text that is selected.
         *
         * @return the String portion of the text that is selected
         */
        public String getSelectedText() {
<span class="nc" id="L1036">            AccessibleText at = getNoteLabelAccessibleText();</span>
<span class="nc bnc" id="L1037" title="All 2 branches missed.">            if (at != null) {   // JLabel contains HTML text</span>
<span class="nc" id="L1038">                return at.getSelectedText();</span>
            }
<span class="nc" id="L1040">            return null;</span>
        }
        /* ===== End AccessibleText impl ===== */
    }
    // inner class AccessibleProgressMonitor

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>