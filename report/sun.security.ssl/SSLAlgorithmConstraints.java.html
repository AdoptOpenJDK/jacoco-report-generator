<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>SSLAlgorithmConstraints.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">sun.security.ssl</a> &gt; <span class="el_source">SSLAlgorithmConstraints.java</span></div><h1>SSLAlgorithmConstraints.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2010, 2011, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package sun.security.ssl;

import java.security.AlgorithmConstraints;
import java.security.CryptoPrimitive;
import java.security.AlgorithmParameters;

import javax.net.ssl.*;

import java.security.Key;

import java.util.Set;
import java.util.HashSet;

import sun.security.util.DisabledAlgorithmConstraints;
import sun.security.ssl.CipherSuite.*;

/**
 * Algorithm constraints for disabled algorithms property
 *
 * See the &quot;jdk.certpath.disabledAlgorithms&quot; specification in java.security
 * for the syntax of the disabled algorithm string.
 */
final class SSLAlgorithmConstraints implements AlgorithmConstraints {
<span class="nc" id="L49">    private final static AlgorithmConstraints tlsDisabledAlgConstraints =</span>
            new TLSDisabledAlgConstraints();
<span class="nc" id="L51">    private final static AlgorithmConstraints x509DisabledAlgConstraints =</span>
            new X509DisabledAlgConstraints();
<span class="nc" id="L53">    private AlgorithmConstraints userAlgConstraints = null;</span>
<span class="nc" id="L54">    private AlgorithmConstraints peerAlgConstraints = null;</span>

<span class="nc" id="L56">    private boolean enabledX509DisabledAlgConstraints = true;</span>

<span class="nc" id="L58">    SSLAlgorithmConstraints(AlgorithmConstraints algorithmConstraints) {</span>
<span class="nc" id="L59">        userAlgConstraints = algorithmConstraints;</span>
<span class="nc" id="L60">    }</span>

    SSLAlgorithmConstraints(SSLSocket socket,
<span class="nc" id="L63">            boolean withDefaultCertPathConstraints) {</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">        if (socket != null) {</span>
<span class="nc" id="L65">            userAlgConstraints =</span>
<span class="nc" id="L66">                socket.getSSLParameters().getAlgorithmConstraints();</span>
        }

<span class="nc bnc" id="L69" title="All 2 branches missed.">        if (!withDefaultCertPathConstraints) {</span>
<span class="nc" id="L70">            enabledX509DisabledAlgConstraints = false;</span>
        }
<span class="nc" id="L72">    }</span>

    SSLAlgorithmConstraints(SSLEngine engine,
<span class="nc" id="L75">            boolean withDefaultCertPathConstraints) {</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">        if (engine != null) {</span>
<span class="nc" id="L77">            userAlgConstraints =</span>
<span class="nc" id="L78">                engine.getSSLParameters().getAlgorithmConstraints();</span>
        }

<span class="nc bnc" id="L81" title="All 2 branches missed.">        if (!withDefaultCertPathConstraints) {</span>
<span class="nc" id="L82">            enabledX509DisabledAlgConstraints = false;</span>
        }
<span class="nc" id="L84">    }</span>

    SSLAlgorithmConstraints(SSLSocket socket, String[] supportedAlgorithms,
<span class="nc" id="L87">            boolean withDefaultCertPathConstraints) {</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (socket != null) {</span>
<span class="nc" id="L89">            userAlgConstraints =</span>
<span class="nc" id="L90">                socket.getSSLParameters().getAlgorithmConstraints();</span>
<span class="nc" id="L91">            peerAlgConstraints =</span>
                new SupportedSignatureAlgorithmConstraints(supportedAlgorithms);
        }

<span class="nc bnc" id="L95" title="All 2 branches missed.">        if (!withDefaultCertPathConstraints) {</span>
<span class="nc" id="L96">            enabledX509DisabledAlgConstraints = false;</span>
        }
<span class="nc" id="L98">    }</span>

    SSLAlgorithmConstraints(SSLEngine engine, String[] supportedAlgorithms,
<span class="nc" id="L101">            boolean withDefaultCertPathConstraints) {</span>
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (engine != null) {</span>
<span class="nc" id="L103">            userAlgConstraints =</span>
<span class="nc" id="L104">                engine.getSSLParameters().getAlgorithmConstraints();</span>
<span class="nc" id="L105">            peerAlgConstraints =</span>
                new SupportedSignatureAlgorithmConstraints(supportedAlgorithms);
        }

<span class="nc bnc" id="L109" title="All 2 branches missed.">        if (!withDefaultCertPathConstraints) {</span>
<span class="nc" id="L110">            enabledX509DisabledAlgConstraints = false;</span>
        }
<span class="nc" id="L112">    }</span>

    @Override
    public boolean permits(Set&lt;CryptoPrimitive&gt; primitives,
            String algorithm, AlgorithmParameters parameters) {

<span class="nc" id="L118">        boolean permitted = true;</span>

<span class="nc bnc" id="L120" title="All 2 branches missed.">        if (peerAlgConstraints != null) {</span>
<span class="nc" id="L121">            permitted = peerAlgConstraints.permits(</span>
                                    primitives, algorithm, parameters);
        }

<span class="nc bnc" id="L125" title="All 4 branches missed.">        if (permitted &amp;&amp; userAlgConstraints != null) {</span>
<span class="nc" id="L126">            permitted = userAlgConstraints.permits(</span>
                                    primitives, algorithm, parameters);
        }

<span class="nc bnc" id="L130" title="All 2 branches missed.">        if (permitted) {</span>
<span class="nc" id="L131">            permitted = tlsDisabledAlgConstraints.permits(</span>
                                    primitives, algorithm, parameters);
        }

<span class="nc bnc" id="L135" title="All 4 branches missed.">        if (permitted &amp;&amp; enabledX509DisabledAlgConstraints) {</span>
<span class="nc" id="L136">            permitted = x509DisabledAlgConstraints.permits(</span>
                                    primitives, algorithm, parameters);
        }

<span class="nc" id="L140">        return permitted;</span>
    }

    @Override
    public boolean permits(Set&lt;CryptoPrimitive&gt; primitives, Key key) {

<span class="nc" id="L146">        boolean permitted = true;</span>

<span class="nc bnc" id="L148" title="All 2 branches missed.">        if (peerAlgConstraints != null) {</span>
<span class="nc" id="L149">            permitted = peerAlgConstraints.permits(primitives, key);</span>
        }

<span class="nc bnc" id="L152" title="All 4 branches missed.">        if (permitted &amp;&amp; userAlgConstraints != null) {</span>
<span class="nc" id="L153">            permitted = userAlgConstraints.permits(primitives, key);</span>
        }

<span class="nc bnc" id="L156" title="All 2 branches missed.">        if (permitted) {</span>
<span class="nc" id="L157">            permitted = tlsDisabledAlgConstraints.permits(primitives, key);</span>
        }

<span class="nc bnc" id="L160" title="All 4 branches missed.">        if (permitted &amp;&amp; enabledX509DisabledAlgConstraints) {</span>
<span class="nc" id="L161">            permitted = x509DisabledAlgConstraints.permits(primitives, key);</span>
        }

<span class="nc" id="L164">        return permitted;</span>
    }

    @Override
    public boolean permits(Set&lt;CryptoPrimitive&gt; primitives,
            String algorithm, Key key, AlgorithmParameters parameters) {

<span class="nc" id="L171">        boolean permitted = true;</span>

<span class="nc bnc" id="L173" title="All 2 branches missed.">        if (peerAlgConstraints != null) {</span>
<span class="nc" id="L174">            permitted = peerAlgConstraints.permits(</span>
                                    primitives, algorithm, key, parameters);
        }

<span class="nc bnc" id="L178" title="All 4 branches missed.">        if (permitted &amp;&amp; userAlgConstraints != null) {</span>
<span class="nc" id="L179">            permitted = userAlgConstraints.permits(</span>
                                    primitives, algorithm, key, parameters);
        }

<span class="nc bnc" id="L183" title="All 2 branches missed.">        if (permitted) {</span>
<span class="nc" id="L184">            permitted = tlsDisabledAlgConstraints.permits(</span>
                                    primitives, algorithm, key, parameters);
        }

<span class="nc bnc" id="L188" title="All 4 branches missed.">        if (permitted &amp;&amp; enabledX509DisabledAlgConstraints) {</span>
<span class="nc" id="L189">            permitted = x509DisabledAlgConstraints.permits(</span>
                                    primitives, algorithm, key, parameters);
        }

<span class="nc" id="L193">        return permitted;</span>
    }


    static private class SupportedSignatureAlgorithmConstraints
                                    implements AlgorithmConstraints {
        // supported signature algorithms
        private String[] supportedAlgorithms;

<span class="nc" id="L202">        SupportedSignatureAlgorithmConstraints(String[] supportedAlgorithms) {</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">            if (supportedAlgorithms != null) {</span>
<span class="nc" id="L204">                this.supportedAlgorithms = supportedAlgorithms.clone();</span>
            } else {
<span class="nc" id="L206">                this.supportedAlgorithms = null;</span>
            }
<span class="nc" id="L208">        }</span>

        @Override
        public boolean permits(Set&lt;CryptoPrimitive&gt; primitives,
                String algorithm, AlgorithmParameters parameters) {

<span class="nc bnc" id="L214" title="All 4 branches missed.">            if (algorithm == null || algorithm.length() == 0) {</span>
<span class="nc" id="L215">                throw new IllegalArgumentException(</span>
                        &quot;No algorithm name specified&quot;);
            }

<span class="nc bnc" id="L219" title="All 4 branches missed.">            if (primitives == null || primitives.isEmpty()) {</span>
<span class="nc" id="L220">                throw new IllegalArgumentException(</span>
                        &quot;No cryptographic primitive specified&quot;);
            }

<span class="nc bnc" id="L224" title="All 4 branches missed.">            if (supportedAlgorithms == null ||</span>
                        supportedAlgorithms.length == 0) {
<span class="nc" id="L226">                return false;</span>
            }

            // trim the MGF part: &lt;digest&gt;with&lt;encryption&gt;and&lt;mgf&gt;
<span class="nc" id="L230">            int position = algorithm.indexOf(&quot;and&quot;);</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">            if (position &gt; 0) {</span>
<span class="nc" id="L232">                algorithm = algorithm.substring(0, position);</span>
            }

<span class="nc bnc" id="L235" title="All 2 branches missed.">            for (String supportedAlgorithm : supportedAlgorithms) {</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">                if (algorithm.equalsIgnoreCase(supportedAlgorithm)) {</span>
<span class="nc" id="L237">                    return true;</span>
                }
            }

<span class="nc" id="L241">            return false;</span>
        }

        @Override
        final public boolean permits(Set&lt;CryptoPrimitive&gt; primitives, Key key) {
<span class="nc" id="L246">            return true;</span>
        }

        @Override
        final public boolean permits(Set&lt;CryptoPrimitive&gt; primitives,
                String algorithm, Key key, AlgorithmParameters parameters) {

<span class="nc bnc" id="L253" title="All 4 branches missed.">            if (algorithm == null || algorithm.length() == 0) {</span>
<span class="nc" id="L254">                throw new IllegalArgumentException(</span>
                        &quot;No algorithm name specified&quot;);
            }

<span class="nc" id="L258">            return permits(primitives, algorithm, parameters);</span>
        }
    }

    static private class BasicDisabledAlgConstraints
            extends DisabledAlgorithmConstraints {
        BasicDisabledAlgConstraints(String propertyName) {
<span class="nc" id="L265">            super(propertyName);</span>
<span class="nc" id="L266">        }</span>

        protected Set&lt;String&gt; decomposes(KeyExchange keyExchange,
                        boolean forCertPathOnly) {
<span class="nc" id="L270">            Set&lt;String&gt; components = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L271" title="All 16 branches missed.">            switch (keyExchange) {</span>
                case K_NULL:
<span class="nc bnc" id="L273" title="All 2 branches missed.">                    if (!forCertPathOnly) {</span>
<span class="nc" id="L274">                        components.add(&quot;NULL&quot;);</span>
                    }
                    break;
                case K_RSA:
<span class="nc" id="L278">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L279">                    break;</span>
                case K_RSA_EXPORT:
<span class="nc" id="L281">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L282">                    components.add(&quot;RSA_EXPORT&quot;);</span>
<span class="nc" id="L283">                    break;</span>
                case K_DH_RSA:
<span class="nc" id="L285">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L286">                    components.add(&quot;DH&quot;);</span>
<span class="nc" id="L287">                    components.add(&quot;DiffieHellman&quot;);</span>
<span class="nc" id="L288">                    components.add(&quot;DH_RSA&quot;);</span>
<span class="nc" id="L289">                    break;</span>
                case K_DH_DSS:
<span class="nc" id="L291">                    components.add(&quot;DSA&quot;);</span>
<span class="nc" id="L292">                    components.add(&quot;DSS&quot;);</span>
<span class="nc" id="L293">                    components.add(&quot;DH&quot;);</span>
<span class="nc" id="L294">                    components.add(&quot;DiffieHellman&quot;);</span>
<span class="nc" id="L295">                    components.add(&quot;DH_DSS&quot;);</span>
<span class="nc" id="L296">                    break;</span>
                case K_DHE_DSS:
<span class="nc" id="L298">                    components.add(&quot;DSA&quot;);</span>
<span class="nc" id="L299">                    components.add(&quot;DSS&quot;);</span>
<span class="nc" id="L300">                    components.add(&quot;DH&quot;);</span>
<span class="nc" id="L301">                    components.add(&quot;DHE&quot;);</span>
<span class="nc" id="L302">                    components.add(&quot;DiffieHellman&quot;);</span>
<span class="nc" id="L303">                    components.add(&quot;DHE_DSS&quot;);</span>
<span class="nc" id="L304">                    break;</span>
                case K_DHE_RSA:
<span class="nc" id="L306">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L307">                    components.add(&quot;DH&quot;);</span>
<span class="nc" id="L308">                    components.add(&quot;DHE&quot;);</span>
<span class="nc" id="L309">                    components.add(&quot;DiffieHellman&quot;);</span>
<span class="nc" id="L310">                    components.add(&quot;DHE_RSA&quot;);</span>
<span class="nc" id="L311">                    break;</span>
                case K_DH_ANON:
<span class="nc bnc" id="L313" title="All 2 branches missed.">                    if (!forCertPathOnly) {</span>
<span class="nc" id="L314">                        components.add(&quot;ANON&quot;);</span>
<span class="nc" id="L315">                        components.add(&quot;DH&quot;);</span>
<span class="nc" id="L316">                        components.add(&quot;DiffieHellman&quot;);</span>
<span class="nc" id="L317">                        components.add(&quot;DH_ANON&quot;);</span>
                    }
                    break;
                case K_ECDH_ECDSA:
<span class="nc" id="L321">                    components.add(&quot;ECDH&quot;);</span>
<span class="nc" id="L322">                    components.add(&quot;ECDSA&quot;);</span>
<span class="nc" id="L323">                    components.add(&quot;ECDH_ECDSA&quot;);</span>
<span class="nc" id="L324">                    break;</span>
                case K_ECDH_RSA:
<span class="nc" id="L326">                    components.add(&quot;ECDH&quot;);</span>
<span class="nc" id="L327">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L328">                    components.add(&quot;ECDH_RSA&quot;);</span>
<span class="nc" id="L329">                    break;</span>
                case K_ECDHE_ECDSA:
<span class="nc" id="L331">                    components.add(&quot;ECDHE&quot;);</span>
<span class="nc" id="L332">                    components.add(&quot;ECDSA&quot;);</span>
<span class="nc" id="L333">                    components.add(&quot;ECDHE_ECDSA&quot;);</span>
<span class="nc" id="L334">                    break;</span>
                case K_ECDHE_RSA:
<span class="nc" id="L336">                    components.add(&quot;ECDHE&quot;);</span>
<span class="nc" id="L337">                    components.add(&quot;RSA&quot;);</span>
<span class="nc" id="L338">                    components.add(&quot;ECDHE_RSA&quot;);</span>
<span class="nc" id="L339">                    break;</span>
                case K_ECDH_ANON:
<span class="nc bnc" id="L341" title="All 2 branches missed.">                    if (!forCertPathOnly) {</span>
<span class="nc" id="L342">                        components.add(&quot;ECDH&quot;);</span>
<span class="nc" id="L343">                        components.add(&quot;ANON&quot;);</span>
<span class="nc" id="L344">                        components.add(&quot;ECDH_ANON&quot;);</span>
                    }
                    break;
                case K_KRB5:
<span class="nc bnc" id="L348" title="All 2 branches missed.">                    if (!forCertPathOnly) {</span>
<span class="nc" id="L349">                        components.add(&quot;KRB5&quot;);</span>
                    }
                    break;
                case K_KRB5_EXPORT:
<span class="nc bnc" id="L353" title="All 2 branches missed.">                    if (!forCertPathOnly) {</span>
<span class="nc" id="L354">                        components.add(&quot;KRB5_EXPORT&quot;);</span>
                    }
                    break;
                default:
                    // ignore
            }

<span class="nc" id="L361">            return components;</span>
        }

        protected Set&lt;String&gt; decomposes(BulkCipher bulkCipher) {
<span class="nc" id="L365">            Set&lt;String&gt; components = new HashSet&lt;&gt;();</span>

<span class="nc bnc" id="L367" title="All 2 branches missed.">            if (bulkCipher.transformation != null) {</span>
<span class="nc" id="L368">                components.addAll(super.decomposes(bulkCipher.transformation));</span>
            }

<span class="nc" id="L371">            return components;</span>
        }

        protected Set&lt;String&gt; decomposes(MacAlg macAlg) {
<span class="nc" id="L375">            Set&lt;String&gt; components = new HashSet&lt;&gt;();</span>

<span class="nc bnc" id="L377" title="All 2 branches missed.">            if (macAlg == CipherSuite.M_MD5) {</span>
<span class="nc" id="L378">                components.add(&quot;MD5&quot;);</span>
<span class="nc" id="L379">                components.add(&quot;HmacMD5&quot;);</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">            } else if (macAlg == CipherSuite.M_SHA) {</span>
<span class="nc" id="L381">                components.add(&quot;SHA1&quot;);</span>
<span class="nc" id="L382">                components.add(&quot;SHA-1&quot;);</span>
<span class="nc" id="L383">                components.add(&quot;HmacSHA1&quot;);</span>
<span class="nc bnc" id="L384" title="All 2 branches missed.">            } else if (macAlg == CipherSuite.M_SHA256) {</span>
<span class="nc" id="L385">                components.add(&quot;SHA256&quot;);</span>
<span class="nc" id="L386">                components.add(&quot;SHA-256&quot;);</span>
<span class="nc" id="L387">                components.add(&quot;HmacSHA256&quot;);</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">            } else if (macAlg == CipherSuite.M_SHA384) {</span>
<span class="nc" id="L389">                components.add(&quot;SHA384&quot;);</span>
<span class="nc" id="L390">                components.add(&quot;SHA-384&quot;);</span>
<span class="nc" id="L391">                components.add(&quot;HmacSHA384&quot;);</span>
            }

<span class="nc" id="L394">            return components;</span>
        }
    }

    static private class TLSDisabledAlgConstraints
            extends BasicDisabledAlgConstraints {

        TLSDisabledAlgConstraints() {
<span class="nc" id="L402">            super(DisabledAlgorithmConstraints.PROPERTY_TLS_DISABLED_ALGS);</span>
<span class="nc" id="L403">        }</span>

        @Override
        protected Set&lt;String&gt; decomposes(String algorithm) {
<span class="nc bnc" id="L407" title="All 4 branches missed.">            if (algorithm.startsWith(&quot;SSL_&quot;) || algorithm.startsWith(&quot;TLS_&quot;)) {</span>
<span class="nc" id="L408">                CipherSuite cipherSuite = null;</span>
                try {
<span class="nc" id="L410">                    cipherSuite = CipherSuite.valueOf(algorithm);</span>
<span class="nc" id="L411">                } catch (IllegalArgumentException iae) {</span>
                    // ignore: unknown or unsupported ciphersuite
<span class="nc" id="L413">                }</span>

<span class="nc bnc" id="L415" title="All 2 branches missed.">                if (cipherSuite != null) {</span>
<span class="nc" id="L416">                    Set&lt;String&gt; components = new HashSet&lt;&gt;();</span>

<span class="nc bnc" id="L418" title="All 2 branches missed.">                    if(cipherSuite.keyExchange != null) {</span>
<span class="nc" id="L419">                        components.addAll(</span>
<span class="nc" id="L420">                            decomposes(cipherSuite.keyExchange, false));</span>
                    }

<span class="nc bnc" id="L423" title="All 2 branches missed.">                    if (cipherSuite.cipher != null) {</span>
<span class="nc" id="L424">                        components.addAll(decomposes(cipherSuite.cipher));</span>
                    }

<span class="nc bnc" id="L427" title="All 2 branches missed.">                    if (cipherSuite.macAlg != null) {</span>
<span class="nc" id="L428">                        components.addAll(decomposes(cipherSuite.macAlg));</span>
                    }

<span class="nc" id="L431">                    return components;</span>
                }
            }

<span class="nc" id="L435">            return super.decomposes(algorithm);</span>
        }
    }

    static private class X509DisabledAlgConstraints
            extends BasicDisabledAlgConstraints {

        X509DisabledAlgConstraints() {
<span class="nc" id="L443">            super(DisabledAlgorithmConstraints.PROPERTY_CERTPATH_DISABLED_ALGS);</span>
<span class="nc" id="L444">        }</span>

        @Override
        protected Set&lt;String&gt; decomposes(String algorithm) {
<span class="nc bnc" id="L448" title="All 4 branches missed.">            if (algorithm.startsWith(&quot;SSL_&quot;) || algorithm.startsWith(&quot;TLS_&quot;)) {</span>
<span class="nc" id="L449">                CipherSuite cipherSuite = null;</span>
                try {
<span class="nc" id="L451">                    cipherSuite = CipherSuite.valueOf(algorithm);</span>
<span class="nc" id="L452">                } catch (IllegalArgumentException iae) {</span>
                    // ignore: unknown or unsupported ciphersuite
<span class="nc" id="L454">                }</span>

<span class="nc bnc" id="L456" title="All 2 branches missed.">                if (cipherSuite != null) {</span>
<span class="nc" id="L457">                    Set&lt;String&gt; components = new HashSet&lt;&gt;();</span>

<span class="nc bnc" id="L459" title="All 2 branches missed.">                    if(cipherSuite.keyExchange != null) {</span>
<span class="nc" id="L460">                        components.addAll(</span>
<span class="nc" id="L461">                            decomposes(cipherSuite.keyExchange, true));</span>
                    }

                    // Certification path algorithm constraints do not apply
                    // to cipherSuite.cipher and cipherSuite.macAlg.

<span class="nc" id="L467">                    return components;</span>
                }
            }

<span class="nc" id="L471">            return super.decomposes(algorithm);</span>
        }
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>