<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CipherSuite.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">sun.security.ssl</a> &gt; <span class="el_source">CipherSuite.java</span></div><h1>CipherSuite.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */


package sun.security.ssl;

import java.util.*;

import java.security.NoSuchAlgorithmException;
import java.security.InvalidKeyException;
import java.security.SecureRandom;
import java.security.KeyManagementException;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

import static sun.security.ssl.CipherSuite.KeyExchange.*;
import static sun.security.ssl.CipherSuite.PRF.*;
import static sun.security.ssl.CipherSuite.CipherType.*;
import static sun.security.ssl.JsseJce.*;

/**
 * An SSL/TLS CipherSuite. Constants for the standard key exchange, cipher,
 * and mac algorithms are also defined in this class.
 *
 * The CipherSuite class and the inner classes defined in this file roughly
 * follow the type safe enum pattern described in Effective Java. This means:
 *
 *  . instances are immutable, classes are final
 *
 *  . there is a unique instance of every value, i.e. there are never two
 *    instances representing the same CipherSuite, etc. This means equality
 *    tests can be performed using == instead of equals() (although that works
 *    as well). [A minor exception are *unsupported* CipherSuites read from a
 *    handshake message, but this is usually irrelevant]
 *
 *  . instances are obtained using the static valueOf() factory methods.
 *
 *  . properties are defined as final variables and made available as
 *    package private variables without method accessors
 *
 *  . if the member variable allowed is false, the given algorithm is either
 *    unavailable or disabled at compile time
 *
 */
final class CipherSuite implements Comparable&lt;CipherSuite&gt; {

    // minimum priority for supported CipherSuites
    final static int SUPPORTED_SUITES_PRIORITY = 1;

    // minimum priority for default enabled CipherSuites
    final static int DEFAULT_SUITES_PRIORITY = 300;

    // Flag indicating if CipherSuite availability can change dynamically.
    // This is the case when we rely on a JCE cipher implementation that
    // may not be available in the installed JCE providers.
    // It is true because we might not have an ECC implementation.
    final static boolean DYNAMIC_AVAILABILITY = true;

<span class="nc" id="L84">    private final static boolean ALLOW_ECC = Debug.getBooleanProperty</span>
<span class="nc" id="L85">        (&quot;com.sun.net.ssl.enableECC&quot;, true);</span>

    // Map Integer(id) -&gt; CipherSuite
    // contains all known CipherSuites
    private final static Map&lt;Integer,CipherSuite&gt; idMap;

    // Map String(name) -&gt; CipherSuite
    // contains only supported CipherSuites (i.e. allowed == true)
    private final static Map&lt;String,CipherSuite&gt; nameMap;

    // Protocol defined CipherSuite name, e.g. SSL_RSA_WITH_RC4_128_MD5
    // we use TLS_* only for new CipherSuites, still SSL_* for old ones
    final String name;

    // id in 16 bit MSB format, i.e. 0x0004 for SSL_RSA_WITH_RC4_128_MD5
    final int id;

    // priority for the internal default preference order. the higher the
    // better. Each supported CipherSuite *must* have a unique priority.
    // Ciphersuites with priority &gt;= DEFAULT_SUITES_PRIORITY are enabled
    // by default
    final int priority;

    // key exchange, bulk cipher, mac and prf algorithms. See those
    // classes below.
    final KeyExchange keyExchange;
    final BulkCipher cipher;
    final MacAlg macAlg;
    final PRF prfAlg;

    // whether a CipherSuite qualifies as exportable under 512/40 bit rules.
    // TLS 1.1+ (RFC 4346) must not negotiate to these suites.
    final boolean exportable;

    // true iff implemented and enabled at compile time
    final boolean allowed;

    // obsoleted since protocol version
    final int obsoleted;

    // supported since protocol version
    final int supported;

    /**
     * Constructor for implemented CipherSuites.
     */
    private CipherSuite(String name, int id, int priority,
            KeyExchange keyExchange, BulkCipher cipher,
<span class="nc" id="L133">            boolean allowed, int obsoleted, int supported, PRF prfAlg) {</span>
<span class="nc" id="L134">        this.name = name;</span>
<span class="nc" id="L135">        this.id = id;</span>
<span class="nc" id="L136">        this.priority = priority;</span>
<span class="nc" id="L137">        this.keyExchange = keyExchange;</span>
<span class="nc" id="L138">        this.cipher = cipher;</span>
<span class="nc" id="L139">        this.exportable = cipher.exportable;</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">        if (cipher.cipherType == CipherType.AEAD_CIPHER) {</span>
<span class="nc" id="L141">            macAlg = M_NULL;</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_MD5&quot;)) {</span>
<span class="nc" id="L143">            macAlg = M_MD5;</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_SHA&quot;)) {</span>
<span class="nc" id="L145">            macAlg = M_SHA;</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_SHA256&quot;)) {</span>
<span class="nc" id="L147">            macAlg = M_SHA256;</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_SHA384&quot;)) {</span>
<span class="nc" id="L149">            macAlg = M_SHA384;</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_NULL&quot;)) {</span>
<span class="nc" id="L151">            macAlg = M_NULL;</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">        } else if (name.endsWith(&quot;_SCSV&quot;)) {</span>
<span class="nc" id="L153">            macAlg = M_NULL;</span>
        } else {
<span class="nc" id="L155">            throw new IllegalArgumentException</span>
                    (&quot;Unknown MAC algorithm for ciphersuite &quot; + name);
        }

<span class="nc" id="L159">        allowed &amp;= keyExchange.allowed;</span>
<span class="nc" id="L160">        allowed &amp;= cipher.allowed;</span>
<span class="nc" id="L161">        this.allowed = allowed;</span>
<span class="nc" id="L162">        this.obsoleted = obsoleted;</span>
<span class="nc" id="L163">        this.supported = supported;</span>
<span class="nc" id="L164">        this.prfAlg = prfAlg;</span>
<span class="nc" id="L165">    }</span>

    /**
     * Constructor for unimplemented CipherSuites.
     */
<span class="nc" id="L170">    private CipherSuite(String name, int id) {</span>
<span class="nc" id="L171">        this.name = name;</span>
<span class="nc" id="L172">        this.id = id;</span>
<span class="nc" id="L173">        this.allowed = false;</span>

<span class="nc" id="L175">        this.priority = 0;</span>
<span class="nc" id="L176">        this.keyExchange = null;</span>
<span class="nc" id="L177">        this.cipher = null;</span>
<span class="nc" id="L178">        this.macAlg = null;</span>
<span class="nc" id="L179">        this.exportable = false;</span>
<span class="nc" id="L180">        this.obsoleted = ProtocolVersion.LIMIT_MAX_VALUE;</span>
<span class="nc" id="L181">        this.supported = ProtocolVersion.LIMIT_MIN_VALUE;</span>
<span class="nc" id="L182">        this.prfAlg = P_NONE;</span>
<span class="nc" id="L183">    }</span>

    /**
     * Return whether this CipherSuite is available for use. A
     * CipherSuite may be unavailable even if it is supported
     * (i.e. allowed == true) if the required JCE cipher is not installed.
     * In some configuration, this situation may change over time, call
     * CipherSuiteList.clearAvailableCache() before this method to obtain
     * the most current status.
     */
    boolean isAvailable() {
<span class="nc bnc" id="L194" title="All 6 branches missed.">        return allowed &amp;&amp; keyExchange.isAvailable() &amp;&amp; cipher.isAvailable();</span>
    }

    boolean isNegotiable() {
<span class="nc bnc" id="L198" title="All 4 branches missed.">        return this != C_SCSV &amp;&amp; isAvailable();</span>
    }

    /**
     * Compares CipherSuites based on their priority. Has the effect of
     * sorting CipherSuites when put in a sorted collection, which is
     * used by CipherSuiteList. Follows standard Comparable contract.
     *
     * Note that for unsupported CipherSuites parsed from a handshake
     * message we violate the equals() contract.
     */
    @Override
    public int compareTo(CipherSuite o) {
<span class="nc" id="L211">        return o.priority - priority;</span>
    }

    /**
     * Returns this.name.
     */
    @Override
    public String toString() {
<span class="nc" id="L219">        return name;</span>
    }

    /**
     * Return a CipherSuite for the given name. The returned CipherSuite
     * is supported by this implementation but may not actually be
     * currently useable. See isAvailable().
     *
     * @exception IllegalArgumentException if the CipherSuite is unknown or
     * unsupported.
     */
    static CipherSuite valueOf(String s) {
<span class="nc bnc" id="L231" title="All 2 branches missed.">        if (s == null) {</span>
<span class="nc" id="L232">            throw new IllegalArgumentException(&quot;Name must not be null&quot;);</span>
        }

<span class="nc" id="L235">        CipherSuite c = nameMap.get(s);</span>
<span class="nc bnc" id="L236" title="All 4 branches missed.">        if ((c == null) || (c.allowed == false)) {</span>
<span class="nc" id="L237">            throw new IllegalArgumentException(&quot;Unsupported ciphersuite &quot; + s);</span>
        }

<span class="nc" id="L240">        return c;</span>
    }

    /**
     * Return a CipherSuite with the given ID. A temporary object is
     * constructed if the ID is unknown. Use isAvailable() to verify that
     * the CipherSuite can actually be used.
     */
    static CipherSuite valueOf(int id1, int id2) {
<span class="nc" id="L249">        id1 &amp;= 0xff;</span>
<span class="nc" id="L250">        id2 &amp;= 0xff;</span>
<span class="nc" id="L251">        int id = (id1 &lt;&lt; 8) | id2;</span>
<span class="nc" id="L252">        CipherSuite c = idMap.get(id);</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">        if (c == null) {</span>
<span class="nc" id="L254">            String h1 = Integer.toString(id1, 16);</span>
<span class="nc" id="L255">            String h2 = Integer.toString(id2, 16);</span>
<span class="nc" id="L256">            c = new CipherSuite(&quot;Unknown 0x&quot; + h1 + &quot;:0x&quot; + h2, id);</span>
        }
<span class="nc" id="L258">        return c;</span>
    }

    // for use by CipherSuiteList only
    static Collection&lt;CipherSuite&gt; allowedCipherSuites() {
<span class="nc" id="L263">        return nameMap.values();</span>
    }

    /*
     * Use this method when all of the values need to be specified.
     * This is primarily used when defining a new ciphersuite for
     * TLS 1.2+ that doesn't use the &quot;default&quot; PRF.
     */
    private static void add(String name, int id, int priority,
            KeyExchange keyExchange, BulkCipher cipher,
            boolean allowed, int obsoleted, int supported, PRF prf) {

<span class="nc" id="L275">        CipherSuite c = new CipherSuite(name, id, priority, keyExchange,</span>
            cipher, allowed, obsoleted, supported, prf);
<span class="nc bnc" id="L277" title="All 2 branches missed.">        if (idMap.put(id, c) != null) {</span>
<span class="nc" id="L278">            throw new RuntimeException(&quot;Duplicate ciphersuite definition: &quot;</span>
                                        + id + &quot;, &quot; + name);
        }
<span class="nc bnc" id="L281" title="All 2 branches missed.">        if (c.allowed) {</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">            if (nameMap.put(name, c) != null) {</span>
<span class="nc" id="L283">                throw new RuntimeException(&quot;Duplicate ciphersuite definition: &quot;</span>
                                            + id + &quot;, &quot; + name);
            }
        }
<span class="nc" id="L287">    }</span>

    /*
     * Use this method when there is no lower protocol limit where this
     * suite can be used, and the PRF is P_SHA256.  That is, the
     * existing ciphersuites.  From RFC 5246:
     *
     *     All cipher suites in this document use P_SHA256.
     */
    private static void add(String name, int id, int priority,
            KeyExchange keyExchange, BulkCipher cipher,
            boolean allowed, int obsoleted) {
        // If this is an obsoleted suite, then don't let the TLS 1.2
        // protocol have a valid PRF value.
<span class="nc" id="L301">        PRF prf = P_SHA256;</span>
<span class="nc bnc" id="L302" title="All 2 branches missed.">        if (obsoleted &lt; ProtocolVersion.TLS12.v) {</span>
<span class="nc" id="L303">            prf = P_NONE;</span>
        }

<span class="nc" id="L306">        add(name, id, priority, keyExchange, cipher, allowed, obsoleted,</span>
            ProtocolVersion.LIMIT_MIN_VALUE, prf);
<span class="nc" id="L308">    }</span>

    /*
     * Use this method when there is no upper protocol limit.  That is,
     * suites which have not been obsoleted.
     */
    private static void add(String name, int id, int priority,
            KeyExchange keyExchange, BulkCipher cipher, boolean allowed) {
<span class="nc" id="L316">        add(name, id, priority, keyExchange,</span>
            cipher, allowed, ProtocolVersion.LIMIT_MAX_VALUE);
<span class="nc" id="L318">    }</span>

    /*
     * Use this method to define an unimplemented suite.  This provides
     * a number&lt;-&gt;name mapping that can be used for debugging.
     */
    private static void add(String name, int id) {
<span class="nc" id="L325">        CipherSuite c = new CipherSuite(name, id);</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">        if (idMap.put(id, c) != null) {</span>
<span class="nc" id="L327">            throw new RuntimeException(&quot;Duplicate ciphersuite definition: &quot;</span>
                                        + id + &quot;, &quot; + name);
        }
<span class="nc" id="L330">    }</span>

    /**
     * An SSL/TLS key exchange algorithm.
     */
<span class="nc" id="L335">    static enum KeyExchange {</span>

        // key exchange algorithms
<span class="nc" id="L338">        K_NULL       (&quot;NULL&quot;,       false),</span>
<span class="nc" id="L339">        K_RSA        (&quot;RSA&quot;,        true),</span>
<span class="nc" id="L340">        K_RSA_EXPORT (&quot;RSA_EXPORT&quot;, true),</span>
<span class="nc" id="L341">        K_DH_RSA     (&quot;DH_RSA&quot;,     false),</span>
<span class="nc" id="L342">        K_DH_DSS     (&quot;DH_DSS&quot;,     false),</span>
<span class="nc" id="L343">        K_DHE_DSS    (&quot;DHE_DSS&quot;,    true),</span>
<span class="nc" id="L344">        K_DHE_RSA    (&quot;DHE_RSA&quot;,    true),</span>
<span class="nc" id="L345">        K_DH_ANON    (&quot;DH_anon&quot;,    true),</span>

<span class="nc" id="L347">        K_ECDH_ECDSA (&quot;ECDH_ECDSA&quot;,  ALLOW_ECC),</span>
<span class="nc" id="L348">        K_ECDH_RSA   (&quot;ECDH_RSA&quot;,    ALLOW_ECC),</span>
<span class="nc" id="L349">        K_ECDHE_ECDSA(&quot;ECDHE_ECDSA&quot;, ALLOW_ECC),</span>
<span class="nc" id="L350">        K_ECDHE_RSA  (&quot;ECDHE_RSA&quot;,   ALLOW_ECC),</span>
<span class="nc" id="L351">        K_ECDH_ANON  (&quot;ECDH_anon&quot;,   ALLOW_ECC),</span>

        // Kerberos cipher suites
<span class="nc" id="L354">        K_KRB5       (&quot;KRB5&quot;, true),</span>
<span class="nc" id="L355">        K_KRB5_EXPORT(&quot;KRB5_EXPORT&quot;, true),</span>

        // renegotiation protection request signaling cipher suite
<span class="nc" id="L358">        K_SCSV       (&quot;SCSV&quot;,        true);</span>

        // name of the key exchange algorithm, e.g. DHE_DSS
        final String name;
        final boolean allowed;
        private final boolean alwaysAvailable;

<span class="nc" id="L365">        KeyExchange(String name, boolean allowed) {</span>
<span class="nc" id="L366">            this.name = name;</span>
<span class="nc" id="L367">            this.allowed = allowed;</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">            this.alwaysAvailable = allowed &amp;&amp;</span>
<span class="nc bnc" id="L369" title="All 4 branches missed.">                (!name.startsWith(&quot;EC&quot;)) &amp;&amp; (!name.startsWith(&quot;KRB&quot;));</span>
<span class="nc" id="L370">        }</span>

        boolean isAvailable() {
<span class="nc bnc" id="L373" title="All 2 branches missed.">            if (alwaysAvailable) {</span>
<span class="nc" id="L374">                return true;</span>
            }

<span class="nc bnc" id="L377" title="All 2 branches missed.">            if (name.startsWith(&quot;EC&quot;)) {</span>
<span class="nc bnc" id="L378" title="All 4 branches missed.">                return (allowed &amp;&amp; JsseJce.isEcAvailable());</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">            } else if (name.startsWith(&quot;KRB&quot;)) {</span>
<span class="nc bnc" id="L380" title="All 4 branches missed.">                return (allowed &amp;&amp; JsseJce.isKerberosAvailable());</span>
            } else {
<span class="nc" id="L382">                return allowed;</span>
            }
        }

        @Override
        public String toString() {
<span class="nc" id="L388">            return name;</span>
        }
    }

<span class="nc" id="L392">    static enum CipherType {</span>
<span class="nc" id="L393">        STREAM_CIPHER,         // null or stream cipher</span>
<span class="nc" id="L394">        BLOCK_CIPHER,          // block cipher in CBC mode</span>
<span class="nc" id="L395">        AEAD_CIPHER            // AEAD cipher</span>
    }

    /**
     * An SSL/TLS bulk cipher algorithm. One instance per combination of
     * cipher and key length.
     *
     * Also contains a factory method to obtain in initialized CipherBox
     * for this algorithm.
     */
    final static class BulkCipher {

        // Map BulkCipher -&gt; Boolean(available)
<span class="nc" id="L408">        private final static Map&lt;BulkCipher,Boolean&gt; availableCache =</span>
                                            new HashMap&lt;&gt;(8);

        // descriptive name including key size, e.g. AES/128
        final String description;

        // JCE cipher transformation string, e.g. AES/CBC/NoPadding
        final String transformation;

        // algorithm name, e.g. AES
        final String algorithm;

        // supported and compile time enabled. Also see isAvailable()
        final boolean allowed;

        // number of bytes of entropy in the key
        final int keySize;

        // length of the actual cipher key in bytes.
        // for non-exportable ciphers, this is the same as keySize
        final int expandedKeySize;

        // size of the IV
        final int ivSize;

        // size of fixed IV
        //
        // record_iv_length = ivSize - fixedIvSize
        final int fixedIvSize;

        // exportable under 512/40 bit rules
        final boolean exportable;

        // Is the cipher algorithm of Cipher Block Chaining (CBC) mode?
        final CipherType cipherType;

        // size of the authentication tag, only applicable to cipher suites in
        // Galois Counter Mode (GCM)
        //
        // As far as we know, all supported GCM cipher suites use 128-bits
        // authentication tags.
<span class="nc" id="L449">        final int tagSize = 16;</span>

        // The secure random used to detect the cipher availability.
        private final static SecureRandom secureRandom;

        static {
            try {
<span class="nc" id="L456">                secureRandom = JsseJce.getSecureRandom();</span>
<span class="nc" id="L457">            } catch (KeyManagementException kme) {</span>
<span class="nc" id="L458">                throw new RuntimeException(kme);</span>
<span class="nc" id="L459">            }</span>
<span class="nc" id="L460">        }</span>

        BulkCipher(String transformation, CipherType cipherType, int keySize,
                int expandedKeySize, int ivSize,
<span class="nc" id="L464">                int fixedIvSize, boolean allowed) {</span>

<span class="nc" id="L466">            this.transformation = transformation;</span>
<span class="nc" id="L467">            String[] splits = transformation.split(&quot;/&quot;);</span>
<span class="nc" id="L468">            this.algorithm = splits[0];</span>
<span class="nc" id="L469">            this.cipherType = cipherType;</span>
<span class="nc" id="L470">            this.description = this.algorithm + &quot;/&quot; + (keySize &lt;&lt; 3);</span>
<span class="nc" id="L471">            this.keySize = keySize;</span>
<span class="nc" id="L472">            this.ivSize = ivSize;</span>
<span class="nc" id="L473">            this.fixedIvSize = fixedIvSize;</span>
<span class="nc" id="L474">            this.allowed = allowed;</span>

<span class="nc" id="L476">            this.expandedKeySize = expandedKeySize;</span>
<span class="nc" id="L477">            this.exportable = true;</span>
<span class="nc" id="L478">        }</span>

        BulkCipher(String transformation, CipherType cipherType, int keySize,
<span class="nc" id="L481">                int ivSize, int fixedIvSize, boolean allowed) {</span>
<span class="nc" id="L482">            this.transformation = transformation;</span>
<span class="nc" id="L483">            String[] splits = transformation.split(&quot;/&quot;);</span>
<span class="nc" id="L484">            this.algorithm = splits[0];</span>
<span class="nc" id="L485">            this.cipherType = cipherType;</span>
<span class="nc" id="L486">            this.description = this.algorithm + &quot;/&quot; + (keySize &lt;&lt; 3);</span>
<span class="nc" id="L487">            this.keySize = keySize;</span>
<span class="nc" id="L488">            this.ivSize = ivSize;</span>
<span class="nc" id="L489">            this.fixedIvSize = fixedIvSize;</span>
<span class="nc" id="L490">            this.allowed = allowed;</span>

<span class="nc" id="L492">            this.expandedKeySize = keySize;</span>
<span class="nc" id="L493">            this.exportable = false;</span>
<span class="nc" id="L494">        }</span>

        /**
         * Return an initialized CipherBox for this BulkCipher.
         * IV must be null for stream ciphers.
         *
         * @exception NoSuchAlgorithmException if anything goes wrong
         */
        CipherBox newCipher(ProtocolVersion version, SecretKey key,
                IvParameterSpec iv, SecureRandom random,
                boolean encrypt) throws NoSuchAlgorithmException {
<span class="nc" id="L505">            return CipherBox.newCipherBox(version, this,</span>
                                            key, iv, random, encrypt);
        }

        /**
         * Test if this bulk cipher is available. For use by CipherSuite.
         *
         * Currently all supported ciphers except AES are always available
         * via the JSSE internal implementations. We also assume AES/128 of
         * CBC mode is always available since it is shipped with the SunJCE
         * provider.  However, AES/256 is unavailable when the default JCE
         * policy jurisdiction files are installed because of key length
         * restrictions, and AEAD is unavailable when the underlying providers
         * do not support AEAD/GCM mode.
         */
        boolean isAvailable() {
<span class="nc bnc" id="L521" title="All 2 branches missed.">            if (allowed == false) {</span>
<span class="nc" id="L522">                return false;</span>
            }

<span class="nc bnc" id="L525" title="All 4 branches missed.">            if ((this == B_AES_256) ||</span>
                    (this.cipherType == CipherType.AEAD_CIPHER)) {
<span class="nc" id="L527">                return isAvailable(this);</span>
            }

            // always available
<span class="nc" id="L531">            return true;</span>
        }

        // for use by CipherSuiteList.clearAvailableCache();
        static synchronized void clearAvailableCache() {
            if (DYNAMIC_AVAILABILITY) {
<span class="nc" id="L537">                availableCache.clear();</span>
            }
<span class="nc" id="L539">        }</span>

        private static synchronized boolean isAvailable(BulkCipher cipher) {
<span class="nc" id="L542">            Boolean b = availableCache.get(cipher);</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">            if (b == null) {</span>
<span class="nc" id="L544">                int keySizeInBits = cipher.keySize * 8;</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">                if (keySizeInBits &gt; 128) {    // need the JCE unlimited</span>
                                               // strength jurisdiction policy
                    try {
<span class="nc bnc" id="L548" title="All 2 branches missed.">                        if (Cipher.getMaxAllowedKeyLength(</span>
                                cipher.transformation) &lt; keySizeInBits) {
<span class="nc" id="L550">                            b = Boolean.FALSE;</span>
                        }
<span class="nc" id="L552">                    } catch (Exception e) {</span>
<span class="nc" id="L553">                        b = Boolean.FALSE;</span>
<span class="nc" id="L554">                    }</span>
                }

<span class="nc bnc" id="L557" title="All 2 branches missed.">                if (b == null) {</span>
<span class="nc" id="L558">                    b = Boolean.FALSE;          // may be reset to TRUE if</span>
                                                // the cipher is available
<span class="nc" id="L560">                    CipherBox temporary = null;</span>
                    try {
<span class="nc" id="L562">                        SecretKey key = new SecretKeySpec(</span>
                                            new byte[cipher.expandedKeySize],
                                            cipher.algorithm);
                        IvParameterSpec iv;
<span class="nc bnc" id="L566" title="All 2 branches missed.">                        if (cipher.cipherType == CipherType.AEAD_CIPHER) {</span>
<span class="nc" id="L567">                            iv = new IvParameterSpec(</span>
                                            new byte[cipher.fixedIvSize]);
                        } else {
<span class="nc" id="L570">                            iv = new IvParameterSpec(new byte[cipher.ivSize]);</span>
                        }
<span class="nc" id="L572">                        temporary = cipher.newCipher(</span>
                                            ProtocolVersion.DEFAULT,
                                            key, iv, secureRandom, true);
<span class="nc" id="L575">                        b = temporary.isAvailable();</span>
<span class="nc" id="L576">                    } catch (NoSuchAlgorithmException e) {</span>
                        // not available
                    } finally {
<span class="nc bnc" id="L579" title="All 6 branches missed.">                        if (temporary != null) {</span>
<span class="nc" id="L580">                            temporary.dispose();</span>
                        }
                    }
                }

<span class="nc" id="L585">                availableCache.put(cipher, b);</span>
            }

<span class="nc" id="L588">            return b.booleanValue();</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L593">            return description;</span>
        }
    }

    /**
     * An SSL/TLS key MAC algorithm.
     *
     * Also contains a factory method to obtain an initialized MAC
     * for this algorithm.
     */
    final static class MacAlg {

        // descriptive name, e.g. MD5
        final String name;

        // size of the MAC value (and MAC key) in bytes
        final int size;

        // block size of the underlying hash algorithm
        final int hashBlockSize;

        // minimal padding size of the underlying hash algorithm
        final int minimalPaddingSize;

        MacAlg(String name, int size,
<span class="nc" id="L618">                int hashBlockSize, int minimalPaddingSize) {</span>
<span class="nc" id="L619">            this.name = name;</span>
<span class="nc" id="L620">            this.size = size;</span>
<span class="nc" id="L621">            this.hashBlockSize = hashBlockSize;</span>
<span class="nc" id="L622">            this.minimalPaddingSize = minimalPaddingSize;</span>
<span class="nc" id="L623">        }</span>

        /**
         * Return an initialized MAC for this MacAlg. ProtocolVersion
         * must either be SSL30 (SSLv3 custom MAC) or TLS10 (std. HMAC).
         *
         * @exception NoSuchAlgorithmException if anything goes wrong
         */
        MAC newMac(ProtocolVersion protocolVersion, SecretKey secret)
                throws NoSuchAlgorithmException, InvalidKeyException {
<span class="nc" id="L633">            return new MAC(this, protocolVersion, secret);</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L638">            return name;</span>
        }
    }

    // export strength ciphers
<span class="nc" id="L643">    final static BulkCipher B_NULL    =</span>
        new BulkCipher(&quot;NULL&quot;,          STREAM_CIPHER,    0,  0,  0, 0, true);
<span class="nc" id="L645">    final static BulkCipher B_RC4_40  =</span>
        new BulkCipher(CIPHER_RC4,      STREAM_CIPHER,    5, 16,  0, 0, true);
<span class="nc" id="L647">    final static BulkCipher B_RC2_40  =</span>
        new BulkCipher(&quot;RC2&quot;,           BLOCK_CIPHER,     5, 16,  8, 0, false);
<span class="nc" id="L649">    final static BulkCipher B_DES_40  =</span>
        new BulkCipher(CIPHER_DES,      BLOCK_CIPHER,     5,  8,  8, 0, true);

    // domestic strength ciphers
<span class="nc" id="L653">    final static BulkCipher B_RC4_128 =</span>
        new BulkCipher(CIPHER_RC4,      STREAM_CIPHER,   16,  0,  0, true);
<span class="nc" id="L655">    final static BulkCipher B_DES     =</span>
        new BulkCipher(CIPHER_DES,      BLOCK_CIPHER,     8,  8,  0, true);
<span class="nc" id="L657">    final static BulkCipher B_3DES    =</span>
        new BulkCipher(CIPHER_3DES,     BLOCK_CIPHER,    24,  8,  0, true);
<span class="nc" id="L659">    final static BulkCipher B_IDEA    =</span>
        new BulkCipher(&quot;IDEA&quot;,          BLOCK_CIPHER,    16,  8,  0, false);
<span class="nc" id="L661">    final static BulkCipher B_AES_128 =</span>
        new BulkCipher(CIPHER_AES,      BLOCK_CIPHER,    16, 16,  0, true);
<span class="nc" id="L663">    final static BulkCipher B_AES_256 =</span>
        new BulkCipher(CIPHER_AES,      BLOCK_CIPHER,    32, 16,  0, true);
<span class="nc" id="L665">    final static BulkCipher B_AES_128_GCM =</span>
        new BulkCipher(CIPHER_AES_GCM,  AEAD_CIPHER,     16, 12,  4, true);
<span class="nc" id="L667">    final static BulkCipher B_AES_256_GCM =</span>
        new BulkCipher(CIPHER_AES_GCM,  AEAD_CIPHER,     32, 12,  4, true);

    // MACs
<span class="nc" id="L671">    final static MacAlg M_NULL    = new MacAlg(&quot;NULL&quot;,     0,   0,   0);</span>
<span class="nc" id="L672">    final static MacAlg M_MD5     = new MacAlg(&quot;MD5&quot;,     16,  64,   9);</span>
<span class="nc" id="L673">    final static MacAlg M_SHA     = new MacAlg(&quot;SHA&quot;,     20,  64,   9);</span>
<span class="nc" id="L674">    final static MacAlg M_SHA256  = new MacAlg(&quot;SHA256&quot;,  32,  64,   9);</span>
<span class="nc" id="L675">    final static MacAlg M_SHA384  = new MacAlg(&quot;SHA384&quot;,  48, 128,  17);</span>

    /**
     * PRFs (PseudoRandom Function) from TLS specifications.
     *
     * TLS 1.1- uses a single MD5/SHA1-based PRF algorithm for generating
     * the necessary material.
     *
     * In TLS 1.2+, all existing/known CipherSuites use SHA256, however
     * new Ciphersuites (e.g. RFC 5288) can define specific PRF hash
     * algorithms.
     */
<span class="nc" id="L687">    static enum PRF {</span>

        // PRF algorithms
<span class="nc" id="L690">        P_NONE(     &quot;NONE&quot;,  0,   0),</span>
<span class="nc" id="L691">        P_SHA256(&quot;SHA-256&quot;, 32,  64),</span>
<span class="nc" id="L692">        P_SHA384(&quot;SHA-384&quot;, 48, 128),</span>
<span class="nc" id="L693">        P_SHA512(&quot;SHA-512&quot;, 64, 128);  // not currently used.</span>

        // PRF characteristics
        private final String prfHashAlg;
        private final int prfHashLength;
        private final int prfBlockSize;

<span class="nc" id="L700">        PRF(String prfHashAlg, int prfHashLength, int prfBlockSize) {</span>
<span class="nc" id="L701">            this.prfHashAlg = prfHashAlg;</span>
<span class="nc" id="L702">            this.prfHashLength = prfHashLength;</span>
<span class="nc" id="L703">            this.prfBlockSize = prfBlockSize;</span>
<span class="nc" id="L704">        }</span>

        String getPRFHashAlg() {
<span class="nc" id="L707">            return prfHashAlg;</span>
        }

        int getPRFHashLength() {
<span class="nc" id="L711">            return prfHashLength;</span>
        }

        int getPRFBlockSize() {
<span class="nc" id="L715">            return prfBlockSize;</span>
        }
    }

    static {
<span class="nc" id="L720">        idMap = new HashMap&lt;Integer,CipherSuite&gt;();</span>
<span class="nc" id="L721">        nameMap = new HashMap&lt;String,CipherSuite&gt;();</span>

        final boolean F = false;
        final boolean T = true;
        // N: ciphersuites only allowed if we are not in FIPS mode
<span class="nc bnc" id="L726" title="All 2 branches missed.">        final boolean N = (SunJSSE.isFIPS() == false);</span>

        /*
         * TLS Cipher Suite Registry, as of August 2010.
         *
         * http://www.iana.org/assignments/tls-parameters/tls-parameters.xml
         *
         * Range      Registration Procedures   Notes
         * 000-191    Standards Action          Refers to value of first byte
         * 192-254    Specification Required    Refers to value of first byte
         * 255        Reserved for Private Use  Refers to value of first byte
         *
         * Value      Description                               Reference
         * 0x00,0x00  TLS_NULL_WITH_NULL_NULL                   [RFC5246]
         * 0x00,0x01  TLS_RSA_WITH_NULL_MD5                     [RFC5246]
         * 0x00,0x02  TLS_RSA_WITH_NULL_SHA                     [RFC5246]
         * 0x00,0x03  TLS_RSA_EXPORT_WITH_RC4_40_MD5            [RFC4346]
         * 0x00,0x04  TLS_RSA_WITH_RC4_128_MD5                  [RFC5246]
         * 0x00,0x05  TLS_RSA_WITH_RC4_128_SHA                  [RFC5246]
         * 0x00,0x06  TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5        [RFC4346]
         * 0x00,0x07  TLS_RSA_WITH_IDEA_CBC_SHA                 [RFC5469]
         * 0x00,0x08  TLS_RSA_EXPORT_WITH_DES40_CBC_SHA         [RFC4346]
         * 0x00,0x09  TLS_RSA_WITH_DES_CBC_SHA                  [RFC5469]
         * 0x00,0x0A  TLS_RSA_WITH_3DES_EDE_CBC_SHA             [RFC5246]
         * 0x00,0x0B  TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA      [RFC4346]
         * 0x00,0x0C  TLS_DH_DSS_WITH_DES_CBC_SHA               [RFC5469]
         * 0x00,0x0D  TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA          [RFC5246]
         * 0x00,0x0E  TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA      [RFC4346]
         * 0x00,0x0F  TLS_DH_RSA_WITH_DES_CBC_SHA               [RFC5469]
         * 0x00,0x10  TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA          [RFC5246]
         * 0x00,0x11  TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA     [RFC4346]
         * 0x00,0x12  TLS_DHE_DSS_WITH_DES_CBC_SHA              [RFC5469]
         * 0x00,0x13  TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA         [RFC5246]
         * 0x00,0x14  TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA     [RFC4346]
         * 0x00,0x15  TLS_DHE_RSA_WITH_DES_CBC_SHA              [RFC5469]
         * 0x00,0x16  TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA         [RFC5246]
         * 0x00,0x17  TLS_DH_anon_EXPORT_WITH_RC4_40_MD5        [RFC4346]
         * 0x00,0x18  TLS_DH_anon_WITH_RC4_128_MD5              [RFC5246]
         * 0x00,0x19  TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA     [RFC4346]
         * 0x00,0x1A  TLS_DH_anon_WITH_DES_CBC_SHA              [RFC5469]
         * 0x00,0x1B  TLS_DH_anon_WITH_3DES_EDE_CBC_SHA         [RFC5246]
         * 0x00,0x1C-1D Reserved to avoid conflicts with SSLv3  [RFC5246]
         * 0x00,0x1E  TLS_KRB5_WITH_DES_CBC_SHA                 [RFC2712]
         * 0x00,0x1F  TLS_KRB5_WITH_3DES_EDE_CBC_SHA            [RFC2712]
         * 0x00,0x20  TLS_KRB5_WITH_RC4_128_SHA                 [RFC2712]
         * 0x00,0x21  TLS_KRB5_WITH_IDEA_CBC_SHA                [RFC2712]
         * 0x00,0x22  TLS_KRB5_WITH_DES_CBC_MD5                 [RFC2712]
         * 0x00,0x23  TLS_KRB5_WITH_3DES_EDE_CBC_MD5            [RFC2712]
         * 0x00,0x24  TLS_KRB5_WITH_RC4_128_MD5                 [RFC2712]
         * 0x00,0x25  TLS_KRB5_WITH_IDEA_CBC_MD5                [RFC2712]
         * 0x00,0x26  TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA       [RFC2712]
         * 0x00,0x27  TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA       [RFC2712]
         * 0x00,0x28  TLS_KRB5_EXPORT_WITH_RC4_40_SHA           [RFC2712]
         * 0x00,0x29  TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5       [RFC2712]
         * 0x00,0x2A  TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5       [RFC2712]
         * 0x00,0x2B  TLS_KRB5_EXPORT_WITH_RC4_40_MD5           [RFC2712]
         * 0x00,0x2C  TLS_PSK_WITH_NULL_SHA                     [RFC4785]
         * 0x00,0x2D  TLS_DHE_PSK_WITH_NULL_SHA                 [RFC4785]
         * 0x00,0x2E  TLS_RSA_PSK_WITH_NULL_SHA                 [RFC4785]
         * 0x00,0x2F  TLS_RSA_WITH_AES_128_CBC_SHA              [RFC5246]
         * 0x00,0x30  TLS_DH_DSS_WITH_AES_128_CBC_SHA           [RFC5246]
         * 0x00,0x31  TLS_DH_RSA_WITH_AES_128_CBC_SHA           [RFC5246]
         * 0x00,0x32  TLS_DHE_DSS_WITH_AES_128_CBC_SHA          [RFC5246]
         * 0x00,0x33  TLS_DHE_RSA_WITH_AES_128_CBC_SHA          [RFC5246]
         * 0x00,0x34  TLS_DH_anon_WITH_AES_128_CBC_SHA          [RFC5246]
         * 0x00,0x35  TLS_RSA_WITH_AES_256_CBC_SHA              [RFC5246]
         * 0x00,0x36  TLS_DH_DSS_WITH_AES_256_CBC_SHA           [RFC5246]
         * 0x00,0x37  TLS_DH_RSA_WITH_AES_256_CBC_SHA           [RFC5246]
         * 0x00,0x38  TLS_DHE_DSS_WITH_AES_256_CBC_SHA          [RFC5246]
         * 0x00,0x39  TLS_DHE_RSA_WITH_AES_256_CBC_SHA          [RFC5246]
         * 0x00,0x3A  TLS_DH_anon_WITH_AES_256_CBC_SHA          [RFC5246]
         * 0x00,0x3B  TLS_RSA_WITH_NULL_SHA256                  [RFC5246]
         * 0x00,0x3C  TLS_RSA_WITH_AES_128_CBC_SHA256           [RFC5246]
         * 0x00,0x3D  TLS_RSA_WITH_AES_256_CBC_SHA256           [RFC5246]
         * 0x00,0x3E  TLS_DH_DSS_WITH_AES_128_CBC_SHA256        [RFC5246]
         * 0x00,0x3F  TLS_DH_RSA_WITH_AES_128_CBC_SHA256        [RFC5246]
         * 0x00,0x40  TLS_DHE_DSS_WITH_AES_128_CBC_SHA256       [RFC5246]
         * 0x00,0x41  TLS_RSA_WITH_CAMELLIA_128_CBC_SHA         [RFC5932]
         * 0x00,0x42  TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA      [RFC5932]
         * 0x00,0x43  TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA      [RFC5932]
         * 0x00,0x44  TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA     [RFC5932]
         * 0x00,0x45  TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA     [RFC5932]
         * 0x00,0x46  TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA     [RFC5932]
         * 0x00,0x47-4F Reserved to avoid conflicts with
         *            deployed implementations                  [Pasi_Eronen]
         * 0x00,0x50-58 Reserved to avoid conflicts             [Pasi Eronen]
         * 0x00,0x59-5C Reserved to avoid conflicts with
         *            deployed implementations                  [Pasi_Eronen]
         * 0x00,0x5D-5F Unassigned
         * 0x00,0x60-66 Reserved to avoid conflicts with widely
         *            deployed implementations                  [Pasi_Eronen]
         * 0x00,0x67  TLS_DHE_RSA_WITH_AES_128_CBC_SHA256       [RFC5246]
         * 0x00,0x68  TLS_DH_DSS_WITH_AES_256_CBC_SHA256        [RFC5246]
         * 0x00,0x69  TLS_DH_RSA_WITH_AES_256_CBC_SHA256        [RFC5246]
         * 0x00,0x6A  TLS_DHE_DSS_WITH_AES_256_CBC_SHA256       [RFC5246]
         * 0x00,0x6B  TLS_DHE_RSA_WITH_AES_256_CBC_SHA256       [RFC5246]
         * 0x00,0x6C  TLS_DH_anon_WITH_AES_128_CBC_SHA256       [RFC5246]
         * 0x00,0x6D  TLS_DH_anon_WITH_AES_256_CBC_SHA256       [RFC5246]
         * 0x00,0x6E-83 Unassigned
         * 0x00,0x84  TLS_RSA_WITH_CAMELLIA_256_CBC_SHA         [RFC5932]
         * 0x00,0x85  TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA      [RFC5932]
         * 0x00,0x86  TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA      [RFC5932]
         * 0x00,0x87  TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA     [RFC5932]
         * 0x00,0x88  TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA     [RFC5932]
         * 0x00,0x89  TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA     [RFC5932]
         * 0x00,0x8A  TLS_PSK_WITH_RC4_128_SHA                  [RFC4279]
         * 0x00,0x8B  TLS_PSK_WITH_3DES_EDE_CBC_SHA             [RFC4279]
         * 0x00,0x8C  TLS_PSK_WITH_AES_128_CBC_SHA              [RFC4279]
         * 0x00,0x8D  TLS_PSK_WITH_AES_256_CBC_SHA              [RFC4279]
         * 0x00,0x8E  TLS_DHE_PSK_WITH_RC4_128_SHA              [RFC4279]
         * 0x00,0x8F  TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA         [RFC4279]
         * 0x00,0x90  TLS_DHE_PSK_WITH_AES_128_CBC_SHA          [RFC4279]
         * 0x00,0x91  TLS_DHE_PSK_WITH_AES_256_CBC_SHA          [RFC4279]
         * 0x00,0x92  TLS_RSA_PSK_WITH_RC4_128_SHA              [RFC4279]
         * 0x00,0x93  TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA         [RFC4279]
         * 0x00,0x94  TLS_RSA_PSK_WITH_AES_128_CBC_SHA          [RFC4279]
         * 0x00,0x95  TLS_RSA_PSK_WITH_AES_256_CBC_SHA          [RFC4279]
         * 0x00,0x96  TLS_RSA_WITH_SEED_CBC_SHA                 [RFC4162]
         * 0x00,0x97  TLS_DH_DSS_WITH_SEED_CBC_SHA              [RFC4162]
         * 0x00,0x98  TLS_DH_RSA_WITH_SEED_CBC_SHA              [RFC4162]
         * 0x00,0x99  TLS_DHE_DSS_WITH_SEED_CBC_SHA             [RFC4162]
         * 0x00,0x9A  TLS_DHE_RSA_WITH_SEED_CBC_SHA             [RFC4162]
         * 0x00,0x9B  TLS_DH_anon_WITH_SEED_CBC_SHA             [RFC4162]
         * 0x00,0x9C  TLS_RSA_WITH_AES_128_GCM_SHA256           [RFC5288]
         * 0x00,0x9D  TLS_RSA_WITH_AES_256_GCM_SHA384           [RFC5288]
         * 0x00,0x9E  TLS_DHE_RSA_WITH_AES_128_GCM_SHA256       [RFC5288]
         * 0x00,0x9F  TLS_DHE_RSA_WITH_AES_256_GCM_SHA384       [RFC5288]
         * 0x00,0xA0  TLS_DH_RSA_WITH_AES_128_GCM_SHA256        [RFC5288]
         * 0x00,0xA1  TLS_DH_RSA_WITH_AES_256_GCM_SHA384        [RFC5288]
         * 0x00,0xA2  TLS_DHE_DSS_WITH_AES_128_GCM_SHA256       [RFC5288]
         * 0x00,0xA3  TLS_DHE_DSS_WITH_AES_256_GCM_SHA384       [RFC5288]
         * 0x00,0xA4  TLS_DH_DSS_WITH_AES_128_GCM_SHA256        [RFC5288]
         * 0x00,0xA5  TLS_DH_DSS_WITH_AES_256_GCM_SHA384        [RFC5288]
         * 0x00,0xA6  TLS_DH_anon_WITH_AES_128_GCM_SHA256       [RFC5288]
         * 0x00,0xA7  TLS_DH_anon_WITH_AES_256_GCM_SHA384       [RFC5288]
         * 0x00,0xA8  TLS_PSK_WITH_AES_128_GCM_SHA256           [RFC5487]
         * 0x00,0xA9  TLS_PSK_WITH_AES_256_GCM_SHA384           [RFC5487]
         * 0x00,0xAA  TLS_DHE_PSK_WITH_AES_128_GCM_SHA256       [RFC5487]
         * 0x00,0xAB  TLS_DHE_PSK_WITH_AES_256_GCM_SHA384       [RFC5487]
         * 0x00,0xAC  TLS_RSA_PSK_WITH_AES_128_GCM_SHA256       [RFC5487]
         * 0x00,0xAD  TLS_RSA_PSK_WITH_AES_256_GCM_SHA384       [RFC5487]
         * 0x00,0xAE  TLS_PSK_WITH_AES_128_CBC_SHA256           [RFC5487]
         * 0x00,0xAF  TLS_PSK_WITH_AES_256_CBC_SHA384           [RFC5487]
         * 0x00,0xB0  TLS_PSK_WITH_NULL_SHA256                  [RFC5487]
         * 0x00,0xB1  TLS_PSK_WITH_NULL_SHA384                  [RFC5487]
         * 0x00,0xB2  TLS_DHE_PSK_WITH_AES_128_CBC_SHA256       [RFC5487]
         * 0x00,0xB3  TLS_DHE_PSK_WITH_AES_256_CBC_SHA384       [RFC5487]
         * 0x00,0xB4  TLS_DHE_PSK_WITH_NULL_SHA256              [RFC5487]
         * 0x00,0xB5  TLS_DHE_PSK_WITH_NULL_SHA384              [RFC5487]
         * 0x00,0xB6  TLS_RSA_PSK_WITH_AES_128_CBC_SHA256       [RFC5487]
         * 0x00,0xB7  TLS_RSA_PSK_WITH_AES_256_CBC_SHA384       [RFC5487]
         * 0x00,0xB8  TLS_RSA_PSK_WITH_NULL_SHA256              [RFC5487]
         * 0x00,0xB9  TLS_RSA_PSK_WITH_NULL_SHA384              [RFC5487]
         * 0x00,0xBA  TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256      [RFC5932]
         * 0x00,0xBB  TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256   [RFC5932]
         * 0x00,0xBC  TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256   [RFC5932]
         * 0x00,0xBD  TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256  [RFC5932]
         * 0x00,0xBE  TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256  [RFC5932]
         * 0x00,0xBF  TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256  [RFC5932]
         * 0x00,0xC0  TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256      [RFC5932]
         * 0x00,0xC1  TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256   [RFC5932]
         * 0x00,0xC2  TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256   [RFC5932]
         * 0x00,0xC3  TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256  [RFC5932]
         * 0x00,0xC4  TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256  [RFC5932]
         * 0x00,0xC5  TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256  [RFC5932]
         * 0x00,0xC6-FE         Unassigned
         * 0x00,0xFF  TLS_EMPTY_RENEGOTIATION_INFO_SCSV         [RFC5746]
         * 0x01-BF,*  Unassigned
         * 0xC0,0x01  TLS_ECDH_ECDSA_WITH_NULL_SHA              [RFC4492]
         * 0xC0,0x02  TLS_ECDH_ECDSA_WITH_RC4_128_SHA           [RFC4492]
         * 0xC0,0x03  TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA      [RFC4492]
         * 0xC0,0x04  TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA       [RFC4492]
         * 0xC0,0x05  TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA       [RFC4492]
         * 0xC0,0x06  TLS_ECDHE_ECDSA_WITH_NULL_SHA             [RFC4492]
         * 0xC0,0x07  TLS_ECDHE_ECDSA_WITH_RC4_128_SHA          [RFC4492]
         * 0xC0,0x08  TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA     [RFC4492]
         * 0xC0,0x09  TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA      [RFC4492]
         * 0xC0,0x0A  TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA      [RFC4492]
         * 0xC0,0x0B  TLS_ECDH_RSA_WITH_NULL_SHA                [RFC4492]
         * 0xC0,0x0C  TLS_ECDH_RSA_WITH_RC4_128_SHA             [RFC4492]
         * 0xC0,0x0D  TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA        [RFC4492]
         * 0xC0,0x0E  TLS_ECDH_RSA_WITH_AES_128_CBC_SHA         [RFC4492]
         * 0xC0,0x0F  TLS_ECDH_RSA_WITH_AES_256_CBC_SHA         [RFC4492]
         * 0xC0,0x10  TLS_ECDHE_RSA_WITH_NULL_SHA               [RFC4492]
         * 0xC0,0x11  TLS_ECDHE_RSA_WITH_RC4_128_SHA            [RFC4492]
         * 0xC0,0x12  TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA       [RFC4492]
         * 0xC0,0x13  TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA        [RFC4492]
         * 0xC0,0x14  TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA        [RFC4492]
         * 0xC0,0x15  TLS_ECDH_anon_WITH_NULL_SHA               [RFC4492]
         * 0xC0,0x16  TLS_ECDH_anon_WITH_RC4_128_SHA            [RFC4492]
         * 0xC0,0x17  TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA       [RFC4492]
         * 0xC0,0x18  TLS_ECDH_anon_WITH_AES_128_CBC_SHA        [RFC4492]
         * 0xC0,0x19  TLS_ECDH_anon_WITH_AES_256_CBC_SHA        [RFC4492]
         * 0xC0,0x1A  TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA         [RFC5054]
         * 0xC0,0x1B  TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA     [RFC5054]
         * 0xC0,0x1C  TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA     [RFC5054]
         * 0xC0,0x1D  TLS_SRP_SHA_WITH_AES_128_CBC_SHA          [RFC5054]
         * 0xC0,0x1E  TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA      [RFC5054]
         * 0xC0,0x1F  TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA      [RFC5054]
         * 0xC0,0x20  TLS_SRP_SHA_WITH_AES_256_CBC_SHA          [RFC5054]
         * 0xC0,0x21  TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA      [RFC5054]
         * 0xC0,0x22  TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA      [RFC5054]
         * 0xC0,0x23  TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256   [RFC5289]
         * 0xC0,0x24  TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384   [RFC5289]
         * 0xC0,0x25  TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256    [RFC5289]
         * 0xC0,0x26  TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384    [RFC5289]
         * 0xC0,0x27  TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256     [RFC5289]
         * 0xC0,0x28  TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384     [RFC5289]
         * 0xC0,0x29  TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256      [RFC5289]
         * 0xC0,0x2A  TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384      [RFC5289]
         * 0xC0,0x2B  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256   [RFC5289]
         * 0xC0,0x2C  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384   [RFC5289]
         * 0xC0,0x2D  TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256    [RFC5289]
         * 0xC0,0x2E  TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384    [RFC5289]
         * 0xC0,0x2F  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256     [RFC5289]
         * 0xC0,0x30  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384     [RFC5289]
         * 0xC0,0x31  TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256      [RFC5289]
         * 0xC0,0x32  TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384      [RFC5289]
         * 0xC0,0x33  TLS_ECDHE_PSK_WITH_RC4_128_SHA            [RFC5489]
         * 0xC0,0x34  TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA       [RFC5489]
         * 0xC0,0x35  TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA        [RFC5489]
         * 0xC0,0x36  TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA        [RFC5489]
         * 0xC0,0x37  TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256     [RFC5489]
         * 0xC0,0x38  TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384     [RFC5489]
         * 0xC0,0x39  TLS_ECDHE_PSK_WITH_NULL_SHA               [RFC5489]
         * 0xC0,0x3A  TLS_ECDHE_PSK_WITH_NULL_SHA256            [RFC5489]
         * 0xC0,0x3B  TLS_ECDHE_PSK_WITH_NULL_SHA384            [RFC5489]
         * 0xC0,0x3C-FF Unassigned
         * 0xC1-FD,*  Unassigned
         * 0xFE,0x00-FD Unassigned
         * 0xFE,0xFE-FF Reserved to avoid conflicts with widely
         *            deployed implementations                  [Pasi_Eronen]
         * 0xFF,0x00-FF Reserved for Private Use                [RFC5246]
         */

<span class="nc" id="L961">        add(&quot;SSL_NULL_WITH_NULL_NULL&quot;,</span>
                              0x0000,   1, K_NULL,       B_NULL,    F);

        /*
         * Definition of the CipherSuites that are enabled by default.
         * They are listed in preference order, most preferred first, using
         * the following criteria:
         * 1. Prefer Suite B compliant cipher suites, see RFC6460 (To be
         *    changed later, see below).
         * 2. Prefer the stronger bulk cipher, in the order of AES_256(GCM),
         *    AES_128(GCM), AES_256, AES_128, RC-4, 3DES-EDE.
         * 3. Prefer the stronger MAC algorithm, in the order of SHA384,
         *    SHA256, SHA, MD5.
         * 4. Prefer the better performance of key exchange and digital
         *    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
         *    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS.
         */
<span class="nc" id="L978">        int p = DEFAULT_SUITES_PRIORITY * 2;</span>

        // shorten names to fit the following table cleanly.
<span class="nc" id="L981">        int max = ProtocolVersion.LIMIT_MAX_VALUE;</span>
<span class="nc" id="L982">        int tls11 = ProtocolVersion.TLS11.v;</span>
<span class="nc" id="L983">        int tls12 = ProtocolVersion.TLS12.v;</span>

        //  ID           Key Exchange   Cipher     A  obs  suprt  PRF
        //  ======       ============   =========  =  ===  =====  ========


        // Placeholder for cipher suites in GCM mode.
        //
        // For better compatibility and interoperability, we decrease the
        // priority of cipher suites in GCM mode for a while as GCM
        // technologies mature in the industry.  Eventually we'll move
        // the GCM suites here.

        // AES_256(CBC)
<span class="nc" id="L997">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
            0xc024, --p, K_ECDHE_ECDSA, B_AES_256, T, max, tls12, P_SHA384);
<span class="nc" id="L999">        add(&quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
            0xc028, --p, K_ECDHE_RSA,   B_AES_256, T, max, tls12, P_SHA384);
<span class="nc" id="L1001">        add(&quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
            0x003d, --p, K_RSA,         B_AES_256, T, max, tls12, P_SHA256);
<span class="nc" id="L1003">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
            0xc026, --p, K_ECDH_ECDSA,  B_AES_256, T, max, tls12, P_SHA384);
<span class="nc" id="L1005">        add(&quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
            0xc02a, --p, K_ECDH_RSA,    B_AES_256, T, max, tls12, P_SHA384);
<span class="nc" id="L1007">        add(&quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
            0x006b, --p, K_DHE_RSA,     B_AES_256, T, max, tls12, P_SHA256);
<span class="nc" id="L1009">        add(&quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
            0x006a, --p, K_DHE_DSS,     B_AES_256, T, max, tls12, P_SHA256);

<span class="nc" id="L1012">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0xC00A, --p, K_ECDHE_ECDSA, B_AES_256, T);
<span class="nc" id="L1014">        add(&quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0xC014, --p, K_ECDHE_RSA,   B_AES_256, T);
<span class="nc" id="L1016">        add(&quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0x0035, --p, K_RSA,         B_AES_256, T);
<span class="nc" id="L1018">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0xC005, --p, K_ECDH_ECDSA,  B_AES_256, T);
<span class="nc" id="L1020">        add(&quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0xC00F, --p, K_ECDH_RSA,    B_AES_256, T);
<span class="nc" id="L1022">        add(&quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
            0x0039, --p, K_DHE_RSA,     B_AES_256, T);
<span class="nc" id="L1024">        add(&quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
            0x0038, --p, K_DHE_DSS,     B_AES_256, T);

        // AES_128(CBC)
<span class="nc" id="L1028">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0xc023, --p, K_ECDHE_ECDSA, B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1030">        add(&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0xc027, --p, K_ECDHE_RSA,   B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1032">        add(&quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0x003c, --p, K_RSA,         B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1034">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0xc025, --p, K_ECDH_ECDSA,  B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1036">        add(&quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0xc029, --p, K_ECDH_RSA,    B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1038">        add(&quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
            0x0067, --p, K_DHE_RSA,     B_AES_128, T, max, tls12, P_SHA256);
<span class="nc" id="L1040">        add(&quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,</span>
            0x0040, --p, K_DHE_DSS,     B_AES_128, T, max, tls12, P_SHA256);

<span class="nc" id="L1043">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0xC009, --p, K_ECDHE_ECDSA, B_AES_128, T);
<span class="nc" id="L1045">        add(&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0xC013, --p, K_ECDHE_RSA,   B_AES_128, T);
<span class="nc" id="L1047">        add(&quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0x002f, --p, K_RSA,         B_AES_128, T);
<span class="nc" id="L1049">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0xC004, --p, K_ECDH_ECDSA,  B_AES_128, T);
<span class="nc" id="L1051">        add(&quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0xC00E, --p, K_ECDH_RSA,    B_AES_128, T);
<span class="nc" id="L1053">        add(&quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
            0x0033, --p, K_DHE_RSA,     B_AES_128, T);
<span class="nc" id="L1055">        add(&quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,</span>
            0x0032, --p, K_DHE_DSS,     B_AES_128, T);

        // RC-4
<span class="nc" id="L1059">        add(&quot;TLS_ECDHE_ECDSA_WITH_RC4_128_SHA&quot;,</span>
            0xC007, --p, K_ECDHE_ECDSA, B_RC4_128, N);
<span class="nc" id="L1061">        add(&quot;TLS_ECDHE_RSA_WITH_RC4_128_SHA&quot;,</span>
            0xC011, --p, K_ECDHE_RSA,   B_RC4_128, N);
<span class="nc" id="L1063">        add(&quot;SSL_RSA_WITH_RC4_128_SHA&quot;,</span>
            0x0005, --p, K_RSA,         B_RC4_128, N);
<span class="nc" id="L1065">        add(&quot;TLS_ECDH_ECDSA_WITH_RC4_128_SHA&quot;,</span>
            0xC002, --p, K_ECDH_ECDSA,  B_RC4_128, N);
<span class="nc" id="L1067">        add(&quot;TLS_ECDH_RSA_WITH_RC4_128_SHA&quot;,</span>
            0xC00C, --p, K_ECDH_RSA,    B_RC4_128, N);

        // Cipher suites in GCM mode, see RFC 5288/5289.
        //
        // We may increase the priority of cipher suites in GCM mode when
        // GCM technologies become mature in the industry.

        // Suite B compliant cipher suites, see RFC 6460.
        //
        // Note that, at present this provider is not Suite B compliant. The
        // preference order of the GCM cipher suites does not follow the spec
        // of RFC 6460.
<span class="nc" id="L1080">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0xc02c, --p, K_ECDHE_ECDSA, B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1082">        add(&quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0xc02b, --p, K_ECDHE_ECDSA, B_AES_128_GCM, T, max, tls12, P_SHA256);

        // AES_256(GCM)
<span class="nc" id="L1086">        add(&quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0xc030, --p, K_ECDHE_RSA,   B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1088">        add(&quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0x009d, --p, K_RSA,         B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1090">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0xc02e, --p, K_ECDH_ECDSA,  B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1092">        add(&quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0xc032, --p, K_ECDH_RSA,    B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1094">        add(&quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
            0x009f, --p, K_DHE_RSA,     B_AES_256_GCM, T, max, tls12, P_SHA384);
<span class="nc" id="L1096">        add(&quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;,</span>
            0x00a3, --p, K_DHE_DSS,     B_AES_256_GCM, T, max, tls12, P_SHA384);

        // AES_128(GCM)
<span class="nc" id="L1100">        add(&quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0xc02f, --p, K_ECDHE_RSA,   B_AES_128_GCM, T, max, tls12, P_SHA256);
<span class="nc" id="L1102">        add(&quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0x009c, --p, K_RSA,         B_AES_128_GCM, T, max, tls12, P_SHA256);
<span class="nc" id="L1104">        add(&quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0xc02d, --p, K_ECDH_ECDSA,  B_AES_128_GCM, T, max, tls12, P_SHA256);
<span class="nc" id="L1106">        add(&quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0xc031, --p, K_ECDH_RSA,    B_AES_128_GCM, T, max, tls12, P_SHA256);
<span class="nc" id="L1108">        add(&quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
            0x009e, --p, K_DHE_RSA,     B_AES_128_GCM, T, max, tls12, P_SHA256);
<span class="nc" id="L1110">        add(&quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,</span>
            0x00a2, --p, K_DHE_DSS,     B_AES_128_GCM, T, max, tls12, P_SHA256);
        // End of cipher suites in GCM mode.

        // 3DES_EDE
<span class="nc" id="L1115">        add(&quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0xC008, --p, K_ECDHE_ECDSA, B_3DES,    T);
<span class="nc" id="L1117">        add(&quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0xC012, --p, K_ECDHE_RSA,   B_3DES,    T);
<span class="nc" id="L1119">        add(&quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0x000a, --p, K_RSA,         B_3DES,    T);
<span class="nc" id="L1121">        add(&quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0xC003, --p, K_ECDH_ECDSA,  B_3DES,    T);
<span class="nc" id="L1123">        add(&quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0xC00D, --p, K_ECDH_RSA,    B_3DES,    T);
<span class="nc" id="L1125">        add(&quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0x0016, --p, K_DHE_RSA,     B_3DES,    T);
<span class="nc" id="L1127">        add(&quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0x0013, --p, K_DHE_DSS,     B_3DES,    N);

<span class="nc" id="L1130">        add(&quot;SSL_RSA_WITH_RC4_128_MD5&quot;,</span>
            0x0004, --p, K_RSA,         B_RC4_128, N);

        // Renegotiation protection request Signalling Cipher Suite Value (SCSV)
<span class="nc" id="L1134">        add(&quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;,</span>
            0x00ff, --p, K_SCSV,        B_NULL,    T);

        /*
         * Definition of the CipherSuites that are supported but not enabled
         * by default.
         * They are listed in preference order, preferred first, using the
         * following criteria:
         * 1. CipherSuites for KRB5 need additional KRB5 service
         *    configuration, and these suites are not common in practice,
         *    so we put KRB5 based cipher suites at the end of the supported
         *    list.
         * 2. If a cipher suite has been obsoleted, we put it at the end of
         *    the list.
         * 3. Prefer the stronger bulk cipher, in the order of AES_256,
         *    AES_128, RC-4, 3DES-EDE, DES, RC4_40, DES40, NULL.
         * 4. Prefer the stronger MAC algorithm, in the order of SHA384,
         *    SHA256, SHA, MD5.
         * 5. Prefer the better performance of key exchange and digital
         *    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
         *    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS, anonymous.
         */
<span class="nc" id="L1156">        p = DEFAULT_SUITES_PRIORITY;</span>

<span class="nc" id="L1158">        add(&quot;TLS_DH_anon_WITH_AES_256_GCM_SHA384&quot;,</span>
            0x00a7, --p, K_DH_ANON,     B_AES_256_GCM, N, max, tls12, P_SHA384);
<span class="nc" id="L1160">        add(&quot;TLS_DH_anon_WITH_AES_128_GCM_SHA256&quot;,</span>
            0x00a6, --p, K_DH_ANON,     B_AES_128_GCM, N, max, tls12, P_SHA256);

<span class="nc" id="L1163">        add(&quot;TLS_DH_anon_WITH_AES_256_CBC_SHA256&quot;,</span>
            0x006d, --p, K_DH_ANON,     B_AES_256, N, max, tls12, P_SHA256);
<span class="nc" id="L1165">        add(&quot;TLS_ECDH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
            0xC019, --p, K_ECDH_ANON,   B_AES_256, N);
<span class="nc" id="L1167">        add(&quot;TLS_DH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
            0x003a, --p, K_DH_ANON,     B_AES_256, N);

<span class="nc" id="L1170">        add(&quot;TLS_DH_anon_WITH_AES_128_CBC_SHA256&quot;,</span>
            0x006c, --p, K_DH_ANON,     B_AES_128, N, max, tls12, P_SHA256);
<span class="nc" id="L1172">        add(&quot;TLS_ECDH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
            0xC018, --p, K_ECDH_ANON,   B_AES_128, N);
<span class="nc" id="L1174">        add(&quot;TLS_DH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
            0x0034, --p, K_DH_ANON,     B_AES_128, N);

<span class="nc" id="L1177">        add(&quot;TLS_ECDH_anon_WITH_RC4_128_SHA&quot;,</span>
            0xC016, --p, K_ECDH_ANON,   B_RC4_128, N);
<span class="nc" id="L1179">        add(&quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,</span>
            0x0018, --p, K_DH_ANON,     B_RC4_128, N);

<span class="nc" id="L1182">        add(&quot;TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0xC017, --p, K_ECDH_ANON,   B_3DES,    N);
<span class="nc" id="L1184">        add(&quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0x001b, --p, K_DH_ANON,     B_3DES,    N);

<span class="nc" id="L1187">        add(&quot;TLS_RSA_WITH_NULL_SHA256&quot;,</span>
            0x003b, --p, K_RSA,         B_NULL,    N, max, tls12, P_SHA256);
<span class="nc" id="L1189">        add(&quot;TLS_ECDHE_ECDSA_WITH_NULL_SHA&quot;,</span>
            0xC006, --p, K_ECDHE_ECDSA, B_NULL,    N);
<span class="nc" id="L1191">        add(&quot;TLS_ECDHE_RSA_WITH_NULL_SHA&quot;,</span>
            0xC010, --p, K_ECDHE_RSA,   B_NULL,    N);
<span class="nc" id="L1193">        add(&quot;SSL_RSA_WITH_NULL_SHA&quot;,</span>
            0x0002, --p, K_RSA,         B_NULL,    N);
<span class="nc" id="L1195">        add(&quot;TLS_ECDH_ECDSA_WITH_NULL_SHA&quot;,</span>
            0xC001, --p, K_ECDH_ECDSA,  B_NULL,    N);
<span class="nc" id="L1197">        add(&quot;TLS_ECDH_RSA_WITH_NULL_SHA&quot;,</span>
            0xC00B, --p, K_ECDH_RSA,    B_NULL,    N);
<span class="nc" id="L1199">        add(&quot;TLS_ECDH_anon_WITH_NULL_SHA&quot;,</span>
            0xC015, --p, K_ECDH_ANON,   B_NULL,    N);
<span class="nc" id="L1201">        add(&quot;SSL_RSA_WITH_NULL_MD5&quot;,</span>
            0x0001, --p, K_RSA,         B_NULL,    N);

        // weak cipher suites obsoleted in TLS 1.2
<span class="nc" id="L1205">        add(&quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,</span>
            0x0009, --p, K_RSA,         B_DES,     N, tls12);
<span class="nc" id="L1207">        add(&quot;SSL_DHE_RSA_WITH_DES_CBC_SHA&quot;,</span>
            0x0015, --p, K_DHE_RSA,     B_DES,     N, tls12);
<span class="nc" id="L1209">        add(&quot;SSL_DHE_DSS_WITH_DES_CBC_SHA&quot;,</span>
            0x0012, --p, K_DHE_DSS,     B_DES,     N, tls12);
<span class="nc" id="L1211">        add(&quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,</span>
            0x001a, --p, K_DH_ANON,     B_DES,     N, tls12);

        // weak cipher suites obsoleted in TLS 1.1
<span class="nc" id="L1215">        add(&quot;SSL_RSA_EXPORT_WITH_RC4_40_MD5&quot;,</span>
            0x0003, --p, K_RSA_EXPORT,  B_RC4_40,  N, tls11);
<span class="nc" id="L1217">        add(&quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,</span>
            0x0017, --p, K_DH_ANON,     B_RC4_40,  N, tls11);

<span class="nc" id="L1220">        add(&quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
            0x0008, --p, K_RSA_EXPORT,  B_DES_40,  N, tls11);
<span class="nc" id="L1222">        add(&quot;SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
            0x0014, --p, K_DHE_RSA,     B_DES_40,  N, tls11);
<span class="nc" id="L1224">        add(&quot;SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
            0x0011, --p, K_DHE_DSS,     B_DES_40,  N, tls11);
<span class="nc" id="L1226">        add(&quot;SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
            0x0019, --p, K_DH_ANON,     B_DES_40,  N, tls11);

        // Supported Kerberos ciphersuites from RFC2712
<span class="nc" id="L1230">        add(&quot;TLS_KRB5_WITH_RC4_128_SHA&quot;,</span>
            0x0020, --p, K_KRB5,        B_RC4_128, N);
<span class="nc" id="L1232">        add(&quot;TLS_KRB5_WITH_RC4_128_MD5&quot;,</span>
            0x0024, --p, K_KRB5,        B_RC4_128, N);
<span class="nc" id="L1234">        add(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_SHA&quot;,</span>
            0x001f, --p, K_KRB5,        B_3DES,    N);
<span class="nc" id="L1236">        add(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_MD5&quot;,</span>
            0x0023, --p, K_KRB5,        B_3DES,    N);
<span class="nc" id="L1238">        add(&quot;TLS_KRB5_WITH_DES_CBC_SHA&quot;,</span>
            0x001e, --p, K_KRB5,        B_DES,     N, tls12);
<span class="nc" id="L1240">        add(&quot;TLS_KRB5_WITH_DES_CBC_MD5&quot;,</span>
            0x0022, --p, K_KRB5,        B_DES,     N, tls12);
<span class="nc" id="L1242">        add(&quot;TLS_KRB5_EXPORT_WITH_RC4_40_SHA&quot;,</span>
            0x0028, --p, K_KRB5_EXPORT, B_RC4_40,  N, tls11);
<span class="nc" id="L1244">        add(&quot;TLS_KRB5_EXPORT_WITH_RC4_40_MD5&quot;,</span>
            0x002b, --p, K_KRB5_EXPORT, B_RC4_40,  N, tls11);
<span class="nc" id="L1246">        add(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA&quot;,</span>
            0x0026, --p, K_KRB5_EXPORT, B_DES_40,  N, tls11);
<span class="nc" id="L1248">        add(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5&quot;,</span>
            0x0029, --p, K_KRB5_EXPORT, B_DES_40,  N, tls11);

        /*
         * Other values from the TLS Cipher Suite Registry, as of August 2010.
         *
         * http://www.iana.org/assignments/tls-parameters/tls-parameters.xml
         *
         * Range      Registration Procedures   Notes
         * 000-191    Standards Action          Refers to value of first byte
         * 192-254    Specification Required    Refers to value of first byte
         * 255        Reserved for Private Use  Refers to value of first byte
         */

        // Register the names of a few additional CipherSuites.
        // Makes them show up as names instead of numbers in
        // the debug output.

        // remaining unsupported ciphersuites defined in RFC2246.
<span class="nc" id="L1267">        add(&quot;SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5&quot;,          0x0006);</span>
<span class="nc" id="L1268">        add(&quot;SSL_RSA_WITH_IDEA_CBC_SHA&quot;,                   0x0007);</span>
<span class="nc" id="L1269">        add(&quot;SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,        0x000b);</span>
<span class="nc" id="L1270">        add(&quot;SSL_DH_DSS_WITH_DES_CBC_SHA&quot;,                 0x000c);</span>
<span class="nc" id="L1271">        add(&quot;SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA&quot;,            0x000d);</span>
<span class="nc" id="L1272">        add(&quot;SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,        0x000e);</span>
<span class="nc" id="L1273">        add(&quot;SSL_DH_RSA_WITH_DES_CBC_SHA&quot;,                 0x000f);</span>
<span class="nc" id="L1274">        add(&quot;SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,            0x0010);</span>

        // SSL 3.0 Fortezza ciphersuites
<span class="nc" id="L1277">        add(&quot;SSL_FORTEZZA_DMS_WITH_NULL_SHA&quot;,              0x001c);</span>
<span class="nc" id="L1278">        add(&quot;SSL_FORTEZZA_DMS_WITH_FORTEZZA_CBC_SHA&quot;,      0x001d);</span>

        // 1024/56 bit exportable ciphersuites from expired internet draft
<span class="nc" id="L1281">        add(&quot;SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA&quot;,         0x0062);</span>
<span class="nc" id="L1282">        add(&quot;SSL_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA&quot;,     0x0063);</span>
<span class="nc" id="L1283">        add(&quot;SSL_RSA_EXPORT1024_WITH_RC4_56_SHA&quot;,          0x0064);</span>
<span class="nc" id="L1284">        add(&quot;SSL_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA&quot;,      0x0065);</span>
<span class="nc" id="L1285">        add(&quot;SSL_DHE_DSS_WITH_RC4_128_SHA&quot;,                0x0066);</span>

        // Netscape old and new SSL 3.0 FIPS ciphersuites
        // see http://www.mozilla.org/projects/security/pki/nss/ssl/fips-ssl-ciphersuites.html
<span class="nc" id="L1289">        add(&quot;NETSCAPE_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,     0xffe0);</span>
<span class="nc" id="L1290">        add(&quot;NETSCAPE_RSA_FIPS_WITH_DES_CBC_SHA&quot;,          0xffe1);</span>
<span class="nc" id="L1291">        add(&quot;SSL_RSA_FIPS_WITH_DES_CBC_SHA&quot;,               0xfefe);</span>
<span class="nc" id="L1292">        add(&quot;SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,          0xfeff);</span>

        // Unsupported Kerberos cipher suites from RFC 2712
<span class="nc" id="L1295">        add(&quot;TLS_KRB5_WITH_IDEA_CBC_SHA&quot;,                  0x0021);</span>
<span class="nc" id="L1296">        add(&quot;TLS_KRB5_WITH_IDEA_CBC_MD5&quot;,                  0x0025);</span>
<span class="nc" id="L1297">        add(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA&quot;,         0x0027);</span>
<span class="nc" id="L1298">        add(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5&quot;,         0x002a);</span>

        // Unsupported cipher suites from RFC 4162
<span class="nc" id="L1301">        add(&quot;TLS_RSA_WITH_SEED_CBC_SHA&quot;,                   0x0096);</span>
<span class="nc" id="L1302">        add(&quot;TLS_DH_DSS_WITH_SEED_CBC_SHA&quot;,                0x0097);</span>
<span class="nc" id="L1303">        add(&quot;TLS_DH_RSA_WITH_SEED_CBC_SHA&quot;,                0x0098);</span>
<span class="nc" id="L1304">        add(&quot;TLS_DHE_DSS_WITH_SEED_CBC_SHA&quot;,               0x0099);</span>
<span class="nc" id="L1305">        add(&quot;TLS_DHE_RSA_WITH_SEED_CBC_SHA&quot;,               0x009a);</span>
<span class="nc" id="L1306">        add(&quot;TLS_DH_anon_WITH_SEED_CBC_SHA&quot;,               0x009b);</span>

        // Unsupported cipher suites from RFC 4279
<span class="nc" id="L1309">        add(&quot;TLS_PSK_WITH_RC4_128_SHA&quot;,                    0x008a);</span>
<span class="nc" id="L1310">        add(&quot;TLS_PSK_WITH_3DES_EDE_CBC_SHA&quot;,               0x008b);</span>
<span class="nc" id="L1311">        add(&quot;TLS_PSK_WITH_AES_128_CBC_SHA&quot;,                0x008c);</span>
<span class="nc" id="L1312">        add(&quot;TLS_PSK_WITH_AES_256_CBC_SHA&quot;,                0x008d);</span>
<span class="nc" id="L1313">        add(&quot;TLS_DHE_PSK_WITH_RC4_128_SHA&quot;,                0x008e);</span>
<span class="nc" id="L1314">        add(&quot;TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA&quot;,           0x008f);</span>
<span class="nc" id="L1315">        add(&quot;TLS_DHE_PSK_WITH_AES_128_CBC_SHA&quot;,            0x0090);</span>
<span class="nc" id="L1316">        add(&quot;TLS_DHE_PSK_WITH_AES_256_CBC_SHA&quot;,            0x0091);</span>
<span class="nc" id="L1317">        add(&quot;TLS_RSA_PSK_WITH_RC4_128_SHA&quot;,                0x0092);</span>
<span class="nc" id="L1318">        add(&quot;TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA&quot;,           0x0093);</span>
<span class="nc" id="L1319">        add(&quot;TLS_RSA_PSK_WITH_AES_128_CBC_SHA&quot;,            0x0094);</span>
<span class="nc" id="L1320">        add(&quot;TLS_RSA_PSK_WITH_AES_256_CBC_SHA&quot;,            0x0095);</span>

        // Unsupported cipher suites from RFC 4785
<span class="nc" id="L1323">        add(&quot;TLS_PSK_WITH_NULL_SHA&quot;,                       0x002c);</span>
<span class="nc" id="L1324">        add(&quot;TLS_DHE_PSK_WITH_NULL_SHA&quot;,                   0x002d);</span>
<span class="nc" id="L1325">        add(&quot;TLS_RSA_PSK_WITH_NULL_SHA&quot;,                   0x002e);</span>

        // Unsupported cipher suites from RFC 5246
<span class="nc" id="L1328">        add(&quot;TLS_DH_DSS_WITH_AES_128_CBC_SHA&quot;,             0x0030);</span>
<span class="nc" id="L1329">        add(&quot;TLS_DH_RSA_WITH_AES_128_CBC_SHA&quot;,             0x0031);</span>
<span class="nc" id="L1330">        add(&quot;TLS_DH_DSS_WITH_AES_256_CBC_SHA&quot;,             0x0036);</span>
<span class="nc" id="L1331">        add(&quot;TLS_DH_RSA_WITH_AES_256_CBC_SHA&quot;,             0x0037);</span>
<span class="nc" id="L1332">        add(&quot;TLS_DH_DSS_WITH_AES_128_CBC_SHA256&quot;,          0x003e);</span>
<span class="nc" id="L1333">        add(&quot;TLS_DH_RSA_WITH_AES_128_CBC_SHA256&quot;,          0x003f);</span>
<span class="nc" id="L1334">        add(&quot;TLS_DH_DSS_WITH_AES_256_CBC_SHA256&quot;,          0x0068);</span>
<span class="nc" id="L1335">        add(&quot;TLS_DH_RSA_WITH_AES_256_CBC_SHA256&quot;,          0x0069);</span>

        // Unsupported cipher suites from RFC 5288
<span class="nc" id="L1338">        add(&quot;TLS_DH_RSA_WITH_AES_128_GCM_SHA256&quot;,          0x00a0);</span>
<span class="nc" id="L1339">        add(&quot;TLS_DH_RSA_WITH_AES_256_GCM_SHA384&quot;,          0x00a1);</span>
<span class="nc" id="L1340">        add(&quot;TLS_DH_DSS_WITH_AES_128_GCM_SHA256&quot;,          0x00a4);</span>
<span class="nc" id="L1341">        add(&quot;TLS_DH_DSS_WITH_AES_256_GCM_SHA384&quot;,          0x00a5);</span>

        // Unsupported cipher suites from RFC 5487
<span class="nc" id="L1344">        add(&quot;TLS_PSK_WITH_AES_128_GCM_SHA256&quot;,             0x00a8);</span>
<span class="nc" id="L1345">        add(&quot;TLS_PSK_WITH_AES_256_GCM_SHA384&quot;,             0x00a9);</span>
<span class="nc" id="L1346">        add(&quot;TLS_DHE_PSK_WITH_AES_128_GCM_SHA256&quot;,         0x00aa);</span>
<span class="nc" id="L1347">        add(&quot;TLS_DHE_PSK_WITH_AES_256_GCM_SHA384&quot;,         0x00ab);</span>
<span class="nc" id="L1348">        add(&quot;TLS_RSA_PSK_WITH_AES_128_GCM_SHA256&quot;,         0x00ac);</span>
<span class="nc" id="L1349">        add(&quot;TLS_RSA_PSK_WITH_AES_256_GCM_SHA384&quot;,         0x00ad);</span>
<span class="nc" id="L1350">        add(&quot;TLS_PSK_WITH_AES_128_CBC_SHA256&quot;,             0x00ae);</span>
<span class="nc" id="L1351">        add(&quot;TLS_PSK_WITH_AES_256_CBC_SHA384&quot;,             0x00af);</span>
<span class="nc" id="L1352">        add(&quot;TLS_PSK_WITH_NULL_SHA256&quot;,                    0x00b0);</span>
<span class="nc" id="L1353">        add(&quot;TLS_PSK_WITH_NULL_SHA384&quot;,                    0x00b1);</span>
<span class="nc" id="L1354">        add(&quot;TLS_DHE_PSK_WITH_AES_128_CBC_SHA256&quot;,         0x00b2);</span>
<span class="nc" id="L1355">        add(&quot;TLS_DHE_PSK_WITH_AES_256_CBC_SHA384&quot;,         0x00b3);</span>
<span class="nc" id="L1356">        add(&quot;TLS_DHE_PSK_WITH_NULL_SHA256&quot;,                0x00b4);</span>
<span class="nc" id="L1357">        add(&quot;TLS_DHE_PSK_WITH_NULL_SHA384&quot;,                0x00b5);</span>
<span class="nc" id="L1358">        add(&quot;TLS_RSA_PSK_WITH_AES_128_CBC_SHA256&quot;,         0x00b6);</span>
<span class="nc" id="L1359">        add(&quot;TLS_RSA_PSK_WITH_AES_256_CBC_SHA384&quot;,         0x00b7);</span>
<span class="nc" id="L1360">        add(&quot;TLS_RSA_PSK_WITH_NULL_SHA256&quot;,                0x00b8);</span>
<span class="nc" id="L1361">        add(&quot;TLS_RSA_PSK_WITH_NULL_SHA384&quot;,                0x00b9);</span>

        // Unsupported cipher suites from RFC 5932
<span class="nc" id="L1364">        add(&quot;TLS_RSA_WITH_CAMELLIA_128_CBC_SHA&quot;,           0x0041);</span>
<span class="nc" id="L1365">        add(&quot;TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA&quot;,        0x0042);</span>
<span class="nc" id="L1366">        add(&quot;TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA&quot;,        0x0043);</span>
<span class="nc" id="L1367">        add(&quot;TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA&quot;,       0x0044);</span>
<span class="nc" id="L1368">        add(&quot;TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA&quot;,       0x0045);</span>
<span class="nc" id="L1369">        add(&quot;TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA&quot;,       0x0046);</span>
<span class="nc" id="L1370">        add(&quot;TLS_RSA_WITH_CAMELLIA_256_CBC_SHA&quot;,           0x0084);</span>
<span class="nc" id="L1371">        add(&quot;TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA&quot;,        0x0085);</span>
<span class="nc" id="L1372">        add(&quot;TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA&quot;,        0x0086);</span>
<span class="nc" id="L1373">        add(&quot;TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA&quot;,       0x0087);</span>
<span class="nc" id="L1374">        add(&quot;TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA&quot;,       0x0088);</span>
<span class="nc" id="L1375">        add(&quot;TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA&quot;,       0x0089);</span>
<span class="nc" id="L1376">        add(&quot;TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256&quot;,        0x00ba);</span>
<span class="nc" id="L1377">        add(&quot;TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256&quot;,     0x00bb);</span>
<span class="nc" id="L1378">        add(&quot;TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256&quot;,     0x00bc);</span>
<span class="nc" id="L1379">        add(&quot;TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256&quot;,    0x00bd);</span>
<span class="nc" id="L1380">        add(&quot;TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256&quot;,    0x00be);</span>
<span class="nc" id="L1381">        add(&quot;TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256&quot;,    0x00bf);</span>
<span class="nc" id="L1382">        add(&quot;TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256&quot;,        0x00c0);</span>
<span class="nc" id="L1383">        add(&quot;TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256&quot;,     0x00c1);</span>
<span class="nc" id="L1384">        add(&quot;TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256&quot;,     0x00c2);</span>
<span class="nc" id="L1385">        add(&quot;TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256&quot;,    0x00c3);</span>
<span class="nc" id="L1386">        add(&quot;TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256&quot;,    0x00c4);</span>
<span class="nc" id="L1387">        add(&quot;TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256&quot;,    0x00c5);</span>

        // Unsupported cipher suites from RFC 5054
<span class="nc" id="L1390">        add(&quot;TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA&quot;,           0xc01a);</span>
<span class="nc" id="L1391">        add(&quot;TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA&quot;,       0xc01b);</span>
<span class="nc" id="L1392">        add(&quot;TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA&quot;,       0xc01c);</span>
<span class="nc" id="L1393">        add(&quot;TLS_SRP_SHA_WITH_AES_128_CBC_SHA&quot;,            0xc01d);</span>
<span class="nc" id="L1394">        add(&quot;TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA&quot;,        0xc01e);</span>
<span class="nc" id="L1395">        add(&quot;TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA&quot;,        0xc01f);</span>
<span class="nc" id="L1396">        add(&quot;TLS_SRP_SHA_WITH_AES_256_CBC_SHA&quot;,            0xc020);</span>
<span class="nc" id="L1397">        add(&quot;TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA&quot;,        0xc021);</span>
<span class="nc" id="L1398">        add(&quot;TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA&quot;,        0xc022);</span>

        // Unsupported cipher suites from RFC 5489
<span class="nc" id="L1401">        add(&quot;TLS_ECDHE_PSK_WITH_RC4_128_SHA&quot;,              0xc033);</span>
<span class="nc" id="L1402">        add(&quot;TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA&quot;,         0xc034);</span>
<span class="nc" id="L1403">        add(&quot;TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA&quot;,          0xc035);</span>
<span class="nc" id="L1404">        add(&quot;TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA&quot;,          0xc036);</span>
<span class="nc" id="L1405">        add(&quot;TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256&quot;,       0xc037);</span>
<span class="nc" id="L1406">        add(&quot;TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384&quot;,       0xc038);</span>
<span class="nc" id="L1407">        add(&quot;TLS_ECDHE_PSK_WITH_NULL_SHA&quot;,                 0xc039);</span>
<span class="nc" id="L1408">        add(&quot;TLS_ECDHE_PSK_WITH_NULL_SHA256&quot;,              0xc03a);</span>
<span class="nc" id="L1409">        add(&quot;TLS_ECDHE_PSK_WITH_NULL_SHA384&quot;,              0xc03b);</span>
    }

    // ciphersuite SSL_NULL_WITH_NULL_NULL
<span class="nc" id="L1413">    final static CipherSuite C_NULL = CipherSuite.valueOf(0, 0);</span>

    // ciphersuite TLS_EMPTY_RENEGOTIATION_INFO_SCSV
<span class="nc" id="L1416">    final static CipherSuite C_SCSV = CipherSuite.valueOf(0x00, 0xff);</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>