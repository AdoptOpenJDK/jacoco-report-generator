<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>JRELocaleProviderAdapter.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">sun.util.locale.provider</a> &gt; <span class="el_source">JRELocaleProviderAdapter.java</span></div><h1>JRELocaleProviderAdapter.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package sun.util.locale.provider;

import java.io.File;
import java.security.AccessController;
import java.security.PrivilegedAction;
import java.text.spi.BreakIteratorProvider;
import java.text.spi.CollatorProvider;
import java.text.spi.DateFormatProvider;
import java.text.spi.DateFormatSymbolsProvider;
import java.text.spi.DecimalFormatSymbolsProvider;
import java.text.spi.NumberFormatProvider;
import java.util.HashSet;
import java.util.Locale;
import java.util.Set;
import java.util.StringTokenizer;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;
import java.util.spi.CalendarDataProvider;
import java.util.spi.CalendarNameProvider;
import java.util.spi.CurrencyNameProvider;
import java.util.spi.LocaleNameProvider;
import java.util.spi.LocaleServiceProvider;
import java.util.spi.TimeZoneNameProvider;
import sun.util.resources.LocaleData;
import sun.util.spi.CalendarProvider;

/**
 * LocaleProviderAdapter implementation for the legacy JRE locale data.
 *
 * @author Naoto Sato
 * @author Masayoshi Okutsu
 */
<span class="fc" id="L58">public class JRELocaleProviderAdapter extends LocaleProviderAdapter implements ResourceBundleBasedAdapter {</span>

    private static final String LOCALE_DATA_JAR_NAME = &quot;localedata.jar&quot;;

<span class="fc" id="L62">    private final ConcurrentMap&lt;String, Set&lt;String&gt;&gt; langtagSets</span>
        = new ConcurrentHashMap&lt;&gt;();

<span class="fc" id="L65">    private final ConcurrentMap&lt;Locale, LocaleResources&gt; localeResourcesMap</span>
        = new ConcurrentHashMap&lt;&gt;();

    // LocaleData specific to this LocaleProviderAdapter.
    private volatile LocaleData localeData;

    /**
     * Returns the type of this LocaleProviderAdapter
     */
    @Override
    public LocaleProviderAdapter.Type getAdapterType() {
<span class="fc" id="L76">        return Type.JRE;</span>
    }

    /**
     * Getter method for Locale Service Providers
     */
    @Override
    @SuppressWarnings(&quot;unchecked&quot;)
    public &lt;P extends LocaleServiceProvider&gt; P getLocaleServiceProvider(Class&lt;P&gt; c) {
<span class="pc bpc" id="L85" title="14 of 50 branches missed.">        switch (c.getSimpleName()) {</span>
        case &quot;BreakIteratorProvider&quot;:
<span class="fc" id="L87">            return (P) getBreakIteratorProvider();</span>
        case &quot;CollatorProvider&quot;:
<span class="fc" id="L89">            return (P) getCollatorProvider();</span>
        case &quot;DateFormatProvider&quot;:
<span class="fc" id="L91">            return (P) getDateFormatProvider();</span>
        case &quot;DateFormatSymbolsProvider&quot;:
<span class="fc" id="L93">            return (P) getDateFormatSymbolsProvider();</span>
        case &quot;DecimalFormatSymbolsProvider&quot;:
<span class="fc" id="L95">            return (P) getDecimalFormatSymbolsProvider();</span>
        case &quot;NumberFormatProvider&quot;:
<span class="fc" id="L97">            return (P) getNumberFormatProvider();</span>
        case &quot;CurrencyNameProvider&quot;:
<span class="fc" id="L99">            return (P) getCurrencyNameProvider();</span>
        case &quot;LocaleNameProvider&quot;:
<span class="fc" id="L101">            return (P) getLocaleNameProvider();</span>
        case &quot;TimeZoneNameProvider&quot;:
<span class="fc" id="L103">            return (P) getTimeZoneNameProvider();</span>
        case &quot;CalendarDataProvider&quot;:
<span class="fc" id="L105">            return (P) getCalendarDataProvider();</span>
        case &quot;CalendarNameProvider&quot;:
<span class="fc" id="L107">            return (P) getCalendarNameProvider();</span>
        case &quot;CalendarProvider&quot;:
<span class="fc" id="L109">            return (P) getCalendarProvider();</span>
        default:
<span class="nc" id="L111">            throw new InternalError(&quot;should not come down here&quot;);</span>
        }
    }

<span class="fc" id="L115">    private volatile BreakIteratorProvider breakIteratorProvider = null;</span>
<span class="fc" id="L116">    private volatile CollatorProvider collatorProvider = null;</span>
<span class="fc" id="L117">    private volatile DateFormatProvider dateFormatProvider = null;</span>
<span class="fc" id="L118">    private volatile DateFormatSymbolsProvider dateFormatSymbolsProvider = null;</span>
<span class="fc" id="L119">    private volatile DecimalFormatSymbolsProvider decimalFormatSymbolsProvider = null;</span>
<span class="fc" id="L120">    private volatile NumberFormatProvider numberFormatProvider = null;</span>

<span class="fc" id="L122">    private volatile CurrencyNameProvider currencyNameProvider = null;</span>
<span class="fc" id="L123">    private volatile LocaleNameProvider localeNameProvider = null;</span>
<span class="fc" id="L124">    private volatile TimeZoneNameProvider timeZoneNameProvider = null;</span>
<span class="fc" id="L125">    private volatile CalendarDataProvider calendarDataProvider = null;</span>
<span class="fc" id="L126">    private volatile CalendarNameProvider calendarNameProvider = null;</span>

<span class="fc" id="L128">    private volatile CalendarProvider calendarProvider = null;</span>

    /*
     * Getter methods for java.text.spi.* providers
     */
    @Override
    public BreakIteratorProvider getBreakIteratorProvider() {
<span class="fc bfc" id="L135" title="All 2 branches covered.">        if (breakIteratorProvider == null) {</span>
<span class="fc" id="L136">            BreakIteratorProvider provider = new BreakIteratorProviderImpl(getAdapterType(),</span>
<span class="fc" id="L137">                                                            getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L138">            synchronized (this) {</span>
<span class="pc bpc" id="L139" title="1 of 2 branches missed.">                if (breakIteratorProvider == null) {</span>
<span class="fc" id="L140">                    breakIteratorProvider = provider;</span>
                }
<span class="pc" id="L142">            }</span>
        }
<span class="fc" id="L144">        return breakIteratorProvider;</span>
    }

    @Override
    public CollatorProvider getCollatorProvider() {
<span class="fc bfc" id="L149" title="All 2 branches covered.">        if (collatorProvider == null) {</span>
<span class="fc" id="L150">            CollatorProvider provider = new CollatorProviderImpl(getAdapterType(),</span>
<span class="fc" id="L151">                                                getLanguageTagSet(&quot;CollationData&quot;));</span>
<span class="fc" id="L152">            synchronized (this) {</span>
<span class="pc bpc" id="L153" title="1 of 2 branches missed.">                if (collatorProvider == null) {</span>
<span class="fc" id="L154">                    collatorProvider = provider;</span>
                }
<span class="pc" id="L156">            }</span>
        }
<span class="fc" id="L158">        return collatorProvider;</span>
    }

    @Override
    public DateFormatProvider getDateFormatProvider() {
<span class="fc bfc" id="L163" title="All 2 branches covered.">        if (dateFormatProvider == null) {</span>
<span class="fc" id="L164">            DateFormatProvider provider = new DateFormatProviderImpl(getAdapterType(),</span>
<span class="fc" id="L165">                                                    getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L166">            synchronized (this) {</span>
<span class="pc bpc" id="L167" title="1 of 2 branches missed.">                if (dateFormatProvider == null) {</span>
<span class="fc" id="L168">                    dateFormatProvider = provider;</span>
                }
<span class="pc" id="L170">            }</span>
        }
<span class="fc" id="L172">        return dateFormatProvider;</span>
    }

    @Override
    public DateFormatSymbolsProvider getDateFormatSymbolsProvider() {
<span class="fc bfc" id="L177" title="All 2 branches covered.">        if (dateFormatSymbolsProvider == null) {</span>
<span class="fc" id="L178">            DateFormatSymbolsProvider provider = new DateFormatSymbolsProviderImpl(getAdapterType(),</span>
<span class="fc" id="L179">                                                                getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L180">            synchronized (this) {</span>
<span class="fc bfc" id="L181" title="All 2 branches covered.">                if (dateFormatSymbolsProvider == null) {</span>
<span class="fc" id="L182">                    dateFormatSymbolsProvider = provider;</span>
                }
<span class="pc" id="L184">            }</span>
        }
<span class="fc" id="L186">        return dateFormatSymbolsProvider;</span>
    }

    @Override
    public DecimalFormatSymbolsProvider getDecimalFormatSymbolsProvider() {
<span class="fc bfc" id="L191" title="All 2 branches covered.">        if (decimalFormatSymbolsProvider == null) {</span>
<span class="fc" id="L192">            DecimalFormatSymbolsProvider provider = new DecimalFormatSymbolsProviderImpl(getAdapterType(), getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L193">            synchronized (this) {</span>
<span class="fc bfc" id="L194" title="All 2 branches covered.">                if (decimalFormatSymbolsProvider == null) {</span>
<span class="fc" id="L195">                    decimalFormatSymbolsProvider = provider;</span>
                }
<span class="pc" id="L197">            }</span>
        }
<span class="fc" id="L199">        return decimalFormatSymbolsProvider;</span>
    }

    @Override
    public NumberFormatProvider getNumberFormatProvider() {
<span class="fc bfc" id="L204" title="All 2 branches covered.">        if (numberFormatProvider == null) {</span>
<span class="fc" id="L205">            NumberFormatProvider provider = new NumberFormatProviderImpl(getAdapterType(),</span>
<span class="fc" id="L206">                                                        getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L207">            synchronized (this) {</span>
<span class="fc bfc" id="L208" title="All 2 branches covered.">                if (numberFormatProvider == null) {</span>
<span class="fc" id="L209">                    numberFormatProvider = provider;</span>
                }
<span class="pc" id="L211">            }</span>
        }
<span class="fc" id="L213">        return numberFormatProvider;</span>
    }

    /**
     * Getter methods for java.util.spi.* providers
     */
    @Override
    public CurrencyNameProvider getCurrencyNameProvider() {
<span class="fc bfc" id="L221" title="All 2 branches covered.">        if (currencyNameProvider == null) {</span>
<span class="fc" id="L222">            CurrencyNameProvider provider = new CurrencyNameProviderImpl(getAdapterType(),</span>
<span class="fc" id="L223">                                            getLanguageTagSet(&quot;CurrencyNames&quot;));</span>
<span class="fc" id="L224">            synchronized (this) {</span>
<span class="fc bfc" id="L225" title="All 2 branches covered.">                if (currencyNameProvider == null) {</span>
<span class="fc" id="L226">                    currencyNameProvider = provider;</span>
                }
<span class="pc" id="L228">            }</span>
        }
<span class="fc" id="L230">        return currencyNameProvider;</span>
    }

    @Override
    public LocaleNameProvider getLocaleNameProvider() {
<span class="fc bfc" id="L235" title="All 2 branches covered.">        if (localeNameProvider == null) {</span>
<span class="fc" id="L236">            LocaleNameProvider provider = new LocaleNameProviderImpl(getAdapterType(),</span>
<span class="fc" id="L237">                                                    getLanguageTagSet(&quot;LocaleNames&quot;));</span>
<span class="fc" id="L238">            synchronized (this) {</span>
<span class="pc bpc" id="L239" title="1 of 2 branches missed.">                if (localeNameProvider == null) {</span>
<span class="fc" id="L240">                    localeNameProvider = provider;</span>
                }
<span class="pc" id="L242">            }</span>
        }
<span class="fc" id="L244">        return localeNameProvider;</span>
    }

    @Override
    public TimeZoneNameProvider getTimeZoneNameProvider() {
<span class="fc bfc" id="L249" title="All 2 branches covered.">        if (timeZoneNameProvider == null) {</span>
<span class="fc" id="L250">            TimeZoneNameProvider provider = new TimeZoneNameProviderImpl(getAdapterType(),</span>
<span class="fc" id="L251">                                                    getLanguageTagSet(&quot;TimeZoneNames&quot;));</span>
<span class="fc" id="L252">            synchronized (this) {</span>
<span class="fc bfc" id="L253" title="All 2 branches covered.">                if (timeZoneNameProvider == null) {</span>
<span class="fc" id="L254">                    timeZoneNameProvider = provider;</span>
                }
<span class="pc" id="L256">            }</span>
        }
<span class="fc" id="L258">        return timeZoneNameProvider;</span>
    }

    @Override
    public CalendarDataProvider getCalendarDataProvider() {
<span class="pc bpc" id="L263" title="1 of 2 branches missed.">        if (calendarDataProvider == null) {</span>
            CalendarDataProvider provider;
<span class="fc" id="L265">            provider = new CalendarDataProviderImpl(getAdapterType(),</span>
<span class="fc" id="L266">                                                    getLanguageTagSet(&quot;CalendarData&quot;));</span>
<span class="fc" id="L267">            synchronized (this) {</span>
<span class="fc bfc" id="L268" title="All 2 branches covered.">                if (calendarDataProvider == null) {</span>
<span class="fc" id="L269">                    calendarDataProvider = provider;</span>
                }
<span class="pc" id="L271">            }</span>
        }
<span class="fc" id="L273">        return calendarDataProvider;</span>
    }

    @Override
    public CalendarNameProvider getCalendarNameProvider() {
<span class="pc bpc" id="L278" title="1 of 2 branches missed.">        if (calendarNameProvider == null) {</span>
            CalendarNameProvider provider;
<span class="fc" id="L280">            provider = new CalendarNameProviderImpl(getAdapterType(),</span>
<span class="fc" id="L281">                                                    getLanguageTagSet(&quot;FormatData&quot;));</span>
<span class="fc" id="L282">            synchronized (this) {</span>
<span class="pc bpc" id="L283" title="1 of 2 branches missed.">                if (calendarNameProvider == null) {</span>
<span class="fc" id="L284">                    calendarNameProvider = provider;</span>
                }
<span class="pc" id="L286">            }</span>
        }
<span class="fc" id="L288">        return calendarNameProvider;</span>
    }

    /**
     * Getter methods for sun.util.spi.* providers
     */
    @Override
    public CalendarProvider getCalendarProvider() {
<span class="fc bfc" id="L296" title="All 2 branches covered.">        if (calendarProvider == null) {</span>
<span class="fc" id="L297">            CalendarProvider provider = new CalendarProviderImpl(getAdapterType(),</span>
<span class="fc" id="L298">                                                    getLanguageTagSet(&quot;CalendarData&quot;));</span>
<span class="fc" id="L299">            synchronized (this) {</span>
<span class="fc bfc" id="L300" title="All 2 branches covered.">                if (calendarProvider == null) {</span>
<span class="fc" id="L301">                    calendarProvider = provider;</span>
                }
<span class="pc" id="L303">            }</span>
        }
<span class="fc" id="L305">        return calendarProvider;</span>
    }

    @Override
    public LocaleResources getLocaleResources(Locale locale) {
<span class="fc" id="L310">        LocaleResources lr = localeResourcesMap.get(locale);</span>
<span class="fc bfc" id="L311" title="All 2 branches covered.">        if (lr == null) {</span>
<span class="fc" id="L312">            lr = new LocaleResources(this, locale);</span>
<span class="fc" id="L313">            LocaleResources lrc = localeResourcesMap.putIfAbsent(locale, lr);</span>
<span class="fc bfc" id="L314" title="All 2 branches covered.">            if (lrc != null) {</span>
<span class="fc" id="L315">                lr = lrc;</span>
            }
        }
<span class="fc" id="L318">        return lr;</span>
    }

    // ResourceBundleBasedAdapter method implementation
    @Override
    public LocaleData getLocaleData() {
<span class="fc bfc" id="L324" title="All 2 branches covered.">        if (localeData == null) {</span>
<span class="fc" id="L325">            synchronized (this) {</span>
<span class="fc bfc" id="L326" title="All 2 branches covered.">                if (localeData == null) {</span>
<span class="fc" id="L327">                    localeData = new LocaleData(getAdapterType());</span>
                }
<span class="pc" id="L329">            }</span>
        }
<span class="fc" id="L331">        return localeData;</span>
    }

    /**
     * Returns a list of the installed locales. Currently, this simply returns
     * the list of locales for which a sun.text.resources.FormatData bundle
     * exists. This bundle family happens to be the one with the broadest
     * locale coverage in the JRE.
     */
    @Override
    public Locale[] getAvailableLocales() {
<span class="fc" id="L342">        return AvailableJRELocales.localeList.clone();</span>
    }

    public Set&lt;String&gt; getLanguageTagSet(String category) {
<span class="fc" id="L346">        Set&lt;String&gt; tagset = langtagSets.get(category);</span>
<span class="fc bfc" id="L347" title="All 2 branches covered.">        if (tagset == null) {</span>
<span class="fc" id="L348">            tagset = createLanguageTagSet(category);</span>
<span class="fc" id="L349">            Set&lt;String&gt; ts = langtagSets.putIfAbsent(category, tagset);</span>
<span class="fc bfc" id="L350" title="All 2 branches covered.">            if (ts != null) {</span>
<span class="fc" id="L351">                tagset = ts;</span>
            }
        }
<span class="fc" id="L354">        return tagset;</span>
    }

    protected Set&lt;String&gt; createLanguageTagSet(String category) {
<span class="fc" id="L358">        String supportedLocaleString = LocaleDataMetaInfo.getSupportedLocaleString(category);</span>
<span class="fc" id="L359">        Set&lt;String&gt; tagset = new HashSet&lt;&gt;();</span>
<span class="fc" id="L360">        StringTokenizer tokens = new StringTokenizer(supportedLocaleString);</span>
<span class="fc bfc" id="L361" title="All 2 branches covered.">        while (tokens.hasMoreTokens()) {</span>
<span class="fc" id="L362">            String token = tokens.nextToken();</span>
<span class="fc bfc" id="L363" title="All 2 branches covered.">            if (token.equals(&quot;|&quot;)) {</span>
<span class="pc bpc" id="L364" title="1 of 2 branches missed.">                if (isNonENLangSupported()) {</span>
<span class="fc" id="L365">                    continue;</span>
                }
                break;
            }
<span class="fc" id="L369">            tagset.add(token);</span>
<span class="fc" id="L370">        }</span>

<span class="fc" id="L372">        return tagset;</span>
    }

    /**
     * Lazy load available locales.
     */
<span class="fc" id="L378">    private static class AvailableJRELocales {</span>
<span class="fc" id="L379">        private static final Locale[] localeList = createAvailableLocales();</span>
<span class="nc" id="L380">        private AvailableJRELocales() {</span>
<span class="nc" id="L381">        }</span>
    }

    private static Locale[] createAvailableLocales() {
        /*
         * Gets the locale string list from LocaleDataMetaInfo class and then
         * contructs the Locale array and a set of language tags based on the
         * locale string returned above.
         */
<span class="fc" id="L390">        String supportedLocaleString = LocaleDataMetaInfo.getSupportedLocaleString(&quot;AvailableLocales&quot;);</span>

<span class="pc bpc" id="L392" title="1 of 2 branches missed.">        if (supportedLocaleString.length() == 0) {</span>
<span class="nc" id="L393">            throw new InternalError(&quot;No available locales for JRE&quot;);</span>
        }

        /*
         * Look for &quot;|&quot; and construct a new locale string list.
         */
<span class="fc" id="L399">        int barIndex = supportedLocaleString.indexOf('|');</span>
        StringTokenizer localeStringTokenizer;
<span class="pc bpc" id="L401" title="1 of 2 branches missed.">        if (isNonENLangSupported()) {</span>
<span class="fc" id="L402">            localeStringTokenizer = new StringTokenizer(supportedLocaleString.substring(0, barIndex)</span>
<span class="fc" id="L403">                    + supportedLocaleString.substring(barIndex + 1));</span>
        } else {
<span class="nc" id="L405">            localeStringTokenizer = new StringTokenizer(supportedLocaleString.substring(0, barIndex));</span>
        }

<span class="fc" id="L408">        int length = localeStringTokenizer.countTokens();</span>
<span class="fc" id="L409">        Locale[] locales = new Locale[length + 1];</span>
<span class="fc" id="L410">        locales[0] = Locale.ROOT;</span>
<span class="fc bfc" id="L411" title="All 2 branches covered.">        for (int i = 1; i &lt;= length; i++) {</span>
<span class="fc" id="L412">            String currentToken = localeStringTokenizer.nextToken();</span>
<span class="pc bpc" id="L413" title="3 of 14 branches missed.">            switch (currentToken) {</span>
                case &quot;ja-JP-JP&quot;:
<span class="fc" id="L415">                    locales[i] = JRELocaleConstants.JA_JP_JP;</span>
<span class="fc" id="L416">                    break;</span>
                case &quot;no-NO-NY&quot;:
<span class="fc" id="L418">                    locales[i] = JRELocaleConstants.NO_NO_NY;</span>
<span class="fc" id="L419">                    break;</span>
                case &quot;th-TH-TH&quot;:
<span class="fc" id="L421">                    locales[i] = JRELocaleConstants.TH_TH_TH;</span>
<span class="fc" id="L422">                    break;</span>
                default:
<span class="fc" id="L424">                    locales[i] = Locale.forLanguageTag(currentToken);</span>
            }
        }
<span class="fc" id="L427">        return locales;</span>
    }

<span class="fc" id="L430">    private static volatile Boolean isNonENSupported = null;</span>

    /*
     * Returns true if the non EN resources jar file exists in jre
     * extension directory. @returns true if the jar file is there. Otherwise,
     * returns false.
     */
    private static boolean isNonENLangSupported() {
<span class="fc bfc" id="L438" title="All 2 branches covered.">        if (isNonENSupported == null) {</span>
<span class="fc" id="L439">            synchronized (JRELocaleProviderAdapter.class) {</span>
<span class="fc bfc" id="L440" title="All 2 branches covered.">                if (isNonENSupported == null) {</span>
<span class="fc" id="L441">                    final String sep = File.separator;</span>
<span class="fc" id="L442">                    String localeDataJar =</span>
<span class="fc" id="L443">                            java.security.AccessController.doPrivileged(</span>
                            new sun.security.action.GetPropertyAction(&quot;java.home&quot;))
                            + sep + &quot;lib&quot; + sep + &quot;ext&quot; + sep + LOCALE_DATA_JAR_NAME;

                    /*
                     * Peek at the installed extension directory to see if
                     * localedata.jar is installed or not.
                     */
<span class="fc" id="L451">                    final File f = new File(localeDataJar);</span>
<span class="fc" id="L452">                    isNonENSupported =</span>
<span class="fc" id="L453">                        AccessController.doPrivileged(new PrivilegedAction&lt;Boolean&gt;() {</span>
                            @Override
                            public Boolean run() {
<span class="fc" id="L456">                                return f.exists();</span>
                            }
                        });
               }
<span class="pc" id="L460">            }</span>
        }
<span class="fc" id="L462">        return isNonENSupported;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>