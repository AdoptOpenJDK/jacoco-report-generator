<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>MotifMenuUI.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">com.sun.java.swing.plaf.motif</a> &gt; <span class="el_source">MotifMenuUI.java</span></div><h1>MotifMenuUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2004, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package com.sun.java.swing.plaf.motif;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.plaf.*;
import javax.swing.border.*;
import javax.swing.plaf.basic.*;


import javax.swing.plaf.basic.BasicMenuUI;

/**
 * A Motif L&amp;F implementation of MenuUI.
 * &lt;p&gt;
 *
 * @author Georges Saab
 * @author Rich Schiavi
 */
<span class="nc" id="L45">public class MotifMenuUI extends BasicMenuUI</span>
{

    public static ComponentUI createUI( JComponent x ) {
<span class="nc" id="L49">        return new MotifMenuUI();</span>
    }

// These should not be necessary because BasicMenuUI does this,
// and this class overrides createChangeListener.
//    protected void installListeners() {
//      super.installListeners();
//        changeListener = createChangeListener(menuItem);
//        menuItem.addChangeListener(changeListener);
//    }
//
//    protected void uninstallListeners() {
//      super.uninstallListeners();
//      menuItem.removeChangeListener(changeListener);
//    }

    protected ChangeListener createChangeListener(JComponent c) {
<span class="nc" id="L66">        return new MotifChangeHandler((JMenu)c, this);</span>
    }

    private boolean popupIsOpen(JMenu m,MenuElement me[]) {
        int i;
<span class="nc" id="L71">        JPopupMenu pm = m.getPopupMenu();</span>

<span class="nc bnc" id="L73" title="All 2 branches missed.">        for(i=me.length-1;i&gt;=0;i--) {</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">            if(me[i].getComponent() == pm)</span>
<span class="nc" id="L75">                return true;</span>
        }
<span class="nc" id="L77">        return false;</span>
    }

    protected MouseInputListener createMouseInputListener(JComponent c) {
<span class="nc" id="L81">        return new MouseInputHandler();</span>
    }

    public class MotifChangeHandler extends ChangeHandler {
<span class="nc" id="L85">        public MotifChangeHandler(JMenu m, MotifMenuUI ui) {</span>
<span class="nc" id="L86">            super(m, ui);</span>
<span class="nc" id="L87">        }</span>


        public void stateChanged(ChangeEvent e) {
<span class="nc" id="L91">            JMenuItem c = (JMenuItem)e.getSource();</span>
<span class="nc bnc" id="L92" title="All 4 branches missed.">            if (c.isArmed() || c.isSelected()) {</span>
<span class="nc" id="L93">                c.setBorderPainted(true);</span>
                // c.repaint();
            } else {
<span class="nc" id="L96">                c.setBorderPainted(false);</span>
            }

<span class="nc" id="L99">            super.stateChanged(e);</span>
<span class="nc" id="L100">        }</span>
    }

<span class="nc" id="L103">    protected class MouseInputHandler implements MouseInputListener {</span>
<span class="nc" id="L104">        public void mouseClicked(MouseEvent e) {}</span>
        public void mousePressed(MouseEvent e) {
<span class="nc" id="L106">            MenuSelectionManager manager = MenuSelectionManager.defaultManager();</span>
<span class="nc" id="L107">            JMenu menu = (JMenu)e.getComponent();</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">            if(menu.isEnabled()) {</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">                if(menu.isTopLevelMenu()) {</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">                    if(menu.isSelected()) {</span>
<span class="nc" id="L111">                        manager.clearSelectedPath();</span>
                    } else {
<span class="nc" id="L113">                        Container cnt = menu.getParent();</span>
<span class="nc bnc" id="L114" title="All 4 branches missed.">                        if(cnt != null &amp;&amp; cnt instanceof JMenuBar) {</span>
<span class="nc" id="L115">                            MenuElement me[] = new MenuElement[2];</span>
<span class="nc" id="L116">                            me[0]=(MenuElement)cnt;</span>
<span class="nc" id="L117">                            me[1]=menu;</span>
<span class="nc" id="L118">                            manager.setSelectedPath(me);</span>
                        }
                    }
                }

<span class="nc" id="L123">                MenuElement path[] = getPath();</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">                if (path.length &gt; 0) {</span>
<span class="nc" id="L125">                    MenuElement newPath[] = new MenuElement[path.length+1];</span>
<span class="nc" id="L126">                    System.arraycopy(path,0,newPath,0,path.length);</span>
<span class="nc" id="L127">                    newPath[path.length] = menu.getPopupMenu();</span>
<span class="nc" id="L128">                    manager.setSelectedPath(newPath);</span>
                }
            }
<span class="nc" id="L131">        }</span>

        public void mouseReleased(MouseEvent e) {
            MenuSelectionManager manager =
<span class="nc" id="L135">                MenuSelectionManager.defaultManager();</span>
<span class="nc" id="L136">            JMenuItem menuItem = (JMenuItem)e.getComponent();</span>
<span class="nc" id="L137">            Point p = e.getPoint();</span>
<span class="nc bnc" id="L138" title="All 6 branches missed.">            if(!(p.x &gt;= 0 &amp;&amp; p.x &lt; menuItem.getWidth() &amp;&amp;</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">                 p.y &gt;= 0 &amp;&amp; p.y &lt; menuItem.getHeight())) {</span>
<span class="nc" id="L140">                manager.processMouseEvent(e);</span>
            }
<span class="nc" id="L142">        }</span>
<span class="nc" id="L143">        public void mouseEntered(MouseEvent e) {}</span>
<span class="nc" id="L144">        public void mouseExited(MouseEvent e) {}</span>
        public void mouseDragged(MouseEvent e) {
<span class="nc" id="L146">            MenuSelectionManager.defaultManager().processMouseEvent(e);</span>
<span class="nc" id="L147">        }</span>
<span class="nc" id="L148">        public void mouseMoved(MouseEvent e) { }</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>