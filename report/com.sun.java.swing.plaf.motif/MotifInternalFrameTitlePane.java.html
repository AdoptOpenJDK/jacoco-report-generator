<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>MotifInternalFrameTitlePane.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">com.sun.java.swing.plaf.motif</a> &gt; <span class="el_source">MotifInternalFrameTitlePane.java</span></div><h1>MotifInternalFrameTitlePane.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 1997, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package com.sun.java.swing.plaf.motif;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.event.InternalFrameEvent;
import javax.swing.plaf.basic.*;
import java.util.EventListener;
import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeEvent;
import java.beans.VetoableChangeListener;
import java.beans.PropertyVetoException;

/**
 * Class that manages a Motif title bar
 *
 * @since 1.3
 */
public class MotifInternalFrameTitlePane
    extends BasicInternalFrameTitlePane implements LayoutManager, ActionListener, PropertyChangeListener
{
    SystemButton systemButton;
    MinimizeButton minimizeButton;
    MaximizeButton maximizeButton;
    JPopupMenu systemMenu;
    Title title;
    Color color;
    Color highlight;
    Color shadow;

    // The width and height of a title pane button
    public final static int BUTTON_SIZE = 19;  // 17 + 1 pixel border


    public MotifInternalFrameTitlePane(JInternalFrame frame) {
<span class="nc" id="L62">        super(frame);</span>
<span class="nc" id="L63">    }</span>

    protected void installDefaults() {
<span class="nc" id="L66">        setFont(UIManager.getFont(&quot;InternalFrame.titleFont&quot;));</span>
<span class="nc" id="L67">        setPreferredSize(new Dimension(100, BUTTON_SIZE));</span>
<span class="nc" id="L68">    }</span>

    protected void uninstallListeners() {
        // Get around protected method in superclass
<span class="nc" id="L72">        super.uninstallListeners();</span>
<span class="nc" id="L73">    }</span>

    protected PropertyChangeListener createPropertyChangeListener() {
<span class="nc" id="L76">        return this;</span>
    }

    protected LayoutManager createLayout() {
<span class="nc" id="L80">        return this;</span>
    }

    JPopupMenu getSystemMenu() {
<span class="nc" id="L84">        return systemMenu;</span>
    }

    protected void assembleSystemMenu() {
<span class="nc" id="L88">        systemMenu = new JPopupMenu();</span>
<span class="nc" id="L89">        JMenuItem mi = systemMenu.add(restoreAction);</span>
<span class="nc" id="L90">        mi.setMnemonic(getButtonMnemonic(&quot;restore&quot;));</span>
<span class="nc" id="L91">        mi = systemMenu.add(moveAction);</span>
<span class="nc" id="L92">        mi.setMnemonic(getButtonMnemonic(&quot;move&quot;));</span>
<span class="nc" id="L93">        mi = systemMenu.add(sizeAction);</span>
<span class="nc" id="L94">        mi.setMnemonic(getButtonMnemonic(&quot;size&quot;));</span>
<span class="nc" id="L95">        mi = systemMenu.add(iconifyAction);</span>
<span class="nc" id="L96">        mi.setMnemonic(getButtonMnemonic(&quot;minimize&quot;));</span>
<span class="nc" id="L97">        mi = systemMenu.add(maximizeAction);</span>
<span class="nc" id="L98">        mi.setMnemonic(getButtonMnemonic(&quot;maximize&quot;));</span>
<span class="nc" id="L99">        systemMenu.add(new JSeparator());</span>
<span class="nc" id="L100">        mi = systemMenu.add(closeAction);</span>
<span class="nc" id="L101">        mi.setMnemonic(getButtonMnemonic(&quot;close&quot;));</span>

<span class="nc" id="L103">        systemButton = new SystemButton();</span>
<span class="nc" id="L104">        systemButton.addActionListener(new ActionListener() {</span>
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L106">                systemMenu.show(systemButton, 0, BUTTON_SIZE);</span>
<span class="nc" id="L107">            }</span>
        });

<span class="nc" id="L110">        systemButton.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed(MouseEvent evt) {
                try {
<span class="nc" id="L113">                    frame.setSelected(true);</span>
<span class="nc" id="L114">                } catch (PropertyVetoException pve) {</span>
<span class="nc" id="L115">                }</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">                if ((evt.getClickCount() == 2)) {</span>
<span class="nc" id="L117">                    closeAction.actionPerformed(new</span>
<span class="nc" id="L118">                        ActionEvent(evt.getSource(),</span>
                            ActionEvent.ACTION_PERFORMED,
<span class="nc" id="L120">                            null, evt.getWhen(), 0));</span>
<span class="nc" id="L121">                    systemMenu.setVisible(false);</span>
                }
<span class="nc" id="L123">            }</span>
        });
<span class="nc" id="L125">    }</span>

    private static int getButtonMnemonic(String button) {
        try {
<span class="nc" id="L129">            return Integer.parseInt(UIManager.getString(</span>
                    &quot;InternalFrameTitlePane.&quot; + button + &quot;Button.mnemonic&quot;));
<span class="nc" id="L131">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L132">            return -1;</span>
        }
    }

    protected void createButtons() {
<span class="nc" id="L137">        minimizeButton = new MinimizeButton();</span>
<span class="nc" id="L138">        minimizeButton.addActionListener(iconifyAction);</span>

<span class="nc" id="L140">        maximizeButton = new MaximizeButton();</span>
<span class="nc" id="L141">        maximizeButton.addActionListener(maximizeAction);</span>
<span class="nc" id="L142">    }</span>


    protected void addSubComponents() {
<span class="nc" id="L146">        title = new Title(frame.getTitle());</span>
<span class="nc" id="L147">        title.setFont(getFont());</span>

<span class="nc" id="L149">        add(systemButton);</span>
<span class="nc" id="L150">        add(title);</span>
<span class="nc" id="L151">        add(minimizeButton);</span>
<span class="nc" id="L152">        add(maximizeButton);</span>
<span class="nc" id="L153">    }</span>

    public void paintComponent(Graphics g) {
<span class="nc" id="L156">    }</span>

    void setColors(Color c, Color h, Color s) {
<span class="nc" id="L159">        color = c;</span>
<span class="nc" id="L160">        highlight = h;</span>
<span class="nc" id="L161">        shadow = s;</span>
<span class="nc" id="L162">    }</span>

    public void actionPerformed(ActionEvent e) {
<span class="nc" id="L165">    }</span>

    public void propertyChange(PropertyChangeEvent evt) {
<span class="nc" id="L168">        String prop = evt.getPropertyName();</span>
<span class="nc" id="L169">        JInternalFrame f = (JInternalFrame)evt.getSource();</span>
<span class="nc" id="L170">        boolean value = false;</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">        if (JInternalFrame.IS_SELECTED_PROPERTY.equals(prop)) {</span>
<span class="nc" id="L172">            repaint();</span>
<span class="nc bnc" id="L173" title="All 2 branches missed.">        } else if (prop.equals(&quot;maximizable&quot;)) {</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">            if ((Boolean)evt.getNewValue() == Boolean.TRUE)</span>
<span class="nc" id="L175">                add(maximizeButton);</span>
            else
<span class="nc" id="L177">                remove(maximizeButton);</span>
<span class="nc" id="L178">            revalidate();</span>
<span class="nc" id="L179">            repaint();</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">        } else if (prop.equals(&quot;iconable&quot;)) {</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">            if ((Boolean)evt.getNewValue() == Boolean.TRUE)</span>
<span class="nc" id="L182">                add(minimizeButton);</span>
            else
<span class="nc" id="L184">                remove(minimizeButton);</span>
<span class="nc" id="L185">            revalidate();</span>
<span class="nc" id="L186">            repaint();</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">        } else if (prop.equals(JInternalFrame.TITLE_PROPERTY)) {</span>
<span class="nc" id="L188">            repaint();</span>
        }
<span class="nc" id="L190">        enableActions();</span>
<span class="nc" id="L191">    }</span>

<span class="nc" id="L193">    public void addLayoutComponent(String name, Component c) {}</span>
<span class="nc" id="L194">    public void removeLayoutComponent(Component c) {}</span>
    public Dimension preferredLayoutSize(Container c)  {
<span class="nc" id="L196">        return minimumLayoutSize(c);</span>
    }

    public Dimension minimumLayoutSize(Container c) {
<span class="nc" id="L200">        return new Dimension(100, BUTTON_SIZE);</span>
    }

    public void layoutContainer(Container c) {
<span class="nc" id="L204">        int w = getWidth();</span>
<span class="nc" id="L205">        systemButton.setBounds(0, 0, BUTTON_SIZE, BUTTON_SIZE);</span>
<span class="nc" id="L206">        int x = w - BUTTON_SIZE;</span>

<span class="nc bnc" id="L208" title="All 2 branches missed.">        if(frame.isMaximizable()) {</span>
<span class="nc" id="L209">            maximizeButton.setBounds(x, 0, BUTTON_SIZE, BUTTON_SIZE);</span>
<span class="nc" id="L210">            x -= BUTTON_SIZE;</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">        } else if(maximizeButton.getParent() != null) {</span>
<span class="nc" id="L212">            maximizeButton.getParent().remove(maximizeButton);</span>
        }

<span class="nc bnc" id="L215" title="All 2 branches missed.">        if(frame.isIconifiable()) {</span>
<span class="nc" id="L216">            minimizeButton.setBounds(x, 0, BUTTON_SIZE, BUTTON_SIZE);</span>
<span class="nc" id="L217">            x -= BUTTON_SIZE;</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">        } else if(minimizeButton.getParent() != null) {</span>
<span class="nc" id="L219">            minimizeButton.getParent().remove(minimizeButton);</span>
        }

<span class="nc" id="L222">        title.setBounds(BUTTON_SIZE, 0, x, BUTTON_SIZE);</span>
<span class="nc" id="L223">    }</span>

    protected void showSystemMenu(){
<span class="nc" id="L226">      systemMenu.show(systemButton, 0, BUTTON_SIZE);</span>
<span class="nc" id="L227">    }</span>

    protected void hideSystemMenu(){
<span class="nc" id="L230">      systemMenu.setVisible(false);</span>
<span class="nc" id="L231">    }</span>

<span class="nc" id="L233">    static Dimension buttonDimension = new Dimension(BUTTON_SIZE, BUTTON_SIZE);</span>

    private abstract class FrameButton extends JButton {

<span class="nc" id="L237">        FrameButton() {</span>
<span class="nc" id="L238">            super();</span>
<span class="nc" id="L239">            setFocusPainted(false);</span>
<span class="nc" id="L240">            setBorderPainted(false);</span>
<span class="nc" id="L241">        }</span>

        public boolean isFocusTraversable() {
<span class="nc" id="L244">            return false;</span>
        }

        public void requestFocus() {
            // ignore request.
<span class="nc" id="L249">        }</span>

        public Dimension getMinimumSize() {
<span class="nc" id="L252">            return buttonDimension;</span>
        }

        public Dimension getPreferredSize() {
<span class="nc" id="L256">            return buttonDimension;</span>
        }

        public void paintComponent(Graphics g) {
<span class="nc" id="L260">            Dimension d = getSize();</span>
<span class="nc" id="L261">            int maxX = d.width - 1;</span>
<span class="nc" id="L262">            int maxY = d.height - 1;</span>

            // draw background
<span class="nc" id="L265">            g.setColor(color);</span>
<span class="nc" id="L266">            g.fillRect(1, 1, d.width, d.height);</span>

            // draw border
<span class="nc" id="L269">            boolean pressed = getModel().isPressed();</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">            g.setColor(pressed ? shadow : highlight);</span>
<span class="nc" id="L271">            g.drawLine(0, 0, maxX, 0);</span>
<span class="nc" id="L272">            g.drawLine(0, 0, 0, maxY);</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">            g.setColor(pressed ? highlight : shadow);</span>
<span class="nc" id="L274">            g.drawLine(1, maxY, maxX, maxY);</span>
<span class="nc" id="L275">            g.drawLine(maxX, 1, maxX, maxY);</span>
<span class="nc" id="L276">        }</span>
    }

<span class="nc" id="L279">    private class MinimizeButton extends FrameButton {</span>
        public void paintComponent(Graphics g) {
<span class="nc" id="L281">            super.paintComponent(g);</span>
<span class="nc" id="L282">            g.setColor(highlight);</span>
<span class="nc" id="L283">            g.drawLine(7, 8, 7, 11);</span>
<span class="nc" id="L284">            g.drawLine(7, 8, 10, 8);</span>
<span class="nc" id="L285">            g.setColor(shadow);</span>
<span class="nc" id="L286">            g.drawLine(8, 11, 10, 11);</span>
<span class="nc" id="L287">            g.drawLine(11, 9, 11, 11);</span>
<span class="nc" id="L288">        }</span>
    }

<span class="nc" id="L291">    private class MaximizeButton extends FrameButton {</span>
        public void paintComponent(Graphics g) {
<span class="nc" id="L293">            super.paintComponent(g);</span>
<span class="nc" id="L294">            int max = BUTTON_SIZE - 5;</span>
<span class="nc" id="L295">            boolean isMaxed = frame.isMaximum();</span>
<span class="nc bnc" id="L296" title="All 2 branches missed.">            g.setColor(isMaxed ? shadow : highlight);</span>
<span class="nc" id="L297">            g.drawLine(4, 4, 4, max);</span>
<span class="nc" id="L298">            g.drawLine(4, 4, max, 4);</span>
<span class="nc bnc" id="L299" title="All 2 branches missed.">            g.setColor(isMaxed ? highlight : shadow);</span>
<span class="nc" id="L300">            g.drawLine(5, max, max, max);</span>
<span class="nc" id="L301">            g.drawLine(max, 5, max, max);</span>
<span class="nc" id="L302">        }</span>
    }

<span class="nc" id="L305">    private class SystemButton extends FrameButton {</span>
<span class="nc" id="L306">        public boolean isFocusTraversable() { return false; }</span>
<span class="nc" id="L307">        public void requestFocus() {}</span>

        public void paintComponent(Graphics g) {
<span class="nc" id="L310">            super.paintComponent(g);</span>
<span class="nc" id="L311">            g.setColor(highlight);</span>
<span class="nc" id="L312">            g.drawLine(4, 8, 4, 11);</span>
<span class="nc" id="L313">            g.drawLine(4, 8, BUTTON_SIZE - 5, 8);</span>
<span class="nc" id="L314">            g.setColor(shadow);</span>
<span class="nc" id="L315">            g.drawLine(5, 11, BUTTON_SIZE - 5, 11);</span>
<span class="nc" id="L316">            g.drawLine(BUTTON_SIZE - 5, 9, BUTTON_SIZE - 5, 11);</span>
<span class="nc" id="L317">        }</span>
    }

    private class Title extends FrameButton {
<span class="nc" id="L321">        Title(String title) {</span>
<span class="nc" id="L322">            super();</span>
<span class="nc" id="L323">            setText(title);</span>
<span class="nc" id="L324">            setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L325">            setBorder(BorderFactory.createBevelBorder(</span>
                BevelBorder.RAISED,
<span class="nc" id="L327">                UIManager.getColor(&quot;activeCaptionBorder&quot;),</span>
<span class="nc" id="L328">                UIManager.getColor(&quot;inactiveCaptionBorder&quot;)));</span>

            // Forward mouse events to titlebar for moves.
<span class="nc" id="L331">            addMouseMotionListener(new MouseMotionListener() {</span>
                public void mouseDragged(MouseEvent e) {
<span class="nc" id="L333">                    forwardEventToParent(e);</span>
<span class="nc" id="L334">                }</span>
                public void mouseMoved(MouseEvent e) {
<span class="nc" id="L336">                    forwardEventToParent(e);</span>
<span class="nc" id="L337">                }</span>
            });
<span class="nc" id="L339">            addMouseListener(new MouseListener() {</span>
                public void mouseClicked(MouseEvent e) {
<span class="nc" id="L341">                    forwardEventToParent(e);</span>
<span class="nc" id="L342">                }</span>
                public void mousePressed(MouseEvent e) {
<span class="nc" id="L344">                    forwardEventToParent(e);</span>
<span class="nc" id="L345">                }</span>
                public void mouseReleased(MouseEvent e) {
<span class="nc" id="L347">                    forwardEventToParent(e);</span>
<span class="nc" id="L348">                }</span>
                public void mouseEntered(MouseEvent e) {
<span class="nc" id="L350">                    forwardEventToParent(e);</span>
<span class="nc" id="L351">                }</span>
                public void mouseExited(MouseEvent e) {
<span class="nc" id="L353">                    forwardEventToParent(e);</span>
<span class="nc" id="L354">                }</span>
            });
<span class="nc" id="L356">        }</span>

        void forwardEventToParent(MouseEvent e) {
<span class="nc" id="L359">            getParent().dispatchEvent(new MouseEvent(</span>
<span class="nc" id="L360">                getParent(), e.getID(), e.getWhen(), e.getModifiers(),</span>
<span class="nc" id="L361">                e.getX(), e.getY(),  e.getXOnScreen(),</span>
<span class="nc" id="L362">                e.getYOnScreen(), e.getClickCount(),</span>
<span class="nc" id="L363">                e.isPopupTrigger(),  MouseEvent.NOBUTTON));</span>
<span class="nc" id="L364">        }</span>

        public void paintComponent(Graphics g) {
<span class="nc" id="L367">            super.paintComponent(g);</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">            if (frame.isSelected()) {</span>
<span class="nc" id="L369">                g.setColor(UIManager.getColor(&quot;activeCaptionText&quot;));</span>
            } else {
<span class="nc" id="L371">                g.setColor(UIManager.getColor(&quot;inactiveCaptionText&quot;));</span>
            }
<span class="nc" id="L373">            Dimension d = getSize();</span>
<span class="nc" id="L374">            String frameTitle = frame.getTitle();</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">            if (frameTitle != null) {</span>
<span class="nc" id="L376">                MotifGraphicsUtils.drawStringInRect(frame, g, frameTitle,</span>
                                                    0, 0, d.width, d.height,
                                                    SwingConstants.CENTER);
            }
<span class="nc" id="L380">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>