<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>SynthInternalFrameTitlePane.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.synth</a> &gt; <span class="el_source">SynthInternalFrameTitlePane.java</span></div><h1>SynthInternalFrameTitlePane.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2008, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.synth;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.plaf.*;
import javax.swing.plaf.basic.BasicInternalFrameTitlePane;
import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyVetoException;
import sun.swing.SwingUtilities2;

/**
 * The class that manages a synth title bar
 *
 * @author David Kloba
 * @author Joshua Outwater
 * @author Steve Wilson
 */
class SynthInternalFrameTitlePane extends BasicInternalFrameTitlePane
        implements SynthUI, PropertyChangeListener {

    protected JPopupMenu systemPopupMenu;
    protected JButton menuButton;

    private SynthStyle style;
    private int titleSpacing;
    private int buttonSpacing;
    // Alignment for the title, one of SwingConstants.(LEADING|TRAILING|CENTER)
    private int titleAlignment;

    public SynthInternalFrameTitlePane(JInternalFrame f) {
<span class="nc" id="L58">        super(f);</span>
<span class="nc" id="L59">    }</span>

    public String getUIClassID() {
<span class="nc" id="L62">        return &quot;InternalFrameTitlePaneUI&quot;;</span>
    }

    public SynthContext getContext(JComponent c) {
<span class="nc" id="L66">        return getContext(c, getComponentState(c));</span>
    }

    public SynthContext getContext(JComponent c, int state) {
<span class="nc" id="L70">        return SynthContext.getContext(SynthContext.class, c,</span>
<span class="nc" id="L71">                    SynthLookAndFeel.getRegion(c), style, state);</span>
    }

    private Region getRegion(JComponent c) {
<span class="nc" id="L75">        return SynthLookAndFeel.getRegion(c);</span>
    }

    private int getComponentState(JComponent c) {
<span class="nc bnc" id="L79" title="All 2 branches missed.">        if (frame != null) {</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">            if (frame.isSelected()) {</span>
<span class="nc" id="L81">                return SELECTED;</span>
            }
        }
<span class="nc" id="L84">        return SynthLookAndFeel.getComponentState(c);</span>
    }

    protected void addSubComponents() {
<span class="nc" id="L88">        menuButton.setName(&quot;InternalFrameTitlePane.menuButton&quot;);</span>
<span class="nc" id="L89">        iconButton.setName(&quot;InternalFrameTitlePane.iconifyButton&quot;);</span>
<span class="nc" id="L90">        maxButton.setName(&quot;InternalFrameTitlePane.maximizeButton&quot;);</span>
<span class="nc" id="L91">        closeButton.setName(&quot;InternalFrameTitlePane.closeButton&quot;);</span>

<span class="nc" id="L93">        add(menuButton);</span>
<span class="nc" id="L94">        add(iconButton);</span>
<span class="nc" id="L95">        add(maxButton);</span>
<span class="nc" id="L96">        add(closeButton);</span>
<span class="nc" id="L97">    }</span>

    protected void installListeners() {
<span class="nc" id="L100">        super.installListeners();</span>
<span class="nc" id="L101">        frame.addPropertyChangeListener(this);</span>
<span class="nc" id="L102">        addPropertyChangeListener(this);</span>
<span class="nc" id="L103">    }</span>

    protected void uninstallListeners() {
<span class="nc" id="L106">        frame.removePropertyChangeListener(this);</span>
<span class="nc" id="L107">        removePropertyChangeListener(this);</span>
<span class="nc" id="L108">        super.uninstallListeners();</span>
<span class="nc" id="L109">    }</span>

    private void updateStyle(JComponent c) {
<span class="nc" id="L112">        SynthContext context = getContext(this, ENABLED);</span>
<span class="nc" id="L113">        SynthStyle oldStyle = style;</span>
<span class="nc" id="L114">        style = SynthLookAndFeel.updateStyle(context, this);</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">        if (style != oldStyle) {</span>
<span class="nc" id="L116">            maxIcon =</span>
<span class="nc" id="L117">                style.getIcon(context,&quot;InternalFrameTitlePane.maximizeIcon&quot;);</span>
<span class="nc" id="L118">            minIcon =</span>
<span class="nc" id="L119">                style.getIcon(context,&quot;InternalFrameTitlePane.minimizeIcon&quot;);</span>
<span class="nc" id="L120">            iconIcon =</span>
<span class="nc" id="L121">                style.getIcon(context,&quot;InternalFrameTitlePane.iconifyIcon&quot;);</span>
<span class="nc" id="L122">            closeIcon =</span>
<span class="nc" id="L123">                style.getIcon(context,&quot;InternalFrameTitlePane.closeIcon&quot;);</span>
<span class="nc" id="L124">            titleSpacing = style.getInt(context,</span>
                              &quot;InternalFrameTitlePane.titleSpacing&quot;, 2);
<span class="nc" id="L126">            buttonSpacing = style.getInt(context,</span>
                              &quot;InternalFrameTitlePane.buttonSpacing&quot;, 2);
<span class="nc" id="L128">            String alignString = (String)style.get(context,</span>
                              &quot;InternalFrameTitlePane.titleAlignment&quot;);
<span class="nc" id="L130">            titleAlignment = SwingConstants.LEADING;</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">            if (alignString != null) {</span>
<span class="nc" id="L132">                alignString = alignString.toUpperCase();</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">                if (alignString.equals(&quot;TRAILING&quot;)) {</span>
<span class="nc" id="L134">                    titleAlignment = SwingConstants.TRAILING;</span>
                }
<span class="nc bnc" id="L136" title="All 2 branches missed.">                else if (alignString.equals(&quot;CENTER&quot;)) {</span>
<span class="nc" id="L137">                    titleAlignment = SwingConstants.CENTER;</span>
                }
            }
        }
<span class="nc" id="L141">        context.dispose();</span>
<span class="nc" id="L142">    }</span>

    protected void installDefaults() {
<span class="nc" id="L145">        super.installDefaults();</span>
<span class="nc" id="L146">        updateStyle(this);</span>
<span class="nc" id="L147">    }</span>

    protected void uninstallDefaults() {
<span class="nc" id="L150">        SynthContext context = getContext(this, ENABLED);</span>
<span class="nc" id="L151">        style.uninstallDefaults(context);</span>
<span class="nc" id="L152">        context.dispose();</span>
<span class="nc" id="L153">        style = null;</span>
<span class="nc" id="L154">        JInternalFrame.JDesktopIcon di = frame.getDesktopIcon();</span>
<span class="nc bnc" id="L155" title="All 4 branches missed.">        if(di != null &amp;&amp; di.getComponentPopupMenu() == systemPopupMenu) {</span>
            // Release link to systemMenu from the JInternalFrame
<span class="nc" id="L157">            di.setComponentPopupMenu(null);</span>
        }
<span class="nc" id="L159">        super.uninstallDefaults();</span>
<span class="nc" id="L160">    }</span>

<span class="nc" id="L162">    private static class JPopupMenuUIResource extends JPopupMenu implements</span>
        UIResource { }

    protected void assembleSystemMenu() {
<span class="nc" id="L166">        systemPopupMenu = new JPopupMenuUIResource();</span>
<span class="nc" id="L167">        addSystemMenuItems(systemPopupMenu);</span>
<span class="nc" id="L168">        enableActions();</span>
<span class="nc" id="L169">        menuButton = createNoFocusButton();</span>
<span class="nc" id="L170">        updateMenuIcon();</span>
<span class="nc" id="L171">        menuButton.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed(MouseEvent e) {
                try {
<span class="nc" id="L174">                    frame.setSelected(true);</span>
<span class="nc" id="L175">                } catch(PropertyVetoException pve) {</span>
<span class="nc" id="L176">                }</span>
<span class="nc" id="L177">                showSystemMenu();</span>
<span class="nc" id="L178">            }</span>
        });
<span class="nc" id="L180">        JPopupMenu p = frame.getComponentPopupMenu();</span>
<span class="nc bnc" id="L181" title="All 4 branches missed.">        if (p == null || p instanceof UIResource) {</span>
<span class="nc" id="L182">            frame.setComponentPopupMenu(systemPopupMenu);</span>
        }
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if (frame.getDesktopIcon() != null) {</span>
<span class="nc" id="L185">            p = frame.getDesktopIcon().getComponentPopupMenu();</span>
<span class="nc bnc" id="L186" title="All 4 branches missed.">            if (p == null || p instanceof UIResource) {</span>
<span class="nc" id="L187">                frame.getDesktopIcon().setComponentPopupMenu(systemPopupMenu);</span>
            }
        }
<span class="nc" id="L190">        setInheritsPopupMenu(true);</span>
<span class="nc" id="L191">    }</span>

    protected void addSystemMenuItems(JPopupMenu menu) {
<span class="nc" id="L194">        JMenuItem mi = menu.add(restoreAction);</span>
<span class="nc" id="L195">        mi.setMnemonic(getButtonMnemonic(&quot;restore&quot;));</span>
<span class="nc" id="L196">        mi = menu.add(moveAction);</span>
<span class="nc" id="L197">        mi.setMnemonic(getButtonMnemonic(&quot;move&quot;));</span>
<span class="nc" id="L198">        mi = menu.add(sizeAction);</span>
<span class="nc" id="L199">        mi.setMnemonic(getButtonMnemonic(&quot;size&quot;));</span>
<span class="nc" id="L200">        mi = menu.add(iconifyAction);</span>
<span class="nc" id="L201">        mi.setMnemonic(getButtonMnemonic(&quot;minimize&quot;));</span>
<span class="nc" id="L202">        mi = menu.add(maximizeAction);</span>
<span class="nc" id="L203">        mi.setMnemonic(getButtonMnemonic(&quot;maximize&quot;));</span>
<span class="nc" id="L204">        menu.add(new JSeparator());</span>
<span class="nc" id="L205">        mi = menu.add(closeAction);</span>
<span class="nc" id="L206">        mi.setMnemonic(getButtonMnemonic(&quot;close&quot;));</span>
<span class="nc" id="L207">    }</span>

    private static int getButtonMnemonic(String button) {
        try {
<span class="nc" id="L211">            return Integer.parseInt(UIManager.getString(</span>
                    &quot;InternalFrameTitlePane.&quot; + button + &quot;Button.mnemonic&quot;));
<span class="nc" id="L213">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L214">            return -1;</span>
        }
    }

    protected void showSystemMenu() {
<span class="nc" id="L219">        Insets insets = frame.getInsets();</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (!frame.isIcon()) {</span>
<span class="nc" id="L221">            systemPopupMenu.show(frame, menuButton.getX(), getY() + getHeight());</span>
        } else {
<span class="nc" id="L223">            systemPopupMenu.show(menuButton,</span>
<span class="nc" id="L224">                getX() - insets.left - insets.right,</span>
<span class="nc" id="L225">                getY() - systemPopupMenu.getPreferredSize().height -</span>
                    insets.bottom - insets.top);
        }
<span class="nc" id="L228">    }</span>

    // SynthInternalFrameTitlePane has no UI, we'll invoke paint on it.
    public void paintComponent(Graphics g) {
<span class="nc" id="L232">        SynthContext context = getContext(this);</span>
<span class="nc" id="L233">        SynthLookAndFeel.update(context, g);</span>
<span class="nc" id="L234">        context.getPainter().paintInternalFrameTitlePaneBackground(context,</span>
<span class="nc" id="L235">                          g, 0, 0, getWidth(), getHeight());</span>
<span class="nc" id="L236">        paint(context, g);</span>
<span class="nc" id="L237">        context.dispose();</span>
<span class="nc" id="L238">    }</span>

    protected void paint(SynthContext context, Graphics g) {
<span class="nc" id="L241">        String title = frame.getTitle();</span>

<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (title != null) {</span>
<span class="nc" id="L244">            SynthStyle style = context.getStyle();</span>

<span class="nc" id="L246">            g.setColor(style.getColor(context, ColorType.TEXT_FOREGROUND));</span>
<span class="nc" id="L247">            g.setFont(style.getFont(context));</span>

            // Center text vertically.
<span class="nc" id="L250">            FontMetrics fm = SwingUtilities2.getFontMetrics(frame, g);</span>
<span class="nc" id="L251">            int baseline = (getHeight() + fm.getAscent() - fm.getLeading() -</span>
<span class="nc" id="L252">                            fm.getDescent()) / 2;</span>
<span class="nc" id="L253">            JButton lastButton = null;</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">            if (frame.isIconifiable()) {</span>
<span class="nc" id="L255">                lastButton = iconButton;</span>
            }
<span class="nc bnc" id="L257" title="All 2 branches missed.">            else if (frame.isMaximizable()) {</span>
<span class="nc" id="L258">                lastButton = maxButton;</span>
            }
<span class="nc bnc" id="L260" title="All 2 branches missed.">            else if (frame.isClosable()) {</span>
<span class="nc" id="L261">                lastButton = closeButton;</span>
            }
            int maxX;
            int minX;
<span class="nc" id="L265">            boolean ltr = SynthLookAndFeel.isLeftToRight(frame);</span>
<span class="nc" id="L266">            int titleAlignment = this.titleAlignment;</span>
<span class="nc bnc" id="L267" title="All 2 branches missed.">            if (ltr) {</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">                if (lastButton != null) {</span>
<span class="nc" id="L269">                    maxX = lastButton.getX() - titleSpacing;</span>
                }
                else {
<span class="nc" id="L272">                    maxX = frame.getWidth() - frame.getInsets().right -</span>
                           titleSpacing;
                }
<span class="nc" id="L275">                minX = menuButton.getX() + menuButton.getWidth() +</span>
                       titleSpacing;
            }
            else {
<span class="nc bnc" id="L279" title="All 2 branches missed.">                if (lastButton != null) {</span>
<span class="nc" id="L280">                    minX = lastButton.getX() + lastButton.getWidth() +</span>
                           titleSpacing;
                }
                else {
<span class="nc" id="L284">                    minX = frame.getInsets().left + titleSpacing;</span>
                }
<span class="nc" id="L286">                maxX = menuButton.getX() - titleSpacing;</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">                if (titleAlignment == SwingConstants.LEADING) {</span>
<span class="nc" id="L288">                    titleAlignment = SwingConstants.TRAILING;</span>
                }
<span class="nc bnc" id="L290" title="All 2 branches missed.">                else if (titleAlignment == SwingConstants.TRAILING) {</span>
<span class="nc" id="L291">                    titleAlignment = SwingConstants.LEADING;</span>
                }
            }
<span class="nc" id="L294">            String clippedTitle = getTitle(title, fm, maxX - minX);</span>
<span class="nc bnc" id="L295" title="All 2 branches missed.">            if (clippedTitle == title) {</span>
                // String fit, align as necessary.
<span class="nc bnc" id="L297" title="All 2 branches missed.">                if (titleAlignment == SwingConstants.TRAILING) {</span>
<span class="nc" id="L298">                    minX = maxX - style.getGraphicsUtils(context).</span>
<span class="nc" id="L299">                        computeStringWidth(context, g.getFont(), fm, title);</span>
                }
<span class="nc bnc" id="L301" title="All 2 branches missed.">                else if (titleAlignment == SwingConstants.CENTER) {</span>
<span class="nc" id="L302">                    int width = style.getGraphicsUtils(context).</span>
<span class="nc" id="L303">                           computeStringWidth(context, g.getFont(), fm, title);</span>
<span class="nc" id="L304">                    minX = Math.max(minX, (getWidth() - width) / 2);</span>
<span class="nc" id="L305">                    minX = Math.min(maxX - width, minX);</span>
                }
            }
<span class="nc" id="L308">            style.getGraphicsUtils(context).paintText(</span>
<span class="nc" id="L309">                context, g, clippedTitle, minX, baseline - fm.getAscent(), -1);</span>
        }
<span class="nc" id="L311">    }</span>

    public void paintBorder(SynthContext context, Graphics g, int x,
                            int y, int w, int h) {
<span class="nc" id="L315">        context.getPainter().paintInternalFrameTitlePaneBorder(context,</span>
                                                            g, x, y, w, h);
<span class="nc" id="L317">    }</span>

    protected LayoutManager createLayout() {
<span class="nc" id="L320">        SynthContext context = getContext(this);</span>
<span class="nc" id="L321">        LayoutManager lm =</span>
<span class="nc" id="L322">            (LayoutManager)style.get(context, &quot;InternalFrameTitlePane.titlePaneLayout&quot;);</span>
<span class="nc" id="L323">        context.dispose();</span>
<span class="nc bnc" id="L324" title="All 2 branches missed.">        return (lm != null) ? lm : new SynthTitlePaneLayout();</span>
    }

    public void propertyChange(PropertyChangeEvent evt) {
<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (evt.getSource() == this) {</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">            if (SynthLookAndFeel.shouldUpdateStyle(evt)) {</span>
<span class="nc" id="L330">                updateStyle(this);</span>
            }
        }
        else {
            // Changes for the internal frame
<span class="nc bnc" id="L335" title="All 2 branches missed.">            if (evt.getPropertyName() == JInternalFrame.FRAME_ICON_PROPERTY) {</span>
<span class="nc" id="L336">                updateMenuIcon();</span>
            }
        }
<span class="nc" id="L339">    }</span>

    /**
     * Resets the menuButton icon to match that of the frame.
     */
    private void updateMenuIcon() {
<span class="nc" id="L345">        Icon frameIcon = frame.getFrameIcon();</span>
<span class="nc" id="L346">        SynthContext context = getContext(this);</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">        if (frameIcon != null) {</span>
<span class="nc" id="L348">            Dimension maxSize = (Dimension)context.getStyle().get(context,</span>
                                &quot;InternalFrameTitlePane.maxFrameIconSize&quot;);
<span class="nc" id="L350">            int maxWidth = 16;</span>
<span class="nc" id="L351">            int maxHeight = 16;</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">            if (maxSize != null) {</span>
<span class="nc" id="L353">                maxWidth = maxSize.width;</span>
<span class="nc" id="L354">                maxHeight = maxSize.height;</span>
            }
<span class="nc bnc" id="L356" title="All 2 branches missed.">            if ((frameIcon.getIconWidth() &gt; maxWidth ||</span>
<span class="nc bnc" id="L357" title="All 4 branches missed.">                     frameIcon.getIconHeight() &gt; maxHeight) &amp;&amp;</span>
                    (frameIcon instanceof ImageIcon)) {
<span class="nc" id="L359">                frameIcon = new ImageIcon(((ImageIcon)frameIcon).</span>
<span class="nc" id="L360">                             getImage().getScaledInstance(maxWidth, maxHeight,</span>
                             Image.SCALE_SMOOTH));
            }
        }
<span class="nc" id="L364">        context.dispose();</span>
<span class="nc" id="L365">        menuButton.setIcon(frameIcon);</span>
<span class="nc" id="L366">    }</span>


<span class="nc" id="L369">    class SynthTitlePaneLayout implements LayoutManager {</span>
<span class="nc" id="L370">        public void addLayoutComponent(String name, Component c) {}</span>
<span class="nc" id="L371">        public void removeLayoutComponent(Component c) {}</span>
        public Dimension preferredLayoutSize(Container c)  {
<span class="nc" id="L373">            return minimumLayoutSize(c);</span>
        }

        public Dimension minimumLayoutSize(Container c) {
<span class="nc" id="L377">            SynthContext context = getContext(</span>
                             SynthInternalFrameTitlePane.this);
<span class="nc" id="L379">            int width = 0;</span>
<span class="nc" id="L380">            int height = 0;</span>

<span class="nc" id="L382">            int buttonCount = 0;</span>
            Dimension pref;

<span class="nc bnc" id="L385" title="All 2 branches missed.">            if (frame.isClosable()) {</span>
<span class="nc" id="L386">                pref = closeButton.getPreferredSize();</span>
<span class="nc" id="L387">                width += pref.width;</span>
<span class="nc" id="L388">                height = Math.max(pref.height, height);</span>
<span class="nc" id="L389">                buttonCount++;</span>
            }
<span class="nc bnc" id="L391" title="All 2 branches missed.">            if (frame.isMaximizable()) {</span>
<span class="nc" id="L392">                pref = maxButton.getPreferredSize();</span>
<span class="nc" id="L393">                width += pref.width;</span>
<span class="nc" id="L394">                height = Math.max(pref.height, height);</span>
<span class="nc" id="L395">                buttonCount++;</span>
            }
<span class="nc bnc" id="L397" title="All 2 branches missed.">            if (frame.isIconifiable()) {</span>
<span class="nc" id="L398">                pref = iconButton.getPreferredSize();</span>
<span class="nc" id="L399">                width += pref.width;</span>
<span class="nc" id="L400">                height = Math.max(pref.height, height);</span>
<span class="nc" id="L401">                buttonCount++;</span>
            }
<span class="nc" id="L403">            pref = menuButton.getPreferredSize();</span>
<span class="nc" id="L404">            width += pref.width;</span>
<span class="nc" id="L405">            height = Math.max(pref.height, height);</span>

<span class="nc" id="L407">            width += Math.max(0, (buttonCount - 1) * buttonSpacing);</span>

<span class="nc" id="L409">            FontMetrics fm = SynthInternalFrameTitlePane.this.getFontMetrics(</span>
<span class="nc" id="L410">                                          getFont());</span>
<span class="nc" id="L411">            SynthGraphicsUtils graphicsUtils = context.getStyle().</span>
<span class="nc" id="L412">                                       getGraphicsUtils(context);</span>
<span class="nc" id="L413">            String frameTitle = frame.getTitle();</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">            int title_w = frameTitle != null ? graphicsUtils.</span>
<span class="nc" id="L415">                               computeStringWidth(context, fm.getFont(),</span>
                               fm, frameTitle) : 0;
<span class="nc bnc" id="L417" title="All 2 branches missed.">            int title_length = frameTitle != null ? frameTitle.length() : 0;</span>

            // Leave room for three characters in the title.
<span class="nc bnc" id="L420" title="All 2 branches missed.">            if (title_length &gt; 3) {</span>
<span class="nc" id="L421">                int subtitle_w = graphicsUtils.computeStringWidth(context,</span>
<span class="nc" id="L422">                    fm.getFont(), fm, frameTitle.substring(0, 3) + &quot;...&quot;);</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">                width += (title_w &lt; subtitle_w) ? title_w : subtitle_w;</span>
<span class="nc" id="L424">            } else {</span>
<span class="nc" id="L425">                width += title_w;</span>
            }

<span class="nc" id="L428">            height = Math.max(fm.getHeight() + 2, height);</span>

<span class="nc" id="L430">            width += titleSpacing + titleSpacing;</span>

<span class="nc" id="L432">            Insets insets = getInsets();</span>
<span class="nc" id="L433">            height += insets.top + insets.bottom;</span>
<span class="nc" id="L434">            width += insets.left + insets.right;</span>
<span class="nc" id="L435">            context.dispose();</span>
<span class="nc" id="L436">            return new Dimension(width, height);</span>
        }

        private int center(Component c, Insets insets, int x,
                           boolean trailing) {
<span class="nc" id="L441">            Dimension pref = c.getPreferredSize();</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">            if (trailing) {</span>
<span class="nc" id="L443">                x -= pref.width;</span>
            }
<span class="nc" id="L445">            c.setBounds(x, insets.top +</span>
<span class="nc" id="L446">                        (getHeight() - insets.top - insets.bottom -</span>
                         pref.height) / 2, pref.width, pref.height);
<span class="nc bnc" id="L448" title="All 2 branches missed.">            if (pref.width &gt; 0) {</span>
<span class="nc bnc" id="L449" title="All 2 branches missed.">                if (trailing) {</span>
<span class="nc" id="L450">                    return x - buttonSpacing;</span>
                }
<span class="nc" id="L452">                return x + pref.width + buttonSpacing;</span>
            }
<span class="nc" id="L454">            return x;</span>
        }

        public void layoutContainer(Container c) {
<span class="nc" id="L458">            Insets insets = c.getInsets();</span>
            Dimension pref;

<span class="nc bnc" id="L461" title="All 2 branches missed.">            if (SynthLookAndFeel.isLeftToRight(frame)) {</span>
<span class="nc" id="L462">                center(menuButton, insets, insets.left, false);</span>
<span class="nc" id="L463">                int x = getWidth() - insets.right;</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">                if (frame.isClosable()) {</span>
<span class="nc" id="L465">                    x = center(closeButton, insets, x, true);</span>
                }
<span class="nc bnc" id="L467" title="All 2 branches missed.">                if (frame.isMaximizable()) {</span>
<span class="nc" id="L468">                    x = center(maxButton, insets, x, true);</span>
                }
<span class="nc bnc" id="L470" title="All 2 branches missed.">                if (frame.isIconifiable()) {</span>
<span class="nc" id="L471">                    x = center(iconButton, insets, x, true);</span>
                }
<span class="nc" id="L473">            }</span>
            else {
<span class="nc" id="L475">                center(menuButton, insets, getWidth() - insets.right,</span>
                       true);
<span class="nc" id="L477">                int x = insets.left;</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">                if (frame.isClosable()) {</span>
<span class="nc" id="L479">                    x = center(closeButton, insets, x, false);</span>
                }
<span class="nc bnc" id="L481" title="All 2 branches missed.">                if (frame.isMaximizable()) {</span>
<span class="nc" id="L482">                    x = center(maxButton, insets, x, false);</span>
                }
<span class="nc bnc" id="L484" title="All 2 branches missed.">                if (frame.isIconifiable()) {</span>
<span class="nc" id="L485">                    x = center(iconButton, insets, x, false);</span>
                }
            }
<span class="nc" id="L488">        }</span>
    }

    private JButton createNoFocusButton() {
<span class="nc" id="L492">        JButton button = new JButton();</span>
<span class="nc" id="L493">        button.setFocusable(false);</span>
<span class="nc" id="L494">        button.setMargin(new Insets(0,0,0,0));</span>
<span class="nc" id="L495">        return button;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>