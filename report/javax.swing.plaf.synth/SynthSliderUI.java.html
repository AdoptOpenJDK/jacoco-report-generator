<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SynthSliderUI.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.synth</a> &gt; <span class="el_source">SynthSliderUI.java</span></div><h1>SynthSliderUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.synth;

import java.awt.event.*;
import java.awt.Graphics;
import java.awt.Dimension;
import java.awt.FontMetrics;
import java.awt.Rectangle;
import java.awt.Point;
import java.awt.Insets;
import java.beans.*;
import java.util.Dictionary;
import java.util.Enumeration;
import javax.swing.*;
import javax.swing.plaf.*;
import javax.swing.plaf.basic.BasicSliderUI;
import sun.swing.SwingUtilities2;


/**
 * Provides the Synth L&amp;amp;F UI delegate for
 * {@link JSlider}.
 *
 * @author Joshua Outwater
 * @since 1.7
 */
public class SynthSliderUI extends BasicSliderUI
                           implements PropertyChangeListener, SynthUI {
<span class="nc" id="L53">    private Rectangle valueRect = new Rectangle();</span>
    private boolean paintValue;

    /**
     * When a JSlider is used as a renderer in a JTable, its layout is not
     * being recomputed even though the size is changing. Even though there
     * is a ComponentListener installed, it is not being notified. As such,
     * at times when being asked to paint the layout should first be redone.
     * At the end of the layout method we set this lastSize variable, which
     * represents the size of the slider the last time it was layed out.
     *
     * In the paint method we then check to see that this is accurate, that
     * the slider has not changed sizes since being last layed out. If necessary
     * we recompute the layout.
     */
    private Dimension lastSize;

    private int trackHeight;
    private int trackBorder;
    private int thumbWidth;
    private int thumbHeight;

    private SynthStyle style;
    private SynthStyle sliderTrackStyle;
    private SynthStyle sliderThumbStyle;

    /** Used to determine the color to paint the thumb. */
    private transient boolean thumbActive; //happens on rollover, and when pressed
    private transient boolean thumbPressed; //happens when mouse was depressed while over thumb

    ///////////////////////////////////////////////////
    // ComponentUI Interface Implementation methods
    ///////////////////////////////////////////////////
    /**
     * Creates a new UI object for the given component.
     *
     * @param c component to create UI object for
     * @return the UI object
     */
    public static ComponentUI createUI(JComponent c) {
<span class="nc" id="L93">        return new SynthSliderUI((JSlider)c);</span>
    }

    protected SynthSliderUI(JSlider c) {
<span class="nc" id="L97">        super(c);</span>
<span class="nc" id="L98">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected void installDefaults(JSlider slider) {
<span class="nc" id="L105">        updateStyle(slider);</span>
<span class="nc" id="L106">    }</span>

    /**
     * Uninstalls default setting. This method is called when a
     * {@code LookAndFeel} is uninstalled.
     */
    protected void uninstallDefaults(JSlider slider) {
<span class="nc" id="L113">        SynthContext context = getContext(slider, ENABLED);</span>
<span class="nc" id="L114">        style.uninstallDefaults(context);</span>
<span class="nc" id="L115">        context.dispose();</span>
<span class="nc" id="L116">        style = null;</span>

<span class="nc" id="L118">        context = getContext(slider, Region.SLIDER_TRACK, ENABLED);</span>
<span class="nc" id="L119">        sliderTrackStyle.uninstallDefaults(context);</span>
<span class="nc" id="L120">        context.dispose();</span>
<span class="nc" id="L121">        sliderTrackStyle = null;</span>

<span class="nc" id="L123">        context = getContext(slider, Region.SLIDER_THUMB, ENABLED);</span>
<span class="nc" id="L124">        sliderThumbStyle.uninstallDefaults(context);</span>
<span class="nc" id="L125">        context.dispose();</span>
<span class="nc" id="L126">        sliderThumbStyle = null;</span>
<span class="nc" id="L127">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected void installListeners(JSlider slider) {
<span class="nc" id="L134">        super.installListeners(slider);</span>
<span class="nc" id="L135">        slider.addPropertyChangeListener(this);</span>
<span class="nc" id="L136">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected void uninstallListeners(JSlider slider) {
<span class="nc" id="L143">        slider.removePropertyChangeListener(this);</span>
<span class="nc" id="L144">        super.uninstallListeners(slider);</span>
<span class="nc" id="L145">    }</span>

    private void updateStyle(JSlider c) {
<span class="nc" id="L148">        SynthContext context = getContext(c, ENABLED);</span>
<span class="nc" id="L149">        SynthStyle oldStyle = style;</span>
<span class="nc" id="L150">        style = SynthLookAndFeel.updateStyle(context, this);</span>

<span class="nc bnc" id="L152" title="All 2 branches missed.">        if (style != oldStyle) {</span>
<span class="nc" id="L153">            thumbWidth =</span>
<span class="nc" id="L154">                style.getInt(context, &quot;Slider.thumbWidth&quot;, 30);</span>

<span class="nc" id="L156">            thumbHeight =</span>
<span class="nc" id="L157">                style.getInt(context, &quot;Slider.thumbHeight&quot;, 14);</span>

            // handle scaling for sizeVarients for special case components. The
            // key &quot;JComponent.sizeVariant&quot; scales for large/small/mini
            // components are based on Apples LAF
<span class="nc" id="L162">            String scaleKey = (String)slider.getClientProperty(</span>
                    &quot;JComponent.sizeVariant&quot;);
<span class="nc bnc" id="L164" title="All 2 branches missed.">            if (scaleKey != null){</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">                if (&quot;large&quot;.equals(scaleKey)){</span>
<span class="nc" id="L166">                    thumbWidth *= 1.15;</span>
<span class="nc" id="L167">                    thumbHeight *= 1.15;</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">                } else if (&quot;small&quot;.equals(scaleKey)){</span>
<span class="nc" id="L169">                    thumbWidth *= 0.857;</span>
<span class="nc" id="L170">                    thumbHeight *= 0.857;</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">                } else if (&quot;mini&quot;.equals(scaleKey)){</span>
<span class="nc" id="L172">                    thumbWidth *= 0.784;</span>
<span class="nc" id="L173">                    thumbHeight *= 0.784;</span>
                }
            }

<span class="nc" id="L177">            trackBorder =</span>
<span class="nc" id="L178">                style.getInt(context, &quot;Slider.trackBorder&quot;, 1);</span>

<span class="nc" id="L180">            trackHeight = thumbHeight + trackBorder * 2;</span>

<span class="nc" id="L182">            paintValue = style.getBoolean(context,</span>
                    &quot;Slider.paintValue&quot;, true);
<span class="nc bnc" id="L184" title="All 2 branches missed.">            if (oldStyle != null) {</span>
<span class="nc" id="L185">                uninstallKeyboardActions(c);</span>
<span class="nc" id="L186">                installKeyboardActions(c);</span>
            }
        }
<span class="nc" id="L189">        context.dispose();</span>

<span class="nc" id="L191">        context = getContext(c, Region.SLIDER_TRACK, ENABLED);</span>
<span class="nc" id="L192">        sliderTrackStyle =</span>
<span class="nc" id="L193">            SynthLookAndFeel.updateStyle(context, this);</span>
<span class="nc" id="L194">        context.dispose();</span>

<span class="nc" id="L196">        context = getContext(c, Region.SLIDER_THUMB, ENABLED);</span>
<span class="nc" id="L197">        sliderThumbStyle =</span>
<span class="nc" id="L198">            SynthLookAndFeel.updateStyle(context, this);</span>
<span class="nc" id="L199">        context.dispose();</span>
<span class="nc" id="L200">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected TrackListener createTrackListener(JSlider s) {
<span class="nc" id="L207">        return new SynthTrackListener();</span>
    }

    private void updateThumbState(int x, int y) {
<span class="nc" id="L211">        setThumbActive(thumbRect.contains(x, y));</span>
<span class="nc" id="L212">    }</span>

    private void updateThumbState(int x, int y, boolean pressed) {
<span class="nc" id="L215">        updateThumbState(x, y);</span>
<span class="nc" id="L216">        setThumbPressed(pressed);</span>
<span class="nc" id="L217">    }</span>

    private void setThumbActive(boolean active) {
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (thumbActive != active) {</span>
<span class="nc" id="L221">            thumbActive = active;</span>
<span class="nc" id="L222">            slider.repaint(thumbRect);</span>
        }
<span class="nc" id="L224">    }</span>

    private void setThumbPressed(boolean pressed) {
<span class="nc bnc" id="L227" title="All 2 branches missed.">        if (thumbPressed != pressed) {</span>
<span class="nc" id="L228">            thumbPressed = pressed;</span>
<span class="nc" id="L229">            slider.repaint(thumbRect);</span>
        }
<span class="nc" id="L231">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public int getBaseline(JComponent c, int width, int height) {
<span class="nc bnc" id="L238" title="All 2 branches missed.">        if (c == null) {</span>
<span class="nc" id="L239">            throw new NullPointerException(&quot;Component must be non-null&quot;);</span>
        }
<span class="nc bnc" id="L241" title="All 4 branches missed.">        if (width &lt; 0 || height &lt; 0) {</span>
<span class="nc" id="L242">            throw new IllegalArgumentException(</span>
                    &quot;Width and height must be &gt;= 0&quot;);
        }
<span class="nc bnc" id="L245" title="All 4 branches missed.">        if (slider.getPaintLabels() &amp;&amp; labelsHaveSameBaselines()) {</span>
            // Get the insets for the track.
<span class="nc" id="L247">            Insets trackInsets = new Insets(0, 0, 0, 0);</span>
<span class="nc" id="L248">            SynthContext trackContext = getContext(slider,</span>
                                                   Region.SLIDER_TRACK);
<span class="nc" id="L250">            style.getInsets(trackContext, trackInsets);</span>
<span class="nc" id="L251">            trackContext.dispose();</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">            if (slider.getOrientation() == JSlider.HORIZONTAL) {</span>
<span class="nc" id="L253">                int valueHeight = 0;</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">                if (paintValue) {</span>
<span class="nc" id="L255">                    SynthContext context = getContext(slider);</span>
<span class="nc" id="L256">                    valueHeight = context.getStyle().getGraphicsUtils(context).</span>
<span class="nc" id="L257">                            getMaximumCharHeight(context);</span>
<span class="nc" id="L258">                    context.dispose();</span>
                }
<span class="nc" id="L260">                int tickHeight = 0;</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">                if (slider.getPaintTicks()) {</span>
<span class="nc" id="L262">                    tickHeight = getTickLength();</span>
                }
<span class="nc" id="L264">                int labelHeight = getHeightOfTallestLabel();</span>
<span class="nc" id="L265">                int contentHeight = valueHeight + trackHeight +</span>
                        trackInsets.top + trackInsets.bottom +
                        tickHeight + labelHeight + 4;
<span class="nc" id="L268">                int centerY = height / 2 - contentHeight / 2;</span>
<span class="nc" id="L269">                centerY += valueHeight + 2;</span>
<span class="nc" id="L270">                centerY += trackHeight + trackInsets.top + trackInsets.bottom;</span>
<span class="nc" id="L271">                centerY += tickHeight + 2;</span>
<span class="nc" id="L272">                JComponent label = (JComponent) slider.getLabelTable().elements().nextElement();</span>
<span class="nc" id="L273">                Dimension pref = label.getPreferredSize();</span>
<span class="nc" id="L274">                return centerY + label.getBaseline(pref.width, pref.height);</span>
            }
            else { // VERTICAL
<span class="nc bnc" id="L277" title="All 2 branches missed.">                Integer value = slider.getInverted() ? getLowestValue() :</span>
<span class="nc" id="L278">                                                       getHighestValue();</span>
<span class="nc bnc" id="L279" title="All 2 branches missed.">                if (value != null) {</span>
<span class="nc" id="L280">                    int valueY = insetCache.top;</span>
<span class="nc" id="L281">                    int valueHeight = 0;</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">                    if (paintValue) {</span>
<span class="nc" id="L283">                        SynthContext context = getContext(slider);</span>
<span class="nc" id="L284">                        valueHeight = context.getStyle().getGraphicsUtils(</span>
<span class="nc" id="L285">                                context).getMaximumCharHeight(context);</span>
<span class="nc" id="L286">                        context.dispose();</span>
                    }
<span class="nc" id="L288">                    int contentHeight = height - insetCache.top -</span>
                            insetCache.bottom;
<span class="nc" id="L290">                    int trackY = valueY + valueHeight;</span>
<span class="nc" id="L291">                    int trackHeight = contentHeight - valueHeight;</span>
<span class="nc" id="L292">                    int yPosition = yPositionForValue(value.intValue(), trackY,</span>
                                                      trackHeight);
<span class="nc" id="L294">                    JComponent label = (JComponent) slider.getLabelTable().get(value);</span>
<span class="nc" id="L295">                    Dimension pref = label.getPreferredSize();</span>
<span class="nc" id="L296">                    return yPosition - pref.height / 2 +</span>
<span class="nc" id="L297">                            label.getBaseline(pref.width, pref.height);</span>
                }
            }
        }
<span class="nc" id="L301">        return -1;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public Dimension getPreferredSize(JComponent c)  {
<span class="nc" id="L309">        recalculateIfInsetsChanged();</span>
<span class="nc" id="L310">        Dimension d = new Dimension(contentRect.width, contentRect.height);</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">        if (slider.getOrientation() == JSlider.VERTICAL) {</span>
<span class="nc" id="L312">            d.height = 200;</span>
        } else {
<span class="nc" id="L314">            d.width = 200;</span>
        }
<span class="nc" id="L316">        Insets i = slider.getInsets();</span>
<span class="nc" id="L317">        d.width += i.left + i.right;</span>
<span class="nc" id="L318">        d.height += i.top + i.bottom;</span>
<span class="nc" id="L319">        return d;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public Dimension getMinimumSize(JComponent c) {
<span class="nc" id="L327">        recalculateIfInsetsChanged();</span>
<span class="nc" id="L328">        Dimension d = new Dimension(contentRect.width, contentRect.height);</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (slider.getOrientation() == JSlider.VERTICAL) {</span>
<span class="nc" id="L330">            d.height = thumbRect.height + insetCache.top + insetCache.bottom;</span>
        } else {
<span class="nc" id="L332">            d.width = thumbRect.width + insetCache.left + insetCache.right;</span>
        }
<span class="nc" id="L334">        return d;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected void calculateGeometry() {
<span class="nc" id="L342">        calculateThumbSize();</span>
<span class="nc" id="L343">        layout();</span>
<span class="nc" id="L344">        calculateThumbLocation();</span>
<span class="nc" id="L345">    }</span>

    /**
     * Lays out the slider.
     */
    protected void layout() {
<span class="nc" id="L351">        SynthContext context = getContext(slider);</span>
<span class="nc" id="L352">        SynthGraphicsUtils synthGraphics = style.getGraphicsUtils(context);</span>

        // Get the insets for the track.
<span class="nc" id="L355">        Insets trackInsets = new Insets(0, 0, 0, 0);</span>
<span class="nc" id="L356">        SynthContext trackContext = getContext(slider, Region.SLIDER_TRACK);</span>
<span class="nc" id="L357">        style.getInsets(trackContext, trackInsets);</span>
<span class="nc" id="L358">        trackContext.dispose();</span>

<span class="nc bnc" id="L360" title="All 2 branches missed.">        if (slider.getOrientation() == JSlider.HORIZONTAL) {</span>
            // Calculate the height of all the subcomponents so we can center
            // them.
<span class="nc" id="L363">            valueRect.height = 0;</span>
<span class="nc bnc" id="L364" title="All 2 branches missed.">            if (paintValue) {</span>
<span class="nc" id="L365">                valueRect.height =</span>
<span class="nc" id="L366">                    synthGraphics.getMaximumCharHeight(context);</span>
            }

<span class="nc" id="L369">            trackRect.height = trackHeight;</span>

<span class="nc" id="L371">            tickRect.height = 0;</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">            if (slider.getPaintTicks()) {</span>
<span class="nc" id="L373">                tickRect.height = getTickLength();</span>
            }

<span class="nc" id="L376">            labelRect.height = 0;</span>
<span class="nc bnc" id="L377" title="All 2 branches missed.">            if (slider.getPaintLabels()) {</span>
<span class="nc" id="L378">                labelRect.height = getHeightOfTallestLabel();</span>
            }

<span class="nc" id="L381">            contentRect.height = valueRect.height + trackRect.height</span>
                + trackInsets.top + trackInsets.bottom
                + tickRect.height + labelRect.height + 4;
<span class="nc" id="L384">            contentRect.width = slider.getWidth() - insetCache.left</span>
                - insetCache.right;

            // Check if any of the labels will paint out of bounds.
<span class="nc" id="L388">            int pad = 0;</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">            if (slider.getPaintLabels()) {</span>
                // Calculate the track rectangle.  It is necessary for
                // xPositionForValue to return correct values.
<span class="nc" id="L392">                trackRect.x = insetCache.left;</span>
<span class="nc" id="L393">                trackRect.width = contentRect.width;</span>

<span class="nc" id="L395">                Dictionary dictionary = slider.getLabelTable();</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">                if (dictionary != null) {</span>
<span class="nc" id="L397">                    int minValue = slider.getMinimum();</span>
<span class="nc" id="L398">                    int maxValue = slider.getMaximum();</span>

                    // Iterate through the keys in the dictionary and find the
                    // first and last labels indices that fall within the
                    // slider range.
<span class="nc" id="L403">                    int firstLblIdx = Integer.MAX_VALUE;</span>
<span class="nc" id="L404">                    int lastLblIdx = Integer.MIN_VALUE;</span>
<span class="nc" id="L405">                    for (Enumeration keys = dictionary.keys();</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">                            keys.hasMoreElements(); ) {</span>
<span class="nc" id="L407">                        int keyInt = ((Integer)keys.nextElement()).intValue();</span>
<span class="nc bnc" id="L408" title="All 4 branches missed.">                        if (keyInt &gt;= minValue &amp;&amp; keyInt &lt; firstLblIdx) {</span>
<span class="nc" id="L409">                            firstLblIdx = keyInt;</span>
                        }
<span class="nc bnc" id="L411" title="All 4 branches missed.">                        if (keyInt &lt;= maxValue &amp;&amp; keyInt &gt; lastLblIdx) {</span>
<span class="nc" id="L412">                            lastLblIdx = keyInt;</span>
                        }
<span class="nc" id="L414">                    }</span>
                    // Calculate the pad necessary for the labels at the first
                    // and last visible indices.
<span class="nc" id="L417">                    pad = getPadForLabel(firstLblIdx);</span>
<span class="nc" id="L418">                    pad = Math.max(pad, getPadForLabel(lastLblIdx));</span>
                }
            }
            // Calculate the painting rectangles for each of the different
            // slider areas.
<span class="nc" id="L423">            valueRect.x = trackRect.x = tickRect.x = labelRect.x =</span>
                (insetCache.left + pad);
<span class="nc" id="L425">            valueRect.width = trackRect.width = tickRect.width =</span>
                labelRect.width = (contentRect.width - (pad * 2));

<span class="nc" id="L428">            int centerY = slider.getHeight() / 2 - contentRect.height / 2;</span>

<span class="nc" id="L430">            valueRect.y = centerY;</span>
<span class="nc" id="L431">            centerY += valueRect.height + 2;</span>

<span class="nc" id="L433">            trackRect.y = centerY + trackInsets.top;</span>
<span class="nc" id="L434">            centerY += trackRect.height + trackInsets.top + trackInsets.bottom;</span>

<span class="nc" id="L436">            tickRect.y = centerY;</span>
<span class="nc" id="L437">            centerY += tickRect.height + 2;</span>

<span class="nc" id="L439">            labelRect.y = centerY;</span>
<span class="nc" id="L440">            centerY += labelRect.height;</span>
<span class="nc" id="L441">        } else {</span>
            // Calculate the width of all the subcomponents so we can center
            // them.
<span class="nc" id="L444">            trackRect.width = trackHeight;</span>

<span class="nc" id="L446">            tickRect.width = 0;</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">            if (slider.getPaintTicks()) {</span>
<span class="nc" id="L448">                tickRect.width = getTickLength();</span>
            }

<span class="nc" id="L451">            labelRect.width = 0;</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">            if (slider.getPaintLabels()) {</span>
<span class="nc" id="L453">                labelRect.width = getWidthOfWidestLabel();</span>
            }

<span class="nc" id="L456">            valueRect.y = insetCache.top;</span>
<span class="nc" id="L457">            valueRect.height = 0;</span>
<span class="nc bnc" id="L458" title="All 2 branches missed.">            if (paintValue) {</span>
<span class="nc" id="L459">                valueRect.height =</span>
<span class="nc" id="L460">                    synthGraphics.getMaximumCharHeight(context);</span>
            }

            // Get the max width of the min or max value of the slider.
<span class="nc" id="L464">            FontMetrics fm = slider.getFontMetrics(slider.getFont());</span>
<span class="nc" id="L465">            valueRect.width = Math.max(</span>
<span class="nc" id="L466">                synthGraphics.computeStringWidth(context, slider.getFont(),</span>
<span class="nc" id="L467">                    fm, &quot;&quot; + slider.getMaximum()),</span>
<span class="nc" id="L468">                synthGraphics.computeStringWidth(context, slider.getFont(),</span>
<span class="nc" id="L469">                    fm, &quot;&quot; + slider.getMinimum()));</span>

<span class="nc" id="L471">            int l = valueRect.width / 2;</span>
<span class="nc" id="L472">            int w1 = trackInsets.left + trackRect.width / 2;</span>
<span class="nc" id="L473">            int w2 = trackRect.width / 2 + trackInsets.right +</span>
                              tickRect.width + labelRect.width;
<span class="nc" id="L475">            contentRect.width = Math.max(w1, l) + Math.max(w2, l) +</span>
                    2 + insetCache.left + insetCache.right;
<span class="nc" id="L477">            contentRect.height = slider.getHeight() -</span>
                                    insetCache.top - insetCache.bottom;

            // Layout the components.
<span class="nc" id="L481">            trackRect.y = tickRect.y = labelRect.y =</span>
                valueRect.y + valueRect.height;
<span class="nc" id="L483">            trackRect.height = tickRect.height = labelRect.height =</span>
                contentRect.height - valueRect.height;

<span class="nc" id="L486">            int startX = slider.getWidth() / 2 - contentRect.width / 2;</span>
<span class="nc bnc" id="L487" title="All 2 branches missed.">            if (SynthLookAndFeel.isLeftToRight(slider)) {</span>
<span class="nc bnc" id="L488" title="All 2 branches missed.">                if (l &gt; w1) {</span>
<span class="nc" id="L489">                    startX += (l - w1);</span>
                }
<span class="nc" id="L491">                trackRect.x = startX + trackInsets.left;</span>

<span class="nc" id="L493">                startX += trackInsets.left + trackRect.width + trackInsets.right;</span>
<span class="nc" id="L494">                tickRect.x = startX;</span>
<span class="nc" id="L495">                labelRect.x = startX + tickRect.width + 2;</span>
            } else {
<span class="nc bnc" id="L497" title="All 2 branches missed.">                if (l &gt; w2) {</span>
<span class="nc" id="L498">                    startX += (l - w2);</span>
                }
<span class="nc" id="L500">                labelRect.x = startX;</span>

<span class="nc" id="L502">                startX += labelRect.width + 2;</span>
<span class="nc" id="L503">                tickRect.x = startX;</span>
<span class="nc" id="L504">                trackRect.x = startX + tickRect.width + trackInsets.left;</span>
            }
        }
<span class="nc" id="L507">        context.dispose();</span>
<span class="nc" id="L508">        lastSize = slider.getSize();</span>
<span class="nc" id="L509">    }</span>

    /**
     * Calculates the pad for the label at the specified index.
     *
     * @param i index of the label to calculate pad for.
     * @return padding required to keep label visible.
     */
    private int getPadForLabel(int i) {
<span class="nc" id="L518">        int pad = 0;</span>

<span class="nc" id="L520">        JComponent c = (JComponent) slider.getLabelTable().get(i);</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">        if (c != null) {</span>
<span class="nc" id="L522">            int centerX = xPositionForValue(i);</span>
<span class="nc" id="L523">            int cHalfWidth = c.getPreferredSize().width / 2;</span>
<span class="nc bnc" id="L524" title="All 2 branches missed.">            if (centerX - cHalfWidth &lt; insetCache.left) {</span>
<span class="nc" id="L525">                pad = Math.max(pad, insetCache.left - (centerX - cHalfWidth));</span>
            }

<span class="nc bnc" id="L528" title="All 2 branches missed.">            if (centerX + cHalfWidth &gt; slider.getWidth() - insetCache.right) {</span>
<span class="nc" id="L529">                pad = Math.max(pad, (centerX + cHalfWidth) -</span>
<span class="nc" id="L530">                        (slider.getWidth() - insetCache.right));</span>
            }
        }
<span class="nc" id="L533">        return pad;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected void calculateThumbLocation() {
<span class="nc" id="L541">        super.calculateThumbLocation();</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">        if (slider.getOrientation() == JSlider.HORIZONTAL) {</span>
<span class="nc" id="L543">            thumbRect.y += trackBorder;</span>
        } else {
<span class="nc" id="L545">            thumbRect.x += trackBorder;</span>
        }
<span class="nc" id="L547">        Point mousePosition = slider.getMousePosition();</span>
<span class="nc bnc" id="L548" title="All 2 branches missed.">        if(mousePosition != null) {</span>
<span class="nc" id="L549">        updateThumbState(mousePosition.x, mousePosition.y);</span>
       }
<span class="nc" id="L551">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public void setThumbLocation(int x, int y) {
<span class="nc" id="L558">        super.setThumbLocation(x, y);</span>
        // Value rect is tied to the thumb location.  We need to repaint when
        // the thumb repaints.
<span class="nc" id="L561">        slider.repaint(valueRect.x, valueRect.y,</span>
                valueRect.width, valueRect.height);
<span class="nc" id="L563">        setThumbActive(false);</span>
<span class="nc" id="L564">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected int xPositionForValue(int value) {
<span class="nc" id="L571">        int min = slider.getMinimum();</span>
<span class="nc" id="L572">        int max = slider.getMaximum();</span>
<span class="nc" id="L573">        int trackLeft = trackRect.x + thumbRect.width / 2 + trackBorder;</span>
<span class="nc" id="L574">        int trackRight = trackRect.x + trackRect.width - thumbRect.width / 2</span>
            - trackBorder;
<span class="nc" id="L576">        int trackLength = trackRight - trackLeft;</span>
<span class="nc" id="L577">        double valueRange = (double)max - (double)min;</span>
<span class="nc" id="L578">        double pixelsPerValue = (double)trackLength / valueRange;</span>
        int xPosition;

<span class="nc bnc" id="L581" title="All 2 branches missed.">        if (!drawInverted()) {</span>
<span class="nc" id="L582">            xPosition = trackLeft;</span>
<span class="nc" id="L583">            xPosition += Math.round( pixelsPerValue * ((double)value - min));</span>
        } else {
<span class="nc" id="L585">            xPosition = trackRight;</span>
<span class="nc" id="L586">            xPosition -= Math.round( pixelsPerValue * ((double)value - min));</span>
        }

<span class="nc" id="L589">        xPosition = Math.max(trackLeft, xPosition);</span>
<span class="nc" id="L590">        xPosition = Math.min(trackRight, xPosition);</span>

<span class="nc" id="L592">        return xPosition;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected int yPositionForValue(int value, int trackY, int trackHeight) {
<span class="nc" id="L600">        int min = slider.getMinimum();</span>
<span class="nc" id="L601">        int max = slider.getMaximum();</span>
<span class="nc" id="L602">        int trackTop = trackY + thumbRect.height / 2 + trackBorder;</span>
<span class="nc" id="L603">        int trackBottom = trackY + trackHeight - thumbRect.height / 2 -</span>
                trackBorder;
<span class="nc" id="L605">        int trackLength = trackBottom - trackTop;</span>
<span class="nc" id="L606">        double valueRange = (double)max - (double)min;</span>
<span class="nc" id="L607">        double pixelsPerValue = (double)trackLength / valueRange;</span>
        int yPosition;

<span class="nc bnc" id="L610" title="All 2 branches missed.">        if (!drawInverted()) {</span>
<span class="nc" id="L611">            yPosition = trackTop;</span>
<span class="nc" id="L612">            yPosition += Math.round(pixelsPerValue * ((double)max - value));</span>
        } else {
<span class="nc" id="L614">            yPosition = trackTop;</span>
<span class="nc" id="L615">            yPosition += Math.round(pixelsPerValue * ((double)value - min));</span>
        }

<span class="nc" id="L618">        yPosition = Math.max(trackTop, yPosition);</span>
<span class="nc" id="L619">        yPosition = Math.min(trackBottom, yPosition);</span>

<span class="nc" id="L621">        return yPosition;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public int valueForYPosition(int yPos) {
        int value;
<span class="nc" id="L630">        int minValue = slider.getMinimum();</span>
<span class="nc" id="L631">        int maxValue = slider.getMaximum();</span>
<span class="nc" id="L632">        int trackTop = trackRect.y + thumbRect.height / 2 + trackBorder;</span>
<span class="nc" id="L633">        int trackBottom = trackRect.y + trackRect.height</span>
            - thumbRect.height / 2 - trackBorder;
<span class="nc" id="L635">        int trackLength = trackBottom - trackTop;</span>

<span class="nc bnc" id="L637" title="All 2 branches missed.">        if (yPos &lt;= trackTop) {</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">            value = drawInverted() ? minValue : maxValue;</span>
<span class="nc bnc" id="L639" title="All 2 branches missed.">        } else if (yPos &gt;= trackBottom) {</span>
<span class="nc bnc" id="L640" title="All 2 branches missed.">            value = drawInverted() ? maxValue : minValue;</span>
        } else {
<span class="nc" id="L642">            int distanceFromTrackTop = yPos - trackTop;</span>
<span class="nc" id="L643">            double valueRange = (double)maxValue - (double)minValue;</span>
<span class="nc" id="L644">            double valuePerPixel = valueRange / (double)trackLength;</span>
<span class="nc" id="L645">            int valueFromTrackTop =</span>
<span class="nc" id="L646">                (int)Math.round(distanceFromTrackTop * valuePerPixel);</span>
<span class="nc bnc" id="L647" title="All 2 branches missed.">            value = drawInverted() ?</span>
                minValue + valueFromTrackTop : maxValue - valueFromTrackTop;
        }
<span class="nc" id="L650">        return value;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public int valueForXPosition(int xPos) {
        int value;
<span class="nc" id="L659">        int minValue = slider.getMinimum();</span>
<span class="nc" id="L660">        int maxValue = slider.getMaximum();</span>
<span class="nc" id="L661">        int trackLeft = trackRect.x + thumbRect.width / 2 + trackBorder;</span>
<span class="nc" id="L662">        int trackRight = trackRect.x + trackRect.width</span>
            - thumbRect.width / 2 - trackBorder;
<span class="nc" id="L664">        int trackLength = trackRight - trackLeft;</span>

<span class="nc bnc" id="L666" title="All 2 branches missed.">        if (xPos &lt;= trackLeft) {</span>
<span class="nc bnc" id="L667" title="All 2 branches missed.">            value = drawInverted() ? maxValue : minValue;</span>
<span class="nc bnc" id="L668" title="All 2 branches missed.">        } else if (xPos &gt;= trackRight) {</span>
<span class="nc bnc" id="L669" title="All 2 branches missed.">            value = drawInverted() ? minValue : maxValue;</span>
        } else {
<span class="nc" id="L671">            int distanceFromTrackLeft = xPos - trackLeft;</span>
<span class="nc" id="L672">            double valueRange = (double)maxValue - (double)minValue;</span>
<span class="nc" id="L673">            double valuePerPixel = valueRange / (double)trackLength;</span>
<span class="nc" id="L674">            int valueFromTrackLeft =</span>
<span class="nc" id="L675">                (int)Math.round(distanceFromTrackLeft * valuePerPixel);</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">            value = drawInverted() ?</span>
                maxValue - valueFromTrackLeft : minValue + valueFromTrackLeft;
        }
<span class="nc" id="L679">        return value;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected Dimension getThumbSize() {
<span class="nc" id="L687">        Dimension size = new Dimension();</span>

<span class="nc bnc" id="L689" title="All 2 branches missed.">        if (slider.getOrientation() == JSlider.VERTICAL) {</span>
<span class="nc" id="L690">            size.width = thumbHeight;</span>
<span class="nc" id="L691">            size.height = thumbWidth;</span>
        } else {
<span class="nc" id="L693">            size.width = thumbWidth;</span>
<span class="nc" id="L694">            size.height = thumbHeight;</span>
        }
<span class="nc" id="L696">        return size;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected void recalculateIfInsetsChanged() {
<span class="nc" id="L704">        SynthContext context = getContext(slider);</span>
<span class="nc" id="L705">        Insets newInsets = style.getInsets(context, null);</span>
<span class="nc" id="L706">        Insets compInsets = slider.getInsets();</span>
<span class="nc" id="L707">        newInsets.left += compInsets.left; newInsets.right += compInsets.right;</span>
<span class="nc" id="L708">        newInsets.top += compInsets.top; newInsets.bottom += compInsets.bottom;</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">        if (!newInsets.equals(insetCache)) {</span>
<span class="nc" id="L710">            insetCache = newInsets;</span>
<span class="nc" id="L711">            calculateGeometry();</span>
        }
<span class="nc" id="L713">        context.dispose();</span>
<span class="nc" id="L714">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public SynthContext getContext(JComponent c) {
<span class="nc" id="L721">        return getContext(c, SynthLookAndFeel.getComponentState(c));</span>
    }

    private SynthContext getContext(JComponent c, int state) {
<span class="nc" id="L725">        return SynthContext.getContext(SynthContext.class, c,</span>
<span class="nc" id="L726">                            SynthLookAndFeel.getRegion(c), style, state);</span>
    }

    private SynthContext getContext(JComponent c, Region subregion) {
<span class="nc" id="L730">        return getContext(c, subregion, getComponentState(c, subregion));</span>
    }

    private SynthContext getContext(JComponent c, Region subregion, int state) {
<span class="nc" id="L734">        SynthStyle style = null;</span>
<span class="nc" id="L735">        Class klass = SynthContext.class;</span>

<span class="nc bnc" id="L737" title="All 2 branches missed.">        if (subregion == Region.SLIDER_TRACK) {</span>
<span class="nc" id="L738">            style = sliderTrackStyle;</span>
<span class="nc bnc" id="L739" title="All 2 branches missed.">        } else if (subregion == Region.SLIDER_THUMB) {</span>
<span class="nc" id="L740">            style = sliderThumbStyle;</span>
        }
<span class="nc" id="L742">        return SynthContext.getContext(klass, c, subregion, style, state);</span>
    }

    private int getComponentState(JComponent c, Region region) {
<span class="nc bnc" id="L746" title="All 6 branches missed.">        if (region == Region.SLIDER_THUMB &amp;&amp; thumbActive &amp;&amp;c.isEnabled()) {</span>
<span class="nc bnc" id="L747" title="All 2 branches missed.">            int state = thumbPressed ? PRESSED : MOUSE_OVER;</span>
<span class="nc bnc" id="L748" title="All 2 branches missed.">            if (c.isFocusOwner()) state |= FOCUSED;</span>
<span class="nc" id="L749">            return state;</span>
        }
<span class="nc" id="L751">        return SynthLookAndFeel.getComponentState(c);</span>
    }

    /**
     * Notifies this UI delegate to repaint the specified component.
     * This method paints the component background, then calls
     * the {@link #paint(SynthContext,Graphics)} method.
     *
     * &lt;p&gt;In general, this method does not need to be overridden by subclasses.
     * All Look and Feel rendering code should reside in the {@code paint} method.
     *
     * @param g the {@code Graphics} object used for painting
     * @param c the component being painted
     * @see #paint(SynthContext,Graphics)
     */
    @Override
    public void update(Graphics g, JComponent c) {
<span class="nc" id="L768">        SynthContext context = getContext(c);</span>
<span class="nc" id="L769">        SynthLookAndFeel.update(context, g);</span>
<span class="nc" id="L770">        context.getPainter().paintSliderBackground(context,</span>
<span class="nc" id="L771">                          g, 0, 0, c.getWidth(), c.getHeight(),</span>
<span class="nc" id="L772">                          slider.getOrientation());</span>
<span class="nc" id="L773">        paint(context, g);</span>
<span class="nc" id="L774">        context.dispose();</span>
<span class="nc" id="L775">    }</span>

    /**
     * Paints the specified component according to the Look and Feel.
     * &lt;p&gt;This method is not used by Synth Look and Feel.
     * Painting is handled by the {@link #paint(SynthContext,Graphics)} method.
     *
     * @param g the {@code Graphics} object used for painting
     * @param c the component being painted
     * @see #paint(SynthContext,Graphics)
     */
    @Override
    public void paint(Graphics g, JComponent c) {
<span class="nc" id="L788">        SynthContext context = getContext(c);</span>
<span class="nc" id="L789">        paint(context, g);</span>
<span class="nc" id="L790">        context.dispose();</span>
<span class="nc" id="L791">    }</span>

    /**
     * Paints the specified component.
     *
     * @param context context for the component being painted
     * @param g the {@code Graphics} object used for painting
     * @see #update(Graphics,JComponent)
     */
    protected void paint(SynthContext context, Graphics g) {
<span class="nc" id="L801">        recalculateIfInsetsChanged();</span>
<span class="nc" id="L802">        recalculateIfOrientationChanged();</span>
<span class="nc" id="L803">        Rectangle clip = g.getClipBounds();</span>

<span class="nc bnc" id="L805" title="All 4 branches missed.">        if (lastSize == null || !lastSize.equals(slider.getSize())) {</span>
<span class="nc" id="L806">            calculateGeometry();</span>
        }

<span class="nc bnc" id="L809" title="All 2 branches missed.">        if (paintValue) {</span>
<span class="nc" id="L810">            FontMetrics fm = SwingUtilities2.getFontMetrics(slider, g);</span>
<span class="nc" id="L811">            int labelWidth = context.getStyle().getGraphicsUtils(context).</span>
<span class="nc" id="L812">                computeStringWidth(context, g.getFont(), fm,</span>
<span class="nc" id="L813">                    &quot;&quot; + slider.getValue());</span>
<span class="nc" id="L814">            valueRect.x = thumbRect.x + (thumbRect.width - labelWidth) / 2;</span>

            // For horizontal sliders, make sure value is not painted
            // outside slider bounds.
<span class="nc bnc" id="L818" title="All 2 branches missed.">            if (slider.getOrientation() == JSlider.HORIZONTAL) {</span>
<span class="nc bnc" id="L819" title="All 2 branches missed.">                if (valueRect.x + labelWidth &gt; insetCache.left + contentRect.width) {</span>
<span class="nc" id="L820">                    valueRect.x =  (insetCache.left + contentRect.width) - labelWidth;</span>
                }
<span class="nc" id="L822">                valueRect.x = Math.max(valueRect.x, 0);</span>
            }

<span class="nc" id="L825">            g.setColor(context.getStyle().getColor(</span>
                    context, ColorType.TEXT_FOREGROUND));
<span class="nc" id="L827">            context.getStyle().getGraphicsUtils(context).paintText(</span>
<span class="nc" id="L828">                    context, g, &quot;&quot; + slider.getValue(), valueRect.x,</span>
                    valueRect.y, -1);
        }

<span class="nc bnc" id="L832" title="All 4 branches missed.">        if (slider.getPaintTrack() &amp;&amp; clip.intersects(trackRect)) {</span>
<span class="nc" id="L833">            SynthContext subcontext = getContext(slider, Region.SLIDER_TRACK);</span>
<span class="nc" id="L834">            paintTrack(subcontext, g, trackRect);</span>
<span class="nc" id="L835">            subcontext.dispose();</span>
        }

<span class="nc bnc" id="L838" title="All 2 branches missed.">        if (clip.intersects(thumbRect)) {</span>
<span class="nc" id="L839">            SynthContext subcontext = getContext(slider, Region.SLIDER_THUMB);</span>
<span class="nc" id="L840">            paintThumb(subcontext, g, thumbRect);</span>
<span class="nc" id="L841">            subcontext.dispose();</span>
        }

<span class="nc bnc" id="L844" title="All 4 branches missed.">        if (slider.getPaintTicks() &amp;&amp; clip.intersects(tickRect)) {</span>
<span class="nc" id="L845">            paintTicks(g);</span>
        }

<span class="nc bnc" id="L848" title="All 4 branches missed.">        if (slider.getPaintLabels() &amp;&amp; clip.intersects(labelRect)) {</span>
<span class="nc" id="L849">            paintLabels(g);</span>
        }
<span class="nc" id="L851">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public void paintBorder(SynthContext context, Graphics g, int x,
                            int y, int w, int h) {
<span class="nc" id="L859">        context.getPainter().paintSliderBorder(context, g, x, y, w, h,</span>
<span class="nc" id="L860">                                               slider.getOrientation());</span>
<span class="nc" id="L861">    }</span>

    /**
     * Paints the slider thumb.
     *
     * @param context context for the component being painted
     * @param g {@code Graphics} object used for painting
     * @param thumbBounds bounding box for the thumb
     */
    protected void paintThumb(SynthContext context, Graphics g,
            Rectangle thumbBounds)  {
<span class="nc" id="L872">        int orientation = slider.getOrientation();</span>
<span class="nc" id="L873">        SynthLookAndFeel.updateSubregion(context, g, thumbBounds);</span>
<span class="nc" id="L874">        context.getPainter().paintSliderThumbBackground(context, g,</span>
                             thumbBounds.x, thumbBounds.y, thumbBounds.width,
                             thumbBounds.height, orientation);
<span class="nc" id="L877">        context.getPainter().paintSliderThumbBorder(context, g,</span>
                             thumbBounds.x, thumbBounds.y, thumbBounds.width,
                             thumbBounds.height, orientation);
<span class="nc" id="L880">    }</span>

    /**
     * Paints the slider track.
     *
     * @param context context for the component being painted
     * @param g {@code Graphics} object used for painting
     * @param trackBounds bounding box for the track
     */
    protected void paintTrack(SynthContext context, Graphics g,
            Rectangle trackBounds) {
<span class="nc" id="L891">        int orientation = slider.getOrientation();</span>
<span class="nc" id="L892">        SynthLookAndFeel.updateSubregion(context, g, trackBounds);</span>
<span class="nc" id="L893">        context.getPainter().paintSliderTrackBackground(context, g,</span>
                trackBounds.x, trackBounds.y, trackBounds.width,
                trackBounds.height, orientation);
<span class="nc" id="L896">        context.getPainter().paintSliderTrackBorder(context, g,</span>
                trackBounds.x, trackBounds.y, trackBounds.width,
                trackBounds.height, orientation);
<span class="nc" id="L899">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public void propertyChange(PropertyChangeEvent e) {
<span class="nc bnc" id="L906" title="All 2 branches missed.">        if (SynthLookAndFeel.shouldUpdateStyle(e)) {</span>
<span class="nc" id="L907">            updateStyle((JSlider)e.getSource());</span>
        }
<span class="nc" id="L909">    }</span>

    //////////////////////////////////////////////////
    /// Track Listener Class
    //////////////////////////////////////////////////
    /**
     * Track mouse movements.
     */
<span class="nc" id="L917">    private class SynthTrackListener extends TrackListener {</span>

        @Override public void mouseExited(MouseEvent e) {
<span class="nc" id="L920">            setThumbActive(false);</span>
<span class="nc" id="L921">        }</span>

        @Override public void mousePressed(MouseEvent e) {
<span class="nc" id="L924">            super.mousePressed(e);</span>
<span class="nc" id="L925">            setThumbPressed(thumbRect.contains(e.getX(), e.getY()));</span>
<span class="nc" id="L926">        }</span>

        @Override public void mouseReleased(MouseEvent e) {
<span class="nc" id="L929">            super.mouseReleased(e);</span>
<span class="nc" id="L930">            updateThumbState(e.getX(), e.getY(), false);</span>
<span class="nc" id="L931">        }</span>

        @Override public void mouseDragged(MouseEvent e) {
            int thumbMiddle;

<span class="nc bnc" id="L936" title="All 2 branches missed.">            if (!slider.isEnabled()) {</span>
<span class="nc" id="L937">                return;</span>
            }

<span class="nc" id="L940">            currentMouseX = e.getX();</span>
<span class="nc" id="L941">            currentMouseY = e.getY();</span>

<span class="nc bnc" id="L943" title="All 2 branches missed.">            if (!isDragging()) {</span>
<span class="nc" id="L944">                return;</span>
            }

<span class="nc" id="L947">            slider.setValueIsAdjusting(true);</span>

<span class="nc bnc" id="L949" title="All 3 branches missed.">            switch (slider.getOrientation()) {</span>
            case JSlider.VERTICAL:
<span class="nc" id="L951">                int halfThumbHeight = thumbRect.height / 2;</span>
<span class="nc" id="L952">                int thumbTop = e.getY() - offset;</span>
<span class="nc" id="L953">                int trackTop = trackRect.y;</span>
<span class="nc" id="L954">                int trackBottom = trackRect.y + trackRect.height</span>
<span class="nc" id="L955">                    - halfThumbHeight - trackBorder;</span>
<span class="nc" id="L956">                int vMax = yPositionForValue(slider.getMaximum() -</span>
<span class="nc" id="L957">                    slider.getExtent());</span>

<span class="nc bnc" id="L959" title="All 2 branches missed.">                if (drawInverted()) {</span>
<span class="nc" id="L960">                    trackBottom = vMax;</span>
<span class="nc" id="L961">                    trackTop = trackTop + halfThumbHeight;</span>
                } else {
<span class="nc" id="L963">                    trackTop = vMax;</span>
                }
<span class="nc" id="L965">                thumbTop = Math.max(thumbTop, trackTop - halfThumbHeight);</span>
<span class="nc" id="L966">                thumbTop = Math.min(thumbTop, trackBottom - halfThumbHeight);</span>

<span class="nc" id="L968">                setThumbLocation(thumbRect.x, thumbTop);</span>

<span class="nc" id="L970">                thumbMiddle = thumbTop + halfThumbHeight;</span>
<span class="nc" id="L971">                slider.setValue(valueForYPosition(thumbMiddle));</span>
<span class="nc" id="L972">                break;</span>
            case JSlider.HORIZONTAL:
<span class="nc" id="L974">                int halfThumbWidth = thumbRect.width / 2;</span>
<span class="nc" id="L975">                int thumbLeft = e.getX() - offset;</span>
<span class="nc" id="L976">                int trackLeft = trackRect.x + halfThumbWidth + trackBorder;</span>
<span class="nc" id="L977">                int trackRight = trackRect.x + trackRect.width</span>
<span class="nc" id="L978">                    - halfThumbWidth - trackBorder;</span>
<span class="nc" id="L979">                int hMax = xPositionForValue(slider.getMaximum() -</span>
<span class="nc" id="L980">                    slider.getExtent());</span>

<span class="nc bnc" id="L982" title="All 2 branches missed.">                if (drawInverted()) {</span>
<span class="nc" id="L983">                    trackLeft = hMax;</span>
                } else {
<span class="nc" id="L985">                    trackRight = hMax;</span>
                }
<span class="nc" id="L987">                thumbLeft = Math.max(thumbLeft, trackLeft - halfThumbWidth);</span>
<span class="nc" id="L988">                thumbLeft = Math.min(thumbLeft, trackRight - halfThumbWidth);</span>

<span class="nc" id="L990">                setThumbLocation(thumbLeft, thumbRect.y);</span>

<span class="nc" id="L992">                thumbMiddle = thumbLeft + halfThumbWidth;</span>
<span class="nc" id="L993">                slider.setValue(valueForXPosition(thumbMiddle));</span>
<span class="nc" id="L994">                break;</span>
            default:
<span class="nc" id="L996">                return;</span>
            }

<span class="nc bnc" id="L999" title="All 2 branches missed.">            if (slider.getValueIsAdjusting()) {</span>
<span class="nc" id="L1000">                setThumbActive(true);</span>
            }
<span class="nc" id="L1002">        }</span>

        @Override public void mouseMoved(MouseEvent e) {
<span class="nc" id="L1005">            updateThumbState(e.getX(), e.getY());</span>
<span class="nc" id="L1006">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>