<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>SynthSplitPaneUI.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JDK</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.synth</a> &gt; <span class="el_source">SynthSplitPaneUI.java</span></div><h1>SynthSplitPaneUI.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2002, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing.plaf.synth;


import java.awt.*;
import java.awt.event.*;
import java.beans.*;
import java.util.*;
import javax.swing.*;
import javax.swing.plaf.*;
import javax.swing.plaf.basic.*;


/**
 * Provides the Synth L&amp;amp;F UI delegate for
 * {@link javax.swing.JSplitPane}.
 *
 * @author Scott Violet
 * @since 1.7
 */
<span class="nc" id="L45">public class SynthSplitPaneUI extends BasicSplitPaneUI</span>
                              implements PropertyChangeListener, SynthUI {
    /**
     * Keys to use for forward focus traversal when the JComponent is
     * managing focus.
     */
    private static Set&lt;KeyStroke&gt; managingFocusForwardTraversalKeys;

    /**
     * Keys to use for backward focus traversal when the JComponent is
     * managing focus.
     */
    private static Set&lt;KeyStroke&gt; managingFocusBackwardTraversalKeys;

    /**
     * Style for the JSplitPane.
     */
    private SynthStyle style;
    /**
     * Style for the divider.
     */
    private SynthStyle dividerStyle;


    /**
     * Creates a new SynthSplitPaneUI instance
     *
     * @param x component to create UI object for
     * @return the UI object
     */
    public static ComponentUI createUI(JComponent x) {
<span class="nc" id="L76">        return new SynthSplitPaneUI();</span>
    }

    /**
     * Installs the UI defaults.
     */
    @Override
    protected void installDefaults() {
<span class="nc" id="L84">        updateStyle(splitPane);</span>

<span class="nc" id="L86">        setOrientation(splitPane.getOrientation());</span>
<span class="nc" id="L87">        setContinuousLayout(splitPane.isContinuousLayout());</span>

<span class="nc" id="L89">        resetLayoutManager();</span>

        /* Install the nonContinuousLayoutDivider here to avoid having to
        add/remove everything later. */
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if(nonContinuousLayoutDivider == null) {</span>
<span class="nc" id="L94">            setNonContinuousLayoutDivider(</span>
<span class="nc" id="L95">                                createDefaultNonContinuousLayoutDivider(),</span>
                                true);
        } else {
<span class="nc" id="L98">            setNonContinuousLayoutDivider(nonContinuousLayoutDivider, true);</span>
        }

        // focus forward traversal key
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (managingFocusForwardTraversalKeys==null) {</span>
<span class="nc" id="L103">            managingFocusForwardTraversalKeys = new HashSet&lt;KeyStroke&gt;();</span>
<span class="nc" id="L104">            managingFocusForwardTraversalKeys.add(</span>
<span class="nc" id="L105">                KeyStroke.getKeyStroke(KeyEvent.VK_TAB, 0));</span>
        }
<span class="nc" id="L107">        splitPane.setFocusTraversalKeys(KeyboardFocusManager.FORWARD_TRAVERSAL_KEYS,</span>
                                        managingFocusForwardTraversalKeys);
        // focus backward traversal key
<span class="nc bnc" id="L110" title="All 2 branches missed.">        if (managingFocusBackwardTraversalKeys==null) {</span>
<span class="nc" id="L111">            managingFocusBackwardTraversalKeys = new HashSet&lt;KeyStroke&gt;();</span>
<span class="nc" id="L112">            managingFocusBackwardTraversalKeys.add(</span>
<span class="nc" id="L113">                KeyStroke.getKeyStroke(KeyEvent.VK_TAB, InputEvent.SHIFT_MASK));</span>
        }
<span class="nc" id="L115">        splitPane.setFocusTraversalKeys(KeyboardFocusManager.BACKWARD_TRAVERSAL_KEYS,</span>
                                        managingFocusBackwardTraversalKeys);
<span class="nc" id="L117">    }</span>

    private void updateStyle(JSplitPane splitPane) {
<span class="nc" id="L120">        SynthContext context = getContext(splitPane, Region.SPLIT_PANE_DIVIDER,</span>
                                          ENABLED);
<span class="nc" id="L122">        SynthStyle oldDividerStyle = dividerStyle;</span>
<span class="nc" id="L123">        dividerStyle = SynthLookAndFeel.updateStyle(context, this);</span>
<span class="nc" id="L124">        context.dispose();</span>

<span class="nc" id="L126">        context = getContext(splitPane, ENABLED);</span>
<span class="nc" id="L127">        SynthStyle oldStyle = style;</span>

<span class="nc" id="L129">        style = SynthLookAndFeel.updateStyle(context, this);</span>

<span class="nc bnc" id="L131" title="All 2 branches missed.">        if (style != oldStyle) {</span>
<span class="nc" id="L132">            Object value = style.get(context, &quot;SplitPane.size&quot;);</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">            if (value == null) {</span>
<span class="nc" id="L134">                value = Integer.valueOf(6);</span>
            }
<span class="nc" id="L136">            LookAndFeel.installProperty(splitPane, &quot;dividerSize&quot;, value);</span>

<span class="nc" id="L138">            value = style.get(context, &quot;SplitPane.oneTouchExpandable&quot;);</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">            if (value != null) {</span>
<span class="nc" id="L140">                LookAndFeel.installProperty(splitPane, &quot;oneTouchExpandable&quot;, value);</span>
            }

<span class="nc bnc" id="L143" title="All 2 branches missed.">            if (divider != null) {</span>
<span class="nc" id="L144">                splitPane.remove(divider);</span>
<span class="nc" id="L145">                divider.setDividerSize(splitPane.getDividerSize());</span>
            }
<span class="nc bnc" id="L147" title="All 2 branches missed.">            if (oldStyle != null) {</span>
<span class="nc" id="L148">                uninstallKeyboardActions();</span>
<span class="nc" id="L149">                installKeyboardActions();</span>
            }
        }
<span class="nc bnc" id="L152" title="All 4 branches missed.">        if (style != oldStyle || dividerStyle != oldDividerStyle) {</span>
            // Only way to force BasicSplitPaneDivider to reread the
            // necessary properties.
<span class="nc bnc" id="L155" title="All 2 branches missed.">            if (divider != null) {</span>
<span class="nc" id="L156">                splitPane.remove(divider);</span>
            }
<span class="nc" id="L158">            divider = createDefaultDivider();</span>
<span class="nc" id="L159">            divider.setBasicSplitPaneUI(this);</span>
<span class="nc" id="L160">            splitPane.add(divider, JSplitPane.DIVIDER);</span>
        }
<span class="nc" id="L162">        context.dispose();</span>
<span class="nc" id="L163">    }</span>

    /**
     * Installs the event listeners for the UI.
     */
    @Override
    protected void installListeners() {
<span class="nc" id="L170">        super.installListeners();</span>
<span class="nc" id="L171">        splitPane.addPropertyChangeListener(this);</span>
<span class="nc" id="L172">    }</span>

    /**
     * Uninstalls the UI defaults.
     */
    @Override
    protected void uninstallDefaults() {
<span class="nc" id="L179">        SynthContext context = getContext(splitPane, ENABLED);</span>

<span class="nc" id="L181">        style.uninstallDefaults(context);</span>
<span class="nc" id="L182">        context.dispose();</span>
<span class="nc" id="L183">        style = null;</span>

<span class="nc" id="L185">        context = getContext(splitPane, Region.SPLIT_PANE_DIVIDER, ENABLED);</span>
<span class="nc" id="L186">        dividerStyle.uninstallDefaults(context);</span>
<span class="nc" id="L187">        context.dispose();</span>
<span class="nc" id="L188">        dividerStyle = null;</span>

<span class="nc" id="L190">        super.uninstallDefaults();</span>
<span class="nc" id="L191">    }</span>


    /**
     * Uninstalls the event listeners from the UI.
     */
    @Override
    protected void uninstallListeners() {
<span class="nc" id="L199">        super.uninstallListeners();</span>
<span class="nc" id="L200">        splitPane.removePropertyChangeListener(this);</span>
<span class="nc" id="L201">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public SynthContext getContext(JComponent c) {
<span class="nc" id="L208">        return getContext(c, SynthLookAndFeel.getComponentState(c));</span>
    }

    private SynthContext getContext(JComponent c, int state) {
<span class="nc" id="L212">        return SynthContext.getContext(SynthContext.class, c,</span>
<span class="nc" id="L213">                    SynthLookAndFeel.getRegion(c), style, state);</span>
    }

    SynthContext getContext(JComponent c, Region region) {
<span class="nc" id="L217">        return getContext(c, region, getComponentState(c, region));</span>
    }

    private SynthContext getContext(JComponent c, Region region, int state) {
<span class="nc bnc" id="L221" title="All 2 branches missed.">        if (region == Region.SPLIT_PANE_DIVIDER) {</span>
<span class="nc" id="L222">            return SynthContext.getContext(SynthContext.class, c, region,</span>
                                           dividerStyle, state);
        }
<span class="nc" id="L225">        return SynthContext.getContext(SynthContext.class, c, region,</span>
                                       style, state);
    }

    private int getComponentState(JComponent c, Region subregion) {
<span class="nc" id="L230">        int state = SynthLookAndFeel.getComponentState(c);</span>

<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (divider.isMouseOver()) {</span>
<span class="nc" id="L233">            state |= MOUSE_OVER;</span>
        }
<span class="nc" id="L235">        return state;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public void propertyChange(PropertyChangeEvent e) {
<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (SynthLookAndFeel.shouldUpdateStyle(e)) {</span>
<span class="nc" id="L244">            updateStyle((JSplitPane)e.getSource());</span>
        }
<span class="nc" id="L246">    }</span>

    /**
     * Creates the default divider.
     */
    @Override
    public BasicSplitPaneDivider createDefaultDivider() {
<span class="nc" id="L253">        SynthSplitPaneDivider divider = new SynthSplitPaneDivider(this);</span>

<span class="nc" id="L255">        divider.setDividerSize(splitPane.getDividerSize());</span>
<span class="nc" id="L256">        return divider;</span>
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected Component createDefaultNonContinuousLayoutDivider() {
<span class="nc" id="L264">        return new Canvas() {</span>
            public void paint(Graphics g) {
<span class="nc" id="L266">                paintDragDivider(g, 0, 0, getWidth(), getHeight());</span>
<span class="nc" id="L267">            }</span>
        };
    }

    /**
     * Notifies this UI delegate to repaint the specified component.
     * This method paints the component background, then calls
     * the {@link #paint(SynthContext,Graphics)} method.
     *
     * &lt;p&gt;In general, this method does not need to be overridden by subclasses.
     * All Look and Feel rendering code should reside in the {@code paint} method.
     *
     * @param g the {@code Graphics} object used for painting
     * @param c the component being painted
     * @see #paint(SynthContext,Graphics)
     */
    @Override
    public void update(Graphics g, JComponent c) {
<span class="nc" id="L285">        SynthContext context = getContext(c);</span>

<span class="nc" id="L287">        SynthLookAndFeel.update(context, g);</span>
<span class="nc" id="L288">        context.getPainter().paintSplitPaneBackground(context,</span>
<span class="nc" id="L289">                          g, 0, 0, c.getWidth(), c.getHeight());</span>
<span class="nc" id="L290">        paint(context, g);</span>
<span class="nc" id="L291">        context.dispose();</span>
<span class="nc" id="L292">    }</span>

    /**
     * Paints the specified component according to the Look and Feel.
     * &lt;p&gt;This method is not used by Synth Look and Feel.
     * Painting is handled by the {@link #paint(SynthContext,Graphics)} method.
     *
     * @param g the {@code Graphics} object used for painting
     * @param c the component being painted
     * @see #paint(SynthContext,Graphics)
     */
    @Override
    public void paint(Graphics g, JComponent c) {
<span class="nc" id="L305">        SynthContext context = getContext(c);</span>

<span class="nc" id="L307">        paint(context, g);</span>
<span class="nc" id="L308">        context.dispose();</span>
<span class="nc" id="L309">    }</span>

    /**
     * Paints the specified component. This implementation does nothing.
     *
     * @param context context for the component being painted
     * @param g the {@code Graphics} object used for painting
     * @see #update(Graphics,JComponent)
     */
    protected void paint(SynthContext context, Graphics g) {
        // This is done to update package private variables in
        // BasicSplitPaneUI
<span class="nc" id="L321">        super.paint(g, splitPane);</span>
<span class="nc" id="L322">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public void paintBorder(SynthContext context, Graphics g, int x,
                            int y, int w, int h) {
<span class="nc" id="L330">        context.getPainter().paintSplitPaneBorder(context, g, x, y, w, h);</span>
<span class="nc" id="L331">    }</span>

    private void paintDragDivider(Graphics g, int x, int y, int w, int h) {
<span class="nc" id="L334">        SynthContext context = getContext(splitPane,Region.SPLIT_PANE_DIVIDER);</span>
<span class="nc" id="L335">        context.setComponentState(((context.getComponentState() | MOUSE_OVER) ^</span>
                                   MOUSE_OVER) | PRESSED);
<span class="nc" id="L337">        Shape oldClip = g.getClip();</span>
<span class="nc" id="L338">        g.clipRect(x, y, w, h);</span>
<span class="nc" id="L339">        context.getPainter().paintSplitPaneDragDivider(context, g, x, y, w, h,</span>
<span class="nc" id="L340">                                           splitPane.getOrientation());</span>
<span class="nc" id="L341">        g.setClip(oldClip);</span>
<span class="nc" id="L342">        context.dispose();</span>
<span class="nc" id="L343">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    public void finishedPaintingChildren(JSplitPane jc, Graphics g) {
<span class="nc bnc" id="L350" title="All 4 branches missed.">        if(jc == splitPane &amp;&amp; getLastDragLocation() != -1 &amp;&amp;</span>
<span class="nc bnc" id="L351" title="All 4 branches missed.">                              !isContinuousLayout() &amp;&amp; !draggingHW) {</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">            if(jc.getOrientation() == JSplitPane.HORIZONTAL_SPLIT) {</span>
<span class="nc" id="L353">                paintDragDivider(g, getLastDragLocation(), 0, dividerSize - 1,</span>
<span class="nc" id="L354">                                 splitPane.getHeight() - 1);</span>
            } else {
<span class="nc" id="L356">                paintDragDivider(g, 0, getLastDragLocation(),</span>
<span class="nc" id="L357">                                 splitPane.getWidth() - 1, dividerSize - 1);</span>
            }
        }
<span class="nc" id="L360">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>