<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SynthParser.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Foo</a> &gt; <a href="index.html" class="el_package">javax.swing.plaf.synth</a> &gt; <span class="el_source">SynthParser.java</span></div><h1>SynthParser.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2003, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
package javax.swing.plaf.synth;

import java.awt.Color;
import java.awt.Component;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Insets;
import java.awt.Toolkit;
import java.io.BufferedInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.StringTokenizer;
import java.util.regex.PatternSyntaxException;

import javax.swing.ImageIcon;
import javax.swing.JSplitPane;
import javax.swing.SwingConstants;
import javax.swing.UIDefaults;
import javax.swing.plaf.ColorUIResource;
import javax.swing.plaf.DimensionUIResource;
import javax.swing.plaf.FontUIResource;
import javax.swing.plaf.InsetsUIResource;
import javax.swing.plaf.UIResource;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.Attributes;
import org.xml.sax.InputSource;
import org.xml.sax.Locator;
import org.xml.sax.SAXException;
import org.xml.sax.SAXParseException;
import org.xml.sax.helpers.DefaultHandler;

import com.sun.beans.decoder.DocumentHandler;

<span class="nc bnc" id="L71" title="All 2 branches missed.">class SynthParser extends DefaultHandler {</span>
    //
    // Known element names
    //
    private static final String ELEMENT_SYNTH = &quot;synth&quot;;
    private static final String ELEMENT_STYLE = &quot;style&quot;;
    private static final String ELEMENT_STATE = &quot;state&quot;;
    private static final String ELEMENT_FONT = &quot;font&quot;;
    private static final String ELEMENT_COLOR = &quot;color&quot;;
    private static final String ELEMENT_IMAGE_PAINTER = &quot;imagePainter&quot;;
    private static final String ELEMENT_PAINTER = &quot;painter&quot;;
    private static final String ELEMENT_PROPERTY = &quot;property&quot;;
    private static final String ELEMENT_SYNTH_GRAPHICS = &quot;graphicsUtils&quot;;
    private static final String ELEMENT_IMAGE_ICON = &quot;imageIcon&quot;;
    private static final String ELEMENT_BIND = &quot;bind&quot;;
    private static final String ELEMENT_BIND_KEY = &quot;bindKey&quot;;
    private static final String ELEMENT_INSETS = &quot;insets&quot;;
    private static final String ELEMENT_OPAQUE = &quot;opaque&quot;;
    private static final String ELEMENT_DEFAULTS_PROPERTY =
                                        &quot;defaultsProperty&quot;;
    private static final String ELEMENT_INPUT_MAP = &quot;inputMap&quot;;

    //
    // Known attribute names
    //
    private static final String ATTRIBUTE_ACTION = &quot;action&quot;;
    private static final String ATTRIBUTE_ID = &quot;id&quot;;
    private static final String ATTRIBUTE_IDREF = &quot;idref&quot;;
    private static final String ATTRIBUTE_CLONE = &quot;clone&quot;;
    private static final String ATTRIBUTE_VALUE = &quot;value&quot;;
    private static final String ATTRIBUTE_NAME = &quot;name&quot;;
    private static final String ATTRIBUTE_STYLE = &quot;style&quot;;
    private static final String ATTRIBUTE_SIZE = &quot;size&quot;;
    private static final String ATTRIBUTE_TYPE = &quot;type&quot;;
    private static final String ATTRIBUTE_TOP = &quot;top&quot;;
    private static final String ATTRIBUTE_LEFT = &quot;left&quot;;
    private static final String ATTRIBUTE_BOTTOM = &quot;bottom&quot;;
    private static final String ATTRIBUTE_RIGHT = &quot;right&quot;;
    private static final String ATTRIBUTE_KEY = &quot;key&quot;;
    private static final String ATTRIBUTE_SOURCE_INSETS = &quot;sourceInsets&quot;;
    private static final String ATTRIBUTE_DEST_INSETS = &quot;destinationInsets&quot;;
    private static final String ATTRIBUTE_PATH = &quot;path&quot;;
    private static final String ATTRIBUTE_STRETCH = &quot;stretch&quot;;
    private static final String ATTRIBUTE_PAINT_CENTER = &quot;paintCenter&quot;;
    private static final String ATTRIBUTE_METHOD = &quot;method&quot;;
    private static final String ATTRIBUTE_DIRECTION = &quot;direction&quot;;
    private static final String ATTRIBUTE_CENTER = &quot;center&quot;;

    /**
     * Lazily created, used for anything we don't understand.
     */
    private DocumentHandler _handler;

    /**
     * Indicates the depth of how many elements we've encountered but don't
     * understand. This is used when forwarding to beans persistance to know
     * when we hsould stop forwarding.
     */
    private int _depth;

    /**
     * Factory that new styles are added to.
     */
    private DefaultSynthStyleFactory _factory;

    /**
     * Array of state infos for the current style. These are pushed to the
     * style when &lt;/style&gt; is received.
     */
    private List&lt;ParsedSynthStyle.StateInfo&gt; _stateInfos;

    /**
     * Current style.
     */
    private ParsedSynthStyle _style;

    /**
     * Current state info.
     */
    private ParsedSynthStyle.StateInfo _stateInfo;

    /**
     * Bindings for the current InputMap
     */
    private List&lt;String&gt; _inputMapBindings;

    /**
     * ID for the input map. This is cached as
     * the InputMap is created AFTER the inputMapProperty has ended.
     */
    private String _inputMapID;

    /**
     * Object references outside the scope of persistance.
     */
    private Map&lt;String,Object&gt; _mapping;

    /**
     * Based URL used to resolve paths.
     */
    private URL _urlResourceBase;

    /**
     * Based class used to resolve paths.
     */
    private Class&lt;?&gt; _classResourceBase;

    /**
     * List of ColorTypes. This is populated in startColorType.
     */
    private List&lt;ColorType&gt; _colorTypes;

    /**
     * defaultsPropertys are placed here.
     */
    private Map&lt;String, Object&gt; _defaultsMap;

    /**
     * List of SynthStyle.Painters that will be applied to the current style.
     */
    private List&lt;ParsedSynthStyle.PainterInfo&gt; _stylePainters;

    /**
     * List of SynthStyle.Painters that will be applied to the current state.
     */
    private List&lt;ParsedSynthStyle.PainterInfo&gt; _statePainters;

<span class="nc" id="L198">    SynthParser() {</span>
<span class="nc" id="L199">        _mapping = new HashMap&lt;String,Object&gt;();</span>
<span class="nc" id="L200">        _stateInfos = new ArrayList&lt;ParsedSynthStyle.StateInfo&gt;();</span>
<span class="nc" id="L201">        _colorTypes = new ArrayList&lt;ColorType&gt;();</span>
<span class="nc" id="L202">        _inputMapBindings = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L203">        _stylePainters = new ArrayList&lt;ParsedSynthStyle.PainterInfo&gt;();</span>
<span class="nc" id="L204">        _statePainters = new ArrayList&lt;ParsedSynthStyle.PainterInfo&gt;();</span>
<span class="nc" id="L205">    }</span>

    /**
     * Parses a set of styles from &lt;code&gt;inputStream&lt;/code&gt;, adding the
     * resulting styles to the passed in DefaultSynthStyleFactory.
     * Resources are resolved either from a URL or from a Class. When calling
     * this method, one of the URL or the Class must be null but not both at
     * the same time.
     *
     * @param inputStream XML document containing the styles to read
     * @param factory DefaultSynthStyleFactory that new styles are added to
     * @param urlResourceBase the URL used to resolve any resources, such as Images
     * @param classResourceBase the Class used to resolve any resources, such as Images
     * @param defaultsMap Map that UIDefaults properties are placed in
     */
    public void parse(InputStream inputStream,
                      DefaultSynthStyleFactory factory,
                      URL urlResourceBase, Class&lt;?&gt; classResourceBase,
                      Map&lt;String, Object&gt; defaultsMap)
                      throws ParseException, IllegalArgumentException {
<span class="nc bnc" id="L225" title="All 8 branches missed.">        if (inputStream == null || factory == null ||</span>
            (urlResourceBase == null &amp;&amp; classResourceBase == null)) {
<span class="nc" id="L227">            throw new IllegalArgumentException(</span>
                &quot;You must supply an InputStream, StyleFactory and Class or URL&quot;);
        }

<span class="nc bnc" id="L231" title="All 6 branches missed.">        assert(!(urlResourceBase != null &amp;&amp; classResourceBase != null));</span>

<span class="nc" id="L233">        _factory = factory;</span>
<span class="nc" id="L234">        _classResourceBase = classResourceBase;</span>
<span class="nc" id="L235">        _urlResourceBase = urlResourceBase;</span>
<span class="nc" id="L236">        _defaultsMap = defaultsMap;</span>
        try {
            try {
<span class="nc" id="L239">                SAXParser saxParser = SAXParserFactory.newInstance().</span>
<span class="nc" id="L240">                                                   newSAXParser();</span>
<span class="nc" id="L241">                saxParser.parse(new BufferedInputStream(inputStream), this);</span>
<span class="nc" id="L242">            } catch (ParserConfigurationException e) {</span>
<span class="nc" id="L243">                throw new ParseException(&quot;Error parsing: &quot; + e, 0);</span>
            }
<span class="nc" id="L245">            catch (SAXException se) {</span>
<span class="nc" id="L246">                throw new ParseException(&quot;Error parsing: &quot; + se + &quot; &quot; +</span>
<span class="nc" id="L247">                                         se.getException(), 0);</span>
            }
<span class="nc" id="L249">            catch (IOException ioe) {</span>
<span class="nc" id="L250">                throw new ParseException(&quot;Error parsing: &quot; + ioe, 0);</span>
<span class="nc" id="L251">            }</span>
        } finally {
<span class="nc" id="L253">            reset();</span>
<span class="nc" id="L254">        }</span>
<span class="nc" id="L255">    }</span>

    /**
     * Returns the path to a resource.
     */
    private URL getResource(String path) {
<span class="nc bnc" id="L261" title="All 2 branches missed.">        if (_classResourceBase != null) {</span>
<span class="nc" id="L262">            return _classResourceBase.getResource(path);</span>
        } else {
            try {
<span class="nc" id="L265">                return new URL(_urlResourceBase, path);</span>
<span class="nc" id="L266">            } catch (MalformedURLException mue) {</span>
<span class="nc" id="L267">                return null;</span>
            }
        }
    }

    /**
     * Clears our internal state.
     */
    private void reset() {
<span class="nc" id="L276">        _handler = null;</span>
<span class="nc" id="L277">        _depth = 0;</span>
<span class="nc" id="L278">        _mapping.clear();</span>
<span class="nc" id="L279">        _stateInfos.clear();</span>
<span class="nc" id="L280">        _colorTypes.clear();</span>
<span class="nc" id="L281">        _statePainters.clear();</span>
<span class="nc" id="L282">        _stylePainters.clear();</span>
<span class="nc" id="L283">    }</span>

    /**
     * Returns true if we are forwarding to persistance.
     */
    private boolean isForwarding() {
<span class="nc bnc" id="L289" title="All 2 branches missed.">        return (_depth &gt; 0);</span>
    }

    /**
     * Handles beans persistance.
     */
    private DocumentHandler getHandler() {
<span class="nc bnc" id="L296" title="All 2 branches missed.">        if (_handler == null) {</span>
<span class="nc" id="L297">            _handler = new DocumentHandler();</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">            if (_urlResourceBase != null) {</span>
                // getHandler() is never called before parse() so it is safe
                // to create a URLClassLoader with _resourceBase.
                //
                // getResource(&quot;.&quot;) is called to ensure we have the directory
                // containing the resources in the case the resource base is a
                // .class file.
<span class="nc" id="L305">                URL[] urls = new URL[] { getResource(&quot;.&quot;) };</span>
<span class="nc" id="L306">                ClassLoader parent = Thread.currentThread().getContextClassLoader();</span>
<span class="nc" id="L307">                ClassLoader urlLoader = new URLClassLoader(urls, parent);</span>
<span class="nc" id="L308">                _handler.setClassLoader(urlLoader);</span>
<span class="nc" id="L309">            } else {</span>
<span class="nc" id="L310">                _handler.setClassLoader(_classResourceBase.getClassLoader());</span>
            }

<span class="nc bnc" id="L313" title="All 2 branches missed.">            for (String key : _mapping.keySet()) {</span>
<span class="nc" id="L314">                _handler.setVariable(key, _mapping.get(key));</span>
<span class="nc" id="L315">            }</span>
        }
<span class="nc" id="L317">        return _handler;</span>
    }

    /**
     * If &lt;code&gt;value&lt;/code&gt; is an instance of &lt;code&gt;type&lt;/code&gt; it is
     * returned, otherwise a SAXException is thrown.
     */
    private Object checkCast(Object value, Class type) throws SAXException {
<span class="nc bnc" id="L325" title="All 2 branches missed.">        if (!type.isInstance(value)) {</span>
<span class="nc" id="L326">            throw new SAXException(&quot;Expected type &quot; + type + &quot; got &quot; +</span>
<span class="nc" id="L327">                                   value.getClass());</span>
        }
<span class="nc" id="L329">        return value;</span>
    }

    /**
     * Returns an object created with id=key. If the object is not of
     * type type, this will throw an exception.
     */
    private Object lookup(String key, Class type) throws SAXException {
        Object value;
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (_handler != null) {</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">            if (_handler.hasVariable(key)) {</span>
<span class="nc" id="L340">                return checkCast(_handler.getVariable(key), type);</span>
            }
        }
<span class="nc" id="L343">        value = _mapping.get(key);</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L345">            throw new SAXException(&quot;ID &quot; + key + &quot; has not been defined&quot;);</span>
        }
<span class="nc" id="L347">        return checkCast(value, type);</span>
    }

    /**
     * Registers an object by name. This will throw an exception if an
     * object has already been registered under the given name.
     */
    private void register(String key, Object value) throws SAXException {
<span class="nc bnc" id="L355" title="All 2 branches missed.">        if (key != null) {</span>
<span class="nc bnc" id="L356" title="All 4 branches missed.">            if (_mapping.get(key) != null ||</span>
<span class="nc bnc" id="L357" title="All 2 branches missed.">                     (_handler != null &amp;&amp; _handler.hasVariable(key))) {</span>
<span class="nc" id="L358">                throw new SAXException(&quot;ID &quot; + key + &quot; is already defined&quot;);</span>
            }
<span class="nc bnc" id="L360" title="All 2 branches missed.">            if (_handler != null) {</span>
<span class="nc" id="L361">                _handler.setVariable(key, value);</span>
            }
            else {
<span class="nc" id="L364">                _mapping.put(key, value);</span>
            }
        }
<span class="nc" id="L367">    }</span>

    /**
     * Convenience method to return the next int, or throw if there are no
     * more valid ints.
     */
    private int nextInt(StringTokenizer tok, String errorMsg) throws
                   SAXException {
<span class="nc bnc" id="L375" title="All 2 branches missed.">        if (!tok.hasMoreTokens()) {</span>
<span class="nc" id="L376">            throw new SAXException(errorMsg);</span>
        }
        try {
<span class="nc" id="L379">            return Integer.parseInt(tok.nextToken());</span>
<span class="nc" id="L380">        } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L381">            throw new SAXException(errorMsg);</span>
        }
    }

    /**
     * Convenience method to return an Insets object.
     */
    private Insets parseInsets(String insets, String errorMsg) throws
                        SAXException {
<span class="nc" id="L390">        StringTokenizer tokenizer = new StringTokenizer(insets);</span>
<span class="nc" id="L391">        return new Insets(nextInt(tokenizer, errorMsg),</span>
<span class="nc" id="L392">                          nextInt(tokenizer, errorMsg),</span>
<span class="nc" id="L393">                          nextInt(tokenizer, errorMsg),</span>
<span class="nc" id="L394">                          nextInt(tokenizer, errorMsg));</span>
    }



    //
    // The following methods are invoked from startElement/stopElement
    //

    private void startStyle(Attributes attributes) throws SAXException {
<span class="nc" id="L404">        String id = null;</span>

<span class="nc" id="L406">        _style = null;</span>
<span class="nc bnc" id="L407" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L408">            String key = attributes.getQName(i);</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_CLONE)) {</span>
<span class="nc" id="L410">                _style = (ParsedSynthStyle)((ParsedSynthStyle)lookup(</span>
<span class="nc" id="L411">                         attributes.getValue(i), ParsedSynthStyle.class)).</span>
<span class="nc" id="L412">                         clone();</span>
            }
<span class="nc bnc" id="L414" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L415">                id = attributes.getValue(i);</span>
            }
        }
<span class="nc bnc" id="L418" title="All 2 branches missed.">        if (_style == null) {</span>
<span class="nc" id="L419">            _style = new ParsedSynthStyle();</span>
        }
<span class="nc" id="L421">        register(id, _style);</span>
<span class="nc" id="L422">    }</span>

    private void endStyle() {
<span class="nc" id="L425">        int size = _stylePainters.size();</span>
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (size &gt; 0) {</span>
<span class="nc" id="L427">            _style.setPainters(_stylePainters.toArray(new ParsedSynthStyle.PainterInfo[size]));</span>
<span class="nc" id="L428">            _stylePainters.clear();</span>
        }
<span class="nc" id="L430">        size = _stateInfos.size();</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">        if (size &gt; 0) {</span>
<span class="nc" id="L432">            _style.setStateInfo(_stateInfos.toArray(new ParsedSynthStyle.StateInfo[size]));</span>
<span class="nc" id="L433">            _stateInfos.clear();</span>
        }
<span class="nc" id="L435">        _style = null;</span>
<span class="nc" id="L436">    }</span>

    private void startState(Attributes attributes) throws SAXException {
<span class="nc" id="L439">        ParsedSynthStyle.StateInfo stateInfo = null;</span>
<span class="nc" id="L440">        int state = 0;</span>
<span class="nc" id="L441">        String id = null;</span>

<span class="nc" id="L443">        _stateInfo = null;</span>
<span class="nc bnc" id="L444" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L445">            String key = attributes.getQName(i);</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L447">                id = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L449" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L450">                _stateInfo = (ParsedSynthStyle.StateInfo)lookup(</span>
<span class="nc" id="L451">                   attributes.getValue(i), ParsedSynthStyle.StateInfo.class);</span>
            }
<span class="nc bnc" id="L453" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_CLONE)) {</span>
<span class="nc" id="L454">                _stateInfo = (ParsedSynthStyle.StateInfo)((ParsedSynthStyle.</span>
<span class="nc" id="L455">                             StateInfo)lookup(attributes.getValue(i),</span>
<span class="nc" id="L456">                             ParsedSynthStyle.StateInfo.class)).clone();</span>
            }
<span class="nc bnc" id="L458" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_VALUE)) {</span>
<span class="nc" id="L459">                StringTokenizer tokenizer = new StringTokenizer(</span>
<span class="nc" id="L460">                                   attributes.getValue(i));</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">                while (tokenizer.hasMoreTokens()) {</span>
<span class="nc" id="L462">                    String stateString = tokenizer.nextToken().toUpperCase().</span>
<span class="nc" id="L463">                                                   intern();</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">                    if (stateString == &quot;ENABLED&quot;) {</span>
<span class="nc" id="L465">                        state |= SynthConstants.ENABLED;</span>
                    }
<span class="nc bnc" id="L467" title="All 2 branches missed.">                    else if (stateString == &quot;MOUSE_OVER&quot;) {</span>
<span class="nc" id="L468">                        state |= SynthConstants.MOUSE_OVER;</span>
                    }
<span class="nc bnc" id="L470" title="All 2 branches missed.">                    else if (stateString == &quot;PRESSED&quot;) {</span>
<span class="nc" id="L471">                        state |= SynthConstants.PRESSED;</span>
                    }
<span class="nc bnc" id="L473" title="All 2 branches missed.">                    else if (stateString == &quot;DISABLED&quot;) {</span>
<span class="nc" id="L474">                        state |= SynthConstants.DISABLED;</span>
                    }
<span class="nc bnc" id="L476" title="All 2 branches missed.">                    else if (stateString == &quot;FOCUSED&quot;) {</span>
<span class="nc" id="L477">                        state |= SynthConstants.FOCUSED;</span>
                    }
<span class="nc bnc" id="L479" title="All 2 branches missed.">                    else if (stateString == &quot;SELECTED&quot;) {</span>
<span class="nc" id="L480">                        state |= SynthConstants.SELECTED;</span>
                    }
<span class="nc bnc" id="L482" title="All 2 branches missed.">                    else if (stateString == &quot;DEFAULT&quot;) {</span>
<span class="nc" id="L483">                        state |= SynthConstants.DEFAULT;</span>
                    }
<span class="nc bnc" id="L485" title="All 2 branches missed.">                    else if (stateString != &quot;AND&quot;) {</span>
<span class="nc" id="L486">                        throw new SAXException(&quot;Unknown state: &quot; + state);</span>
                    }
<span class="nc" id="L488">                }</span>
            }
        }
<span class="nc bnc" id="L491" title="All 2 branches missed.">        if (_stateInfo == null) {</span>
<span class="nc" id="L492">            _stateInfo = new ParsedSynthStyle.StateInfo();</span>
        }
<span class="nc" id="L494">        _stateInfo.setComponentState(state);</span>
<span class="nc" id="L495">        register(id, _stateInfo);</span>
<span class="nc" id="L496">        _stateInfos.add(_stateInfo);</span>
<span class="nc" id="L497">    }</span>

    private void endState() {
<span class="nc" id="L500">        int size = _statePainters.size();</span>
<span class="nc bnc" id="L501" title="All 2 branches missed.">        if (size &gt; 0) {</span>
<span class="nc" id="L502">            _stateInfo.setPainters(_statePainters.toArray(new ParsedSynthStyle.PainterInfo[size]));</span>
<span class="nc" id="L503">            _statePainters.clear();</span>
        }
<span class="nc" id="L505">        _stateInfo = null;</span>
<span class="nc" id="L506">    }</span>

    private void startFont(Attributes attributes) throws SAXException {
<span class="nc" id="L509">        Font font = null;</span>
<span class="nc" id="L510">        int style = Font.PLAIN;</span>
<span class="nc" id="L511">        int size = 0;</span>
<span class="nc" id="L512">        String id = null;</span>
<span class="nc" id="L513">        String name = null;</span>

<span class="nc bnc" id="L515" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L516">            String key = attributes.getQName(i);</span>
<span class="nc bnc" id="L517" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L518">                id = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L520" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L521">                font = (Font)lookup(attributes.getValue(i), Font.class);</span>
            }
<span class="nc bnc" id="L523" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_NAME)) {</span>
<span class="nc" id="L524">                name = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L526" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_SIZE)) {</span>
                try {
<span class="nc" id="L528">                    size = Integer.parseInt(attributes.getValue(i));</span>
<span class="nc" id="L529">                } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L530">                    throw new SAXException(&quot;Invalid font size: &quot; +</span>
<span class="nc" id="L531">                                           attributes.getValue(i));</span>
<span class="nc" id="L532">                }</span>
            }
<span class="nc bnc" id="L534" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_STYLE)) {</span>
<span class="nc" id="L535">                StringTokenizer tok = new StringTokenizer(</span>
<span class="nc" id="L536">                                                attributes.getValue(i));</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">                while (tok.hasMoreTokens()) {</span>
<span class="nc" id="L538">                    String token = tok.nextToken().intern();</span>
<span class="nc bnc" id="L539" title="All 2 branches missed.">                    if (token == &quot;BOLD&quot;) {</span>
<span class="nc" id="L540">                        style = ((style | Font.PLAIN) ^ Font.PLAIN) |</span>
                                Font.BOLD;
                    }
<span class="nc bnc" id="L543" title="All 2 branches missed.">                    else if (token == &quot;ITALIC&quot;) {</span>
<span class="nc" id="L544">                        style |= Font.ITALIC;</span>
                    }
<span class="nc" id="L546">                }</span>
            }
        }
<span class="nc bnc" id="L549" title="All 2 branches missed.">        if (font == null) {</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">            if (name == null) {</span>
<span class="nc" id="L551">                throw new SAXException(&quot;You must define a name for the font&quot;);</span>
            }
<span class="nc bnc" id="L553" title="All 2 branches missed.">            if (size == 0) {</span>
<span class="nc" id="L554">                throw new SAXException(&quot;You must define a size for the font&quot;);</span>
            }
<span class="nc" id="L556">            font = new FontUIResource(name, style, size);</span>
        }
<span class="nc bnc" id="L558" title="All 6 branches missed.">        else if (name != null || size != 0 || style != Font.PLAIN) {</span>
<span class="nc" id="L559">            throw new SAXException(&quot;Name, size and style are not for use &quot; +</span>
                                   &quot;with idref&quot;);
        }
<span class="nc" id="L562">        register(id, font);</span>
<span class="nc bnc" id="L563" title="All 2 branches missed.">        if (_stateInfo != null) {</span>
<span class="nc" id="L564">            _stateInfo.setFont(font);</span>
        }
<span class="nc bnc" id="L566" title="All 2 branches missed.">        else if (_style != null) {</span>
<span class="nc" id="L567">            _style.setFont(font);</span>
        }
<span class="nc" id="L569">    }</span>

    private void startColor(Attributes attributes) throws SAXException {
<span class="nc" id="L572">        Color color = null;</span>
<span class="nc" id="L573">        String id = null;</span>

<span class="nc" id="L575">        _colorTypes.clear();</span>
<span class="nc bnc" id="L576" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L577">            String key = attributes.getQName(i);</span>
<span class="nc bnc" id="L578" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L579">                id = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L581" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L582">                color = (Color)lookup(attributes.getValue(i), Color.class);</span>
            }
<span class="nc bnc" id="L584" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_NAME)) {</span>
            }
<span class="nc bnc" id="L586" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_VALUE)) {</span>
<span class="nc" id="L587">                String value = attributes.getValue(i);</span>

<span class="nc bnc" id="L589" title="All 2 branches missed.">                if (value.startsWith(&quot;#&quot;)) {</span>
                    try {
                        int argb;
                        boolean hasAlpha;

<span class="nc" id="L594">                        int length = value.length();</span>
<span class="nc bnc" id="L595" title="All 2 branches missed.">                        if (length &lt; 8) {</span>
                            // Just RGB, or some portion of it.
<span class="nc" id="L597">                            argb = Integer.decode(value);</span>
<span class="nc" id="L598">                            hasAlpha = false;</span>
<span class="nc bnc" id="L599" title="All 2 branches missed.">                        } else if (length == 8) {</span>
                            // Single character alpha: #ARRGGBB.
<span class="nc" id="L601">                            argb = Integer.decode(value);</span>
<span class="nc" id="L602">                            hasAlpha = true;</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">                        } else if (length == 9) {</span>
                            // Color has alpha and is of the form
                            // #AARRGGBB.
                            // The following split decoding is mandatory due to
                            // Integer.decode() behavior which won't decode
                            // hexadecimal values higher than #7FFFFFFF.
                            // Thus, when an alpha channel is detected, it is
                            // decoded separately from the RGB channels.
<span class="nc" id="L611">                            int rgb = Integer.decode('#' +</span>
<span class="nc" id="L612">                                                     value.substring(3, 9));</span>
<span class="nc" id="L613">                            int a = Integer.decode(value.substring(0, 3));</span>
<span class="nc" id="L614">                            argb = (a &lt;&lt; 24) | rgb;</span>
<span class="nc" id="L615">                            hasAlpha = true;</span>
<span class="nc" id="L616">                        } else {</span>
<span class="nc" id="L617">                            throw new SAXException(&quot;Invalid Color value: &quot;</span>
                                + value);
                        }

<span class="nc" id="L621">                        color = new ColorUIResource(new Color(argb, hasAlpha));</span>
<span class="nc" id="L622">                    } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L623">                        throw new SAXException(&quot;Invalid Color value: &quot; +value);</span>
<span class="nc" id="L624">                    }</span>
                }
                else {
                    try {
<span class="nc" id="L628">                        color = new ColorUIResource((Color)Color.class.</span>
<span class="nc" id="L629">                              getField(value.toUpperCase()).get(Color.class));</span>
<span class="nc" id="L630">                    } catch (NoSuchFieldException nsfe) {</span>
<span class="nc" id="L631">                        throw new SAXException(&quot;Invalid color name: &quot; + value);</span>
<span class="nc" id="L632">                    } catch (IllegalAccessException iae) {</span>
<span class="nc" id="L633">                        throw new SAXException(&quot;Invalid color name: &quot; + value);</span>
<span class="nc" id="L634">                    }</span>
                }
<span class="nc" id="L636">            }</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_TYPE)) {</span>
<span class="nc" id="L638">                StringTokenizer tokenizer = new StringTokenizer(</span>
<span class="nc" id="L639">                                   attributes.getValue(i));</span>
<span class="nc bnc" id="L640" title="All 2 branches missed.">                while (tokenizer.hasMoreTokens()) {</span>
<span class="nc" id="L641">                    String typeName = tokenizer.nextToken();</span>
<span class="nc" id="L642">                    int classIndex = typeName.lastIndexOf('.');</span>
                    Class typeClass;

<span class="nc bnc" id="L645" title="All 2 branches missed.">                    if (classIndex == -1) {</span>
<span class="nc" id="L646">                        typeClass = ColorType.class;</span>
<span class="nc" id="L647">                        classIndex = 0;</span>
                    }
                    else {
                        try {
<span class="nc" id="L651">                            typeClass = Class.forName(typeName.substring(</span>
                                                      0, classIndex));
<span class="nc" id="L653">                        } catch (ClassNotFoundException cnfe) {</span>
<span class="nc" id="L654">                            throw new SAXException(&quot;Unknown class: &quot; +</span>
<span class="nc" id="L655">                                      typeName.substring(0, classIndex));</span>
<span class="nc" id="L656">                        }</span>
<span class="nc" id="L657">                        classIndex++;</span>
                    }
                    try {
<span class="nc" id="L660">                        _colorTypes.add((ColorType)checkCast(typeClass.</span>
<span class="nc" id="L661">                              getField(typeName.substring(classIndex)).</span>
<span class="nc" id="L662">                              get(typeClass), ColorType.class));</span>
<span class="nc" id="L663">                    } catch (NoSuchFieldException nsfe) {</span>
<span class="nc" id="L664">                        throw new SAXException(&quot;Unable to find color type: &quot; +</span>
                                               typeName);
<span class="nc" id="L666">                    } catch (IllegalAccessException iae) {</span>
<span class="nc" id="L667">                        throw new SAXException(&quot;Unable to find color type: &quot; +</span>
                                               typeName);
<span class="nc" id="L669">                    }</span>
<span class="nc" id="L670">                }</span>
            }
        }
<span class="nc bnc" id="L673" title="All 2 branches missed.">        if (color == null) {</span>
<span class="nc" id="L674">            throw new SAXException(&quot;color: you must specificy a value&quot;);</span>
        }
<span class="nc" id="L676">        register(id, color);</span>
<span class="nc bnc" id="L677" title="All 4 branches missed.">        if (_stateInfo != null &amp;&amp; _colorTypes.size() &gt; 0) {</span>
<span class="nc" id="L678">            Color[] colors = _stateInfo.getColors();</span>
<span class="nc" id="L679">            int max = 0;</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">            for (int counter = _colorTypes.size() - 1; counter &gt;= 0;</span>
<span class="nc" id="L681">                     counter--) {</span>
<span class="nc" id="L682">                max = Math.max(max, _colorTypes.get(counter).getID());</span>
            }
<span class="nc bnc" id="L684" title="All 4 branches missed.">            if (colors == null || colors.length &lt;= max) {</span>
<span class="nc" id="L685">                Color[] newColors = new Color[max + 1];</span>
<span class="nc bnc" id="L686" title="All 2 branches missed.">                if (colors != null) {</span>
<span class="nc" id="L687">                    System.arraycopy(colors, 0, newColors, 0, colors.length);</span>
                }
<span class="nc" id="L689">                colors = newColors;</span>
            }
<span class="nc bnc" id="L691" title="All 2 branches missed.">            for (int counter = _colorTypes.size() - 1; counter &gt;= 0;</span>
<span class="nc" id="L692">                     counter--) {</span>
<span class="nc" id="L693">                colors[_colorTypes.get(counter).getID()] = color;</span>
            }
<span class="nc" id="L695">            _stateInfo.setColors(colors);</span>
        }
<span class="nc" id="L697">    }</span>

    private void startProperty(Attributes attributes,
                               Object property) throws SAXException {
<span class="nc" id="L701">        Object value = null;</span>
<span class="nc" id="L702">        String key = null;</span>
        // Type of the value: 0=idref, 1=boolean, 2=dimension, 3=insets,
        // 4=integer,5=string
<span class="nc" id="L705">        int iType = 0;</span>
<span class="nc" id="L706">        String aValue = null;</span>

<span class="nc bnc" id="L708" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L709">            String aName = attributes.getQName(i);</span>
<span class="nc bnc" id="L710" title="All 2 branches missed.">            if (aName.equals(ATTRIBUTE_TYPE)) {</span>
<span class="nc" id="L711">                String type = attributes.getValue(i).toUpperCase();</span>
<span class="nc bnc" id="L712" title="All 2 branches missed.">                if (type.equals(&quot;IDREF&quot;)) {</span>
<span class="nc" id="L713">                    iType = 0;</span>
                }
<span class="nc bnc" id="L715" title="All 2 branches missed.">                else if (type.equals(&quot;BOOLEAN&quot;)) {</span>
<span class="nc" id="L716">                    iType = 1;</span>
                }
<span class="nc bnc" id="L718" title="All 2 branches missed.">                else if (type.equals(&quot;DIMENSION&quot;)) {</span>
<span class="nc" id="L719">                    iType = 2;</span>
                }
<span class="nc bnc" id="L721" title="All 2 branches missed.">                else if (type.equals(&quot;INSETS&quot;)) {</span>
<span class="nc" id="L722">                    iType = 3;</span>
                }
<span class="nc bnc" id="L724" title="All 2 branches missed.">                else if (type.equals(&quot;INTEGER&quot;)) {</span>
<span class="nc" id="L725">                    iType = 4;</span>
                }
<span class="nc bnc" id="L727" title="All 2 branches missed.">                else if (type.equals(&quot;STRING&quot;)) {</span>
<span class="nc" id="L728">                    iType = 5;</span>
                }
                else {
<span class="nc" id="L731">                    throw new SAXException(property + &quot; unknown type, use&quot; +</span>
                        &quot;idref, boolean, dimension, insets or integer&quot;);
                }
<span class="nc" id="L734">            }</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">            else if (aName.equals(ATTRIBUTE_VALUE)) {</span>
<span class="nc" id="L736">                aValue = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L738" title="All 2 branches missed.">            else if (aName.equals(ATTRIBUTE_KEY)) {</span>
<span class="nc" id="L739">                key = attributes.getValue(i);</span>
            }
        }
<span class="nc bnc" id="L742" title="All 2 branches missed.">        if (aValue != null) {</span>
<span class="nc bnc" id="L743" title="All 7 branches missed.">            switch (iType) {</span>
            case 0: // idref
<span class="nc" id="L745">                value = lookup(aValue, Object.class);</span>
<span class="nc" id="L746">                break;</span>
            case 1: // boolean
<span class="nc bnc" id="L748" title="All 2 branches missed.">                if (aValue.toUpperCase().equals(&quot;TRUE&quot;)) {</span>
<span class="nc" id="L749">                    value = Boolean.TRUE;</span>
                }
                else {
<span class="nc" id="L752">                    value = Boolean.FALSE;</span>
                }
<span class="nc" id="L754">                break;</span>
            case 2: // dimension
<span class="nc" id="L756">                StringTokenizer tok = new StringTokenizer(aValue);</span>
<span class="nc" id="L757">                value = new DimensionUIResource(</span>
<span class="nc" id="L758">                    nextInt(tok, &quot;Invalid dimension&quot;),</span>
<span class="nc" id="L759">                    nextInt(tok, &quot;Invalid dimension&quot;));</span>
<span class="nc" id="L760">                break;</span>
            case 3: // insets
<span class="nc" id="L762">                value = parseInsets(aValue, property + &quot; invalid insets&quot;);</span>
<span class="nc" id="L763">                break;</span>
            case 4: // integer
                try {
<span class="nc" id="L766">                    value = new Integer(Integer.parseInt(aValue));</span>
<span class="nc" id="L767">                } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L768">                    throw new SAXException(property + &quot; invalid value&quot;);</span>
<span class="nc" id="L769">                }</span>
                break;
            case 5: //string
<span class="nc" id="L772">                value = aValue;</span>
                break;
            }
        }
<span class="nc bnc" id="L776" title="All 4 branches missed.">        if (value == null || key == null) {</span>
<span class="nc" id="L777">            throw new SAXException(property + &quot;: you must supply a &quot; +</span>
                                   &quot;key and value&quot;);
        }
<span class="nc bnc" id="L780" title="All 2 branches missed.">        if (property == ELEMENT_DEFAULTS_PROPERTY) {</span>
<span class="nc" id="L781">            _defaultsMap.put(key, value);</span>
        }
<span class="nc bnc" id="L783" title="All 2 branches missed.">        else if (_stateInfo != null) {</span>
<span class="nc bnc" id="L784" title="All 2 branches missed.">            if (_stateInfo.getData() == null) {</span>
<span class="nc" id="L785">                _stateInfo.setData(new HashMap());</span>
            }
<span class="nc" id="L787">            _stateInfo.getData().put(key, value);</span>
        }
<span class="nc bnc" id="L789" title="All 2 branches missed.">        else if (_style != null) {</span>
<span class="nc bnc" id="L790" title="All 2 branches missed.">            if (_style.getData() == null) {</span>
<span class="nc" id="L791">                _style.setData(new HashMap());</span>
            }
<span class="nc" id="L793">            _style.getData().put(key, value);</span>
        }
<span class="nc" id="L795">    }</span>

    private void startGraphics(Attributes attributes) throws SAXException {
<span class="nc" id="L798">        SynthGraphicsUtils graphics = null;</span>

<span class="nc bnc" id="L800" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L801">            String key = attributes.getQName(i);</span>
<span class="nc bnc" id="L802" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L803">                graphics = (SynthGraphicsUtils)lookup(attributes.getValue(i),</span>
                                                 SynthGraphicsUtils.class);
            }
        }
<span class="nc bnc" id="L807" title="All 2 branches missed.">        if (graphics == null) {</span>
<span class="nc" id="L808">            throw new SAXException(&quot;graphicsUtils: you must supply an idref&quot;);</span>
        }
<span class="nc bnc" id="L810" title="All 2 branches missed.">        if (_style != null) {</span>
<span class="nc" id="L811">            _style.setGraphicsUtils(graphics);</span>
        }
<span class="nc" id="L813">    }</span>

    private void startInsets(Attributes attributes) throws SAXException {
<span class="nc" id="L816">        int top = 0;</span>
<span class="nc" id="L817">        int bottom = 0;</span>
<span class="nc" id="L818">        int left = 0;</span>
<span class="nc" id="L819">        int right = 0;</span>
<span class="nc" id="L820">        Insets insets = null;</span>
<span class="nc" id="L821">        String id = null;</span>

<span class="nc bnc" id="L823" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L824">            String key = attributes.getQName(i);</span>

            try {
<span class="nc bnc" id="L827" title="All 2 branches missed.">                if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L828">                    insets = (Insets)lookup(attributes.getValue(i),</span>
                                                   Insets.class);
                }
<span class="nc bnc" id="L831" title="All 2 branches missed.">                else if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L832">                    id = attributes.getValue(i);</span>
                }
<span class="nc bnc" id="L834" title="All 2 branches missed.">                else if (key.equals(ATTRIBUTE_TOP)) {</span>
<span class="nc" id="L835">                    top = Integer.parseInt(attributes.getValue(i));</span>
                }
<span class="nc bnc" id="L837" title="All 2 branches missed.">                else if (key.equals(ATTRIBUTE_LEFT)) {</span>
<span class="nc" id="L838">                    left = Integer.parseInt(attributes.getValue(i));</span>
                }
<span class="nc bnc" id="L840" title="All 2 branches missed.">                else if (key.equals(ATTRIBUTE_BOTTOM)) {</span>
<span class="nc" id="L841">                    bottom = Integer.parseInt(attributes.getValue(i));</span>
                }
<span class="nc bnc" id="L843" title="All 2 branches missed.">                else if (key.equals(ATTRIBUTE_RIGHT)) {</span>
<span class="nc" id="L844">                    right = Integer.parseInt(attributes.getValue(i));</span>
                }
<span class="nc" id="L846">            } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L847">                throw new SAXException(&quot;insets: bad integer value for &quot; +</span>
<span class="nc" id="L848">                                       attributes.getValue(i));</span>
<span class="nc" id="L849">            }</span>
        }
<span class="nc bnc" id="L851" title="All 2 branches missed.">        if (insets == null) {</span>
<span class="nc" id="L852">            insets = new InsetsUIResource(top, left, bottom, right);</span>
        }
<span class="nc" id="L854">        register(id, insets);</span>
<span class="nc bnc" id="L855" title="All 2 branches missed.">        if (_style != null) {</span>
<span class="nc" id="L856">            _style.setInsets(insets);</span>
        }
<span class="nc" id="L858">    }</span>

    private void startBind(Attributes attributes) throws SAXException {
<span class="nc" id="L861">        ParsedSynthStyle style = null;</span>
<span class="nc" id="L862">        String path = null;</span>
<span class="nc" id="L863">        int type = -1;</span>

<span class="nc bnc" id="L865" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L866">            String key = attributes.getQName(i);</span>

<span class="nc bnc" id="L868" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_STYLE)) {</span>
<span class="nc" id="L869">                style = (ParsedSynthStyle)lookup(attributes.getValue(i),</span>
                                                  ParsedSynthStyle.class);
            }
<span class="nc bnc" id="L872" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_TYPE)) {</span>
<span class="nc" id="L873">                String typeS = attributes.getValue(i).toUpperCase();</span>

<span class="nc bnc" id="L875" title="All 2 branches missed.">                if (typeS.equals(&quot;NAME&quot;)) {</span>
<span class="nc" id="L876">                    type = DefaultSynthStyleFactory.NAME;</span>
                }
<span class="nc bnc" id="L878" title="All 2 branches missed.">                else if (typeS.equals(&quot;REGION&quot;)) {</span>
<span class="nc" id="L879">                    type = DefaultSynthStyleFactory.REGION;</span>
                }
                else {
<span class="nc" id="L882">                    throw new SAXException(&quot;bind: unknown type &quot; + typeS);</span>
                }
<span class="nc" id="L884">            }</span>
<span class="nc bnc" id="L885" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_KEY)) {</span>
<span class="nc" id="L886">                path = attributes.getValue(i);</span>
            }
        }
<span class="nc bnc" id="L889" title="All 6 branches missed.">        if (style == null || path == null || type == -1) {</span>
<span class="nc" id="L890">            throw new SAXException(&quot;bind: you must specify a style, type &quot; +</span>
                                   &quot;and key&quot;);
        }
        try {
<span class="nc" id="L894">            _factory.addStyle(style, path, type);</span>
<span class="nc" id="L895">        } catch (PatternSyntaxException pse) {</span>
<span class="nc" id="L896">            throw new SAXException(&quot;bind: &quot; + path + &quot; is not a valid &quot; +</span>
                                   &quot;regular expression&quot;);
<span class="nc" id="L898">        }</span>
<span class="nc" id="L899">    }</span>

    private void startPainter(Attributes attributes, String type) throws SAXException {
<span class="nc" id="L902">        Insets sourceInsets = null;</span>
<span class="nc" id="L903">        Insets destInsets = null;</span>
<span class="nc" id="L904">        String path = null;</span>
<span class="nc" id="L905">        boolean paintCenter = true;</span>
<span class="nc" id="L906">        boolean stretch = true;</span>
<span class="nc" id="L907">        SynthPainter painter = null;</span>
<span class="nc" id="L908">        String method = null;</span>
<span class="nc" id="L909">        String id = null;</span>
<span class="nc" id="L910">        int direction = -1;</span>
<span class="nc" id="L911">        boolean center = false;</span>

<span class="nc" id="L913">        boolean stretchSpecified = false;</span>
<span class="nc" id="L914">        boolean paintCenterSpecified = false;</span>

<span class="nc bnc" id="L916" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L917">            String key = attributes.getQName(i);</span>
<span class="nc" id="L918">            String value = attributes.getValue(i);</span>

<span class="nc bnc" id="L920" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L921">                id = value;</span>
            }
<span class="nc bnc" id="L923" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_METHOD)) {</span>
<span class="nc" id="L924">                method = value.toLowerCase(Locale.ENGLISH);</span>
            }
<span class="nc bnc" id="L926" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_IDREF)) {</span>
<span class="nc" id="L927">                painter = (SynthPainter)lookup(value, SynthPainter.class);</span>
            }
<span class="nc bnc" id="L929" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_PATH)) {</span>
<span class="nc" id="L930">                path = value;</span>
            }
<span class="nc bnc" id="L932" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_SOURCE_INSETS)) {</span>
<span class="nc" id="L933">                sourceInsets = parseInsets(value, type +</span>
                   &quot;: sourceInsets must be top left bottom right&quot;);
            }
<span class="nc bnc" id="L936" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_DEST_INSETS)) {</span>
<span class="nc" id="L937">                destInsets = parseInsets(value, type +</span>
                  &quot;: destinationInsets must be top left bottom right&quot;);
            }
<span class="nc bnc" id="L940" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_PAINT_CENTER)) {</span>
<span class="nc" id="L941">                paintCenter = value.toLowerCase().equals(&quot;true&quot;);</span>
<span class="nc" id="L942">                paintCenterSpecified = true;</span>
            }
<span class="nc bnc" id="L944" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_STRETCH)) {</span>
<span class="nc" id="L945">                stretch = value.toLowerCase().equals(&quot;true&quot;);</span>
<span class="nc" id="L946">                stretchSpecified = true;</span>
            }
<span class="nc bnc" id="L948" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_DIRECTION)) {</span>
<span class="nc" id="L949">                value = value.toUpperCase().intern();</span>
<span class="nc bnc" id="L950" title="All 2 branches missed.">                if (value == &quot;EAST&quot;) {</span>
<span class="nc" id="L951">                    direction = SwingConstants.EAST;</span>
                }
<span class="nc bnc" id="L953" title="All 2 branches missed.">                else if (value == &quot;NORTH&quot;) {</span>
<span class="nc" id="L954">                    direction = SwingConstants.NORTH;</span>
                }
<span class="nc bnc" id="L956" title="All 2 branches missed.">                else if (value == &quot;SOUTH&quot;) {</span>
<span class="nc" id="L957">                    direction = SwingConstants.SOUTH;</span>
                }
<span class="nc bnc" id="L959" title="All 2 branches missed.">                else if (value == &quot;WEST&quot;) {</span>
<span class="nc" id="L960">                    direction = SwingConstants.WEST;</span>
                }
<span class="nc bnc" id="L962" title="All 2 branches missed.">                else if (value == &quot;TOP&quot;) {</span>
<span class="nc" id="L963">                    direction = SwingConstants.TOP;</span>
                }
<span class="nc bnc" id="L965" title="All 2 branches missed.">                else if (value == &quot;LEFT&quot;) {</span>
<span class="nc" id="L966">                    direction = SwingConstants.LEFT;</span>
                }
<span class="nc bnc" id="L968" title="All 2 branches missed.">                else if (value == &quot;BOTTOM&quot;) {</span>
<span class="nc" id="L969">                    direction = SwingConstants.BOTTOM;</span>
                }
<span class="nc bnc" id="L971" title="All 2 branches missed.">                else if (value == &quot;RIGHT&quot;) {</span>
<span class="nc" id="L972">                    direction = SwingConstants.RIGHT;</span>
                }
<span class="nc bnc" id="L974" title="All 2 branches missed.">                else if (value == &quot;HORIZONTAL&quot;) {</span>
<span class="nc" id="L975">                    direction = SwingConstants.HORIZONTAL;</span>
                }
<span class="nc bnc" id="L977" title="All 2 branches missed.">                else if (value == &quot;VERTICAL&quot;) {</span>
<span class="nc" id="L978">                    direction = SwingConstants.VERTICAL;</span>
                }
<span class="nc bnc" id="L980" title="All 2 branches missed.">                else if (value == &quot;HORIZONTAL_SPLIT&quot;) {</span>
<span class="nc" id="L981">                    direction = JSplitPane.HORIZONTAL_SPLIT;</span>
                }
<span class="nc bnc" id="L983" title="All 2 branches missed.">                else if (value == &quot;VERTICAL_SPLIT&quot;) {</span>
<span class="nc" id="L984">                    direction = JSplitPane.VERTICAL_SPLIT;</span>
                }
                else {
<span class="nc" id="L987">                    throw new SAXException(type + &quot;: unknown direction&quot;);</span>
                }
            }
<span class="nc bnc" id="L990" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_CENTER)) {</span>
<span class="nc" id="L991">                center = value.toLowerCase().equals(&quot;true&quot;);</span>
            }
        }
<span class="nc bnc" id="L994" title="All 2 branches missed.">        if (painter == null) {</span>
<span class="nc bnc" id="L995" title="All 2 branches missed.">            if (type == ELEMENT_PAINTER) {</span>
<span class="nc" id="L996">                throw new SAXException(type +</span>
                             &quot;: you must specify an idref&quot;);
            }
<span class="nc bnc" id="L999" title="All 4 branches missed.">            if (sourceInsets == null &amp;&amp; !center) {</span>
<span class="nc" id="L1000">                throw new SAXException(</span>
                             &quot;property: you must specify sourceInsets&quot;);
            }
<span class="nc bnc" id="L1003" title="All 2 branches missed.">            if (path == null) {</span>
<span class="nc" id="L1004">                throw new SAXException(&quot;property: you must specify a path&quot;);</span>
            }
<span class="nc bnc" id="L1006" title="All 10 branches missed.">            if (center &amp;&amp; (sourceInsets != null || destInsets != null ||</span>
                           paintCenterSpecified || stretchSpecified)) {
<span class="nc" id="L1008">                throw new SAXException(&quot;The attributes: sourceInsets, &quot; +</span>
                                       &quot;destinationInsets, paintCenter and stretch &quot; +
                                       &quot; are not legal when center is true&quot;);
            }
<span class="nc bnc" id="L1012" title="All 2 branches missed.">            painter = new ImagePainter(!stretch, paintCenter,</span>
<span class="nc" id="L1013">                     sourceInsets, destInsets, getResource(path), center);</span>
        }
<span class="nc" id="L1015">        register(id, painter);</span>
<span class="nc bnc" id="L1016" title="All 2 branches missed.">        if (_stateInfo != null) {</span>
<span class="nc" id="L1017">            addPainterOrMerge(_statePainters, method, painter, direction);</span>
        }
<span class="nc bnc" id="L1019" title="All 2 branches missed.">        else if (_style != null) {</span>
<span class="nc" id="L1020">            addPainterOrMerge(_stylePainters, method, painter, direction);</span>
        }
<span class="nc" id="L1022">    }</span>

    private void addPainterOrMerge(List&lt;ParsedSynthStyle.PainterInfo&gt; painters, String method,
                                   SynthPainter painter, int direction) {
        ParsedSynthStyle.PainterInfo painterInfo;
<span class="nc" id="L1027">        painterInfo = new ParsedSynthStyle.PainterInfo(method,</span>
                                                       painter,
                                                       direction);

<span class="nc bnc" id="L1031" title="All 2 branches missed.">        for (Object infoObject: painters) {</span>
            ParsedSynthStyle.PainterInfo info;
<span class="nc" id="L1033">            info = (ParsedSynthStyle.PainterInfo) infoObject;</span>

<span class="nc bnc" id="L1035" title="All 2 branches missed.">            if (painterInfo.equalsPainter(info)) {</span>
<span class="nc" id="L1036">                info.addPainter(painter);</span>
<span class="nc" id="L1037">                return;</span>
            }
<span class="nc" id="L1039">        }</span>

<span class="nc" id="L1041">        painters.add(painterInfo);</span>
<span class="nc" id="L1042">    }</span>

    private void startImageIcon(Attributes attributes) throws SAXException {
<span class="nc" id="L1045">        String path = null;</span>
<span class="nc" id="L1046">        String id = null;</span>

<span class="nc bnc" id="L1048" title="All 2 branches missed.">        for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L1049">            String key = attributes.getQName(i);</span>

<span class="nc bnc" id="L1051" title="All 2 branches missed.">            if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L1052">                id = attributes.getValue(i);</span>
            }
<span class="nc bnc" id="L1054" title="All 2 branches missed.">            else if (key.equals(ATTRIBUTE_PATH)) {</span>
<span class="nc" id="L1055">                path = attributes.getValue(i);</span>
            }
        }
<span class="nc bnc" id="L1058" title="All 2 branches missed.">        if (path == null) {</span>
<span class="nc" id="L1059">            throw new SAXException(&quot;imageIcon: you must specify a path&quot;);</span>
        }
<span class="nc" id="L1061">        register(id, new LazyImageIcon(getResource(path)));</span>
<span class="nc" id="L1062">       }</span>

    private void startOpaque(Attributes attributes) {
<span class="nc bnc" id="L1065" title="All 2 branches missed.">        if (_style != null) {</span>
<span class="nc" id="L1066">            _style.setOpaque(true);</span>
<span class="nc bnc" id="L1067" title="All 2 branches missed.">            for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L1068">                String key = attributes.getQName(i);</span>

<span class="nc bnc" id="L1070" title="All 2 branches missed.">                if (key.equals(ATTRIBUTE_VALUE)) {</span>
<span class="nc" id="L1071">                    _style.setOpaque(&quot;true&quot;.equals(attributes.getValue(i).</span>
<span class="nc" id="L1072">                                                   toLowerCase()));</span>
                }
            }
        }
<span class="nc" id="L1076">    }</span>

    private void startInputMap(Attributes attributes) throws SAXException {
<span class="nc" id="L1079">        _inputMapBindings.clear();</span>
<span class="nc" id="L1080">        _inputMapID = null;</span>
<span class="nc bnc" id="L1081" title="All 2 branches missed.">        if (_style != null) {</span>
<span class="nc bnc" id="L1082" title="All 2 branches missed.">            for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L1083">                String key = attributes.getQName(i);</span>

<span class="nc bnc" id="L1085" title="All 2 branches missed.">                if (key.equals(ATTRIBUTE_ID)) {</span>
<span class="nc" id="L1086">                    _inputMapID = attributes.getValue(i);</span>
                }
            }
        }
<span class="nc" id="L1090">    }</span>

    private void endInputMap() throws SAXException {
<span class="nc bnc" id="L1093" title="All 2 branches missed.">        if (_inputMapID != null) {</span>
<span class="nc" id="L1094">            register(_inputMapID, new UIDefaults.LazyInputMap(</span>
<span class="nc" id="L1095">                     _inputMapBindings.toArray(new Object[_inputMapBindings.</span>
<span class="nc" id="L1096">                     size()])));</span>
        }
<span class="nc" id="L1098">        _inputMapBindings.clear();</span>
<span class="nc" id="L1099">        _inputMapID = null;</span>
<span class="nc" id="L1100">    }</span>

    private void startBindKey(Attributes attributes) throws SAXException {
<span class="nc bnc" id="L1103" title="All 2 branches missed.">        if (_inputMapID == null) {</span>
            // Not in an inputmap, bail.
<span class="nc" id="L1105">            return;</span>
        }
<span class="nc bnc" id="L1107" title="All 2 branches missed.">        if (_style != null) {</span>
<span class="nc" id="L1108">            String key = null;</span>
<span class="nc" id="L1109">            String value = null;</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">            for(int i = attributes.getLength() - 1; i &gt;= 0; i--) {</span>
<span class="nc" id="L1111">                String aKey = attributes.getQName(i);</span>

<span class="nc bnc" id="L1113" title="All 2 branches missed.">                if (aKey.equals(ATTRIBUTE_KEY)) {</span>
<span class="nc" id="L1114">                    key = attributes.getValue(i);</span>
                }
<span class="nc bnc" id="L1116" title="All 2 branches missed.">                else if (aKey.equals(ATTRIBUTE_ACTION)) {</span>
<span class="nc" id="L1117">                    value = attributes.getValue(i);</span>
                }
            }
<span class="nc bnc" id="L1120" title="All 4 branches missed.">            if (key == null || value == null) {</span>
<span class="nc" id="L1121">                throw new SAXException(</span>
                    &quot;bindKey: you must supply a key and action&quot;);
            }
<span class="nc" id="L1124">            _inputMapBindings.add(key);</span>
<span class="nc" id="L1125">            _inputMapBindings.add(value);</span>
        }
<span class="nc" id="L1127">    }</span>

    //
    // SAX methods, these forward to the DocumentHandler if we don't know
    // the element name.
    //

    public InputSource resolveEntity(String publicId, String systemId)
                              throws IOException, SAXException {
<span class="nc bnc" id="L1136" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1137">            return getHandler().resolveEntity(publicId, systemId);</span>
        }
<span class="nc" id="L1139">        return null;</span>
    }

    public void notationDecl(String name, String publicId, String systemId) throws SAXException {
<span class="nc bnc" id="L1143" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1144">            getHandler().notationDecl(name, publicId, systemId);</span>
        }
<span class="nc" id="L1146">    }</span>

    public void unparsedEntityDecl(String name, String publicId,
                                   String systemId, String notationName) throws SAXException {
<span class="nc bnc" id="L1150" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1151">            getHandler().unparsedEntityDecl(name, publicId, systemId,</span>
                                            notationName);
        }
<span class="nc" id="L1154">    }</span>

    public void setDocumentLocator(Locator locator) {
<span class="nc bnc" id="L1157" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1158">            getHandler().setDocumentLocator(locator);</span>
        }
<span class="nc" id="L1160">    }</span>

    public void startDocument() throws SAXException {
<span class="nc bnc" id="L1163" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1164">            getHandler().startDocument();</span>
        }
<span class="nc" id="L1166">    }</span>

    public void endDocument() throws SAXException {
<span class="nc bnc" id="L1169" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1170">            getHandler().endDocument();</span>
        }
<span class="nc" id="L1172">    }</span>

    public void startElement(String uri, String local, String name, Attributes attributes)
                     throws SAXException {
<span class="nc" id="L1176">        name = name.intern();</span>
<span class="nc bnc" id="L1177" title="All 2 branches missed.">        if (name == ELEMENT_STYLE) {</span>
<span class="nc" id="L1178">            startStyle(attributes);</span>
        }
<span class="nc bnc" id="L1180" title="All 2 branches missed.">        else if (name == ELEMENT_STATE) {</span>
<span class="nc" id="L1181">            startState(attributes);</span>
        }
<span class="nc bnc" id="L1183" title="All 2 branches missed.">        else if (name == ELEMENT_FONT) {</span>
<span class="nc" id="L1184">            startFont(attributes);</span>
        }
<span class="nc bnc" id="L1186" title="All 2 branches missed.">        else if (name == ELEMENT_COLOR) {</span>
<span class="nc" id="L1187">            startColor(attributes);</span>
        }
<span class="nc bnc" id="L1189" title="All 2 branches missed.">        else if (name == ELEMENT_PAINTER) {</span>
<span class="nc" id="L1190">            startPainter(attributes, name);</span>
        }
<span class="nc bnc" id="L1192" title="All 2 branches missed.">        else if (name == ELEMENT_IMAGE_PAINTER) {</span>
<span class="nc" id="L1193">            startPainter(attributes, name);</span>
        }
<span class="nc bnc" id="L1195" title="All 2 branches missed.">        else if (name == ELEMENT_PROPERTY) {</span>
<span class="nc" id="L1196">            startProperty(attributes, ELEMENT_PROPERTY);</span>
        }
<span class="nc bnc" id="L1198" title="All 2 branches missed.">        else if (name == ELEMENT_DEFAULTS_PROPERTY) {</span>
<span class="nc" id="L1199">            startProperty(attributes, ELEMENT_DEFAULTS_PROPERTY);</span>
        }
<span class="nc bnc" id="L1201" title="All 2 branches missed.">        else if (name == ELEMENT_SYNTH_GRAPHICS) {</span>
<span class="nc" id="L1202">            startGraphics(attributes);</span>
        }
<span class="nc bnc" id="L1204" title="All 2 branches missed.">        else if (name == ELEMENT_INSETS) {</span>
<span class="nc" id="L1205">            startInsets(attributes);</span>
        }
<span class="nc bnc" id="L1207" title="All 2 branches missed.">        else if (name == ELEMENT_BIND) {</span>
<span class="nc" id="L1208">            startBind(attributes);</span>
        }
<span class="nc bnc" id="L1210" title="All 2 branches missed.">        else if (name == ELEMENT_BIND_KEY) {</span>
<span class="nc" id="L1211">            startBindKey(attributes);</span>
        }
<span class="nc bnc" id="L1213" title="All 2 branches missed.">        else if (name == ELEMENT_IMAGE_ICON) {</span>
<span class="nc" id="L1214">            startImageIcon(attributes);</span>
        }
<span class="nc bnc" id="L1216" title="All 2 branches missed.">        else if (name == ELEMENT_OPAQUE) {</span>
<span class="nc" id="L1217">            startOpaque(attributes);</span>
        }
<span class="nc bnc" id="L1219" title="All 2 branches missed.">        else if (name == ELEMENT_INPUT_MAP) {</span>
<span class="nc" id="L1220">            startInputMap(attributes);</span>
        }
<span class="nc bnc" id="L1222" title="All 2 branches missed.">        else if (name != ELEMENT_SYNTH) {</span>
<span class="nc bnc" id="L1223" title="All 2 branches missed.">            if (_depth++ == 0) {</span>
<span class="nc" id="L1224">                getHandler().startDocument();</span>
            }
<span class="nc" id="L1226">            getHandler().startElement(uri, local, name, attributes);</span>
        }
<span class="nc" id="L1228">    }</span>

    public void endElement(String uri, String local, String name) throws SAXException {
<span class="nc bnc" id="L1231" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1232">            getHandler().endElement(uri, local, name);</span>
<span class="nc" id="L1233">            _depth--;</span>
<span class="nc bnc" id="L1234" title="All 2 branches missed.">            if (!isForwarding()) {</span>
<span class="nc" id="L1235">                getHandler().startDocument();</span>
            }
        }
        else {
<span class="nc" id="L1239">            name = name.intern();</span>
<span class="nc bnc" id="L1240" title="All 2 branches missed.">            if (name == ELEMENT_STYLE) {</span>
<span class="nc" id="L1241">                endStyle();</span>
            }
<span class="nc bnc" id="L1243" title="All 2 branches missed.">            else if (name == ELEMENT_STATE) {</span>
<span class="nc" id="L1244">                endState();</span>
            }
<span class="nc bnc" id="L1246" title="All 2 branches missed.">            else if (name == ELEMENT_INPUT_MAP) {</span>
<span class="nc" id="L1247">                endInputMap();</span>
            }
        }
<span class="nc" id="L1250">    }</span>

    public void characters(char ch[], int start, int length)
                           throws SAXException {
<span class="nc bnc" id="L1254" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1255">            getHandler().characters(ch, start, length);</span>
        }
<span class="nc" id="L1257">    }</span>

    public void ignorableWhitespace (char ch[], int start, int length)
        throws SAXException {
<span class="nc bnc" id="L1261" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1262">            getHandler().ignorableWhitespace(ch, start, length);</span>
        }
<span class="nc" id="L1264">    }</span>

    public void processingInstruction(String target, String data)
                                     throws SAXException {
<span class="nc bnc" id="L1268" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1269">            getHandler().processingInstruction(target, data);</span>
        }
<span class="nc" id="L1271">    }</span>

    public void warning(SAXParseException e) throws SAXException {
<span class="nc bnc" id="L1274" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1275">            getHandler().warning(e);</span>
        }
<span class="nc" id="L1277">    }</span>

    public void error(SAXParseException e) throws SAXException {
<span class="nc bnc" id="L1280" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1281">            getHandler().error(e);</span>
        }
<span class="nc" id="L1283">    }</span>


    public void fatalError(SAXParseException e) throws SAXException {
<span class="nc bnc" id="L1287" title="All 2 branches missed.">        if (isForwarding()) {</span>
<span class="nc" id="L1288">            getHandler().fatalError(e);</span>
        }
<span class="nc" id="L1290">        throw e;</span>
    }


    /**
     * ImageIcon that lazily loads the image until needed.
     */
    private static class LazyImageIcon extends ImageIcon implements UIResource {
        private URL location;

        public LazyImageIcon(URL location) {
<span class="nc" id="L1301">            super();</span>
<span class="nc" id="L1302">            this.location = location;</span>
<span class="nc" id="L1303">        }</span>

        public void paintIcon(Component c, Graphics g, int x, int y) {
<span class="nc bnc" id="L1306" title="All 2 branches missed.">            if (getImage() != null) {</span>
<span class="nc" id="L1307">                super.paintIcon(c, g, x, y);</span>
            }
<span class="nc" id="L1309">        }</span>

        public int getIconWidth() {
<span class="nc bnc" id="L1312" title="All 2 branches missed.">            if (getImage() != null) {</span>
<span class="nc" id="L1313">                return super.getIconWidth();</span>
            }
<span class="nc" id="L1315">            return 0;</span>
        }

        public int getIconHeight() {
<span class="nc bnc" id="L1319" title="All 2 branches missed.">            if (getImage() != null) {</span>
<span class="nc" id="L1320">                return super.getIconHeight();</span>
            }
<span class="nc" id="L1322">            return 0;</span>
        }

        public Image getImage() {
<span class="nc bnc" id="L1326" title="All 2 branches missed.">            if (location != null) {</span>
<span class="nc" id="L1327">                setImage(Toolkit.getDefaultToolkit().getImage(location));</span>
<span class="nc" id="L1328">                location = null;</span>
            }
<span class="nc" id="L1330">            return super.getImage();</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312031056</span></div></body></html>